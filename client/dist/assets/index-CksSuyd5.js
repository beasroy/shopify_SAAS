import{r as n,j as e,R as es}from"./react-CkuKL7a9.js";import{c as _r}from"./react-dom-CtYNSMMY.js";import{N as Ur,L as Ze,B as Vr}from"./react-router-dom-Denq2AzZ.js";import{a as re}from"./axios-CCb-kr4I.js";import{c as Hr}from"./clsx-B-dksMZM.js";import{t as qr}from"./tailwind-merge-Dnoi3Axr.js";import{S as Wr,R as Ga,V as Ba,a as _a,A as Ua,C as Va,b as Qt,T as Ha,D as qa,P as Yr,c as Kr,d as Wa,e as Qr,f as Zr,g as Jr,h as Ya,i as Xr,j as eo,k as Ka,l as so,O as At,m as Ft,n as Qa,o as It,p as Tt,q as Za,r as Ja,s as Xa,t as to,u as en,v as ao,w as sn,x as no,y as ro,z as tn,I as oo,B as Zt,E as an,F as nn,G as rn,H as on,J as ln,K as cn,L as lo,M as dn,N as mn,Q as io,U as un,W as co,X as hn,Y as mo,Z as xn,_ as fn,$ as uo,a0 as ho,a1 as gn,a2 as xo,a3 as fo,a4 as pn,a5 as jn,a6 as go,a7 as bn,a8 as vn,a9 as yn,aa as Nn,ab as wn,ac as po,ad as Cn,ae as Sn,af as jo,ag as bo,ah as kn,ai as An,aj as Fn,ak as vo}from"./@radix-ui-LZHFz-QR.js";import{c as ct}from"./class-variance-authority-Bb4qSo10.js";import{F as yo,a as Mt,b as No}from"./react-icons-B1ZFOMYF.js";import{u as P,a as fe,s as _e,P as wo}from"./react-redux-BFum93nM.js";import{c as ds,a as Co}from"./@reduxjs-CoJy1jWf.js";import{S as $t,L as So,a as qt,U as In,M as dt,b as ko,E as Ao,c as Fo,C as Tn,d as Jt,e as Io,f as Qs,g as Xs,h as Ss,i as Mn,j as Zs,P as Ct,B as $n,k as Lt,l as ws,T as bs,m as To,n as Mo,o as $o,p as Ln,q as Lo,V as Eo,r as Po,X as xs,R as je,s as lt,t as Js,u as at,A as Et,v as Pt,w as pa,x as Xt,y as Oo,z as Ro,D as Do,F as zo,G as ea,H as Ds,I as jt,J as Vs,K as En,N as ve,O as ye,Q as Go,W as Bo,Y as Pn,Z as _o,_ as On,$ as Rn,a0 as Uo,a1 as Ms,a2 as Dn,a3 as Vo,a4 as Ho,a5 as zn,a6 as Gn,a7 as bt,a8 as ja,a9 as qo,aa as Wo,ab as Bn,ac as _n,ad as Un,ae as Yo,af as Ko,ag as Qo,ah as Vn,ai as Hn,aj as Zo,ak as qn,al as Jo,am as Xo,an as el,ao as sl,ap as tl,aq as al,ar as nl,as as rl,at as ol,au as ba,av as Wn}from"./lucide-react-D1_DWYRe.js";import{c as Ke,b as sa,e as pe,f as ll,g as Be}from"./react-router-DI8MYCuW.js";import{C as Y,s as Fs,a as il,F as cl,G as va,H as ya,t as dl,I as ml,J as ul,e as Na}from"./date-fns-t9QZZHOA.js";import{c as hl}from"./reselect-NCCDNIWx.js";import{D as xl}from"./react-day-picker-D-uFFNZa.js";import{l as fl}from"./socket.io-client-CDVIIGn8.js";import{p as gl,a as pl,d as jl,P as bl}from"./redux-persist-C3zyQnfy.js";import{c as vl}from"./redux-DITMfSWq.js";import{R as Yn,B as yl,X as Kn,Y as Qn,T as Nl,a as pt,A as wl,b as Cl}from"./recharts-CIOB5Ncy.js";import{A as Sl}from"./driver.js-D-7DVtGF.js";import{x as Rs}from"./xlsx-js-style-D9kuvFD2.js";import"./eventemitter3-CJ9KO17d.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-BSEpXHBb.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-CPmXGeA2.js";import"./react-style-singleton-DfON9R_v.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DyqfL0R5.js";import"./use-callback-ref-wNvar0eO.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-C5ifrSBn.js";import"./@floating-ui-C6Fk-jMm.js";import"./use-sync-external-store-xms5UOqV.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./lodash-7sBQYrmz.js";import"./react-is-DcfIKM1A.js";import"./react-smooth-z42qxpQa.js";import"./prop-types-DNLruqPx.js";import"./fast-equals-C7I1S-bJ.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-DjFPhhqo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-6_AdwBXU.js";import"./d3-scale-BYIooUZQ.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-BKO53YJi.js";import"./d3-time-QpEiTrED.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function se(...s){return qr(Hr(s))}const Pe=n.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:se("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));Pe.displayName="Input";const Wt=ct("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-black text-white shadow hover:bg-white hover:text-black",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),z=n.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...o},l)=>{const u=r?Wr:"button";return e.jsx(u,{className:se(Wt({variant:a,size:t,className:s})),ref:l,...o})});z.displayName="Button";const kl=ct("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ns=n.forwardRef(({className:s,...a},t)=>e.jsx(Ga,{ref:t,className:se(kl(),s),...a}));ns.displayName=Ga.displayName;const Al=1,Fl=1e6;let _t=0;function Il(){return _t=(_t+1)%Number.MAX_SAFE_INTEGER,_t.toString()}const Ut=new Map,wa=s=>{if(Ut.has(s))return;const a=setTimeout(()=>{Ut.delete(s),nt({type:"REMOVE_TOAST",toastId:s})},Fl);Ut.set(s,a)},Tl=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Al)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?wa(t):s.toasts.forEach(r=>{wa(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},vt=[];let yt={toasts:[]};function nt(s){yt=Tl(yt,s),vt.forEach(a=>{a(yt)})}function Ml({...s}){const a=Il(),t=o=>nt({type:"UPDATE_TOAST",toast:{...o,id:a}}),r=()=>nt({type:"DISMISS_TOAST",toastId:a});return nt({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:o=>{o||r()}}}),{id:a,dismiss:r,update:t}}function Ot(){const[s,a]=n.useState(yt);return n.useEffect(()=>(vt.push(a),()=>{const t=vt.indexOf(a);t>-1&&vt.splice(t,1)}),[s]),{...s,toast:Ml,dismiss:t=>nt({type:"DISMISS_TOAST",toastId:t})}}const $l={user:null},Zn=ds({name:"user",initialState:$l,reducers:{setUser:(s,a)=>{s.user=a.payload},clearUser:s=>{s.user=null},removeBrandFromUser:(s,a)=>{s.user&&(s.user.brands=s.user.brands.filter(t=>t!==a.payload))},addBrandToUser:(s,a)=>{s.user&&!s.user.brands.includes(a.payload)&&s.user.brands.push(a.payload)}}}),{setUser:rt,clearUser:Rt,removeBrandFromUser:Ll,addBrandToUser:xu}=Zn.actions,El=Zn.reducer,Te="https://parallels.messold.com",Pl="parallels-x-messold",ce={primary:{main:"#0EA5E9",light:"#7DD3FC",dark:"#0369A1",bg:"#F0F9FF"},secondary:{main:"#475569",light:"#94A3B8",dark:"#334155",bg:"#F8FAFC"},success:{main:"#10B981",dark:"#047857",bg:"#D7FFDF"},danger:{main:"#F43F5E",dark:"#BE123C",bg:"#FFF1F2"},warning:{main:"#1E40AF",dark:"#1E3A8A",bg:"#EFF6FF"},neutral:{main:"#F59E0B",dark:"#B45309",bg:"#FFFBEB"},text:{primary:"#0F172A",secondary:"#334155",muted:"#64748B"},border:{main:"#CBD5E1",dark:"#94A3B8"},background:{headerGradient:"linear-gradient(to bottom, #F1F5F9, #E2E8F0)"}},Ol=[{id:"FREE",title:"Free Plan",price:"Free",description:"Perfect for getting started with analytics",features:["Basic Analytics Dashboard","Shopify Integration","Daily Data Updates","Basic Reports","Email Support"],buttonText:"Get Started"},{id:"STARTUP",title:"Startup Plan",price:"$10",period:"/month",description:"Ideal for growing businesses",features:["Everything in Free Plan","Real-time Analytics","Custom Dashboards","Advanced Reports","Priority Email Support"],isPopular:!0,buttonText:"Subscribe Now"},{id:"GROWTH",title:"Growth Plan",price:"$50",period:"/month",description:"For businesses ready to scale",features:["Everything in Startup Plan","AI-Powered Insights","White-label Reports","Custom Integrations","Team Collaboration"],buttonText:"Subscribe Now"}],Ca=[{id:1,title:"Brand Setup",description:"Configure your brand details and identity",icon:$t},{id:2,title:"Connect Platforms",description:"Link your marketing and analytics accounts",icon:So}],Rl=[{title:"1. Introduction",content:['Welcome to Messold ("we," "our," or "us"). Your privacy is important to us. This Privacy Policy explains how we collect, use, share, and protect your information when you use our Parallels application.']},{title:"2. Information We Collect",content:["Our application accesses and processes the following user data from Google and Meta:",["Google Ads Data: We access advertising campaign performance and spend data.","Google Analytics Data: We access read-only analytics data and may edit settings.","Meta Ads Data: We access ad account data, campaign insights, and interest-based targeting information."]]},{title:"3. How We Use Google and Meta User Data",content:[["To provide analytics and advertising insights.","To display relevant reports and campaign performance data.","To personalize the user experience.","To enhance and improve our services through data analysis."]]},{title:"4. Data Sharing & Disclosure",content:["We do not sell, rent, or trade your personal information. However, we may share your data:",["With authorized service providers assisting in hosting, analytics, or customer support.","For legal compliance if required by law.","With your consent."]]},{title:"5. Data Retention & Deletion",content:["Users can request:",["Deletion of their data by contacting us at info@messold.com.","Access to stored data via email.","Revocation of Meta data access via Facebook's security settings."]]},{title:"6. Data Security",content:["We take appropriate security measures including encryption, access control, and regular security audits."]},{title:"7. User Rights & Control",content:["You have the right to:",["Revoke our application's access via Google Security Settings.","Revoke our application's access via Meta App Settings.","Request access, correction, or deletion of your data.","Opt-out of non-essential data collection."]]},{title:"8. Compliance with Google API Services Policy & Meta Platform Terms",content:["We comply with the Google API Services User Data Policy, including the Limited Use requirements.","We comply with Meta's Platform Terms and ensure that we process Platform Data only as described in this policy and in accordance with applicable laws."]},{title:"9. GDPR/CCPA Compliance",content:["Residents of the EEA or California have additional rights, including:",["The right to access, correct, or delete your data.","The right to data portability.","The right to restrict or object to data processing."]]},{title:"10. Updates to This Privacy Policy",content:["We may update this Privacy Policy periodically. Any significant changes will be communicated via email or within the application."]},{title:"11. Contact Us",content:["If you have any questions, contact us at:","Email: info@messold.com"]}],Dl=[{title:"1. Terms",content:["By accessing this web site, you are agreeing to be bound by these web site Terms and Conditions of Use, applicable laws and regulations and their compliance. If you disagree with any of the stated terms and conditions, you are prohibited from using or accessing this site. The materials contained in this site are secured by relevant copyright and trade mark law."]},{title:"2. Use License",content:["Permission is allowed to temporarily download one duplicate of the materials (data or programming) on Messold Technologies's site for individual and non-business use only. This is the just a permit of license and not an exchange of title, and under this permit you may not:",["modify or copy the materials;","use the materials for any commercial use, or for any public presentation (business or non-business);","attempt to decompile or rebuild any product or material contained on Messold Technologies's site;","remove any copyright or other restrictive documentations from the materials; or",'transfer the materials to someone else or even "mirror" the materials on other server.'],"This permit might consequently be terminated if you disregard any of these confinements and may be ended by Messold Technologies whenever deemed. After permit termination or when your viewing permit is terminated, you must destroy any downloaded materials in your ownership whether in electronic or printed form."]},{title:"3. Disclaimer",content:[`The materials on Messold Technologies's site are given "as is". Messold Technologies makes no guarantees, communicated or suggested, and thus renounces and nullifies every single other warranties, including without impediment, inferred guarantees or states of merchantability, fitness for a specific reason, or non-encroachment of licensed property or other infringement of rights. Further, Messold Technologies does not warrant or make any representations concerning the precision, likely results, or unwavering quality of the utilization of the materials on its Internet site or generally identifying with such materials or on any destinations connected to this website.`]},{title:"4. Constraints",content:["In no occasion should Messold Technologies or its suppliers subject for any harms (counting, without constraint, harms for loss of information or benefit, or because of business interference,) emerging out of the utilization or powerlessness to utilize the materials on Messold Technologies's Internet webpage, regardless of the possibility that Messold Technologies or a Messold Technologies approved agent has been told orally or in written of the likelihood of such harm. Since a few purviews don't permit constraints on inferred guarantees, or impediments of obligation for weighty or coincidental harms, these confinements may not make a difference to you."]},{title:"5. Amendments and Errata",content:["The materials showing up on Messold Technologies's site could incorporate typographical, or photographic mistakes. Messold Technologies does not warrant that any of the materials on its site are exact, finished, or current. Messold Technologies may roll out improvements to the materials contained on its site whenever without notification. Messold Technologies does not, then again, make any dedication to update the materials."]},{title:"6. Links",content:["Messold Technologies has not checked on the majority of the websites or links connected to its website and is not in charge of the substance of any such connected webpage. The incorporation of any connection does not infer support by Messold Technologies of the site. Utilization of any such connected site is at the user's own risk."]},{title:"7. Site Terms of Use Modifications",content:["Messold Technologies may update these terms of utilization for its website whenever without notification. By utilizing this site you are consenting to be bound by the then current form of these Terms and Conditions of Use."]},{title:"8. Governing Law",content:["Any case identifying with Messold Technologies's site should be administered by the laws of the country of India Messold Technologies State without respect to its contention of law provisions."]},{title:"9. Refunds",content:["Any amount charged is non-refundable."]},{title:"10. Contact Us",content:["If you have any questions about these Terms and Conditions, please contact us at:","Email: info@messold.com"]}],Me={sessionsAndConversion:{primary:{key:"Total Sessions",name:"Sessions"},secondary:{key:"Avg Conv. Rate",name:"Conversion"}},spendAndRoas:{primary:{key:"Total Spend",name:"Spend"},secondary:{key:"Total Purchase ROAS",name:"Purchase ROAS"}}};function zl(){const[s,a]=n.useState(!0),[t,r]=n.useState(""),[o,l]=n.useState(""),[u,m]=n.useState(""),[h,d]=n.useState(!1),[f,w]=n.useState(""),[S,C]=n.useState(!1),{toast:N}=Ot(),b=Ke(),[v,k]=n.useState({username:"",email:"",password:"",shop:""}),g=P(x=>x.user.user),I=fe();n.useEffect(()=>{g!=null&&g.brands&&g.brands.length>0?b("/dashboard"):g!=null&&g.brands&&g.brands.length===0&&b("/first-time-brand-setup")},[g,b]);const L=()=>{a(!s),C(!1)},M=()=>{C(!S)},y=()=>{const x={username:"",email:"",password:"",shop:""};let F=!0;return S?(f.trim()||(x.shop="Shop name is required",F=!1),F):(!s&&!t.trim()&&(x.username="Username is required",F=!1),o.trim()?/\S+@\S+\.\S+/.test(o)||(x.email="Email is invalid",F=!1):(x.email="Email is required",F=!1),u?u.length<8&&(x.password="Password must be at least 8 characters",F=!1):(x.password="Password is required",F=!1),k(x),F)},R=async x=>{if(x.preventDefault(),!!y()){if(S){T();return}try{let F;if(s){if(F=await re.post(`${Te}/api/auth/login/normal`,{email:o,password:u},{withCredentials:!0}),F.data.success){const p={...F.data.user};I(rt(p)),N({title:"Login successful!",description:"Welcome! Redirecting to your dashboard.",variant:"default"}),console.log(g),g!=null&&g.brands&&g.brands.length>0?b("/dashboard"):g!=null&&g.brands&&g.brands.length===0&&b("/first-time-brand-setup")}}else F=await re.post(`${Te}/api/auth/signup`,{username:t,email:o,password:u},{withCredentials:!0}),F.data.success&&(N({title:"Registration successful!",description:"Please log in with your new account.",variant:"default"}),a(!0))}catch(F){re.isAxiosError(F)&&F.response?N({title:"Error",description:F.response.data.message||"An error occurred",variant:"destructive"}):N({title:"Unexpected Error",description:"An unexpected error occurred",variant:"destructive"})}}},E=async()=>{try{const x=await re.get(`${Te}/api/auth/google?context=userLogin`),{authUrl:F}=x.data;window.location.href=F}catch(x){console.error("Error getting Google Auth URL:",x)}},T=async()=>{try{if(!f.trim()){k(p=>({...p,shop:"Shop name is required"}));return}const x=await re.post(`${Te}/api/auth/shopify`,{shop:f,flowType:"login"}),{authUrl:F}=x.data;window.location.href=F}catch(x){console.error("Error getting Shopify Auth URL:",x),N({title:"Error",description:"Failed to connect to Shopify",variant:"destructive"})}};return e.jsxs("div",{className:"flex h-screen",children:[e.jsx("div",{className:"hidden md:flex md:w-1/2 bg-cover bg-center",style:{backgroundImage:"url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2015&q=80')"},children:e.jsx("div",{className:"flex items-center justify-center w-full h-full bg-black bg-opacity-40",children:e.jsxs("div",{className:"text-white text-center p-8",children:[e.jsx("h3",{className:"text-4xl font-bold mb-6",children:"Unified Marketing Analytics"}),e.jsx("p",{className:"text-xl",children:"View your Shopify, Facebook, and Google Ads data all in one place."})]})})}),e.jsx("div",{className:"w-full md:w-1/2 flex items-center justify-center bg-gradient-to-br from-blue-50 to-white p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3",children:S?"Connect Your Shopify Store":s?"Welcome Back":"Create an Account"}),e.jsx("p",{className:"mb-8",children:S?"Enter your Shopify store name to connect":s?"Sign in to access your marketing dashboard":"Join us to view all your marketing data in one place"}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[S?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ns,{htmlFor:"shop",children:"Shopify Store Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(qt,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(Pe,{id:"shop",type:"text",value:f,onChange:x=>w(x.target.value),placeholder:"your-store-name",required:!0,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"})]}),v.shop&&e.jsx("p",{className:"text-red-500 text-sm",children:v.shop}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enter only the store name without .myshopify.com"})]}):e.jsxs(e.Fragment,{children:[!s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ns,{htmlFor:"username",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(In,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(Pe,{id:"username",type:"text",value:t,onChange:x=>r(x.target.value),placeholder:"Enter your username",required:!s,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"})]}),v.username&&e.jsx("p",{className:"text-red-500 text-sm",children:v.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ns,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(dt,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(Pe,{id:"email",type:"email",value:o,onChange:x=>l(x.target.value),placeholder:"Enter your email",required:!0,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"})]}),v.email&&e.jsx("p",{className:"text-red-500 text-sm",children:v.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ns,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ko,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(Pe,{id:"password",type:h?"text":"password",value:u,onChange:x=>m(x.target.value),placeholder:"Enter your password",required:!0,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>d(!h),className:"absolute right-3 top-3",children:h?e.jsx(Ao,{className:"h-5 w-5"}):e.jsx(Fo,{className:"h-5 w-5"})})]}),v.password&&e.jsx("p",{className:"text-red-500 text-sm",children:v.password})]})]}),e.jsx(z,{type:"submit",className:"w-full text-white",children:S?"Connect Shopify Store":s?"Sign In":"Sign Up"})]}),!S&&e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 items-center justify-center mt-6 w-full ",children:[e.jsx("div",{children:e.jsxs(z,{variant:"outline",className:"w-full flex items-center justify-center space-x-2",onClick:E,children:[e.jsx(yo,{className:"h-5 w-5"}),e.jsx("span",{children:"Continue with Google"})]})}),e.jsx("div",{children:e.jsxs(z,{variant:"outline",className:"w-full flex items-center justify-center space-x-2",onClick:M,children:[e.jsx(qt,{className:"h-5 w-5 text-[#95BF47]"}),e.jsx("span",{children:"Continue with Shopify"})]})})]}),e.jsx("p",{className:"mt-6 text-center text-sm",children:S?e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:M,className:"font-semibold hover:underline",children:["Back to ",s?"Sign In":"Sign Up"]})}):e.jsxs(e.Fragment,{children:[s?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:L,className:"font-semibold hover:underline",children:s?"Sign Up":"Sign In"})]})})]})})]})}const Gl=Yr,Jn=n.forwardRef(({className:s,...a},t)=>e.jsx(Ba,{ref:t,className:se("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));Jn.displayName=Ba.displayName;const Bl=ct("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Xn=n.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(_a,{ref:r,className:se(Bl({variant:a}),s),...t}));Xn.displayName=_a.displayName;const _l=n.forwardRef(({className:s,...a},t)=>e.jsx(Ua,{ref:t,className:se("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));_l.displayName=Ua.displayName;const er=n.forwardRef(({className:s,...a},t)=>e.jsx(Va,{ref:t,className:se("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Qt,{className:"h-4 w-4"})}));er.displayName=Va.displayName;const sr=n.forwardRef(({className:s,...a},t)=>e.jsx(Ha,{ref:t,className:se("text-sm font-semibold [&+div]:text-xs",s),...a}));sr.displayName=Ha.displayName;const tr=n.forwardRef(({className:s,...a},t)=>e.jsx(qa,{ref:t,className:se("text-sm opacity-90",s),...a}));tr.displayName=qa.displayName;function Ul(){const{toasts:s}=Ot();return e.jsxs(Gl,{children:[s.map(function({id:a,title:t,description:r,action:o,...l}){return e.jsxs(Xn,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(sr,{children:t}),r&&e.jsx(tr,{children:r})]}),o,e.jsx(er,{})]},a)}),e.jsx(Jn,{})]})}const Vl={selectedBrandId:null,brands:[]},ar=ds({name:"brand",initialState:Vl,reducers:{setSelectedBrandId:(s,a)=>{s.selectedBrandId=a.payload},setBrands:(s,a)=>{s.brands=a.payload},deleteBrand:(s,a)=>{s.brands=s.brands.filter(t=>t._id!==a.payload),s.selectedBrandId===a.payload&&(s.selectedBrandId=null)},resetBrand:s=>{s.selectedBrandId=null,s.brands=[]}}}),{setSelectedBrandId:Nt,setBrands:ta,deleteBrand:Hl,resetBrand:Dt}=ar.actions,ql=ar.reducer,et=Qr,Je=Zr,ss=Jr,Ye=n.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Kr,{children:e.jsx(Wa,{ref:r,sideOffset:a,className:se("z-50 overflow-hidden rounded-md bg-black px-3 py-1.5 text-xs text-white animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));Ye.displayName=Wa.displayName;const aa="/assets/messold-icon-jcccRy_s.png",na=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ya,{ref:r,className:se("relative overflow-hidden",s),...t,children:[e.jsx(Xr,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(nr,{}),e.jsx(eo,{})]}));na.displayName=Ya.displayName;const nr=n.forwardRef(({className:s,orientation:a="vertical",...t},r)=>e.jsx(Ka,{ref:r,orientation:a,className:se("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(so,{className:"relative flex-1 rounded-full bg-border"})}));nr.displayName=Ka.displayName;const Re=({width:s="1.25rem",height:a="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:a,width:s},children:[e.jsx("rect",{x:"17",y:"2",width:"2rem",height:"2rem",rx:"2.5",fill:"#F9AB00"}),e.jsx("path",{d:"M9.5 13.5C9.5 12.1193 10.6193 11 12 11C13.3807 11 14.5 12.1193 14.5 13.5V19.5C14.5 20.8807 13.3807 22 12 22C10.6193 22 9.5 20.8807 9.5 19.5V13.5Z",fill:"#E37400"}),e.jsx("path",{d:"M2 19.5C2 18.1193 3.11929 17 4.5 17C5.88071 17 7 18.1193 7 19.5C7 20.8807 5.88071 22 4.5 22C3.11929 22 2 20.8807 2 19.5Z",fill:"#E37400"}),e.jsx("path",{d:"M6.92162 10C6.36184 10 5.95724 9.68838 5.95724 9.05977V8.55474H3.2304C2.49881 8.55474 2 8.1088 2 7.45332C2 7.07723 2.12193 6.70651 2.40459 6.22297C2.93666 5.29349 3.57403 4.31565 4.31116 3.23573C4.92637 2.31162 5.39747 2 6.20111 2C7.2209 2 7.88044 2.54265 7.88044 3.38617V7.02351H8.19082C8.72842 7.02351 9 7.34587 9 7.79181C9 8.23774 8.72288 8.55474 8.19082 8.55474H7.88044V9.05977C7.88044 9.68838 7.47585 10 6.92162 10ZM6.01267 7.09335V3.48287H5.97387C5.0095 4.8368 4.34996 5.83076 3.7015 7.03962V7.09335H6.01267Z",fill:"#E37400"})]}),rr=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{viewBox:"0 0 64 64",style:{height:a,width:s},xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{children:[e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-11.703,9.951-12.889,15.008    c-3.078,0.956-5.266,1.638-5.542,1.728C9.943,18.42,9.89,18.474,9.667,20.1C9.495,21.331,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#95C675"})}),e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-9.873,9.951-11.059,15.008    c-3.078,0.956-5.44,6.219-5.719,6.307c-1.719,0.542-1.772,0.596-1.996,2.223C11.148,25.91,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#79B259"})}),e.jsx("path",{d:"M40.022,62.857L59,58.731c0,0-6.661-45.261-6.703-45.572c-0.042-0.311-0.313-0.482-0.538-0.5   c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631c-0.192-0.194-0.479-0.249-0.75-0.251   c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839L40.022,62.857z",fill:"#55932C"}),e.jsx("path",{d:"M33.583,2.977c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844   c-7.887,0-11.674,9.873-12.875,14.947l2.447-0.759c1.354-4.609,4.545-12.053,10.209-12.053c0.346,0,0.688,0.116,1.018,0.345   c-2.532,1.195-5.244,4.209-6.398,10.213l2.43-0.75c1.182-4.541,3.381-6.739,5.307-7.569c0.484,1.227,0.803,2.988,0.803,5.363   c0,0.108,0,0.211-0.002,0.314l2.078-0.643c0-0.2,0.002-0.4,0.002-0.617c0-1.966-0.273-3.551-0.709-4.807   c1.746,0.218,2.912,2.213,3.662,4.508l1.938-0.601C38.906,5.876,36.976,2.977,33.583,2.977z",fill:"#4A7A2B"}),e.jsx("path",{d:"M47.611,12.348c-0.474-0.037-0.793-0.06-0.793-0.06s-3.28-3.271-3.639-3.631   c-0.192-0.194-0.479-0.249-0.75-0.251c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839l0.396,0.075l10.098-2.196L47.611,12.348z",fill:"#4C822A"})]})}),qe=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{style:{height:a,width:s},fill:"#1877F2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),Ue=({width:s="1.25rem",height:a="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:a,width:s},children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),Wl=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",style:{width:s,height:a},fill:"#ffffff",children:e.jsx("g",{fill:"#ffffff",fillRule:"nonzero",stroke:"none",strokeWidth:"1",strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:"10",fontFamily:"none",fontWeight:"none",fontSize:"none",textAnchor:"none",style:{mixBlendMode:"normal"},children:e.jsx("g",{transform:"scale(5.12,5.12)",children:e.jsx("path",{d:"M35,3c-2.206,0 -4,1.794 -4,4v10h-10c-2.19733,0 -4,1.80267 -4,4v10h-10c-2.19733,0 -4,1.80267 -4,4v8c0,2.19733 1.80267,4 4,4h24h1h11c2.206,0 4,-1.794 4,-4v-36c0,-2.206 -1.794,-4 -4,-4zM21,19h10v26h-24c-1.11667,0 -2,-0.88333 -2,-2v-8c0,-1.11667 0.88333,-2 2,-2h11c0.55226,-0.00006 0.99994,-0.44774 1,-1v-11c0,-1.11667 0.88333,-2 2,-2z"})})})}),Yl=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",style:{width:s,height:a},fill:"#ffffff",children:e.jsx("path",{d:"M 25.167969 5.0058594 C 24.781877 4.9968865 24.394532 5.014912 24.007812 5.0625 C 22.976561 5.1894012 21.954004 5.5214624 21 6.0722656 C 19.738126 6.8008205 18.867614 7.8795934 18.189453 9.0625 L 18.074219 8.9960938 L 4.0742188 32.996094 L 4.1894531 33.0625 C 3.5013617 34.243015 3 35.539748 3 37 C 3 41.406432 6.5935644 45 11 45 C 13.946182 45 16.422265 43.319288 17.810547 40.9375 L 17.925781 41.003906 L 25 28.876953 L 32.074219 41.003906 C 34.278505 44.817 39.185255 46.130214 43 43.927734 C 46.816027 41.724515 48.130947 36.816015 45.927734 33 L 45.927734 32.998047 L 31.927734 9 C 30.481872 6.4957324 27.870611 5.0686695 25.167969 5.0058594 z M 25.130859 6.9960938 C 27.155284 7.0392142 29.104113 8.1100176 30.195312 10 L 30.197266 10.001953 L 30.197266 10.003906 L 44.197266 34.003906 C 45.856861 36.883192 44.878669 40.533286 42 42.195312 C 39.120015 43.8581 35.467467 42.879973 33.804688 40 L 33.802734 39.998047 L 19.804688 16 L 19.804688 15.998047 L 19.802734 15.996094 C 18.143139 13.116808 19.121331 9.4667144 22 7.8046875 C 22.719996 7.3889907 23.488252 7.1380832 24.261719 7.0410156 C 24.551769 7.0046153 24.841656 6.9899337 25.130859 6.9960938 z M 17.212891 14.441406 C 17.372969 15.315284 17.603702 16.188437 18.072266 17 L 18.072266 17.001953 L 23.841797 26.892578 L 18.728516 35.658203 C 18.065728 31.912371 14.931107 29 11 29 C 10.084587 29 9.236334 29.238188 8.4160156 29.523438 L 17.212891 14.441406 z M 11 31 C 14.325556 31 17 33.674446 17 37 C 17 40.325554 14.325556 43 11 43 C 7.6744439 43 5 40.325554 5 37 C 5 33.674446 7.6744439 31 11 31 z"})}),zt=Ja,Kl=Xa,Ql=Za,or=n.forwardRef(({className:s,...a},t)=>e.jsx(At,{ref:t,className:se("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));or.displayName=At.displayName;const mt=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(Ql,{children:[e.jsx(or,{}),e.jsxs(Ft,{ref:r,className:se("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(Qa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));mt.displayName=Ft.displayName;const ut=({className:s,...a})=>e.jsx("div",{className:se("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});ut.displayName="DialogHeader";const ht=n.forwardRef(({className:s,...a},t)=>e.jsx(It,{ref:t,className:se("text-lg font-semibold leading-none tracking-tight",s),...a}));ht.displayName=It.displayName;const ra=n.forwardRef(({className:s,...a},t)=>e.jsx(Tt,{ref:t,className:se("text-sm text-muted-foreground",s),...a}));ra.displayName=Tt.displayName;function He({className:s,...a}){return e.jsx("div",{className:se("animate-pulse rounded-md bg-primary/10",s),...a})}function Zl({open:s,onOpenChange:a}){var b;const{selectedBrandId:t,brands:r}=P(v=>v.brand),[o,l]=n.useState(null),[u,m]=n.useState(!0),h=r.find(v=>v._id===t),d=((b=h==null?void 0:h.shopifyAccount)==null?void 0:b.shopName.replace(".myshopify.com",""))||"",f=Pl,w=P(v=>v.brand.selectedBrandId);n.useEffect(()=>{s&&S()},[s]);const S=async()=>{try{m(!0);const v=await re.get(`${Te}/api/pricing/details/${w}`,{withCredentials:!0});l(v.data)}catch(v){console.error("Error fetching subscription details:",v)}finally{m(!1)}},N=o?(v=>({"Free Plan":"FREE","Startup Plan":"STARTUP","Growth Plan":"GROWTH"})[v]||"FREE")(o.planName):null;return e.jsx(zt,{open:s,onOpenChange:a,children:e.jsxs(mt,{className:"max-w-5xl p-0 overflow-auto max-h-[90vh]",children:[e.jsx(ut,{className:"p-6 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(ht,{className:"text-2xl font-bold text-center",children:"Find Your Perfect Plan"})})}),u?e.jsx("div",{className:"px-6 pt-6",children:e.jsx(He,{className:"h-24 w-full rounded-lg"})}):o?e.jsx("div",{className:"px-6",children:e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:["Current Plan:"," ",e.jsx("span",{className:`ml-2 ${N==="FREE"?"text-teal-600":N==="STARTUP"?"text-violet-600":"text-rose-600"}`,children:o.planName})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["Status: ",e.jsx("span",{className:"font-medium text-green-600 capitalize",children:o.status})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.trialDaysRemaining>0&&e.jsxs("div",{className:"flex items-center bg-amber-50 text-amber-700 px-4 py-2 rounded-md border border-amber-200",children:[e.jsx(Tn,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Trial ends in ",o.trialDaysRemaining," days"]}),e.jsx("p",{className:"text-xs",children:Y(new Date(o.trialEndsOn),"MMM dd, yyyy")})]})]}),e.jsxs("div",{className:"flex items-center bg-blue-50 text-blue-700 px-4 py-2 rounded-md border border-blue-200",children:[e.jsx(Jt,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Next billing in ",o.daysUntilBilling," days"]}),e.jsx("p",{className:"text-xs",children:Y(new Date(o.billingOn),"MMM dd, yyyy")})]})]})]})]})})}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid lg:grid-cols-3 gap-6",children:Ol.map(v=>{const k=N===v.id;return e.jsxs("div",{className:`relative bg-white rounded-xl overflow-hidden border transition-all duration-300 hover:shadow-lg ${k?"border-2 border-blue-500 shadow-md":v.isPopular&&!k?"border-slate-200 shadow-md hover:scale-105":"border-slate-100 hover:scale-105"}`,children:[k&&e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white text-xs font-semibold py-1 px-3 rounded-bl-lg",children:"CURRENT PLAN"}),v.isPopular&&!k&&e.jsxs("div",{className:"absolute top-0 left-0 bg-amber-500 text-white text-xs font-semibold py-1 px-3 rounded-br-lg",children:[e.jsx(Io,{className:"h-3.5 w-3.5 fill-white inline-block mr-1"})," POPULAR"]}),e.jsxs("div",{className:`p-6 flex flex-col items-center ${v.id==="FREE"?"bg-gradient-to-b from-teal-50 to-white":v.id==="STARTUP"?"bg-gradient-to-b from-violet-50 to-white":"bg-gradient-to-b from-rose-50 to-white"}`,children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:v.title}),e.jsxs("div",{className:"flex items-baseline mt-4",children:[e.jsx("span",{className:`text-4xl font-bold ${v.id==="FREE"?"text-teal-600":v.id==="STARTUP"?"text-violet-600":"text-rose-600"}`,children:v.price}),v.period&&e.jsx("span",{className:"text-slate-500 ml-1",children:v.period})]}),e.jsx("p",{className:"mt-3 text-slate-600 text-sm text-center",children:v.description})]}),e.jsx("div",{className:"w-full h-px bg-slate-100"}),e.jsxs("div",{className:"p-6 bg-white",children:[e.jsx("ul",{className:"space-y-4",children:v.features.map((g,I)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 rounded-full p-0.5 mt-0.5 ${v.id==="FREE"?"bg-teal-100 text-teal-600":v.id==="STARTUP"?"bg-violet-100 text-violet-600":"bg-rose-100 text-rose-600"}`,children:e.jsx(Qs,{className:"h-4 w-4"})}),e.jsx("span",{className:"ml-3 text-slate-700 text-sm",children:g})]},I))}),e.jsx("div",{className:"mt-8",children:e.jsx("a",{href:`https://admin.shopify.com/store/${d}/charges/${f}/pricing_plans`,children:e.jsx("button",{className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 ${k?"bg-slate-200 text-slate-700 cursor-default":v.id==="FREE"?"bg-teal-600 hover:bg-teal-700 text-white":v.id==="STARTUP"?"bg-violet-600 hover:bg-violet-700 text-white":"bg-rose-600 hover:bg-rose-700 text-white"}`,disabled:k,children:k?"Current Plan":v.buttonText})})})]})]},v.id)})})})]})})}function ts(){var M;const[s,a]=n.useState(!0),[t,r]=n.useState(!1),[o,l]=n.useState(!1),u=sa(),m=Ke(),h=n.useRef(null),d=fe(),f=P(y=>y.brand.selectedBrandId),w=P(y=>y.brand.brands),S=P(y=>y.user.user),C=n.useCallback(async()=>{try{if(!(S!=null&&S.brands)||S.brands.length===0){console.warn("No brand IDs found in user context.");return}const y=await re.post(`${Te}/api/brands/filter`,{brandIds:S.brands},{withCredentials:!0});d(ta(y.data)),!f&&y.data.length>0&&(d(Nt(y.data[0]._id)),o&&(m("/dashboard"),l(!1)))}catch(y){console.error("Error fetching brands:",y)}},[S==null?void 0:S.brands,d,f,o,m]);n.useEffect(()=>{C()},[C]);const N=()=>a(y=>!y),b=async()=>{try{(await re.post(`${Te}/api/auth/logout`,{},{withCredentials:!0})).status===200&&(d(Rt()),d(Dt()),m("/"),l(!0))}catch(y){console.error("Error logging out:",y)}};n.useEffect(()=>{const y=u.pathname.split("/");y[2]&&d(Nt(y[2]))},[u.pathname,d]);const v=()=>{const y=u.pathname.split("/");return y.length>=2?y[1]:"dashboard"},k=y=>{if(d(Nt(y)),!o){const R=v();if(R==="dashboard"){m("/dashboard");return}const E=u.pathname.split("/");E.length>=3?(E[2]=y,m(E.join("/"))):m(`/${R}/${y}`)}},g=()=>{r(!0)},I=[{name:"Business Overview",path:"/dashboard",icon:e.jsx($n,{size:20})},{name:"Marketing Insights Tracker",path:`/marketing-insights/${f}`,icon:e.jsx(Lt,{size:20})},{name:"Ad Metrics Hub",path:`/admetrics/${f}`,icon:e.jsx(ws,{size:20})},{name:"GA4 Analytics",path:"#",icon:e.jsx(Wl,{}),subItems:[{name:"E-Commerce Insights",path:`/ecommerce-reports/${f}`},{name:"Conversion Lens",path:`/conversion-reports/${f}`}]},{name:"Meta",path:"#",icon:e.jsx(Mt,{}),subItems:[{name:"Campaign Analysis",path:`/meta-campaigns/${f}`},{name:"Interest 360",path:`/meta-interest/${f}`},{name:"Meta Reports",path:`/meta-reports/${f}`}]},{name:"Google Reports",path:`/google-reports/${f}`,icon:e.jsx(Yl,{})},{name:"Brands Targets",path:"/performance-metrics",icon:e.jsx(bs,{size:20})}],L=y=>{if(!f)return!0;const R=w.find(E=>E._id===f);return(y.name==="Analytics Dashboard"||y.name==="Campaign Metrics")&&!(R!=null&&R.fbAdAccounts)&&!(R!=null&&R.googleAdAccount)};return e.jsxs(et,{children:[e.jsxs("div",{ref:h,className:`bg-[rgb(4,16,33)] text-white transition-all duration-500 ease-in-out flex flex-col ${s?"w-56":"w-16"}`,style:{height:"100vh"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 relative",children:[e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>m("/dashboard"),children:[e.jsx("img",{src:aa,alt:"Messold Logo",className:"h-8 w-8"}),s?e.jsx("span",{className:"text-sm ml-2",children:"Messold"}):null]}),e.jsx("span",{className:"transition-all duration-300 ease-in-out bg-[rgb(4,16,33)] rounded-full flex items-center justify-center",style:{width:"25px",height:"25px",position:"absolute",right:"-10px",top:"50%",transform:"translateY(-50%)",zIndex:50},onClick:N,children:s?e.jsx(Xs,{size:15}):e.jsx(Ss,{size:15})})]}),e.jsx("div",{className:`flex-1 overflow-y-auto ${s?"h-[calc(100vh-64px)]":"h-[calc(100vh-16px)]"}`,children:e.jsx(na,{className:"h-full",children:e.jsxs("nav",{className:"mt-3",children:[e.jsxs(Xl,{icon:e.jsx(qt,{size:24}),text:f?((M=w.find(y=>y._id===f))==null?void 0:M.name.replace(/_/g," "))||"Unknown Brand":"Your Brands",isExpanded:s,openIcon:e.jsx(Mn,{}),closeIcon:e.jsx(Zs,{}),isSelected:!!f,tooltipContent:"Your Brands",autoOpenOnSelect:!1,children:[w.map(y=>e.jsx(Jl,{path:"#",text:y.name.replace(/_/g," "),onClick:()=>k(y._id),isSelected:f===y._id},y._id)),e.jsxs("div",{className:"flex items-center text-xs  p-2 transition-colors duration-200 text-gray-300 hover:bg-gray-700 hover:text-white cursor-pointer border border-dashed border-gray-500 rounded-md mx-2 mb-2",children:[e.jsx(Ct,{size:16,className:"mr-2"}),e.jsx("span",{children:"Add Brand"})]})]}),I.map((y,R)=>{var F;const E=(F=y.subItems)==null?void 0:F.some(p=>u.pathname===p.path),T=u.pathname.startsWith(y.path)&&y.path!=="#"||E,x=e.jsxs("div",{className:`flex items-center px-4 py-1.5 mb-1 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 ${y.subItems?"cursor-auto":"cursor-pointer"}
                      ${T?"text-white font-semibold relative":"text-gray-100"} ${L(y)?"cursor-not-allowed opacity-50":""}`,onClick:()=>{!L(y)&&y.path&&y.path!=="#"&&!y.subItems&&m(y.path)},children:[e.jsx("span",{className:"mr-2",children:y.icon}),s&&e.jsx("span",{className:"text-xs",children:y.name}),s&&y.subItems&&e.jsx("span",{className:"ml-auto"})]});return e.jsxs("div",{children:[s?x:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:x}),e.jsxs(Ye,{side:"right",children:[e.jsx("p",{children:y.name}),y.subItems&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-[1px] w-full my-2 bg-gray-400"}),e.jsx("div",{className:"mt-1",children:y.subItems.map((p,c)=>{const i=L(p);return e.jsx("div",{className:`text-xs py-1.5 px-1 rounded transition-colors ${i?"cursor-not-allowed opacity-50":"hover:bg-gray-700 cursor-pointer"}`,onClick:A=>{A.stopPropagation(),i||m(p.path)},children:p.name},c)})})]})]})]}),s&&y.subItems&&e.jsxs("div",{className:"pl-8 mb-2",children:[e.jsx("div",{className:"h-[1px] w-2/3 my-2 bg-gray-400"}),y.subItems.map((p,c)=>{const i=L(p);return e.jsx("div",{className:`flex items-center text-xs w-full p-2 transition-colors duration-200 ${i?"opacity-50":"cursor-pointer hover:bg-gray-700"} ${u.pathname===p.path&&!i?"text-white font-semibold relative bg-gray-800":"text-gray-100"}`,onClick:()=>{i||m(p.path)},children:e.jsx("span",{children:p.name})},c)})]})]},R)})]})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(ti,{isExpanded:s,handlePricing:g}),e.jsx(ei,{isExpanded:s,user:S}),e.jsx(si,{handleLogout:b,isExpanded:s})]})]}),e.jsx(Zl,{open:t,onOpenChange:r})]})}function Jl({path:s,text:a,onClick:t,disabled:r=!1,isSelected:o=!1,children:l}){const[u,m]=n.useState(!1),h=es.Children.count(l)>0,d=()=>{h&&m(b=>!b)},f=es.Children.toArray(l).some(b=>{var v;return(v=b==null?void 0:b.props)==null?void 0:v.isSelected}),w=o||f;n.useEffect(()=>{w&&m(!0)},[w]);const S=`flex items-center text-xs w-full p-2 transition-colors duration-200 
      ${w?"text-white font-semibold relative bg-gray-800":"text-gray-100"} 
      ${r?"cursor-not-allowed text-gray-400":"hover:bg-gray-700"}`,C=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:a}),h&&e.jsx("span",{className:"ml-2",children:u?e.jsx(Mn,{}):e.jsx(Zs,{})})]}),w&&e.jsx("div",{className:"absolute left-0 top-0 w-1 h-full bg-white"})]}),N=r?e.jsx("div",{className:S,children:C}):e.jsx(Ur,{to:s,className:S,onClick:b=>{(s==="/#"||!s||s==="#")&&b.preventDefault(),h&&d(),t&&t()},children:C});return e.jsxs("div",{children:[N,u&&h&&e.jsxs("div",{className:"relative pl-4",children:[e.jsx("div",{className:"absolute top-0 left-4 w-1 h-full bg-gray-500"}),l]})]})}function Xl({icon:s,text:a,isExpanded:t,openIcon:r,closeIcon:o,children:l,isSelected:u,tooltipContent:m,onClick:h,disabled:d,autoOpenOnSelect:f=!0}){const[w,S]=n.useState(!1),C=es.Children.count(l)>0,N=()=>{C&&S(g=>!g)},b=es.Children.toArray(l).some(g=>{var I,L;return(I=g==null?void 0:g.props)!=null&&I.isSelected?!0:(L=g==null?void 0:g.props)!=null&&L.children?es.Children.toArray(g.props.children).some(M=>{var y;return(y=M==null?void 0:M.props)==null?void 0:y.isSelected}):!1}),v=u||b;n.useEffect(()=>{f&&v&&S(!0)},[v,f]);const k=e.jsxs("div",{onClick:()=>{C&&N(),!d&&h&&h()},className:`flex items-center px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer ${v?"text-white font-semibold relative":"text-gray-100"} ${d?"cursor-not-allowed opacity-50":""}`,children:[e.jsx("span",{className:"mr-2",children:s}),t&&e.jsx("span",{className:"text-xs",children:a}),t&&e.jsx("span",{className:"ml-auto",children:w?r:o})]});return e.jsxs("div",{children:[t?k:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:k}),e.jsxs(Ye,{side:"right",children:[e.jsx("p",{className:es.Children.count(l)>0?"mb-4":"",children:m}),es.Children.map(l,g=>e.jsx("div",{className:"relative",children:g}))]})]}),w&&t&&e.jsx("div",{className:"relative pl-8",children:es.Children.map(l,g=>e.jsx("div",{children:g}))})]})}function ei({isExpanded:s,user:a}){const t=Ke(),r=e.jsxs("div",{onClick:()=>t("/profile"),className:"flex items-center gap-3 px-3 py-1.5 mb-1 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(To,{size:24})}),s&&e.jsx("span",{className:"text-sm mr-2",children:(a==null?void 0:a.username)||"user"})]});return e.jsx("div",{children:s?r:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:r}),e.jsx(Ye,{side:"right",children:e.jsx("p",{children:(a==null?void 0:a.username)||"user"})})]})})}function si({handleLogout:s,isExpanded:a}){const t=e.jsxs("div",{onClick:s,className:"flex items-center gap-3 px-3 py-1.5 mb-1 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(Mo,{size:24})}),a&&e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]});return e.jsx("div",{children:a?t:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:t}),e.jsx(Ye,{side:"right",children:e.jsx("p",{children:"Logout"})})]})})}function ti({handlePricing:s,isExpanded:a}){const t=e.jsxs("div",{onClick:s,className:"flex items-center gap-3 px-3 py-1.5 mb-1 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx($o,{size:24})}),a&&e.jsx("span",{className:"hidden sm:inline",children:"Pricing"})]});return e.jsx("div",{children:a?t:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:t}),e.jsx(Ye,{side:"right",children:e.jsx("p",{children:"Pricing"})})]})})}const oe=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:se("rounded-xl border bg-card text-card-foreground shadow",s),...a}));oe.displayName="Card";const Cs=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:se("flex flex-col space-y-1.5 p-3",s),...a}));Cs.displayName="CardHeader";const Hs=n.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:se("font-semibold leading-none tracking-tight",s),...a}));Hs.displayName="CardTitle";const lr=n.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:se("text-sm text-muted-foreground",s),...a}));lr.displayName="CardDescription";const de=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:se("p-4 pt-3",s),...a}));de.displayName="CardContent";const ai=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:se("flex items-center p-6 pt-0",s),...a}));ai.displayName="CardFooter";const ni=()=>e.jsxs(oe,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(Cs,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 rounded-full"}),e.jsx(He,{className:"h-6 w-24"})]}),e.jsx(He,{className:"h-4 w-32 mt-2"})]}),e.jsx(de,{children:e.jsx(He,{className:"h-8 w-20 mt-2"})})]}),ri=({label:s,value:a,date:t,icon:r,tooltipContent:o})=>{const l=u=>u?(typeof u=="string"&&(u=new Date(u)),u.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})):"";return e.jsxs(oe,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(Cs,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[r==="Facebook"?e.jsx(qe,{width:"1rem",height:"1rem"}):r==="Google"?e.jsx(Ue,{width:"1rem",height:"1rem"}):null,e.jsx("div",{className:"text-base font-medium",children:s}),o&&e.jsx(et,{children:e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx("button",{className:"p-0 m-0","aria-label":`Info about ${s}`,children:e.jsx(Ln,{className:"w-3 h-3 text-gray-400"})})}),e.jsxs(Ye,{className:"w-64 p-0 bg-white text-black border shadow-sm",children:[e.jsx("div",{className:"p-2 font-semibold border-black",children:s}),e.jsx("div",{className:"w-full h-[0.5px] bg-black"}),e.jsx("div",{className:"p-2",children:o})]})]})})]}),e.jsxs("div",{className:"text-xs text-gray-500 font-bold",children:[l(t.from),t.from&&t.to?" - ":"",l(t.to)]})]}),e.jsx(de,{children:e.jsx("p",{className:"text-lg lg:text-xl 2xl:text-2xl font-bold text-teal-800",children:a})})]})},Vt=({title:s,metrics:a=[],date:t,isLoading:r=!1,icon:o,errorMessage:l})=>l&&!r?e.jsx("section",{className:s?"mt-10":"",children:e.jsxs(oe,{className:"p-4",children:[e.jsx(Cs,{children:e.jsx("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})})}),e.jsx(de,{children:e.jsx("p",{className:"text-red-600 text-sm",children:l})})]})}):e.jsxs("section",{className:s?"mt-10":"",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:r?Array(a.length).fill(0).map((u,m)=>e.jsx(ni,{},m)):a.map((u,m)=>e.jsx(e.Fragment,{children:e.jsx(ri,{label:u.label,value:u.value,date:t,icon:o,tooltipContent:u.tooltipContent},m)}))})]});function St({className:s,classNames:a,showOutsideDays:t=!0,...r}){return e.jsx(xl,{showOutsideDays:t,className:se("px-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-xs font-medium",nav:"space-x-1 flex items-center",nav_button:se(Wt({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-7 font-normal text-[0.6rem]",row:"flex w-full mt-2",cell:se("relative p-0 text-center text-[0.7rem] focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",r.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:se(Wt({variant:"ghost"}),"h-7 w-7 p-0 font-normal aria-selected:opacity-100 text-[0.7rem]"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-black text-white hover:bg-black hover:text-white focus:bg-black focus:text-white",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-gray-400 opacity-50  aria-selected:bg-gray-400/50 aria-selected:text-accent-foreground aria-selected:opacity-30",day_disabled:"text-accent-foreground opacity-50",day_range_middle:"aria-selected:bg-gray-100 aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:()=>e.jsx(to,{className:"h-4 w-4"}),IconRight:()=>e.jsx(en,{className:"h-4 w-4"})},...r})}St.displayName="Calendar";const $s=no,Ls=ro,ks=n.forwardRef(({className:s,align:a="start",sideOffset:t=4,...r},o)=>e.jsx(ao,{children:e.jsx(sn,{ref:o,align:a,sideOffset:t,className:se("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));ks.displayName=sn.displayName;const oa=n.forwardRef(({className:s,...a},t)=>e.jsx(tn,{ref:t,className:se("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(oo,{className:se("flex items-center justify-center text-current"),children:e.jsx(Zt,{className:"h-4 w-4"})})}));oa.displayName=tn.displayName;const oi={from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString(),to:new Date().toISOString()},ir=ds({name:"date",initialState:oi,reducers:{setDate:(s,a)=>{s.from=a.payload.from,s.to=a.payload.to,s.compareFrom=a.payload.compareFrom,s.compareTo=a.payload.compareTo},clearDate:s=>{s.from=void 0,s.to=void 0,s.compareFrom=void 0,s.compareTo=void 0}}}),{setDate:ie,clearDate:li}=ir.actions,ii=ir.reducer,ci=hl(s=>s.date.from,s=>s.date.to,(s,a)=>({from:s,to:a}));function ge({defaultDate:s,resetToFirstPage:a}){const t=fe(),r=P(ci),o=n.useMemo(()=>r?{from:r.from?new Date(r.from):void 0,to:r.to?new Date(r.to):void 0}:s?{from:s.from?new Date(s.from):void 0,to:s.to?new Date(s.to):void 0}:void 0,[r,s]),[l,u]=n.useState(o),[m,h]=n.useState(),[d,f]=n.useState(!1),[w,S]=n.useState(null),[C,N]=n.useState(!1),[b,v]=n.useState("primary"),[k,g]=n.useState(l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):""),[I,L]=n.useState(l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):""),[M,y]=n.useState(""),[R,E]=n.useState(""),T=n.useMemo(()=>{const j=new Date,_=j.getDay(),W=Fs(j,_),Z=il(W,6),Q=new Date(j.getFullYear(),j.getMonth(),1),U=new Date(j.getFullYear(),j.getMonth()+1,0),K=Fs(W,7),J=Fs(W,1),H=Math.floor(j.getMonth()/3),B=new Date(j.getFullYear(),H*3,1),te=new Date(j.getFullYear(),(H+1)*3,0),me=j.getMonth()<3?3:Math.floor((j.getMonth()-3)/3),$=j.getMonth()<3?j.getFullYear()-1:j.getFullYear(),ee=new Date($,me*3,1),X=new Date($,(me+1)*3,0);return{today:j,startOfThisWeek:W,endOfThisWeek:Z,startOfThisMonth:Q,endOfThisMonth:U,startOfLastWeek:K,endOfLastWeek:J,startOfThisQuarter:B,endOfThisQuarter:te,startOfLastQuarter:ee,endOfLastQuarter:X}},[]),x=n.useCallback(j=>{try{const _=cl(j,"yyyy-MM-dd",new Date);return isNaN(_.getTime())?void 0:_}catch{return}},[]),F=n.useCallback(()=>{const j=x(k),_=x(I);j&&_&&(u({from:j,to:_}),S(null))},[k,I,x]),p=n.useCallback(()=>{const j=x(M),_=x(R);j&&_&&h({from:j,to:_})},[M,R,x]),c=n.useCallback((j,_)=>{b==="primary"?(u({from:j,to:_}),g(Y(j,"yyyy-MM-dd")),L(Y(_,"yyyy-MM-dd"))):b==="comparison"&&(h({from:j,to:_}),y(Y(j,"yyyy-MM-dd")),E(Y(_,"yyyy-MM-dd"))),S(null)},[b]),i=n.useMemo(()=>[{label:"Today",fn:()=>c(T.today,T.today)},{label:"Yesterday",fn:()=>c(Fs(T.today,1),Fs(T.today,1))},{label:"This Week",fn:()=>c(T.startOfThisWeek,T.endOfThisWeek)},{label:"Last 7 Days",fn:()=>c(Fs(T.today,6),T.today)},{label:"Last week",fn:()=>c(T.startOfLastWeek,T.endOfLastWeek)},{label:"Last 30 Days",fn:()=>c(Fs(T.today,29),T.today)},{label:"This Month",fn:()=>c(T.startOfThisMonth,T.today)},{label:"Last 3 Months",fn:()=>c(va(T.today,3),T.today)},{label:"Last 6 Months",fn:()=>c(va(T.today,6),T.today)},{label:"This Quarter",fn:()=>c(T.startOfThisQuarter,T.endOfThisQuarter)},{label:"Last Quarter",fn:()=>c(T.startOfLastQuarter,T.endOfLastQuarter)},{label:"This Year",fn:()=>c(new Date(new Date().getFullYear(),0,1),T.today)},{label:"Last 365 Days",fn:()=>c(Fs(T.today,365),T.today)},{label:"Last Year",fn:()=>c(ya(dl(new Date),1),ya(ml(new Date),1))}],[T,c]),A=n.useCallback(j=>{b==="primary"?(j!=null&&j.from&&!j.to?(u({from:j.from,to:j.from}),g(Y(j.from,"yyyy-MM-dd")),L(Y(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)&&j.from>j.to?(u({from:j.from,to:j.from}),g(Y(j.from,"yyyy-MM-dd")),L(Y(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)?(u(j),g(Y(j.from,"yyyy-MM-dd")),L(Y(j.to,"yyyy-MM-dd"))):(u(void 0),g(""),L("")),S(null)):j!=null&&j.from&&!j.to?(h({from:j.from,to:j.from}),y(Y(j.from,"yyyy-MM-dd")),E(Y(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)&&j.from>j.to?(h({from:j.from,to:j.from}),y(Y(j.from,"yyyy-MM-dd")),E(Y(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)?(h(j),y(Y(j.from,"yyyy-MM-dd")),E(Y(j.to,"yyyy-MM-dd"))):(h(void 0),y(""),E(""))},[b]),G=n.useCallback(j=>j?j.from?j.to?`${Y(j.from,"LLL dd, y")} - ${Y(j.to,"LLL dd, y")}`:Y(j.from,"LLL dd, y"):"Pick a date":s&&s.from&&s.to?`${Y(s.from,"LLL dd, y")} - ${Y(s.to,"LLL dd, y")}`:"Pick a date",[s]),O=n.useCallback(()=>{u(void 0),h(void 0),S(null),N(!1),g(""),L(""),y(""),E(""),t(li()),a&&a(),f(!1)},[t,a]),D=n.useCallback(()=>{l&&t(ie({from:l.from?l.from.toISOString():void 0,to:l.to?l.to.toISOString():void 0,compareFrom:C&&(m!=null&&m.from)?m.from.toISOString():void 0,compareTo:C&&(m!=null&&m.to)?m.to.toISOString():void 0})),a&&a(),f(!1)},[t,a,l,m,C]);return e.jsxs($s,{open:d,onOpenChange:f,children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(z,{variant:"outline",className:se("w-[250px] justify-start text-left font-normal",!l&&!s&&"text-muted-foreground","hover:bg-muted/50 transition-colors rounded-lg border-muted-foreground/20"),children:[e.jsx(Jt,{className:"mr-2 h-4 w-4 text-primary"}),G(l)]})}),e.jsxs(ks,{className:"w-auto p-0 max-w-[650px]",align:"start",children:[e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"border-r p-3 w-full md:w-[150px] overflow-y-auto bg-gradient-to-b from-muted/50 to-muted/10",style:{maxHeight:"400px"},children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h1",{className:"text-sm pb-2 font-medium border-b border-border/50 text-primary",children:"Presets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-1",children:i.map(j=>e.jsx(z,{size:"sm",variant:w===j.label?"default":"ghost",className:se("w-full justify-start text-xs font-normal h-8 rounded-md",w===j.label?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground hover:text-foreground"),onClick:()=>{j.fn(),S(j.label)},children:j.label},j.label))})]})}),e.jsxs("div",{className:"p-3 flex-grow",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(oa,{id:"compare-toggle",checked:C,onCheckedChange:()=>N(!C),className:"text-primary"}),e.jsx("label",{htmlFor:"compare-toggle",className:"text-sm font-medium",children:"Compare with another period"})]}),e.jsxs("div",{className:"grid gap-3 mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Primary Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{placeholder:"YYYY-MM-DD",value:k,onChange:j=>g(j.target.value),onBlur:F,onClick:()=>{v("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{placeholder:"YYYY-MM-DD",value:I,onChange:j=>L(j.target.value),onBlur:F,onClick:()=>{v("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]}),C&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Comparison Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{placeholder:"YYYY-MM-DD",value:M,onChange:j=>y(j.target.value),onBlur:p,onClick:()=>{v("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Pe,{placeholder:"YYYY-MM-DD",value:R,onChange:j=>E(j.target.value),onBlur:p,onClick:()=>{v("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]})]}),e.jsx("div",{className:"border rounded-lg p-2 bg-background/80 shadow-sm",children:e.jsx(St,{initialFocus:!0,mode:"range",defaultMonth:b==="primary"?(l==null?void 0:l.from)||(s==null?void 0:s.from)||T.today:(m==null?void 0:m.from)||T.today,selected:b==="primary"?l:m,onSelect:A,numberOfMonths:2,disabled:j=>j>new Date||j<new Date("2023-01-01"),className:"rounded-md"})})]})]}),e.jsxs("div",{className:"border-t p-2 flex justify-end gap-2 bg-muted/10",children:[e.jsx(z,{variant:"outline",size:"sm",onClick:O,className:"rounded-md h-8 text-xs",children:"Clear"}),e.jsx(z,{size:"sm",onClick:D,className:"rounded-md h-8 text-xs bg-primary hover:bg-primary/90",children:"Apply"})]})]})]})}const di={locale:"en-IN"},cr=ds({name:"locale",initialState:di,reducers:{setLocale:(s,a)=>{s.locale=a.payload}}}),{setLocale:kt}=cr.actions,mi=cr.reducer,ui={notifications:[],unreadCount:0,isSoundEnabled:!0},dr=ds({name:"notifications",initialState:ui,reducers:{addNotification:(s,a)=>{const t={...a.payload,id:Date.now().toString(),timestamp:new Date().toISOString(),isRead:!1};s.notifications.unshift(t),s.unreadCount+=1,s.notifications.length>50&&(s.notifications=s.notifications.slice(0,50))},markAsRead:(s,a)=>{const t=s.notifications.find(r=>r.id===a.payload);t&&!t.isRead&&(t.isRead=!0,s.unreadCount=Math.max(0,s.unreadCount-1))},markAllAsRead:s=>{s.notifications.forEach(a=>{a.isRead=!0}),s.unreadCount=0},removeNotification:(s,a)=>{const t=s.notifications.find(r=>r.id===a.payload);t&&!t.isRead&&(s.unreadCount=Math.max(0,s.unreadCount-1)),s.notifications=s.notifications.filter(r=>r.id!==a.payload)},clearAllNotifications:s=>{s.notifications=[],s.unreadCount=0},toggleSound:s=>{s.isSoundEnabled=!s.isSoundEnabled},setSoundEnabled:(s,a)=>{s.isSoundEnabled=a.payload}}}),{addNotification:mr,markAsRead:hi,markAllAsRead:xi,removeNotification:fi,clearAllNotifications:gi,toggleSound:pi,setSoundEnabled:fu}=dr.actions,ji=dr.reducer,bi=ct("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function js({className:s,variant:a,...t}){return e.jsx("div",{className:se(bi({variant:a}),s),...t})}const vi=()=>{const[s,a]=n.useState(!1),t=n.useRef(null),r=fe(),{notifications:o,unreadCount:l,isSoundEnabled:u}=P(N=>N.notifications);n.useEffect(()=>{const N=b=>{t.current&&!t.current.contains(b.target)&&a(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const m=N=>{r(hi(N))},h=(N,b)=>{N.stopPropagation(),r(fi(b))},d=()=>{r(xi())},f=()=>{r(gi())},w=()=>{r(pi())},S=N=>{switch(N){case"success":return"";case"error":return"";case"warning":return"";default:return""}},C=N=>{switch(N){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"warning":return"border-yellow-200 bg-yellow-50";default:return"border-blue-200 bg-blue-50"}};return e.jsxs("div",{className:"relative",ref:t,children:[e.jsxs(z,{variant:"outline",size:"icon",className:"relative transition-transform duration-300 ease-in-out hover:scale-105",onClick:()=>a(!s),children:[e.jsx(Lo,{className:"h-4 w-4"}),l>0&&e.jsx(js,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 text-xs flex items-center justify-center",children:l>99?"99+":l})]}),s&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"ghost",size:"icon",onClick:w,className:"h-8 w-8",children:u?e.jsx(Eo,{className:"h-4 w-4"}):e.jsx(Po,{className:"h-4 w-4"})}),l>0&&e.jsx(z,{variant:"ghost",size:"sm",onClick:d,className:"text-xs",children:"Mark all read"})]})]}),e.jsx(na,{className:"max-h-96",children:o.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):e.jsx("div",{className:"p-2",children:o.map(N=>e.jsx("div",{className:`p-3 rounded-lg border mb-2 cursor-pointer transition-colors hover:bg-gray-50 group ${N.isRead?"opacity-75":""} ${C(N.type)}`,onClick:()=>m(N.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-lg",children:S(N.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-medium text-sm ${N.isRead?"text-gray-600":"text-gray-900"}`,children:N.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:N.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:ul(new Date(N.timestamp),{addSuffix:!0})})]})]}),e.jsx(z,{variant:"ghost",size:"icon",onClick:b=>h(b,N.id),className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(xs,{className:"h-3 w-3"})})]})},N.id))})}),o.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 border-t border-gray-200",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," notification",o.length!==1?"s":""]}),e.jsx(z,{variant:"ghost",size:"sm",onClick:f,className:"text-xs text-red-600 hover:text-red-700",children:"Clear all"})]})]})]})},yi={},ur=ds({name:"conversionFilters",initialState:yi,reducers:{setFilter:(s,a)=>{const{componentId:t,column:r,filter:o}=a.payload;s[t]||(s[t]={}),JSON.stringify(s[t][r])!==JSON.stringify(o)&&(s[t][r]=o)},clearFilters:(s,a)=>{const t=a.payload;Object.keys(s[t]||{}).length>0&&(s[t]={})}}}),{setFilter:Ni,clearFilters:wi}=ur.actions,Ci=ur.reducer,Si={groups:[],selectedCampaigns:[],editingGroupId:null,expandedGroups:[],isCreatingGroup:!1},Is=(s,a)=>{s.accounts||(s.accounts={}),s.accounts[a]||(s.accounts[a]={...Si})},ki=ds({name:"campaignGroups",initialState:{accounts:{}},reducers:{createGroup:(s,a)=>{const{accountId:t,name:r,campaigns:o,color:l}=a.payload;Is(s,t);const u={id:Date.now().toString(),name:r,campaigns:o,color:l};s.accounts[t].groups.push(u),s.accounts[t].selectedCampaigns=[],s.accounts[t].isCreatingGroup=!1},deleteGroup:(s,a)=>{const{accountId:t,groupId:r}=a.payload;Is(s,t),s.accounts[t].groups=s.accounts[t].groups.filter(o=>o.id!==r),s.accounts[t].editingGroupId===r&&(s.accounts[t].editingGroupId=null)},addCampaignToGroup:(s,a)=>{const{accountId:t,groupId:r,campaignName:o}=a.payload;Is(s,t);const l=s.accounts[t].groups.find(u=>u.id===r);l&&!l.campaigns.includes(o)&&l.campaigns.push(o)},removeCampaignFromGroup:(s,a)=>{const{accountId:t,groupId:r,campaignName:o}=a.payload;Is(s,t);const l=s.accounts[t].groups.find(u=>u.id===r);l&&(l.campaigns=l.campaigns.filter(u=>u!==o))},setSelectedCampaigns:(s,a)=>{const{accountId:t,campaigns:r}=a.payload;Is(s,t),s.accounts[t].selectedCampaigns=r},toggleEditingGroup:(s,a)=>{const{accountId:t,groupId:r}=a.payload;Is(s,t),s.accounts[t].editingGroupId=r},toggleGroupExpansion:(s,a)=>{const{accountId:t,groupId:r}=a.payload;Is(s,t);const o=s.accounts[t].expandedGroups;o.includes(r)?s.accounts[t].expandedGroups=o.filter(l=>l!==r):s.accounts[t].expandedGroups.push(r)},setIsCreatingGroup:(s,a)=>{const{accountId:t,isCreating:r}=a.payload;Is(s,t),s.accounts[t].isCreatingGroup=r,r||(s.accounts[t].selectedCampaigns=[])}}}),Ai=ki.reducer,Fi={labels:{},isAddingLabel:!1},hr=ds({name:"campaignLabels",initialState:Fi,reducers:{addLabelToCampaign:(s,a)=>{const{accountId:t,campaignId:r,label:o}=a.payload;s.labels[t]||(s.labels[t]={}),s.labels[t][r]||(s.labels[t][r]=[]),s.labels[t][r].includes(o)||s.labels[t][r].push(o)},removeLabelFromCampaign:(s,a)=>{const{accountId:t,campaignId:r,label:o}=a.payload;s.labels[t]&&s.labels[t][r]&&(s.labels[t][r]=s.labels[t][r].filter(l=>l!==o))},toggleAddingLabel:(s,a)=>{s.isAddingLabel=a.payload},clearAccountLabels:(s,a)=>{const t=a.payload;s.labels[t]&&(s.labels[t]={})},deleteLabel:(s,a)=>{const{accountId:t,label:r}=a.payload;s.labels[t]&&(Object.keys(s.labels[t]).forEach(o=>{s.labels[t][o]=s.labels[t][o].filter(l=>l!==r),s.labels[t][o].length===0&&delete s.labels[t][o]}),Object.keys(s.labels[t]).length===0&&delete s.labels[t])},copyLabels:(s,a)=>{const{accountId:t,sourceCampaignId:r,targetCampaignId:o}=a.payload;s.labels[t]&&s.labels[t][r]&&(s.labels[t][o]||(s.labels[t][o]=[]),s.labels[t][r].forEach(l=>{s.labels[t][o].includes(l)||s.labels[t][o].push(l)}))}}}),{addLabelToCampaign:Ii,removeLabelFromCampaign:Ti,toggleAddingLabel:gu,clearAccountLabels:pu,copyLabels:ju,deleteLabel:bu}=hr.actions,Mi=hr.reducer,$i={isFirstTimeLogin:!1,activeTutorial:null,isTutorialActive:!1,activeTutorialStep:0,tutorialQueue:[],completedTutorials:{}},xr=ds({name:"tutorial",initialState:$i,reducers:{setFirstTimeLogin:(s,a)=>{s.isFirstTimeLogin=a.payload},queueTutorials:(s,a)=>{const t=a.payload.filter(r=>!s.tutorialQueue.includes(r)&&r!==s.activeTutorial);if(t.length===0){console.log("No new tutorials to queue");return}s.tutorialQueue=[...t,...s.tutorialQueue],console.log(`Queued tutorials: ${t.join(", ")}, Queue is now: ${s.tutorialQueue.join(", ")}`),!s.isTutorialActive&&s.tutorialQueue.length>0&&(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Auto-starting tutorial: ${s.activeTutorial}`))},startTutorial:(s,a)=>{s.activeTutorial=a.payload,s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Manually starting tutorial: ${a.payload}`)},nextTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Completed tutorial: ${s.activeTutorial}`)),console.log(`nextTutorial called, queue length: ${s.tutorialQueue.length}, queue: [${s.tutorialQueue.join(", ")}]`),s.tutorialQueue.length>0?(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.activeTutorialStep=0,s.isTutorialActive=!0,console.log(`Starting next tutorial: ${s.activeTutorial}, remaining queue: [${s.tutorialQueue.join(", ")}]`)):(s.activeTutorial=null,s.isTutorialActive=!1,console.log("No more tutorials in queue, stopping tutorial mode"))},setTutorialStep:(s,a)=>{s.activeTutorialStep=a.payload},stopTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Tutorial stopped, marking ${s.activeTutorial} as completed`)),s.isTutorialActive=!1,s.activeTutorial=null,s.tutorialQueue=[],s.activeTutorialStep=0,console.log("Tutorial stopped, queue cleared")},completeFirstTimeLogin:s=>{s.isFirstTimeLogin=!1},resetTutorial:(s,a)=>{s.completedTutorials[a.payload]&&(s.completedTutorials[a.payload]=!1)},resetAllTutorials:s=>{s.completedTutorials={}}}}),{setFirstTimeLogin:Li,queueTutorials:fr,startTutorial:vu,nextTutorial:Ht,setTutorialStep:Ei,stopTutorial:yu,completeFirstTimeLogin:Pi,resetTutorial:Nu,resetAllTutorials:wu}=xr.actions,Oi=xr.reducer,Ri={fbToken:!1,googleAnalyticsToken:!1,googleAdsToken:!1},gr=ds({name:"tokenError",initialState:Ri,reducers:{setFbTokenError:(s,a)=>{s.fbToken=a.payload},setGoogleAnalyticsTokenError:(s,a)=>{s.googleAnalyticsToken=a.payload},setGoogleAdsTokenError:(s,a)=>{s.googleAdsToken=a.payload},resetAllTokenErrors:s=>{s.fbToken=!1,s.googleAnalyticsToken=!1,s.googleAdsToken=!1}}}),{setFbTokenError:Sa,setGoogleAnalyticsTokenError:ka,setGoogleAdsTokenError:Aa,resetAllTokenErrors:pr}=gr.actions,la=s=>s.tokenError.fbToken,Di=s=>s.tokenError.googleAnalyticsToken,xt=s=>s.tokenError.googleAdsToken,zi=gr.reducer,Gi={filters:{}},jr=ds({name:"interestFilter",initialState:Gi,reducers:{addFilter:(s,a)=>{const{tableId:t,filter:r}=a.payload,o=s.filters[t]||[];s.filters={...s.filters,[t]:[...o,r]}},removeFilter:(s,a)=>{const{tableId:t,index:r}=a.payload,o=s.filters[t]||[];s.filters={...s.filters,[t]:o.filter((l,u)=>u!==r)}},updateFilter:(s,a)=>{const{tableId:t,index:r,filter:o}=a.payload,l=s.filters[t]||[];s.filters={...s.filters,[t]:l.map((u,m)=>m===r?o:u)}},clearFilters:(s,a)=>{const{tableId:t}=a.payload;s.filters={...s.filters,[t]:[]}}}}),{addFilter:Bi,removeFilter:_i,updateFilter:Cu,clearFilters:Ui}=jr.actions,Vi=jr.reducer,Fa={brandName:"",connectedAccounts:{},googleAdsConnections:[],ga4Id:"",fbAdId:[],shop:"",shopifyAccessToken:""},br=ds({name:"brandForm",initialState:Fa,reducers:{setBrandFormData:(s,a)=>({...s,...a.payload}),clearBrandFormData:()=>Fa}}),{setBrandFormData:Hi,clearBrandFormData:qi}=br.actions,Wi=br.reducer,Yi=vl({conversionFilters:Ci,brand:ql,user:El,date:ii,campaignGroups:Ai,campaignLabels:Mi,tutorials:Oi,locale:mi,tokenError:zi,interestFilter:Vi,brandForm:Wi,notifications:ji}),Ki={key:"root",storage:jl,whitelist:["tokenError","conversionFilters","brand","user","date","campaignGroups","campaignLabels","tutorials","locale","interestFilter","brandForm","notifications"],transforms:[{in:s=>{if(s.notifications&&s.notifications.notifications){const a=new Date;a.setDate(a.getDate()-7);const t=s.notifications.notifications.filter(r=>new Date(r.timestamp)>a).slice(0,50);return{...s,notifications:{...s.notifications,notifications:t,unreadCount:t.filter(r=>!r.isRead).length}}}return s},out:s=>s}]},Qi=pl(Ki,Yi),_s=Co({reducer:Qi,middleware:s=>s({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE","persist/REGISTER"]}})}),Zi=gl(_s);let be=null,Ts=!1,ms=!1,ot=null,qs=null,Ws=0;const Ia=5;let zs=null;const Yt="https://parallels.messold.com";console.log("Socket Service Environment:",{PROD:!0,baseURL:Yt});const Ji=(s,a)=>{if(console.log(" initializeSocket called with:",{userId:s,brandId:a,isConnecting:Ts,isConnected:ms}),Ts){console.log(" Connection already in progress, skipping...");return}if(s&&(ot=s),a&&(qs=a),be!=null&&be.connected&&ms){console.log(" Socket already connected, handling room changes..."),Nr();return}be&&!be.connected&&(console.log(" Cleaning up disconnected socket..."),be.removeAllListeners(),be=null,ms=!1),vr()},vr=()=>{console.log(" Creating new socket connection to:",Yt),console.log(" Connection details:",{withCredentials:!0,transports:["polling","websocket"],timeout:2e4,autoConnect:!0,reconnection:!1,forceNew:!0}),Ts=!0,Ws++,zs&&(clearTimeout(zs),zs=null),be=fl(Yt,{withCredentials:!0,transports:["polling","websocket"],timeout:2e4,autoConnect:!0,reconnection:!1,forceNew:!0,extraHeaders:{"X-Requested-With":"XMLHttpRequest"}}),be.on("connect",()=>{console.log(" Socket connected successfully:",be==null?void 0:be.id),Ts=!1,ms=!0,Ws=0,Nr()}),be.on("connect_error",s=>{console.error(" Socket connection error:",s),Ts=!1,ms=!1,Xi(s)}),be.on("disconnect",s=>{if(console.log(" Socket disconnected, reason:",s),Ts=!1,ms=!1,s==="io server disconnect"){console.log("Server initiated disconnect, not reconnecting");return}yr()}),be.on("error",s=>{console.error(" Socket error:",s)}),ec()},Xi=s=>{var a,t,r,o,l;if(console.error("Connection error details:",{message:s.message,name:s.name,type:s.type,code:s.code}),(a=s.message)!=null&&a.includes("Authentication")||(t=s.message)!=null&&t.includes("Unauthorized")){console.error(" Authentication failed for socket connection"),_s.dispatch(mr({type:"error",title:"Connection Error",message:"Authentication failed. Please log in again."}));return}(r=s.message)!=null&&r.includes("server error")&&console.error(" Server error detected - check server logs"),((o=s.message)!=null&&o.includes("Network Error")||(l=s.message)!=null&&l.includes("timeout"))&&console.error(" Network error detected"),yr()},yr=()=>{if(Ws>=Ia){console.error(" Max reconnection attempts reached, giving up");return}const s=Math.min(1e3*Math.pow(2,Ws),3e4);console.log(` Attempting reconnection in ${s}ms (attempt ${Ws+1}/${Ia})`),zs=setTimeout(()=>{!ms&&!Ts&&vr()},s)},Nr=()=>{if(!(be!=null&&be.connected)){console.warn(" Socket not connected, cannot handle room changes");return}ot&&(console.log(" Joining user room:",ot),be.emit("join-user-room",ot)),qs&&(console.log(" Joining brand room:",qs),be.emit("join-brand-room",qs))},ec=()=>{be&&(be.on("brand-notification",s=>{console.log(" Brand notification received:",s),Ta(s)}),be.on("notification",s=>{console.log(" User notification received:",s),Ta(s)}),be.on("pong",s=>{console.log(" Pong received:",s)}))},Ta=s=>{const{type:a,data:t}=s;let r="info",o="Notification",l="You have a new notification";switch(a){case"metrics-calculation-complete":r=t.success?"success":"error",o="Metrics Calculation",l=t.success?"Metrics calculation completed successfully!":`Calculation failed: ${t.message}`;break;case"metrics-calculation-error":r="error",o="Calculation Error",l=`Error calculating metrics: ${t.error}`;break;default:o="System Notification",l=t.message||"You have a new notification"}_s.dispatch(mr({type:r,title:o,message:l,brandId:t.brandId,actionUrl:t.actionUrl})),sc()},sc=()=>{const{isSoundEnabled:s}=_s.getState().notifications;if(s)try{const a=new(window.AudioContext||window.webkitAudioContext),t=a.createOscillator(),r=a.createGain();t.connect(r),r.connect(a.destination),t.frequency.setValueAtTime(800,a.currentTime),t.frequency.setValueAtTime(600,a.currentTime+.1),r.gain.setValueAtTime(.3,a.currentTime),r.gain.exponentialRampToValueAtTime(.01,a.currentTime+.2),t.start(a.currentTime),t.stop(a.currentTime+.2)}catch(a){console.warn(" Could not play notification sound:",a)}},tc=s=>{console.log(" joinBrandRoom called with:",s),qs=s,be!=null&&be.connected&&ms?(console.log(` Emitting join-brand-room for brand: ${s}`),be.emit("join-brand-room",s)):console.warn(" Socket not connected, will join brand room after connection")},ac=s=>{be!=null&&be.connected&&ms&&(be.emit("leave-brand-room",s),console.log(` Left brand room: ${s}`))},Ma=()=>{console.log(" Disconnecting socket..."),zs&&(clearTimeout(zs),zs=null),be&&(be.removeAllListeners(),be.disconnect(),be=null),Ts=!1,ms=!1,ot=null,qs=null,Ws=0},tt=()=>!!(be!=null&&be.connected&&ms),nc=()=>{const s=P(u=>u.user.user),a=P(u=>u.brand.selectedBrandId),t=n.useRef(null),r=n.useRef(null),o=n.useRef(!1),l=n.useRef(!1);return console.log("useSocketConnection - Current state:",{hasUser:!!s,userId:s==null?void 0:s.id,selectedBrandId:a,previousBrandId:t.current,isInitialized:o.current,isInitializing:l.current,isSocketConnected:tt()}),n.useEffect(()=>{const u=s==null?void 0:s.id;if(!u){console.log(" No user ID available, cleaning up socket connection"),o.current&&(Ma(),o.current=!1,l.current=!1,r.current=null,t.current=null);return}const m=r.current!==u,h=!o.current,d=!tt(),f=(h||m||d)&&!l.current;if(f){console.log(" Initializing socket connection for user:",u,"brand:",a),console.log(" Initialization reason:",{isFirstTime:h,userChanged:m,socketNotConnected:d}),l.current=!0;try{Ji(u,a||void 0),o.current=!0,r.current=u,t.current=a}catch(S){console.error(" Error initializing socket connection:",S),l.current=!1}}else console.log(" Skipping socket initialization:",{shouldInitialize:f,isFirstTime:h,userChanged:m,socketNotConnected:d,isInitializing:l.current});const w=setTimeout(()=>{l.current=!1},1e3);return()=>{clearTimeout(w)}},[s==null?void 0:s.id]),n.useEffect(()=>{const u=a,m=t.current!==u;if(m&&tt()&&o.current){console.log(" Brand changed from",t.current,"to",u);try{t.current&&(console.log(" Leaving previous brand room:",t.current),ac(t.current)),u&&(console.log(" Joining new brand room:",u),tc(u)),t.current=u}catch(h){console.error(" Error handling brand change:",h)}}else m&&console.log(" Skipping brand change:",{brandChanged:m,isSocketConnected:tt(),isInitialized:o.current})},[a]),n.useEffect(()=>()=>{try{console.log(" Component unmounting, disconnecting socket"),Ma(),o.current=!1,l.current=!1,r.current=null,t.current=null}catch(u){console.error(" Error disconnecting socket on unmount:",u)}},[]),{isConnected:tt()}};function vs({title:s,Icon:a,showDatePicker:t=!1,showSettings:r=!1,showRefresh:o=!1,isLoading:l=!1,handleManualRefresh:u}){const m=fe(),h=P(d=>d.locale.locale);return nc(),e.jsx("header",{className:"sticky top-0 z-40 bg-white border-b px-6 py-3 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"rounded-lg bg-secondary p-2 transition-transform duration-300 ease-in-out hover:scale-110",children:e.jsx(a,{className:"h-6 w-6 text-secondary-foreground"})}),e.jsx("h1",{className:"text-2xl font-semibold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-secondary-foreground to-primary",children:s})]}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[t&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),o&&e.jsx("div",{className:"md:flex items-center hidden",children:e.jsx(z,{onClick:u,disabled:l,className:"flex items-center",children:e.jsx(je,{className:`h-4 w-4 ${l?"animate-spin":""}`})})}),e.jsx(vi,{}),r&&e.jsxs($s,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",children:e.jsx($t,{className:"h-4 w-4"})})}),e.jsx(ks,{children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx("h3",{className:"font-medium",children:"Locale Settings"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-IN",checked:h==="en-IN",onChange:()=>m(kt("en-IN")),className:"mr-2"}),"Indian Formatting"]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-US",checked:h==="en-US",onChange:()=>m(kt("en-US")),className:"mr-2"}),"Western Formatting"]})]})]})})]})]})]})})}function Se({isLoading:s}){const[a,t]=n.useState(0),[r,o]=n.useState(0),[l,u]=n.useState(!1),m=["Just a moment, we're getting things ready...","Almost there, hang tight!","Brewing some magic for you...","The best things are worth waiting for...","Gathering all the awesome stuff...","Just putting on the finishing touches...","We're working our digital magic...","Your experience is being crafted...","Just a few more seconds of patience...","You're going to love what's coming..."];return n.useEffect(()=>{const h=setInterval(()=>{t(f=>s&&f>=95?95:!s&&f<100?(clearInterval(h),t(100),setTimeout(()=>{u(!0)},300),100):f<95?f+1:f)},80),d=setInterval(()=>{l||o(f=>(f+1)%m.length)},2500);return()=>{clearInterval(h),clearInterval(d)}},[s,l]),e.jsxs("div",{className:"flex flex-col items-center justify-center bg-white text-black text-center px-4 z-50 min-h-screen",children:[e.jsx("div",{className:"h-20 flex items-center justify-center mb-6 overflow-hidden",children:e.jsx("h3",{className:"text-xl font-medium text-black/80 animate-fadeIn",children:l?"Ready!":m[r]},r)}),e.jsx("div",{className:"relative w-full max-w-md mx-auto mb-4",children:e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all duration-300 ease-out",style:{width:`${a}%`}})})}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 font-mono mb-8 w-full max-w-md",children:[e.jsx("span",{children:"Loading"}),e.jsxs("span",{children:[a,"%"]})]}),l&&e.jsx("div",{className:"mt-6 animate-fadeIn",children:e.jsxs("div",{className:"text-xl font-medium text-primary flex items-center justify-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5"}),e.jsx("span",{children:"You've arrived! Welcome."})]})}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-in forwards;
        }
      `})]})}const ke=()=>{const s=Ke(),a=fe(),t=re.create({baseURL:"https://parallels.messold.com",withCredentials:!0});return t.interceptors.response.use(r=>{var o,l,u,m,h,d;return(l=(o=r.config)==null?void 0:o.url)!=null&&l.includes("/meta")?a(Sa(!1)):(m=(u=r.config)==null?void 0:u.url)!=null&&m.includes("/analytics")?a(ka(!1)):(d=(h=r.config)==null?void 0:h.url)!=null&&d.includes("/google")&&a(Aa(!1)),r},r=>{var o,l,u,m,h,d,f,w;return((o=r.response)==null?void 0:o.status)===401?(console.log("401 Unauthorized - Token expired or invalid"),_s.dispatch(Rt()),_s.dispatch(Dt()),re.post(`${Te}/api/auth/logout`,{},{withCredentials:!0}).catch(()=>{}),s("/login")):((l=r.response)==null?void 0:l.status)===403&&((m=(u=r.config)==null?void 0:u.url)!=null&&m.includes("/meta")?a(Sa(!0)):(d=(h=r.config)==null?void 0:h.url)!=null&&d.includes("/analytics")?a(ka(!0)):(w=(f=r.config)==null?void 0:f.url)!=null&&w.includes("/google")?a(Aa(!0)):console.warn("Token error occurred but type could not be determined:",r)),Promise.reject(r)}),t};function ft({platform:s,open:a,onOpenChange:t,brandId:r,onSuccess:o}){const[l,u]=n.useState(""),[m,h]=n.useState([]),[d,f]=n.useState([]),[w,S]=n.useState([]),[C,N]=n.useState(!1),[b,v]=n.useState(!1),[k,g]=n.useState([]),[I,L]=n.useState([]),M="https://parallels.messold.com",y=P(D=>D.user.user),R=y==null?void 0:y.id,E=fe(),T=P(D=>D.brand.brands);n.useEffect(()=>{const D=new URLSearchParams(window.location.search),j=D.get("openModal");if(j&&t){switch(j.toLowerCase()){case"googleads":s.toLowerCase()==="google ads"&&t(!0);break;case"googleanalytics":s.toLowerCase()==="google analytics"&&t(!0);break;case"facebook":s.toLowerCase()==="facebook"&&t(!0);break}D.delete("openModal");const _=`${window.location.pathname}${D.toString()?`?${D.toString()}`:""}`;window.history.replaceState({},"",_)}},[s,t]),n.useEffect(()=>{a&&r&&(async()=>{var j,_;try{const Z=(await re.get(`${M}/api/brands/${r}`,{withCredentials:!0})).data,Q=[];(j=Z.fbAdAccounts)!=null&&j.length&&Q.push(...Z.fbAdAccounts),Z.googleAdAccount&&Q.push(Z.googleAdAccount),(_=Z.ga4Account)!=null&&_.PropertyID&&Q.push(Z.ga4Account.PropertyID),g(Q)}catch(W){console.error("Error fetching connected accounts:",W)}})()},[r,a]),n.useEffect(()=>{(async()=>{var j;if(a){v(!0);try{let _="",W=null;switch(s.toLowerCase()){case"google ads":_="/api/setup/google-accounts",W=h;break;case"google analytics":_="/api/setup/ga4-propertyIds",W=f;break;case"facebook":_="/api/setup/fb-ad-accounts",W=S;break}if(console.log(`Calling API: ${M}${_} with userId: ${R}`),!_)throw new Error("Invalid platform");const Z=await re.post(`${M}${_}`,{},{withCredentials:!0});Z.status===200&&(N(!1),s.toLowerCase()==="google ads"?W((j=Z.data)==null?void 0:j.clientAccounts.filter(Q=>!Q.hidden)):s.toLowerCase()==="google analytics"?W(Z.data.propertiesList||[]):s.toLowerCase()==="facebook"&&W(Z.data.adAccounts||[]))}catch(_){x(_,N)}finally{v(!1)}}})()},[s,R,a]);const x=(D,j)=>{const _=D;if(_.response){const{status:W,data:Z}=_.response,Q=_.code;W===400||W===403?j(!0):W===401||Q==="TOKEN_EXPIRED"?(alert("Your Google session has expired. Please log in again."),j(!0)):(console.error("Unhandled Error Status:",W),console.error("Error Message:",Z))}else _.request?console.error("No response received:",_.request):console.error("Unexpected Error:",_.message)},F=async(D,j,_)=>{var W;try{let Z={};switch(s.toLowerCase()){case"facebook":const U=T.find(X=>X._id===r),K=(U==null?void 0:U.fbAdAccounts)||[];Z={fbAdAccounts:[...new Set([...K,...D])]};break;case"google ads":const H=T.find(X=>X._id===r),B=(H==null?void 0:H.googleAdAccount)||[],te=D.map((X,ae)=>({clientId:X,managerId:_[ae]||""})),me=[...B];te.forEach(X=>{me.some(he=>he.clientId===X.clientId&&he.managerId===X.managerId)||me.push({clientId:X.clientId,managerId:X.managerId||""})}),Z={googleAdAccount:me};break;case"google analytics":const $=T.find(X=>X._id===r);((W=$==null?void 0:$.ga4Account)==null?void 0:W.PropertyID)?Z={ga4Account:{PropertyID:D[0]}}:Z={ga4Account:{PropertyID:D[0]}};break}const Q=await re.patch(`${M}/api/brands/update/${r}`,Z,{withCredentials:!0});if(Q.status===200){const U=Q.data,K=T.map(J=>J._id===r?U:J);E(ta(K)),D.forEach((J,H)=>{o==null||o(s,j[H],J)})}}catch(Z){console.error("Error updating brand:",Z)}},p=D=>{L(j=>j.includes(D)?j.filter(_=>_!==D):[...j,D])},c=async()=>{if(I.length===0)return;const D=I.map(j=>{var Q;const _=(Q=O())==null?void 0:Q.find(U=>s.toLowerCase()==="google ads"?U.clientId===j:s.toLowerCase()==="facebook"?U.id===j:U.propertyId===j);if(!_)return null;let W,Z;if("clientId"in _)Z=_.managerId,W=Z?`${_.name} (${_.clientId}/${Z})`:`${_.name} (${_.clientId})`;else if("propertyId"in _)W=`${_.propertyName} (${_.propertyId})`;else if("id"in _)W=`${_.adname}`;else return null;return{accountId:j,displayName:W,managerId:Z}}).filter(Boolean);if(D.length>0){const j=D.map(Z=>Z.accountId),_=D.map(Z=>Z.displayName),W=D.map(Z=>Z.managerId);await F(j,_,W),console.log(`Successfully connected ${D.length} account(s)`),L([]),t(!1)}},i=async()=>{try{const D=await re.get(`${M}/api/auth/google?context=googleAdSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:j}=D.data;window.location.href=j}catch(D){console.error("Error getting Google Auth URL:",D)}},A=async()=>{try{const D=await re.get(`${M}/api/auth/google?context=googleAnalyticsSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:j}=D.data;window.location.href=j}catch(D){console.error("Error getting Google Auth URL:",D)}},G=async()=>{try{const D=await re.get(`${M}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});D.data.success&&(window.location.href=D.data.authURL)}catch(D){console.error("Error getting Facebook Auth URL:",D)}},O=()=>s.toLowerCase()==="google ads"?!m||m.length===0?null:m.filter(D=>{const j=l.toLowerCase();return D.name.toLowerCase().includes(j)||D.clientId.toLowerCase().includes(j)||D.managerId&&D.managerId.toLowerCase().includes(j)}):s.toLowerCase()==="google analytics"?!d||d.length===0?null:d.filter(D=>{const j=l.toLowerCase();return D.propertyName.toLowerCase().includes(j)||D.propertyId.toLowerCase().includes(j)}):s.toLowerCase()==="facebook"?!w||w.length===0?null:w.filter(D=>{const j=l.toLowerCase();return D.adname.toLowerCase().includes(j)||D.id.toLowerCase().includes(j)}):[];return e.jsx(zt,{open:a,onOpenChange:t,children:e.jsxs(mt,{className:"sm:max-w-[600px]",children:[e.jsx(ut,{children:e.jsxs(ht,{children:["Connect ",s," Account"]})}),e.jsx("div",{className:"space-y-4",children:b?e.jsx("div",{className:"flex justify-center py-4",children:"Loading..."}):C?e.jsxs(z,{size:"sm",onClick:s.toLowerCase()==="facebook"?G:s.toLowerCase()==="google ads"?i:A,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(Ue,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{height:"1rem",width:"1rem"}),"Connect to your Facebook account"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(Pe,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:l,onChange:D=>u(D.target.value)})]}),I.length>0&&e.jsx("div",{className:"sticky top-0 z-10 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-blue-800",children:[I.length," account(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{size:"sm",variant:"outline",onClick:()=>{L([]),t(!1)},className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs(z,{size:"sm",onClick:c,className:"bg-blue-600 hover:bg-blue-700",children:["Save (",I.length,")"]})]})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(()=>{const D=O();return!D||D.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:l?"No accounts found matching your search.":"No accounts available."}):D.map((j,_)=>{const W=s.toLowerCase()==="google ads",Z=s.toLowerCase()==="facebook",Q=W?j.clientId:Z?j.id:j.propertyId,U=W?j.managerId:void 0,K=W?j.name:Z?j.adname:j.propertyName,J=W&&U?`${Q}-${U}`:Q,H=W?e.jsx(Ue,{height:"1rem",width:"1rem"}):Z?e.jsx(qe,{height:"1rem",width:"1rem"}):e.jsx(Re,{height:"1rem",width:"1rem"}),B=k.includes(Q),te=I.includes(Q),me=W&&U?`${K} (${Q}/${U})`:Z?`${K}`:`${K} (${Q})`;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[H,me]})})}),e.jsxs(z,{size:"sm",onClick:()=>p(Q),disabled:B,className:B?"bg-gray-400":te?"bg-green-600":"bg-blue-600",children:[B&&e.jsx(Qs,{className:"h-4 w-4 mr-2"}),B?"Connected":te?"Selected":"Select"]})]},J)})})()})]})})]})})}const rc={metaspend:"bg-blue-500",metaroas:"bg-purple-500",sessions:"bg-cyan-500",addToCarts:"bg-orange-500",checkouts:"bg-teal-500",purchases:"bg-red-500",addToCartRate:"bg-pink-500",checkoutRate:"bg-emerald-500",purchaseRate:"bg-rose-500",spend:"bg-green-500",roas:"bg-indigo-500"},oc={metaspend:"bg-blue-50 border-blue-100",metaroas:"bg-purple-50 border-purple-100",sessions:"bg-cyan-50 border-cyan-100",addToCarts:"bg-orange-50 border-orange-100",checkouts:"bg-teal-50 border-teal-100",purchases:"bg-red-50 border-red-100",addToCartRate:"bg-pink-50 border-pink-100",checkoutRate:"bg-emerald-50 border-emerald-100",purchaseRate:"bg-rose-50 border-rose-100",spend:"bg-green-50 border-green-100",roas:"bg-indigo-50 border-indigo-100"},$a=(s,a=!1)=>a?s.toFixed(2):s>=1e3?Math.round(s).toLocaleString():s;function lc({metric:s,label:a,value:t,change:r,trend:o,prevValue:l,source:u}){return e.jsxs("div",{className:se("p-3 rounded-md border shadow-sm flex flex-col",oc[s]),children:[e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:se("h-2 w-2 rounded-full mr-1.5",rc[s])}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:a})]}),(()=>{switch(u){case"analytics":return e.jsx(Re,{width:"1rem",height:"1rem"});case"meta":return e.jsx(qe,{width:"1rem",height:"1rem"});default:return e.jsx(Ue,{width:"1rem",height:"1rem"})}})()]}),e.jsx("div",{className:"text-lg font-bold text-slate-800",children:$a(Number(t))}),e.jsxs("div",{className:"flex items-center mt-1 justify-between",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["vs ",$a(Number(l),!1)]}),e.jsxs("div",{className:se("flex items-center text-xs font-medium",o==="up"?"text-green-600":"text-red-600"),children:[o==="up"?e.jsx(Et,{className:"h-3 w-3 mr-0.5"}):e.jsx(Pt,{className:"h-3 w-3 mr-0.5"}),Math.abs(Number(r))]})]})]})}function Gs({platform:s,onClick:a}){const t=()=>{switch(s){case"Facebook":return e.jsx(qe,{width:"2rem",height:"2rem"});case"Google Ads":return e.jsx(Ue,{width:"2rem",height:"2rem"});case"Google Analytics":return e.jsx(Re,{width:"2rem",height:"2rem"});default:return null}};return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:a,children:[e.jsx("div",{className:"mb-3",children:t()}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:["Connect ",s]}),e.jsxs("p",{className:"text-sm text-slate-500 text-center mb-4",children:["Get better insights by connecting your ",s," account"]}),e.jsxs(z,{variant:"outline",className:"gap-2",children:[e.jsx(at,{className:"h-4 w-4"}),"Connect"]})]})}function ic({period:s,performanceData:a,apiStatus:t}){const o=(()=>{var h,d,f;const m={};return(h=a.meta)!=null&&h[s]&&t.meta&&(m.meta=a.meta[s]),(d=a.google)!=null&&d[s]&&t.google&&(m.google=a.google[s]),(f=a.analytics)!=null&&f[s]&&t.analytics&&(m.analytics=a.analytics[s]),m})(),l={yesterday:"Yesterday",last7Days:"Last 7 Days",last30Days:"Last 30 Days"},u=()=>{const m=[];return t.meta||m.push(e.jsxs("div",{className:"col-span-1 p-3 rounded-md border shadow-sm flex flex-col justify-center items-center bg-gray-50 h-24",children:[e.jsx(qe,{width:"1.5rem",height:"1.5rem"}),e.jsx("span",{className:"text-sm text-slate-500",children:"No data found"})]},"meta-no-data")),t.google||m.push(e.jsxs("div",{className:"col-span-1 p-3 rounded-md border shadow-sm flex flex-col justify-center items-center bg-gray-50 h-24",children:[e.jsx(Ue,{width:"1.5rem",height:"1.5rem"}),e.jsx("span",{className:"text-sm text-slate-500",children:"No data found"})]},"google-no-data")),t.analytics||m.push(e.jsxs("div",{className:"col-span-1 p-3 rounded-md border shadow-sm flex flex-col justify-center items-center bg-gray-50 h-24",children:[e.jsx(Re,{width:"1.5rem",height:"1.5rem"}),e.jsx("span",{className:"text-sm text-slate-500",children:"No data found"})]},"analytics-no-data")),Object.entries(o).forEach(([h,d])=>Object.entries(d).forEach(([f,w])=>{m.push(e.jsx(lc,{metric:f,label:f==="metaspend"?"Meta Spend":f==="metaroas"?"Meta ROAS":f==="spend"?"Google Spend":f==="roas"?"Google ROAS":f.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()),value:w.current,change:w.change,trend:w.trend,prevValue:w.previous,source:h},`${h}-${f}`))})),m};return e.jsxs("div",{className:"bg-white border rounded-lg shadow-md p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("h2",{className:"text-xl font-bold text-slate-800",children:[l[s]," Performance Overview"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:u()})]})}const cc=()=>{const s=P(I=>I.user.user),a=P(I=>I.brand.selectedBrandId),t=s==null?void 0:s.username,[r,o]=n.useState(!1),[l,u]=n.useState({}),m=Ke(),[h,d]=n.useState({meta:!0,google:!0,analytics:!0}),[f,w]=n.useState(!1),[S,C]=n.useState(null);n.useEffect(()=>{const I=new URLSearchParams(window.location.search),L=I.get("openModal");if(L&&a){let M=null;switch(L.toLowerCase()){case"googleads":M="Google Ads";break;case"googleanalytics":M="Google Analytics";break;case"facebook":M="Facebook";break}if(M){C(M),w(!0),I.delete("openModal");const y=`${window.location.pathname}${I.toString()?`?${I.toString()}`:""}`;window.history.replaceState({},"",y)}}},[a]);const N=ke(),b=n.useCallback(async()=>{if(!a){console.log("No brand ID available, skipping API calls");return}o(!0),u({}),d({meta:!0,google:!0,analytics:!0});try{const I=N.post(`api/summary/facebook-ads/${a}`,{withCredentials:!0}).catch(T=>(console.error("Error fetching Meta data:",T),d(x=>({...x,meta:!1})),{data:{success:!1}})),L=N.post(`api/summary/google-ads/${a}`,{withCredentials:!0}).catch(T=>(console.error("Error fetching Google data:",T),d(x=>({...x,google:!1})),{data:{success:!1}})),M=N.post(`api/summary/analytics/${a}`,{withCredentials:!0}).catch(T=>(console.error("Error fetching Analytics data:",T),d(x=>({...x,analytics:!1})),{data:{success:!1}})),[y,R,E]=await Promise.all([I,L,M]);u({meta:y.data.success?y.data.periodData:void 0,google:R.data.success?R.data.periodData:void 0,analytics:E.data.success?E.data.periodData:void 0}),d({meta:y.data.success,google:R.data.success,analytics:E.data.success})}catch(I){console.error("Error in fetchPerformanceData:",I),d({meta:!1,google:!1,analytics:!1})}finally{o(!1)}},[a]),v=I=>{C(I),w(!0)},k=(I,L,M)=>{console.log(`Successfully connected ${I} - ${L} (${M})`),b()};if(n.useEffect(()=>{b()},[b]),n.useEffect(()=>{(!(s!=null&&s.brands)||s.brands.length===0)&&m("/brand-setup")},[s,m]),r)return e.jsx(Se,{isLoading:r});const g=h.meta&&h.google&&h.analytics;return e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:[e.jsxs("div",{className:"mx-auto p-6 max-w-7xl",children:[e.jsx("div",{className:"mb-6 animate-fade-up",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-12 w-1 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:["Welcome Back, ",t]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Here's your performance overview"})]})]}),e.jsx("div",{className:"flex flex-row items-center gap-3",children:e.jsx(z,{onClick:b,disabled:r,size:"sm",variant:"outline",className:"hover:bg-slate-100",children:e.jsx(je,{className:se("h-4 w-4 ",r&&"animate-spin")})})})]})}),!g&&e.jsx("div",{className:"mb-8 animate-fade-up",children:e.jsxs("div",{className:"bg-white border rounded-lg shadow-md p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Connect Your Platforms"})}),e.jsx("p",{className:"text-slate-600",children:"Connect your advertising and analytics platforms to see all your performance data in one place."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[!h.meta&&e.jsx(Gs,{platform:"Facebook",onClick:()=>v("Facebook")}),!h.google&&e.jsx(Gs,{platform:"Google Ads",onClick:()=>v("Google Ads")}),!h.analytics&&e.jsx(Gs,{platform:"Google Analytics",onClick:()=>v("Google Analytics")})]})]})}),e.jsx("div",{className:"space-y-6",children:["yesterday","last7Days","last30Days"].map(I=>e.jsx(ic,{period:I,performanceData:l,apiStatus:h},I))})]}),S&&a&&e.jsx(ft,{platform:S,open:f,onOpenChange:w,brandId:a,onSuccess:k})]})};function dc(){const[s,a]=n.useState(!1),[t,r]=n.useState(null),{brandId:o}=pe(),l=u=>{r(u),a(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(vs,{title:"AdMetrics Dashboard",Icon:ws,showDatePicker:!1,showSettings:!1,showRefresh:!1,isLoading:!1}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Connect Your Advertising Accounts"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Connect your Facebook and Google Ads accounts to start tracking your advertising performance metrics in one place."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 hover:border-blue-500 transition-colors",children:[e.jsx(Gs,{platform:"Facebook",onClick:()=>l("Facebook")}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Facebook Ads Benefits:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Track ad spend and performance"}),e.jsx("li",{children:"Monitor ROAS and conversions"}),e.jsx("li",{children:"Analyze audience insights"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 hover:border-blue-500 transition-colors",children:[e.jsx(Gs,{platform:"Google Ads",onClick:()=>l("Google Ads")}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Google Ads Benefits:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Track campaign performance"}),e.jsx("li",{children:"Monitor conversion rates"}),e.jsx("li",{children:"Analyze keyword performance"})]})]})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500 mb-8",children:[e.jsx("div",{className:"h-px w-16 bg-gray-300"}),e.jsx("span",{children:"or"}),e.jsx("div",{className:"h-px w-16 bg-gray-300"})]}),e.jsx("p",{className:"text-gray-600",children:"Need help? Contact our support team for assistance with connecting your accounts."})]})]}),e.jsx(ft,{open:s,onOpenChange:a,platform:t||"Facebook",brandId:o||""})]})}function mc(){var W,Z,Q,U,K,J,H,B,te,me;const[s,a]=n.useState(!1),[t,r]=n.useState([]),[o,l]=n.useState(),[u,m]=n.useState(!1),[h,d]=n.useState(null),f=P($=>$.locale.locale),{brandId:w}=pe(),S=Ke(),C=P($=>$.date.from),N=P($=>$.date.to),b=P($=>$.brand.brands),v=P($=>$.user.user),[k,g]=n.useState({totalSpent:0,totalRevenue:0,totalROAS:0,totalPurchases:0,totalCTR:0,totalCPC:0,totalCPM:0,totalCPP:0}),I=n.useMemo(()=>({from:C,to:N}),[C,N]),L=ke(),M=b.find($=>$._id===w),y=!!((W=M==null?void 0:M.googleAdAccount)!=null&&W.length),R=!!((Z=M==null?void 0:M.fbAdAccounts)!=null&&Z.length),E=y||R,T=v==null?void 0:v.id,x=async($,ee)=>{try{return(await L.post(`/api/metrics/fbAd/${w}`,{startDate:$,endDate:ee,userId:T},{withCredentials:!0})).data.data}catch(X){return console.error("Error fetching Facebook ad data:",X),[]}},F=async($,ee)=>{var X;try{return((X=(await L.post(`/api/metrics/googleAdAndCampaign/${w}`,{startDate:$,endDate:ee},{withCredentials:!0})).data)==null?void 0:X.data)||[]}catch(ae){return console.error("Error fetching Google ad data:",ae),[]}},p=n.useCallback(async()=>{var $;a(!0);try{const ee=I!=null&&I.from?Y(I.from,"yyyy-MM-dd"):"",X=I!=null&&I.to?Y(I.to,"yyyy-MM-dd"):"",[ae,he]=await Promise.all([x(ee,X),F(ee,X)]);r(ae),l(he),A(ae,he)}catch(ee){console.error("Error fetching ad data:",ee),re.isAxiosError(ee)&&(($=ee.response)==null?void 0:$.status)===401&&(alert("Your session has expired. Please log in again."),S("/"))}finally{a(!1)}},[S,I,w,T]);n.useEffect(()=>{p()},[p]),n.useEffect(()=>{p();const $=setInterval(p,3*60*60*1e3);return()=>clearInterval($)},[p]);const c=$=>{let ee=0,X=0,ae=0,he=0,Ne=0;return $!=null&&$.length&&$.forEach(Fe=>{var Ee,Ge;ee+=parseFloat(String(Fe.spend||"0")),X+=parseFloat(String(((Ee=Fe.Revenue)==null?void 0:Ee.value)||"0")),ae+=parseFloat(String(((Ge=Fe.purchases)==null?void 0:Ge.value)||"0")),he+=parseFloat(String(Fe.clicks||"0")),Ne+=parseFloat(String(Fe.impressions||"0"))}),{totalSpent:ee,totalRevenue:X,totalPurchases:ae,totalClicks:he,totalImpressions:Ne}},i=$=>{let ee=0,X=0,ae=0,he=0,Ne=0;return $!=null&&$.adMetrics&&(ee+=parseFloat($.adMetrics.totalSpend||"0"),X+=parseFloat($.adMetrics.totalConversionsValue||"0"),ae+=parseFloat($.adMetrics.totalConversions||"0"),he+=parseFloat($.adMetrics.totalClicks||"0"),Ne+=parseFloat($.adMetrics.totalImpressions||"0")),{totalSpent:ee,totalRevenue:X,totalPurchases:ae,totalClicks:he,totalImpressions:Ne}},A=n.useCallback(($,ee)=>{const X=c($),ae=i(ee),he=X.totalSpent+ae.totalSpent,Ne=X.totalRevenue+ae.totalRevenue,Fe=X.totalPurchases+ae.totalPurchases,Ee=X.totalClicks+ae.totalClicks,Ge=X.totalImpressions+ae.totalImpressions;g({totalSpent:he,totalRevenue:Ne,totalROAS:Ne/he||0,totalPurchases:Fe,totalCTR:Ee/Ge*100||0,totalCPC:he/Ee||0,totalCPM:he*1e3/Ge||0,totalCPP:Fe>0?he/Fe:0})},[]),G=n.useMemo(()=>({totalSpent:` ${k.totalSpent.toLocaleString(f)}`,totalRevenue:` ${k.totalRevenue.toLocaleString(f)}`,totalROAS:Number(k.totalROAS.toFixed(2)).toLocaleString(f),totalPurchases:k.totalPurchases.toLocaleString(f),totalCTR:`${Number(k.totalCTR.toFixed(2)).toLocaleString(f)} %`,totalCPC:Number(k.totalCPC.toFixed(2)).toLocaleString(f),totalCPM:Number(k.totalCPM.toFixed(2)).toLocaleString(f),totalCPP:Number(k.totalCPP.toFixed(2)).toLocaleString(f)}),[k,f]),O=[{label:"Amount Spent",value:G.totalSpent,tooltipContent:"The sum of ad spends for all advertising platforms"},{label:"Revenue",value:G.totalRevenue,tooltipContent:"Revenue from Ads Purchases"},{label:"ROAS (Ads only)",value:G.totalROAS,tooltipContent:"Blended ROAS = Ads Purchases value / Blended Ad Spend"},{label:"Ads Purchases",value:G.totalPurchases,tooltipContent:"Ads Purchases = Fb Ads Purchase + Google Conversions"},{label:"CPC",value:G.totalCPC,tooltipContent:"Average CPC from all advertising platforms = (Blended Ad Spend / Blended Clicks)"},{label:"CPM",value:G.totalCPM,tooltipContent:"Average CPM from all advertising platforms = (Blended Ad Spend * 1000 / Blended Impressions)"},{label:"CTR",value:G.totalCTR,tooltipContent:"Average CTR from all advertising platforms = (Blended Clicks / Blended Impressions)*100"},{label:"CPP",value:G.totalCPP,tooltipContent:"Average CPP from all advertising platforms = (Blended Ad Spend / Blended Purchases)"}],D=[{label:"Total Cost",value:o?` ${parseFloat(((Q=o==null?void 0:o.adMetrics)==null?void 0:Q.totalSpend)||"0").toLocaleString(f)}`:" 0"},{label:"Conversion Value",value:o?` ${parseFloat((U=o==null?void 0:o.adMetrics)==null?void 0:U.totalConversionsValue).toLocaleString(f)}`:" 0"},{label:"ROAS",value:o?parseFloat((K=o==null?void 0:o.adMetrics)==null?void 0:K.roas).toLocaleString(f):"0.00"},{label:"Conversions",value:o?parseFloat((J=o==null?void 0:o.adMetrics)==null?void 0:J.totalConversions).toLocaleString(f):"0"},{label:"CPC",value:o?` ${parseFloat((H=o==null?void 0:o.adMetrics)==null?void 0:H.totalCPC).toLocaleString(f)}`:" 0"},{label:"CPM",value:o?` ${parseFloat((B=o==null?void 0:o.adMetrics)==null?void 0:B.totalCPM).toLocaleString(f)}`:" 0"},{label:"CTR",value:o?`${parseFloat((te=o==null?void 0:o.adMetrics)==null?void 0:te.totalCTR).toLocaleString(f)} %`:" 0"},{label:"Cost Per Conversion",value:o?` ${parseFloat((me=o==null?void 0:o.adMetrics)==null?void 0:me.totalCostPerConversion).toLocaleString(f)}`:" 0"}],j=$=>{d($),m(!0)},_=($,ee,X)=>{console.log(`Successfully connected ${$} account: ${ee} (${X})`),window.location.reload()};return E?s?e.jsx(Se,{isLoading:s}):e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(vs,{title:"AdMetrics Dashboard",Icon:ws,showDatePicker:!0,showSettings:!0,showRefresh:!0,isLoading:!1,handleManualRefresh:()=>{p()}}),!E&&e.jsxs("div",{className:"p-4 md:p-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Connect Your Ad Accounts"}),e.jsx("p",{className:"text-gray-600",children:"Connect your advertising accounts to start tracking your metrics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:[e.jsx(Gs,{platform:"Facebook",onClick:()=>j("Facebook")}),e.jsx(Gs,{platform:"Google Ads",onClick:()=>j("Google Ads")})]}),e.jsx("div",{className:"text-center mt-8",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500",children:[e.jsx("div",{className:"h-px w-16 bg-gray-300"}),e.jsx("span",{children:"or"}),e.jsx("div",{className:"h-px w-16 bg-gray-300"})]})})]}),e.jsx(ft,{open:u,onOpenChange:m,platform:h||"Facebook",brandId:w||"",onSuccess:_}),e.jsxs("main",{className:"p-4 md:p-6 lg:px-8",children:[E?e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{id:"all",children:[e.jsx("h2",{className:"text-xl font-semibold flex flex-row items-center justify-between",children:e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx($n,{className:"h-5 w-5"}),e.jsx("span",{children:"Blended summary"}),e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]})}),e.jsx(Vt,{metrics:O,date:{from:I.from?new Date(I.from):void 0,to:I.to?new Date(I.to):void 0},isLoading:s})]})}):e.jsx(e.Fragment,{}),(t==null?void 0:t.length)>0&&t.map(($,ee)=>{var ae,he;const X=[{label:"Amount Spent",value:` ${parseFloat(String($.spend||"0")).toLocaleString(f)}`},{label:"Revenue",value:` ${parseFloat(String(((ae=$.Revenue)==null?void 0:ae.value)||"0")).toLocaleString(f)}`},{label:"ROAS (Ads only)",value:$.purchase_roas&&$.purchase_roas.length>0?parseFloat(String($.purchase_roas[0].value)).toLocaleString(f,{minimumFractionDigits:2,maximumFractionDigits:2}):"0"},{label:"Ads Purchases",value:((he=$.purchases)==null?void 0:he.value)||"0"},{label:"CPC (All clicks)",value:` ${new Intl.NumberFormat(f).format(parseFloat($.cpc||"0"))}`},{label:"CPM",value:` ${new Intl.NumberFormat(f,{minimumFractionDigits:2}).format(parseFloat($.cpm||"0"))}`},{label:"CTR",value:`${parseFloat($.ctr||"0").toFixed(2)} %`},{label:"Cost per Purchase (All)",value:` ${new Intl.NumberFormat(f).format(parseFloat($.cpp||"0"))}`}];return e.jsx("div",{id:"facebook",children:e.jsx(Vt,{icon:"Facebook",title:`Facebook - ${$.account_name}`,metrics:X,date:{from:I.from?new Date(I.from):void 0,to:I.to?new Date(I.to):void 0},isLoading:s,errorMessage:$.message})},ee)}),!R&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"facebook",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Facebook Ad Metrics"})]}),e.jsxs("div",{className:"text-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Facebook Ad Account connected for this brand."}),e.jsx("button",{onClick:()=>j("Facebook"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Connect Facebook Ads"})]})]})}),R&&!y&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"google",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(Ue,{width:"1.5rem",height:"1.5rem"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Google Ad Metrics"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Google Ad Account connected for this brand."}),e.jsxs("button",{onClick:()=>j("Google Ads"),className:"flex flex-row items-center justify-center gap-3 px-4 py-2 border-2 border-green-800 text-blackk rounded-md transition-colors",children:[e.jsx(Ue,{width:"1.5rem",height:"1.5rem"}),"Connect Google Ads"]})]})]})}),o&&Object.keys(o).length>0&&e.jsx("div",{id:"google",children:e.jsx(Vt,{icon:"Google",title:`Google Ads - ${o==null?void 0:o.adAccountName}`,metrics:D,date:{from:I.from?new Date(I.from):void 0,to:I.to?new Date(I.to):void 0},isLoading:s})},"google"),!y&&!R&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"google",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(Ue,{width:"1.5rem",height:"1.5rem"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Google Ad Metrics"})]}),e.jsxs("div",{className:"text-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Google Ad Account connected for this brand."}),e.jsx("button",{onClick:()=>j("Google Ads"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Connect Google Ads"})]})]})})]})]}):e.jsx(dc,{})}const La="https://parallels.messold.com";function uc(){return e.jsx(oe,{className:"p-6 space-y-4",children:e.jsxs(de,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{className:"h-4 w-32"}),e.jsx(He,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{className:"h-4 w-32"}),e.jsx(He,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{className:"h-4 w-32"}),e.jsx(He,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{className:"h-4 w-32"}),e.jsx(He,{className:"h-24 w-full"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(He,{className:"h-10 w-24"}),e.jsx(He,{className:"h-10 w-24"})]})]})})}function hc({onClose:s}){const[a,t]=n.useState({subject:"",description:"",departmentId:"",brand:"",firstName:"",lastName:"",email:""}),[r,o]=n.useState([]),[l,u]=n.useState(!1),[m,h]=n.useState(!1),[d,f]=n.useState({});n.useEffect(()=>{(async()=>{u(!0);try{const b=await re.get(`${La}/api/zoho/departments`,{withCredentials:!0});b.data&&b.data.departments&&o(b.data.departments)}catch(b){console.error("Error fetching departments:",b)}finally{u(!1)}})()},[]);const w=N=>{const{name:b,value:v}=N.target;t(k=>({...k,[b]:v})),d[b]&&f(k=>{const g={...k};return delete g[b],g})},S=()=>{const N={};return a.subject.trim()||(N.subject="Subject is required"),a.brand.trim()||(N.brand="Brand name is required"),a.departmentId||(N.departmentId="Please select a department"),a.description.trim()||(N.description="Description is required"),a.firstName.trim()||(N.firstName="First Name is required"),a.email.trim()?/\S+@\S+\.\S+/.test(a.email)||(N.email="Please enter a valid email address"):N.email="Email is required",f(N),Object.keys(N).length===0},C=async N=>{if(N.preventDefault(),!!S()){h(!0);try{(await re.post(`${La}/api/zoho/create-ticket`,a,{withCredentials:!0})).data.success&&s()}catch(b){console.error("Error submitting ticket:",b),f({form:"There was an error submitting your tickets. Please try again."})}finally{h(!1)}}};return l?e.jsx(uc,{}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-800 px-6 py-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center",children:[e.jsx(pa,{className:"mr-2 h-5 w-5"}),"Submit a Support Ticket"]}),e.jsx("button",{onClick:s,className:"text-slate-300 hover:text-white transition-colors",children:e.jsx(xs,{className:"h-6 w-6"})})]}),d.form&&e.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(Xt,{className:"h-5 w-5 text-red-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-red-700 text-sm",children:d.form})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"subject",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pa,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"subject",name:"subject",type:"text",value:a.subject,onChange:w,className:`pl-10 block w-full px-3 py-2.5 border ${d.subject?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Brief description of your issue"})]}),d.subject&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.subject})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"brand",children:["Brand Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Oo,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"brand",name:"brand",type:"text",value:a.brand,onChange:w,className:`pl-10 block w-full px-3 py-2.5 border ${d.brand?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Your brand name"})]}),d.brand&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.brand})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"departmentId",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ro,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("select",{id:"departmentId",name:"departmentId",value:a.departmentId,onChange:w,className:`pl-10 block w-full px-3 py-2.5 border ${d.departmentId?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 appearance-none bg-no-repeat bg-right`,style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' strokeLinecap='round' strokeLinejoin='round' strokeWidth='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.5rem center",backgroundSize:"1.5em 1.5em"},children:[e.jsx("option",{value:"",children:"Select an issue type"}),r.map(N=>e.jsx("option",{value:N==null?void 0:N.id,children:N.name},N.id))]})]}),d.departmentId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.departmentId})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"firstName",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(In,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"firstName",name:"firstName",type:"text",value:a.firstName,onChange:w,className:"pl-10 block w-full px-3 py-2.5 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500",placeholder:"First name"})]}),d.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{id:"lastName",name:"lastName",type:"text",value:a.lastName,onChange:w,className:"block w-full px-3 py-2.5 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500",placeholder:"Last name"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"email",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(dt,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",value:a.email,onChange:w,className:`pl-10 block w-full px-3 py-2.5 border ${d.email?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"your.email@example.com"})]}),d.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.email}),e.jsx("div",{className:"h-full flex items-end",children:e.jsx("div",{className:"text-xs text-slate-500 italic",children:"We'll use this email to contact you about your ticket"})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"description",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:w,rows:5,className:`block w-full px-3 py-2.5 border ${d.description?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Please provide detailed information about your issue to help us assist you better"}),d.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.description})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{type:"submit",disabled:m,className:`flex-1 bg-slate-700 text-white py-2.5 px-4 rounded-md hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors ${m?"opacity-70 cursor-not-allowed":""}`,children:m?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(Do,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(zo,{className:"w-4 h-4"}),"Submit Ticket"]})}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-white text-slate-700 py-2.5 px-4 border border-slate-300 rounded-md hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors",children:"Cancel"})]})]})]})}const As=()=>{const[s,a]=n.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-8 right-8 z-30 flex items-center gap-2 bg-indigo-600 text-white p-3 rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-200 group",children:e.jsx(No,{className:"w-5 h-5 group-hover:animate-pulse"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsx(hc,{onClose:()=>a(!1)})})})]})};function fs(){return e.jsx("footer",{className:"w-full border-t bg-slate-900 text-white",children:e.jsx("div",{className:"container px-6 py-8 flex justify-center items-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-2xl tracking-tight",children:[e.jsx("img",{src:aa,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{className:"text-slate-100",children:"Parallels"})]}),e.jsx("p",{className:"text-sm text-slate-400 text-center max-w-sm",children:"The all-in-one marketing platform for growing businesses."}),e.jsxs("nav",{className:"flex space-x-4 text-sm font-medium",children:[e.jsx(Ze,{to:"/privacy-policy",className:"text-slate-400 transition hover:text-blue-400",children:"Privacy Policy"}),e.jsx("span",{className:"text-slate-500",children:"|"}),e.jsx(Ze,{to:"/terms-and-conditions",className:"text-slate-400 transition hover:text-blue-400",children:"Terms of Service"})]})]})})})}const xc=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(mc,{}),e.jsx(fs,{}),e.jsx(As,{})]})]});function fc({onConnect:s}){const[a,t]=n.useState(""),[r,o]=n.useState(!1),l="https://parallels.messold.com";n.useEffect(()=>{const m=new URLSearchParams(window.location.search),h=m.get("access_token"),d=m.get("shop_name"),f=m.get("shop");if(h&&d&&f){s&&s("Shopify",d,h),m.delete("access_token"),m.delete("shop_name"),m.delete("shop");const w=`${window.location.pathname}${m.toString()?`?${m.toString()}`:""}`;window.history.replaceState({},"",w)}},[s]);const u=async()=>{if(a.trim()){o(!0);try{const m=await re.post(`${l}/api/auth/shopify`,{shop:a,flowType:"brandSetup"},{withCredentials:!0});if(m.data.success){const{authUrl:h}=m.data;console.log("Generated Shopify Auth URL:",h),window.location.href=h}else console.error("Failed to get Shopify Auth URL")}catch(m){console.error("Error getting Shopify Auth URL:",m)}finally{o(!1)}}};return e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(Pe,{type:"text",placeholder:"Enter your Shopify store name (e.g., mystore)",value:a,onChange:m=>t(m.target.value),onKeyPress:m=>{m.key==="Enter"&&a.trim()&&u()}}),e.jsx(z,{className:"w-full",onClick:u,disabled:!a.trim()||r,children:r?"Connecting...":"Login to Shopify"}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Enter your store name without .myshopify.com"})]})}function gc({platform:s,onConnect:a,connectedId:t,onRemove:r,onOpenChange:o}){var T;const[l,u]=n.useState(""),[m,h]=n.useState([]),[d,f]=n.useState([]),[w,S]=n.useState([]),[C,N]=n.useState(!1),[b,v]=n.useState(!1),k="https://parallels.messold.com",g=P(x=>x.user.user);n.useEffect(()=>{const x=new URLSearchParams(window.location.search),F=x.get("openModal");if(F&&o){switch(F.toLowerCase()){case"googleads":s.toLowerCase()==="google ads"&&o(!0);break;case"googleanalytics":s.toLowerCase()==="google analytics"&&o(!0);break;case"facebook":s.toLowerCase()==="facebook"&&o(!0);break}x.delete("openModal");const p=`${window.location.pathname}${x.toString()?`?${x.toString()}`:""}`;window.history.replaceState({},"",p)}},[s,o]),n.useEffect(()=>{const x=async()=>{var c;v(!0);try{const i=g==null?void 0:g.id,A=await re.post(`${k}/api/setup/google-accounts`,{userId:i},{withCredentials:!0});A.status===200?(N(!1),h((c=A.data)==null?void 0:c.clientAccounts.filter(G=>!G.hidden))):console.log("Unexpected status code:",A.status)}catch(i){I(i)}finally{v(!1)}},F=async()=>{v(!0);try{const c=g==null?void 0:g.id,i=await re.post(`${k}/api/setup/ga4-propertyIds`,{userId:c},{withCredentials:!0});i.status===200?(N(!1),f(i.data.propertiesList||[])):console.log("Unexpected status code:",i.status)}catch(c){I(c)}finally{v(!1)}},p=async()=>{v(!0);try{const c=g==null?void 0:g.id,i=await re.post(`${k}/api/setup/fb-ad-accounts`,{userId:c},{withCredentials:!0});S(i.data.adAccounts||[])}catch(c){I(c)}finally{v(!1)}};s.toLowerCase()==="google ads"&&x(),s.toLowerCase()==="google analytics"&&F(),s.toLowerCase()==="facebook"&&p()},[s,g]);const I=x=>{var F;if(re.isAxiosError(x)){const p=x,{response:c,request:i}=p;if(c){const{status:A,data:G,config:O}=c,D=((F=G==null?void 0:G.error)==null?void 0:F.code)||(G==null?void 0:G.code);if([401,403,"UNAUTHENTICATED","TOKEN_EXPIRED","INVALID_CREDENTIALS"].some(W=>A===W||D===W)){console.error("Authentication Error:",{status:A,code:D,message:G==null?void 0:G.message}),N(!0);return}if(G!=null&&G.errors&&G.errors.length>0){const Z=G.errors[0].message||"Google Ads API Error";if(console.error("Google Ads API Error:",Z),Z&&["not associated with any Ads accounts","missing required authentication credential","OAuth access token invalid"].some(K=>Z.toLowerCase().includes(K.toLowerCase()))){N(!0);return}}console.error("Server Error:",{status:A,url:O==null?void 0:O.url,method:O==null?void 0:O.method}),N(!0)}else i?(console.error("No response received:",i),N(!0)):(console.error("Request Setup Error:",p.message),N(!0))}else console.error("Unexpected Error:",x),N(!0)},L=()=>s.toLowerCase()==="google ads"?!m||m.length===0?null:m.filter(x=>x.name.toLowerCase().includes(l.toLowerCase())):s.toLowerCase()==="google analytics"?!d||d.length===0?null:d.filter(x=>x.propertyName.toLowerCase().includes(l.toLowerCase())):s.toLowerCase()==="facebook"?!w||w.length===0?null:w.filter(x=>x.adname.toLowerCase().includes(l.toLowerCase())):[],M=x=>{let F,p,c;"clientId"in x?(F=x.clientId,c=x.managerId,p=c?`${x.name} (${F}/${c})`:`${x.name} (${F})`):"propertyId"in x?(F=x.propertyId,p=`${x.propertyName} (${F})`):"id"in x?(F=x.id,p=`${x.adname}`):(F="",p=""),a(s,p,F,c)},y=async()=>{try{const x=await re.get(`${k}/api/auth/google?context=googleAdSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:F}=x.data;window.location.href=F}catch(x){console.error("Error getting Google Auth URL:",x)}},R=async()=>{try{const x=await re.get(`${k}/api/auth/google?context=googleAnalyticsSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:F}=x.data;window.location.href=F}catch(x){console.error("Error getting Google Auth URL:",x)}},E=async()=>{try{const x=await re.get(`${k}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});x.data.success?window.location.href=x.data.authURL:console.error("Failed to get Facebook Auth URL")}catch(x){console.error("Error getting Facebook Auth URL:",x)}};return b?e.jsx("div",{children:"Loading..."}):e.jsx(e.Fragment,{children:C?e.jsxs(z,{size:"sm",onClick:s.toLowerCase()==="facebook"?E:s.toLowerCase()==="google ads"?y:R,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(Ue,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{height:"1rem",width:"1rem"}),"Connect to your Facebook account"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(Pe,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:l,onChange:x=>u(x.target.value)})]}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(T=L())==null?void 0:T.map(x=>{const F=s.toLowerCase()==="google ads",p=s.toLowerCase()==="facebook",c=F?x.clientId:p?x.id:x.propertyId,i=F?x.managerId:void 0,A=F?x.name:p?x.adname:x.propertyName,G=F?e.jsx(Ue,{height:"1rem",width:"1rem"}):p?e.jsx(qe,{height:"1rem",width:"1rem"}):e.jsx(Re,{height:"1rem",width:"1rem"}),O=F&&i?`${A} (${c}/${i})`:p?`${A}`:`${A} (${c})`;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[G,O]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&r&&e.jsxs(z,{size:"sm",variant:"destructive",onClick:()=>r(s,c,s.toLowerCase()==="google ads"?i:void 0),className:"flex items-center",children:[e.jsx(xs,{className:"h-4 w-4 mr-1"})," Remove"]}),e.jsxs(z,{size:"sm",onClick:()=>M(x),disabled:t.includes(c),className:t.includes(c)?"bg-green-600":"bg-blue-600",children:[t.includes(c)&&e.jsx(Qs,{className:"h-4 w-4 mr-2"}),t.includes(c)?"Connected":"Connect"]})]})]},`${s}-${c}-${i||""}`)})})]})})}const pc=[{name:"Shopify",color:"bg-emerald-50",icon:rr,textColor:"text-emerald-700",ringColor:"ring-emerald-200",description:"Connect your e-commerce store"},{name:"Facebook",color:"bg-blue-50",icon:qe,textColor:"text-blue-700",ringColor:"ring-blue-200",description:"Link your ad accounts"},{name:"Google Ads",color:"bg-rose-50",icon:Ue,textColor:"text-rose-700",ringColor:"ring-rose-200",description:"Import campaign data"},{name:"Google Analytics",color:"bg-yellow-50",icon:Re,textColor:"text-yellow-700",ringColor:"ring-yellow-200",description:"Track website metrics"}];function wr(){const[s,a]=n.useState(null),t=fe(),r=Ke(),{toast:o}=Ot(),l=P(x=>x.user.user),u=P(x=>x.brandForm),[m,h]=n.useState(u.brandName||""),[d,f]=n.useState(u.connectedAccounts||{}),[w,S]=n.useState(u.googleAdsConnections||[]),[C,N]=n.useState(u.ga4Id||""),[b,v]=n.useState(u.fbAdId||[]),[k,g]=n.useState(u.shop||""),[I,L]=n.useState(u.shopifyAccessToken||"");n.useEffect(()=>{const x=new URLSearchParams(window.location.search),F=x.get("access_token"),p=x.get("shop_name");F&&p&&(L(F),g(p),f(c=>({...c,Shopify:[p]})))},[]),n.useEffect(()=>{t(Hi({brandName:m,connectedAccounts:d,googleAdsConnections:w,ga4Id:C,fbAdId:b,shop:k,shopifyAccessToken:I}))},[m,d,w,C,b,k,I,t]),n.useEffect(()=>{const x=new URLSearchParams(window.location.search),F=x.get("openModal");if(F){switch(F.toLowerCase()){case"googleads":a("Google Ads");break;case"googleanalytics":a("Google Analytics");break;case"facebook":a("Facebook");break}x.delete("openModal");const p=`${window.location.pathname}${x.toString()?`?${x.toString()}`:""}`;window.history.replaceState({},"",p)}},[]);const M=(x,F,p,c)=>{f(i=>({...i,[x]:[...i[x]||[],F]})),x.toLowerCase()==="google ads"?S(i=>[...i,{clientId:p,managerId:c}]):x.toLowerCase()==="google analytics"?N(p):x.toLowerCase()==="facebook"?v(i=>[...i,p]):x.toLowerCase()==="shopify"&&(L(p),g(F)),o({description:`Successfully connected ${F} to ${x}`,variant:"default"})},y=x=>{var F;return(((F=d[x])==null?void 0:F.length)||0)>0},R=x=>{switch(x.toLowerCase()){case"google ads":return w.map(F=>F.clientId).join(",");case"google analytics":return C;case"facebook":return b.join(",");default:return""}},E=()=>!!m&&Object.keys(d).length>0,T=async()=>{if(!m||Object.keys(d).length===0)return o({description:"Please complete all fields before submitting.",variant:"destructive"});const x={name:m,googleAdAccount:w.map(F=>({clientId:F.clientId,managerId:F.managerId||""})),ga4Account:{PropertyID:C||""},fbAdAccounts:b.map(F=>F),shopifyAccount:{shopName:k||"",shopifyAccessToken:I||""}};try{const p=(await re.post(`${Te}/api/brands/add`,x,{withCredentials:!0})).data.brand._id;l&&await re.post(`${Te}/api/users/add-brand`,{userId:l==null?void 0:l.id,brandId:p},{withCredentials:!0});const c=l?{...l,brands:[...l.brands,p]}:null;c&&(t(rt(c)),t(qi()),r("/dashboard")),o({description:"Brand setup completed successfully!",variant:"default"})}catch(F){console.error(F),o({description:"Error creating brand. Please try again.",variant:"destructive"})}};return e.jsx(oe,{className:"mx-auto max-w-7xl shadow-lg",children:e.jsxs(de,{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:e.jsx(ea,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Brand Setup"}),e.jsx("p",{className:"text-gray-500",children:"Enter your brand details and connect your platforms"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ns,{htmlFor:"brandName",className:"text-sm font-medium text-gray-700",children:"Brand Name"}),e.jsx(Pe,{id:"brandName",placeholder:"Enter your brand name",value:m,onChange:x=>h(x.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ns,{className:"text-sm font-medium text-gray-700",children:"Connect Platforms"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:pc.map(x=>e.jsxs(zt,{open:s===x.name,onOpenChange:F=>a(F?x.name:null),children:[e.jsx(Kl,{asChild:!0,children:e.jsx("button",{className:`relative group p-6 rounded-xl ${x.color} ring-1 ${x.ringColor} transition-all duration-200 hover:scale-[1.02] w-full text-left`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(x.icon,{width:"2rem",height:"2rem"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold ${x.textColor}`,children:x.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:x.description})]}),y(x.name)?e.jsx(Qs,{className:"h-5 w-5 text-green-500"}):e.jsx(Ss,{className:"h-5 w-5 text-gray-400"})]})})}),e.jsxs(mt,{className:"sm:max-w-[600px]",children:[e.jsxs(ut,{children:[e.jsxs(ht,{children:["Connect to ",x.name]}),e.jsx(ra,{children:x.name==="Shopify"?"Enter your Shopify store name and login to connect.":"Select an account to connect with your brand."})]}),x.name==="Shopify"?e.jsx(fc,{onConnect:M}):e.jsx(gc,{platform:x.name,onConnect:M,connectedId:R(x.name)})]})]},x.name))})]}),Object.keys(d).length>0&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Connected Platforms"}),e.jsx("div",{className:"space-y-2",children:Object.entries(d).map(([x,F])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:x}),e.jsx("span",{className:"font-medium",children:F.join(", ")})]},x))})]}),e.jsxs(z,{className:"w-full",disabled:!E(),onClick:T,children:["Complete Setup",e.jsx(Ds,{className:"ml-2 h-5 w-5"})]})]})]})})}const Cr=n.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},o)=>e.jsx(an,{ref:o,decorative:t,orientation:a,className:se("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));Cr.displayName=an.displayName;function Sr(){const s=P(t=>t.user.user),a=(s==null?void 0:s.username)||"user";return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-6 rounded-xl overflow-hidden shadow-lg relative",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:"/abstract-layout.jpg",alt:"Background",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/60"})]}),e.jsx("div",{className:"relative z-10 p-8 md:p-12",children:e.jsx("div",{className:"max-w-3xl",children:e.jsxs("div",{className:"text-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(jt,{className:"h-5 w-5 text-yellow-300"}),e.jsx("span",{className:"font-medium",children:"Getting Started"})]}),e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-3 tracking-tight",children:["Welcome to Parallels, ",a,"!"]}),e.jsx("p",{className:"text-white/90 text-lg max-w-2xl",children:"Set up your brand to start tracking analytics across your marketing platforms. Connect your accounts to get comprehensive insights all in one place."})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(wr,{})}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(oe,{children:[e.jsxs(Cs,{className:"pb-3",children:[e.jsx(Hs,{className:"text-lg font-semibold",children:"Setup Steps"}),e.jsx(lr,{children:"Complete these steps to get started"})]}),e.jsx(de,{className:"space-y-4",children:Ca.map((t,r)=>e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-gray-100 p-1.5 flex-shrink-0 text-gray-600 group-hover:bg-primary/10 group-hover:text-primary transition-colors",children:e.jsx(t.icon,{className:"h-4 w-4"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-sm",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500",children:t.description})]})]}),r<Ca.length-1&&e.jsx("div",{className:"ml-3 pl-3 border-l border-gray-200 h-4 my-1"})]},t.id))})]}),e.jsxs(oe,{children:[e.jsx(Cs,{className:"pb-3",children:e.jsx(Hs,{className:"text-lg font-semibold text-blue-800",children:"Pro Tips"})}),e.jsx(de,{children:e.jsxs("ul",{className:"space-y-3 text-sm",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-1 text-blue-600 flex-shrink-0",children:e.jsx(lt,{width:14,height:14})}),e.jsx("span",{className:"text-blue-700",children:"Connect multiple platforms for comprehensive analytics across all your marketing channels."})]}),e.jsx(Cr,{className:"my-2 bg-blue-100"}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-1 text-blue-600 flex-shrink-0",children:e.jsx(lt,{width:14,height:14})}),e.jsx("span",{className:"text-blue-700",children:"Your data will be automatically synced and updated every 3 hours."})]})]})})]})]})]})]})})]})}const jc=()=>{var t;const s=P(r=>r.user.user),a=Ke();return s?e.jsx(e.Fragment,{children:((t=s.brands)==null?void 0:t.length)===0?e.jsx(Sr,{}):e.jsxs("div",{className:"flex h-screen relative",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(cc,{}),e.jsx(fs,{})]}),e.jsx(As,{})]})}):(a("/login"),null)};function bc(){const{brandId:s}=pe(),[a,t]=n.useState("Fetching table data"),r=["Fetching table data","Processing sales records","Aggregating metrics","Organizing table columns","Calculating performance indicators","Preparing data tables"];return n.useEffect(()=>{const o=setInterval(()=>{t(l=>{const m=(r.indexOf(l)+1)%r.length;return r[m]})},2500);return()=>clearInterval(o)},[]),e.jsxs("div",{className:"bg-slate-50 flex flex-col w-full min-h-screen",children:[e.jsx(vs,{title:"Marketing Insights Tracker",Icon:Lt,showDatePicker:!0}),e.jsx("main",{className:"container max-w-6xl mx-auto px-4 py-8 flex flex-col h-screen justify-center",children:e.jsxs("div",{className:"w-full text-center mb-12",children:[e.jsx("h1",{className:"text-xl md:text-4xl font-bold text-primary mb-3",children:"Preparing your dashboard..."}),e.jsx("div",{className:"h-8 my-8",children:e.jsxs("p",{className:"text-base md:text-lg text-violet-600 font-medium animate-pulse",children:[a,"..."]})}),e.jsx("p",{className:"text-sm md:text-base text-gray-700 max-w-4xl mx-auto mb-2",children:"We're loading data from the past two years up to yesterday. Going forward, new data will update daily."}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 max-w-4xl mx-auto mb-8",children:["This process may take ",e.jsx("span",{className:"font-medium",children:"1-2 hours"})," to complete."]}),e.jsx("p",{className:"text-sm md:text-base text-gray-700 max-w-4xl mx-auto mb-10",children:"In the meantime, you can explore these dashboards:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-6",children:[e.jsx(Ze,{to:`/admetrics/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-violet-100 flex items-center justify-center mb-3",children:e.jsx(Vs,{className:"w-6 h-6 text-violet-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"AdMetrics Hub"}),e.jsxs("div",{className:"flex items-center text-violet-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ds,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})}),e.jsx(Ze,{to:`/ecommerce-reports/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center mb-3",children:e.jsx(En,{className:"w-6 h-6 text-pink-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Ecommerce Insights"}),e.jsxs("div",{className:"flex items-center text-pink-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ds,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})}),e.jsx(Ze,{to:`/meta-campaigns/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mb-3",children:e.jsx(ws,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Campaign Analysis"}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ds,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})})]})]})})]})}const vc=(s,a="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(s);function We({title:s,tooltip:a,colSpan:t=1,rowSpan:r,isSubHeader:o=!1,isImportant:l=!1,isFirstInSection:u=!1}){return e.jsx("th",{className:`
        ${o?"text-xs font-medium":"font-semibold text-sm"}
        text-center whitespace-nowrap p-2
        ${o?"bg-slate-100":"bg-slate-200"}
        ${l?"bg-blue-50 !font-bold text-blue-800":""}
        relative overflow-hidden
        ${o?"":"sticky top-0 z-10"}
        font-inter border-b border-r border-slate-300
        ${u?"border-l-2 border-l-slate-300 shadow-sm":""}
      `,colSpan:t,rowSpan:r,children:e.jsx(nn,{children:e.jsxs(rn,{children:[e.jsx(on,{asChild:!0,children:e.jsxs("span",{className:`
                flex items-center justify-center gap-1 cursor-help
                ${l?"text-blue-800":""}
              `,children:[l&&e.jsx("span",{className:"text-blue-500",children:""}),s]})}),e.jsx(ln,{className:"mb-3 z-20 w-fit",children:e.jsxs("div",{className:"text-gray-700 bg-white p-2 rounded-md text-sm border shadow-lg max-w-fit",children:[l&&e.jsx("div",{className:"font-semibold text-blue-600 mb-1",children:"Key Metric"}),a]})})]})})})}function Ae({children:s,isNumeric:a=!1,isHeader:t=!1,isSticky:r=!1,isExpanded:o=!1,isImportant:l=!1,isFirstInSection:u=!1,className:m=""}){return e.jsx("td",{className:`
        border-b border-r border-slate-200
        ${a?"text-right font-roboto tabular-nums":"text-left"} 
        ${t?"font-medium font-dm-sans":""}
        ${r?"sticky z-10":""}
        ${o?"bg-blue-50/30":"bg-white hover:bg-slate-50/80"}
        ${r&&o?"bg-blue-50/30":""}
        ${l?"font-semibold text-blue-700":""}
        ${u?"border-l-2 border-l-slate-300 shadow-sm":""}
        transition-colors
        ${m}
      `,children:s})}const yc=()=>{const[s,a]=n.useState([]),[t,r]=n.useState(!0),[o,l]=n.useState(null),[u,m]=n.useState(!1),[h,d]=n.useState("USD"),f=P(x=>x.date.from),w=P(x=>x.date.to),[S,C]=n.useState([]),{brandId:N}=pe(),b=n.useMemo(()=>({from:f,to:w}),[f,w]),v=b!=null&&b.from?Y(b.from,"yyyy-MM-dd"):"",k=b!=null&&b.to?Y(b.to,"yyyy-MM-dd"):"",g=()=>{m(!u)},I=()=>u?"max-h-[calc(100vh-120px)]":"max-h-[calc(100vh-230px)]";n.useEffect(()=>{(async()=>{var F,p;r(!0),l(null);try{const c={};v&&(c.startDate=v),k&&(c.endDate=k);const i=await re.get(`${Te}/api/brands/currency/${N}`,{withCredentials:!0});d(i.data);const G=(await re.get(`${Te}/api/report/${N}`,{params:c,withCredentials:!0})).data.data;a(G)}catch(c){console.error(c);const i=re.isAxiosError(c)&&((p=(F=c.response)==null?void 0:F.data)!=null&&p.message)?c.response.data.message:"Something went wrong";l(i)}finally{r(!1)}})()},[N,v,k,Te]);const L=x=>{C(F=>F.includes(x)?F.filter(p=>p!==x):[...F,x])},M=x=>vc(x,h),y=x=>`${x.toFixed(2)}`,R=n.useMemo(()=>{const x=(F,p)=>p?F/p:0;return s.map(F=>{const p=F.dailyMetrics.map(G=>({...G,metaSales:G.metaSpend*(G.metaROAS||0),googleSales:G.googleSpend*(G.googleROAS||0),adSales:G.totalSpend*G.grossROI||0,ROI:x(G.totalSales,G.totalSpend)})),c=p.reduce((G,O)=>G+O.metaSales,0),i=p.reduce((G,O)=>G+O.googleSales,0),A=c+i||0;return{...F,metaSales:c,googleSales:i,totalAdSales:A,metaROAS:x(c,F.metaSpend),googleROAS:x(i,F.googleSpend),grossROI:x(A,F.totalSpend),netROI:x(F.shopifySales,F.totalSpend),ROI:x(F.totalSales,F.totalSpend),dailyMetrics:p}})},[s]);n.useMemo(()=>{if(!R.length)return null;const x=R.reduce((j,_)=>j+_.totalSales,0),F=R.reduce((j,_)=>j+_.totalSpend,0),p=F?x/F:0,c=R.reduce((j,_)=>j+_.metaSpend,0),i=R.reduce((j,_)=>j+_.googleSpend,0),A=R.reduce((j,_)=>j+_.metaSales,0),G=R.reduce((j,_)=>j+_.googleSales,0),O=c?A/c:0,D=i?G/i:0;return{totalSales:x,totalSpend:F,totalROI:p,metaSpend:c,googleSpend:i,metaSales:A,googleSales:G,metaROAS:O,googleROAS:D}},[R]);const E=()=>o?e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-red-600 border border-red-200",children:o}):e.jsx("div",{className:"border rounded-lg shadow-sm overflow-hidden bg-white",children:e.jsx("div",{className:`${I()} overflow-auto`,children:e.jsxs("table",{className:"w-full border-collapse font-inter",children:[e.jsxs("thead",{className:"sticky top-0 z-20",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 sticky left-0 z-30 bg-slate-200 border-b border-r border-slate-300",rowSpan:2}),e.jsx("th",{className:"sticky left-[40px] z-20 text-center whitespace-nowrap p-2 font-semibold text-sm bg-slate-200 border-b border-r border-slate-300 border-l-2 border-l-slate-300 ",rowSpan:2,children:"Date"}),e.jsx(We,{title:"Shopify (Actual Sales Data)",tooltip:"Shopify Metrics",colSpan:5,isFirstInSection:!0}),e.jsx(We,{title:"Meta + Google",tooltip:"Meta + Google",colSpan:3,isFirstInSection:!0}),e.jsx(We,{title:"Meta (Facebook & Instagram Ads)",tooltip:"Meta Metrics",colSpan:3,isFirstInSection:!0}),e.jsx(We,{title:"Google Ads",tooltip:"Google Metrics",colSpan:3,isFirstInSection:!0})]}),e.jsxs("tr",{children:[e.jsx(We,{title:"Net Sales",tooltip:"Net Sales = Gross Sales - Discount",isSubHeader:!0,isFirstInSection:!0}),e.jsx(We,{title:"Net ROI",tooltip:"Net ROI = Net Sales / Total Spend",isSubHeader:!0,isImportant:!0}),e.jsx(We,{title:"Total Returns",tooltip:"Net Returns + Shipping Returned + Return Fees + Taxes Returned",isSubHeader:!0}),e.jsx(We,{title:"Total Sales",tooltip:"Total Sales = Net Sales - Returns",isSubHeader:!0}),e.jsx(We,{title:"Final ROI",tooltip:"Final ROI = Total Sales / Total Spend",isSubHeader:!0,isImportant:!0}),e.jsx(We,{title:"Spend",tooltip:"Total Spent = Meta Spent + Google Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(We,{title:"Sales",tooltip:"Sales = (MetaSales + GoogleSales)",isSubHeader:!0}),e.jsx(We,{title:"ROI",tooltip:"ROI = (MetaSales + GoogleSales)/ Total Spent",isSubHeader:!0,isImportant:!0}),e.jsx(We,{title:"Spend",tooltip:"Meta Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(We,{title:"Sales",tooltip:"Meta Sales = Meta Spent * Meta ROAS",isSubHeader:!0}),e.jsx(We,{title:"ROAS",tooltip:"Meta ROAS",isSubHeader:!0,isImportant:!0}),e.jsx(We,{title:"Spend",tooltip:"Google Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(We,{title:"Sales",tooltip:"Google Sales = Google Spent * Google ROAS",isSubHeader:!0}),e.jsx(We,{title:"ROAS",tooltip:"Google ROAS",isSubHeader:!0,isImportant:!0})]})]}),e.jsx("tbody",{children:R.map(x=>{const F=`${x.year}-${x.month.toString().padStart(2,"0")}`,p=S.includes(F);return e.jsxs(es.Fragment,{children:[e.jsxs("tr",{className:`
                        ${p?"bg-blue-50/30":"bg-white hover:bg-slate-50/80"} 
                        cursor-pointer transition-colors 
                      `,onClick:()=>L(F),children:[e.jsx(Ae,{isSticky:!0,isExpanded:p,className:"w-10 px-2 py-2 sticky left-0",children:e.jsx("div",{className:`
                            w-6 h-6 rounded-full flex items-center justify-center
                            transition-all duration-300 transform
                            ${p?"rotate-180 bg-blue-500":"bg-blue-100 hover:bg-blue-200"}
                          `,children:e.jsx(Zs,{className:`w-4 h-4 ${p?"text-white":"text-blue-500"}`})})}),e.jsx(Ae,{isHeader:!0,isSticky:!0,isExpanded:p,className:"sticky left-[40px] px-3 py-2.5 whitespace-nowrap bg-slate-50/80 text-sm border-l-2 border-l-slate-300 ",children:Y(new Date(x.year,x.month-1),"MMM yyyy")}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 font-medium text-sm",isFirstInSection:!0,children:M(x.shopifySales)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,isImportant:!0,className:"px-3 py-2.5 text-sm",children:y(x.netROI)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",children:M(x.refundAmount)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 font-medium text-sm",children:M(x.totalSales)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,isImportant:!0,className:"px-3 py-2.5 text-sm",children:y(x.ROI)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:M(x.totalSpend)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",children:M(x.totalAdSales)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,isImportant:!0,className:"px-3 py-2.5 text-sm",children:y(x.grossROI)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:M(x.metaSpend)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",children:M(x.metaSales)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,isImportant:!0,className:"px-3 py-2.5 text-sm",children:y(x.metaROAS)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:M(x.googleSpend)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,className:"px-3 py-2.5 text-sm",children:M(x.googleSales)}),e.jsx(Ae,{isNumeric:!0,isExpanded:p,isImportant:!0,className:"px-3 py-2.5 text-sm",children:y(x.googleROAS)})]}),p&&x.dailyMetrics.map(c=>e.jsxs("tr",{className:"bg-slate-50/50 hover:bg-slate-100/50 transition-colors",children:[e.jsx(Ae,{isSticky:!0,className:"w-10 px-2 py-1.5 sticky left-0 bg-slate-50/50"}),e.jsx(Ae,{isSticky:!0,className:"sticky left-[40px] px-3 py-1.5 text-xs text-gray-600 bg-slate-50/80 border-l-2 border-l-slate-300 ",children:Y(new Date(c.date),"dd/MM/yyyy")}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:M(c.shopifySales)}),e.jsx(Ae,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:y(c.netROI)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:M(c.refundAmount)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:M(c.totalSales)}),e.jsx(Ae,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:y(c.ROI)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:M(c.totalSpend)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:M(c.adSales)}),e.jsx(Ae,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:y(c.grossROI)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:M(c.metaSpend)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:M(c.metaSales)}),e.jsx(Ae,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:y(c.metaROAS)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:M(c.googleSpend)}),e.jsx(Ae,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:M(c.googleSales)}),e.jsx(Ae,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:y(c.googleROAS)})]},c._id))]},F)})})]})})}),T=()=>t?e.jsx(Se,{isLoading:t}):o==="No metrics data available yet. Please try again later."?e.jsx(bc,{}):e.jsxs("div",{className:"flex-1 h-screen overflow-hidden bg-slate-100",children:[e.jsx(vs,{title:"Marketing Insights Tracker",Icon:Lt,showDatePicker:!0}),e.jsx(oe,{id:"metrics-table",className:`${u?"fixed inset-0 z-50 m-0 rounded-none":"m-6"} shadow-md`,children:e.jsxs(de,{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Key Performance Metrics"}),e.jsxs("div",{className:"flex flex-row gap-3 items-center",children:[e.jsx(qe,{width:20,height:20}),e.jsx(Ue,{width:20,height:20}),e.jsx(rr,{width:20,height:20})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[u&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(z,{onClick:g,size:"icon",variant:"outline",className:"bg-white",children:u?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})}),e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2 bg-white",children:[e.jsx(Go,{className:"h-4 w-4"}),"Export"]})]})]}),E()]})})]});return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[T(),e.jsx(fs,{})]}),e.jsx(As,{})]})},ia=n.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:se("w-full caption-bottom text-sm",s),...a})}));ia.displayName="Table";const ca=n.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:se("[&_tr]:border-b",s),...a}));ca.displayName="TableHeader";const da=n.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:se("[&_tr:last-child]:border-0",s),...a}));da.displayName="TableBody";const Nc=n.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:se("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));Nc.displayName="TableFooter";const it=n.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:se("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));it.displayName="TableRow";const as=n.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:se("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));as.displayName="TableHead";const Qe=n.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:se("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));Qe.displayName="TableCell";const wc=n.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:se("mt-4 text-sm text-muted-foreground",s),...a}));wc.displayName="TableCaption";const us=xo,hs=fo,is=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(cn,{ref:r,className:se("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx(lo,{asChild:!0,children:e.jsx(dn,{className:"h-4 w-4 opacity-50"})})]}));is.displayName=cn.displayName;const kr=n.forwardRef(({className:s,...a},t)=>e.jsx(mn,{ref:t,className:se("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(io,{className:"h-4 w-4"})}));kr.displayName=mn.displayName;const Ar=n.forwardRef(({className:s,...a},t)=>e.jsx(un,{ref:t,className:se("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(dn,{className:"h-4 w-4"})}));Ar.displayName=un.displayName;const cs=n.forwardRef(({className:s,children:a,position:t="popper",...r},o)=>e.jsx(co,{children:e.jsxs(hn,{ref:o,className:se("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...r,children:[e.jsx(kr,{}),e.jsx(mo,{className:se("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(Ar,{})]})}));cs.displayName=hn.displayName;const Cc=n.forwardRef(({className:s,...a},t)=>e.jsx(xn,{ref:t,className:se("px-2 py-1.5 text-sm font-semibold",s),...a}));Cc.displayName=xn.displayName;const Oe=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(fn,{ref:r,className:se("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(uo,{children:e.jsx(Zt,{className:"h-4 w-4"})})}),e.jsx(ho,{children:a})]}));Oe.displayName=fn.displayName;const Sc=n.forwardRef(({className:s,...a},t)=>e.jsx(gn,{ref:t,className:se("-mx-1 my-1 h-px bg-muted",s),...a}));Sc.displayName=gn.displayName;function kc(){const s=P(i=>i.brand.brands),[a,t]=n.useState([]),[r,o]=n.useState({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:Na(new Date)}),[l,u]=n.useState(null),[m,h]=n.useState(null),[d,f]=n.useState({}),[w,S]=n.useState(!1),C=Ke(),N=n.useCallback(async i=>{var A;try{return(await re.get(`${Te}/api/performance/metaMetrics/${i}`,{withCredentials:!0})).data}catch(G){return console.error("Error fetching Meta metrics data:",G),re.isAxiosError(G)&&((A=G.response)==null?void 0:A.status)===401&&(alert("Your session has expired. Please log in again."),C("/")),{success:!1,data:{spend:0,Revenue:0,purchase_roas:"0.00"}}}},[Te,C]),b=n.useCallback(async i=>{try{return(await re.get(`${Te}/api/performance/googleAdMetrics/${i}`,{withCredentials:!0})).data}catch(A){return console.error("Error fetching Google metrics data:",A),{success:!1,data:{spend:0,Revenue:0,purchase_roas:"0.00"}}}},[Te]),v=n.useCallback(async()=>{S(!0);try{const i={};await Promise.all(a.map(async A=>{const[G,O]=await Promise.all([N(A.brandId),b(A.brandId)]);i[A.brandId]={meta:G.success?G.data:{spend:0,Revenue:0,purchase_roas:"0.00"},google:O.success?O.data:{spend:0,Revenue:0,purchase_roas:"0.00"}}})),f(i)}catch(i){console.error("Error fetching metrics data:",i)}finally{S(!1)}},[a,N,b]);n.useEffect(()=>{a.length>0&&v()},[v,a]);const k=i=>{const{name:A,value:G}=i.target;o(O=>({...O,[A]:["brandId","name"].includes(A)?G:Number(G)}))},g=i=>{o(A=>({...A,source:i}))},I=async()=>{const i=s.find(A=>String(A._id)===String(r.brandId));if(i)try{const A={brandId:i._id,name:i.name,source:r.source,targetSales:r.targetSales,targetSpend:r.targetSpend,targetROAS:r.targetROAS,targetDate:r.targetDate},G=await re.post(`${Te}/api/performance/addTarget`,A,{withCredentials:!0});t(O=>[...O,G.data]),o({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:Na(new Date)})}catch(A){console.error("Error adding brand:",A)}else console.log("Brand not found")},L=i=>{const A=a.find(G=>G.brandId===i);A&&(u(i),h({...A,targetDate:new Date(A.targetDate)}))},M=async i=>{if(m)try{const A=await re.patch(`${Te}/api/performance/updateTarget/${i}`,m,{withCredentials:!0});t(G=>G.map(O=>O.brandId===i?{...O,...A.data}:O)),u(null),h(null),alert("Brand updated successfully!")}catch(A){console.error("Error saving brand edit:",A),alert("Failed to update brand")}},y=()=>{u(null),h(null)},R=async i=>{try{await re.delete(`${Te}/api/performance/deleteTarget/${i}`,{withCredentials:!0}),t(A=>A.filter(G=>G.brandId!==i)),console.log("Brand deleted successfully")}catch(A){console.error("Error deleting brand:",A)}},E=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-500"}),T=(i,A)=>{var K;const G=((K=d[i.brandId])==null?void 0:K[A])||{spend:0,Revenue:0,purchase_roas:"0.00"},O=G.spend||0,D=Number(G.Revenue)||0,j=Math.max(i.targetSales-D,0).toFixed(2),_=parseFloat(G.purchase_roas)||0,W=new Date;W.setHours(0,0,0,0);const Z=new Date(i.targetDate);Z.setHours(0,0,0,0);const Q=Math.max(Math.ceil((Z.getTime()-W.getTime())/(1e3*60*60*24)),0),U=Q>0?parseFloat(j)/Q:0;return{achievedSales:D,remainingSales:j,achievedSpend:O,achievedROAS:_,remainingDays:Q,requiredSalesPerDay:U}},x=a.map(i=>{const A=T(i,"meta"),G=T(i,"google");return{name:i.name,"Meta Achieved":A.achievedSales,"Meta Remaining":A.remainingSales,"Google Achieved":G.achievedSales,"Google Remaining":G.remainingSales}}),F=a.filter(i=>i.source==="Meta"),p=a.filter(i=>i.source==="Google");n.useEffect(()=>{(async()=>{try{const G=(await re.get(`${Te}/api/performance/brandTarget`,{withCredentials:!0})).data.map(O=>({...O,targetDate:new Date(O.targetDate)}));t(G)}catch(A){console.error("Error fetching brands:",A)}})()},[Te]);const c=(i,A,G)=>e.jsxs(oe,{className:"mb-4",children:[e.jsx(Cs,{children:e.jsxs(Hs,{children:[G," Performance Table"]})}),e.jsx(de,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ia,{children:[e.jsx(ca,{children:e.jsxs(it,{children:[e.jsx(as,{children:"Brand"}),e.jsx(as,{children:"Month"}),e.jsx(as,{children:"Target Spend"}),e.jsx(as,{children:"Target Sales"}),e.jsx(as,{children:"Target ROAS"}),e.jsx(as,{children:"Achieved Spend"}),e.jsx(as,{children:"Achieved Sales"}),e.jsx(as,{children:"Achieved ROAS"}),e.jsx(as,{children:"Remaining Sales"}),e.jsx(as,{children:"Remaining Days"}),e.jsx(as,{children:"Required Sales/Day"}),e.jsx(as,{children:"Actions"})]})}),e.jsx(da,{children:i.map(O=>{const{achievedSales:D,remainingSales:j,achievedSpend:_,achievedROAS:W,remainingDays:Z,requiredSalesPerDay:Q}=T(O,A),U=l===O.brandId;return e.jsxs(it,{children:[e.jsx(Qe,{className:"font-bold text-sm",children:O.name}),e.jsx(Qe,{children:U?e.jsxs($s,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(z,{variant:"outline",children:m!=null&&m.targetDate?Y(m.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(ks,{className:"w-auto p-0",children:e.jsx(St,{mode:"single",selected:m==null?void 0:m.targetDate,onSelect:K=>K&&h(J=>J?{...J,targetDate:K}:null),initialFocus:!0})})]}):Y(new Date(O.targetDate),"MMM yyyy")}),e.jsx(Qe,{children:U?e.jsx(Pe,{type:"number",value:m==null?void 0:m.targetSpend,onChange:K=>h(J=>J?{...J,targetSpend:Number(K.target.value)}:null)}):`${O.targetSpend.toLocaleString()}`}),e.jsx(Qe,{children:U?e.jsx(Pe,{type:"number",value:m==null?void 0:m.targetSales,onChange:K=>h(J=>J?{...J,targetSales:Number(K.target.value)}:null)}):`${O.targetSales.toLocaleString()}`}),e.jsx(Qe,{children:U?e.jsx(Pe,{type:"number",step:"0.01",value:m==null?void 0:m.targetROAS,onChange:K=>h(J=>J?{...J,targetROAS:Number(K.target.value)}:null)}):O.targetROAS.toFixed(2)}),e.jsx(Qe,{children:w?e.jsx(E,{}):`${_.toLocaleString("en-IN")}`}),e.jsx(Qe,{children:w?e.jsx(E,{}):`${D.toLocaleString("en-IN")}`}),e.jsx(Qe,{children:w?e.jsx(E,{}):W.toFixed(2)}),e.jsx(Qe,{children:new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(Number(j))}),e.jsx(Qe,{children:Z}),e.jsxs(Qe,{children:["",new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(Q)]}),e.jsx(Qe,{children:U?e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:()=>M(O.brandId),className:"mr-2",children:"Save"}),e.jsx(z,{onClick:y,variant:"outline",children:e.jsx(xs,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(z,{size:"sm",onClick:()=>L(O.brandId),children:e.jsx(Bo,{className:"h-2 w-2"})}),e.jsx(z,{size:"sm",onClick:()=>R(O.brandId),variant:"destructive",children:e.jsx(Pn,{className:"h-2 w-2"})})]})})]},O.brandId)})})]})})})]});return e.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Brands Performance Metrics"})})}),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs(oe,{className:"mb-4",children:[e.jsx(Cs,{children:e.jsx(Hs,{children:"Add New Brand Target"})}),e.jsxs(de,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(ns,{htmlFor:"brandName",children:"Brand Name"}),e.jsxs(us,{onValueChange:i=>{const A=s.find(G=>G._id===i);o(G=>({...G,brandId:i,name:(A==null?void 0:A.name)||""}))},children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select brand"})}),e.jsx(cs,{children:s.map(i=>e.jsx(Oe,{value:i._id,children:i.name},i._id))})]})]}),e.jsxs("div",{children:[e.jsx(ns,{htmlFor:"source",children:"Source"}),e.jsxs(us,{onValueChange:g,value:r.source,children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select source"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:"Meta",children:"Meta"}),e.jsx(Oe,{value:"Google",children:"Google"})]})]})]}),e.jsxs("div",{children:[e.jsx(ns,{htmlFor:"targetSales",children:"Target Sales"}),e.jsx(Pe,{id:"targetSales",name:"targetSales",type:"number",value:r.targetSales,onChange:k,placeholder:"Enter target sales"})]}),e.jsxs("div",{children:[e.jsx(ns,{htmlFor:"targetSpend",children:"Target Spend"}),e.jsx(Pe,{id:"targetSpend",name:"targetSpend",type:"number",value:r.targetSpend,onChange:k,placeholder:"Enter target spend"})]}),e.jsxs("div",{children:[e.jsx(ns,{htmlFor:"targetROAS",children:"Target ROAS"}),e.jsx(Pe,{id:"targetROAS",name:"targetROAS",type:"number",value:r.targetROAS,onChange:k,placeholder:"Enter target ROAS",step:"0.01"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(z,{onClick:I,className:"w-full",children:[e.jsx(at,{className:"mr-2 h-4 w-4"})," Add Brand Target"]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ns,{children:"Target Date"}),e.jsxs($s,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(z,{variant:"outline",className:se("w-full justify-start text-left font-normal mt-2",!r.targetDate&&"text-muted-foreground"),children:r.targetDate?Y(r.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(ks,{className:"w-auto p-0",children:e.jsx(St,{mode:"single",selected:r.targetDate,onSelect:i=>i&&o(A=>({...A,targetDate:i})),initialFocus:!0})})]})]})]})]}),c(F,"meta","Meta"),c(p,"google","Google"),e.jsxs(oe,{children:[e.jsx(Cs,{children:e.jsx(Hs,{children:"Sales Progress"})}),e.jsx(de,{children:e.jsx(Yn,{width:"100%",height:300,children:e.jsxs(yl,{data:x,children:[e.jsx(Kn,{dataKey:"name"}),e.jsx(Qn,{}),e.jsx(Nl,{formatter:i=>`${Number(i).toLocaleString()}`}),e.jsx(pt,{dataKey:"Meta Achieved",stackId:"meta",fill:"#4ade80"}),e.jsx(pt,{dataKey:"Meta Remaining",stackId:"meta",fill:"#f87171"}),e.jsx(pt,{dataKey:"Google Achieved",stackId:"google",fill:"#60a5fa"}),e.jsx(pt,{dataKey:"Google Remaining",stackId:"google",fill:"#fbbf24"})]})})})]})]})]})}const Ac=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(kc,{})})]});function Fc(){var U,K,J,H,B,te,me;const s="https://parallels.messold.com",{brandId:a}=pe(),[t,r]=n.useState([{id:"products",label:"Products",apiEndpoint:`${s}/api/segment/productMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"categories",label:"Categories",apiEndpoint:`${s}/api/segment/categoryMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"brands",label:"Brands",apiEndpoint:`${s}/api/segment/brandMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"productTypes",label:"Product types",apiEndpoint:`${s}/api/segment/typeMetrics/${a}`,columns:[],data:[],lastUpdated:null}]),[o,l]=n.useState(t[0].id),[u,m]=n.useState(1),[h,d]=n.useState(new Set),[f,w]=n.useState(!1),[S,C]=n.useState(!1),N=100,[b,v]=n.useState({}),k=n.useRef({}),g=5*60*1e3,I=P($=>$.date.from),L=P($=>$.date.to),M=n.useMemo(()=>({from:I,to:L}),[I,L]),y=M!=null&&M.from?Y(M.from,"yyyy-MM-dd"):"",R=M!=null&&M.to?Y(M.to,"yyyy-MM-dd"):"",[E,T]=n.useState(null),[x,F]=n.useState("asc"),p=$=>{l($),m(1),d(new Set)},c=n.useCallback(async($,ee={},X=!1)=>{if(f)return;w(!0);const ae=t.find(Ge=>Ge.id===$);if(!ae){console.warn(`Tab not found for ID: ${$}`),w(!1);return}const he={...ee,...y&&{startDate:y},...R&&{endDate:R}},Ne=`${$}-${y||"default"}-${R||"default"}`,Fe=k.current[Ne],Ee=Date.now();if(!X&&$==="products"&&delete k.current[Ne],!X&&Fe&&Ee-Fe.timestamp<g){r(Ge=>Ge.map(rs=>rs.id===$?{...rs,data:Fe.data,lastUpdated:Fe.timestamp}:rs)),w(!1);return}try{const Ge=await re.post(ae.apiEndpoint,he,{withCredentials:!0});if(Ge.data.success){const os=Ge.data[`${$}Data`]||[];console.log("New Data for Tab:",$,os);const Es=Object.keys(os[0]||{}).map(Ns=>({id:Ns,header:Ns.charAt(0).toUpperCase()+Ns.slice(1),accessorKey:Ns,cell:gs=>Ns==="issues"&&Array.isArray(gs)?gs.length>0?gs[0].description:"No issues":String(gs)}));console.log("Columns for Tab:",Es),r(Ns=>Ns.map(gs=>gs.id===$?{...gs,columns:Es,data:os,lastUpdated:Ee}:gs)),k.current[Ne]={data:os,timestamp:Ee}}else console.error(`Failed to fetch data for ${$}`)}catch(Ge){console.error(`Error fetching data for ${$}:`,Ge)}finally{w(!1)}},[t,f,k,y,R]);n.useEffect(()=>{const $={...b,...y&&{startDate:y},...R&&{endDate:R}};c(o,S?$:{},!!S)},[o,M,S,b]);const i=($,ee)=>{const X={brands:"Brand",productTypes:"Type",categories:"name",products:"status"},ae={brands:"brands",productTypes:"productType",categories:"categoryName",products:"status"},he=X[$],Ne=ae[$];if(he&&Ne){const Fe=ee[he];if(Fe){const Ee={[Ne]:Fe};$==="categories"&&ee.level&&(Ee.categoryLevel=ee.level),v(Ee),C(!0),l("products")}else console.warn(`No value found for column "${he}" in row`,ee)}else console.warn(`No column or body key mapping found for tab: ${$}`)},A=$=>{d(ee=>{const X=new Set(ee);return X.has($)?X.delete($):X.add($),X})},G=($,ee=0,X="")=>{const ae=X?`${X}.${$.name}`:$.name,he=h.has(ae);return e.jsxs(es.Fragment,{children:[e.jsxs("tr",{className:`${he?"bg-gray-100":"bg-white"}`,children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm flex items-center",children:e.jsxs("div",{style:{marginLeft:`${ee*20}px`},onClick:()=>A(ae),className:"flex items-center cursor-pointer",children:[$.subcategories.length>0&&e.jsx("button",{className:"mr-2",children:he?e.jsx(Zs,{className:"h-4 w-4"}):e.jsx(Ss,{className:"h-4 w-4"})}),$.name]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm cursor-pointer text-blue-500 underline",onClick:()=>i(o,$),children:$.metrics.products}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.totalCost}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.ROAS}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.conversions}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.ConversionValue}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.ConversionRate}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.totalClicks}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.ctr}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:$.metrics.AvgCPC})]}),he&&$.subcategories.map(Ne=>G(Ne,ee+1,ae))]},ae)},O=$=>{E===$?F(ee=>ee==="asc"?"desc":"asc"):(T($),F("asc"))},D=()=>{const $=t.find(he=>he.id===o);if(!$||$.id==="categories")return{columns:[],data:[]};let ee=$.data;E&&(ee=[...ee].sort((he,Ne)=>{const Fe=he[E],Ee=Ne[E];if(typeof Fe=="number"&&typeof Ee=="number")return x==="asc"?Fe-Ee:Ee-Fe;const Ge=String(Fe||"").toLowerCase(),rs=String(Ee||"").toLowerCase();return Ge<rs?x==="asc"?-1:1:Ge>rs?x==="asc"?1:-1:0}));const X=(u-1)*N,ae=X+N;return{columns:$.columns,data:ee.slice(X,ae)}},{columns:j,data:_}=D(),W=Math.ceil((((U=t.find($=>$.id===o))==null?void 0:U.data.length)||0)/N),Z=[{id:"name",header:"Name"},{id:"products",header:"Products"},{id:"totalCost",header:"Cost"},{id:"ROAS",header:"ROAS"},{id:"conversions",header:"Conversions"},{id:"ConversionValue",header:"Conv. Value"},{id:"ConversionRate",header:"Conv. Rate"},{id:"totalClicks",header:"Clicks"},{id:"ctr",header:"CTR"},{id:"AvgCPC",header:"Avg CPC"}];function Q(){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map(($,ee)=>e.jsx("th",{className:"px-4 py-2 border-b",children:e.jsx(He,{className:`h-4 ${$}`})},ee))})}),e.jsx("tbody",{children:Array.from({length:8}).map(($,ee)=>e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map((X,ae)=>e.jsx("td",{className:"px-4 py-2 border-b",children:e.jsx(He,{className:`h-4 ${X}`})},ae))},ee))})]})})}return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(Ue,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Product Insights"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2 mb-2",children:[e.jsx("div",{className:"flex space-x-2",role:"tablist",children:t.map($=>e.jsxs(z,{variant:o===$.id?"default":"ghost",onClick:()=>p($.id),className:"relative",children:[$.id==="products"&&e.jsx(_o,{className:"w-4 h-4 mr-2"}),$.id==="categories"&&e.jsx(On,{className:"w-4 h-4 mr-2"}),$.id==="brands"&&e.jsx(Rn,{className:"w-4 h-4 mr-2"}),$.id==="productTypes"&&e.jsx(Uo,{className:"w-4 h-4 mr-2"}),$.label,o===$.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]},$.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{}),e.jsx(z,{variant:"outline",size:"icon",children:e.jsx(Ms,{className:`h-4 w-4 ${S?"text-blue-600":"text-gray-600"}`})}),e.jsx(nn,{children:e.jsxs(rn,{children:[e.jsx(on,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",onClick:()=>c(o,{},!1),children:e.jsx(je,{className:`h-4 w-4 ${f?"animate-spin":""}`})})}),((K=t.find($=>$.id===o))==null?void 0:K.lastUpdated)&&e.jsx(ln,{children:e.jsxs("p",{children:["Last updated: ",new Date(((J=t.find($=>$.id===o))==null?void 0:J.lastUpdated)||0).toLocaleString()]})})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[S&&e.jsxs("div",{className:"flex items-center gap-2 w-fit p-2 bg-blue-50 rounded-full",children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:Object.entries(b).map(([$,ee])=>`${$}: ${ee}`).join(", ")}),e.jsx(z,{variant:"ghost",size:"sm",onClick:()=>{C(!1),v({}),l("products"),k.current.products=null,c("products",{},!1)},className:"text-blue-700 hover:text-blue-800 hover:bg-blue-100 p-1 h-auto",children:e.jsx(xs,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[350px] overflow-auto",children:f?e.jsx(Q,{}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A]",children:e.jsx("tr",{children:(o==="categories"?Z:j).map($=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[150px] cursor-pointer",onClick:()=>O($.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[$.header,E===$.id?x==="asc"?e.jsx(Et,{className:"h-4 w-4"}):e.jsx(Pt,{className:"h-4 w-4"}):e.jsx(Dn,{className:"h-4 w-4"})]})},$.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[o==="categories"?(H=t.find($=>$.id==="categories"))==null?void 0:H.data.map($=>G($)):_.map(($,ee)=>e.jsx("tr",{className:"hover:bg-gray-50",children:j.map(X=>{const ae=X.cell($[X.accessorKey]),he=X.id==="issues",Ne=X.id==="Products",Fe=X.id==="status",Ee=typeof ae=="string"&&ae.trim().toLowerCase()==="no issues",Ge=os=>{switch(os.trim().toUpperCase()){case"UNSPECIFIED":return"bg-gray-100 text-gray-800";case"UNKNOWN":return"bg-yellow-100 text-yellow-800";case"NOT_ELIGIBLE":return"bg-red-100 text-red-800";case"ELIGIBLE_LIMITED":return"bg-orange-100 text-orange-800";case"ELIGIBLE":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-700"}},rs=()=>{if(he)return e.jsxs("div",{className:`flex items-center ${Ee?"text-green-600":"text-red-600"}`,children:[Ee?e.jsx(lt,{className:"w-4 h-4 mr-2"}):e.jsx(Xt,{className:"w-4 h-4 mr-2"}),ae]});if(Fe){const os=ae?String(ae):"",Es=Ge(os);return e.jsx("div",{className:`px-2 py-1.5 rounded-full text-xs font-medium w-full ${Es} cursor-pointer`,onClick:()=>i(o,$),children:os})}return X.cell?X.cell(ae):ae};return e.jsx("td",{className:`px-4 py-2.5 text-sm whitespace-nowrap min-w-[150px] ${Ne?"cursor-pointer text-blue-600 hover:text-blue-800":""}`,onClick:()=>Ne&&i(o,$),children:rs()},X.id)})},ee)),(o==="categories"?((B=t.find($=>$.id==="categories"))==null?void 0:B.data.length)===0:_.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:(o==="categories"?Z:j).length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(u-1)*N+1," to ",Math.min(u*N,((te=t.find($=>$.id===o))==null?void 0:te.data.length)||0)," of ",((me=t.find($=>$.id===o))==null?void 0:me.data.length)||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>m($=>Math.max($-1,1)),disabled:u===1,children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",u," of ",W]}),e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>m($=>Math.min($+1,W)),disabled:u===W,children:["Next",e.jsx(Ss,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})]})}const ma=()=>e.jsxs(ia,{className:"text-center min-w-full",children:[e.jsx(ca,{className:"bg-gray-200 sticky top-0 z-10",children:e.jsx(it,{children:Array(8).fill(0).map((s,a)=>e.jsx(Qe,{className:"font-bold px-4 text-black min-w-[150px]",children:e.jsx(He,{className:"h-6 w-full"})},a))})}),e.jsx(da,{children:Array(10).fill(0).map((s,a)=>e.jsx(it,{children:Array(8).fill(0).map((t,r)=>e.jsx(Qe,{className:"px-4 py-2 max-w-[200px]",children:e.jsx(He,{className:"h-6 w-full"})},r))},a))})]});function Ic(){var J;const s="https://parallels.messold.com",{brandId:a}=pe(),[t,r]=n.useState([]),[o,l]=n.useState(!0),[u,m]=n.useState(1),[h,d]=n.useState(!0),[f,w]=n.useState(0),[S,C]=n.useState(0),[N,b]=n.useState([]),[v,k]=n.useState("all"),[g,I]=n.useState([]),[L,M]=n.useState("all"),[y,R]=n.useState("all"),E=P(H=>H.date.from),T=P(H=>H.date.to),x=n.useMemo(()=>({from:E,to:T}),[E,T]),F=x!=null&&x.from?Y(x.from,"yyyy-MM-dd"):"",p=x!=null&&x.to?Y(x.to,"yyyy-MM-dd"):"",c=100,i=[{id:"searchTerm",header:"Search Term",icon:e.jsx(Js,{className:"w-4 h-4"})},{id:"matchType",header:"Match Type",icon:e.jsx(Vo,{className:"w-4 h-4"})},{id:"status",header:"Status",icon:e.jsx(Ms,{className:"w-4 h-4"})},{id:"campaignName",header:"Campaign Name",icon:e.jsx(Ho,{className:"w-4 h-4"})},{id:"adGroupName",header:"Ad Group",icon:e.jsx(zn,{className:"w-4 h-4"})},{id:"cost",header:"Cost",icon:e.jsx(Gn,{className:"w-4 h-4"})},{id:"conversions",header:"Conversions",icon:e.jsx(bs,{className:"w-4 h-4"})},{id:"conversionsValue",header:"Conv. Value",icon:e.jsx(bt,{className:"w-4 h-4"})},{id:"conversionsRate",header:"Conv. Rate",icon:e.jsx(ja,{className:"w-4 h-4"})},{id:"clicks",header:"Clicks",icon:e.jsx(qo,{className:"w-4 h-4"})},{id:"ctr",header:"CTR",icon:e.jsx(ja,{className:"w-4 h-4"})},{id:"avg_cpc",header:"Avg. CPC",icon:e.jsx(Wo,{className:"w-4 h-4"})}],[A,G]=n.useState(null),[O,D]=n.useState("asc"),j=H=>{A===H?D(B=>B==="asc"?"desc":"asc"):(G(H),D("asc"))},_=n.useMemo(()=>A?[...t].sort((H,B)=>{const te=H[A],me=B[A];if(typeof te=="number"&&typeof me=="number")return O==="asc"?te-me:me-te;const $=String(te).toLowerCase(),ee=String(me).toLowerCase();return $<ee?O==="asc"?-1:1:$>ee?O==="asc"?1:-1:0}):t,[t,A,O]),W=n.useCallback(async()=>{l(!0);try{const H={limit:c,page:u,startDate:F,endDate:p,...v&&v!=="all"&&{campaign:v},...L&&L!=="all"&&{adGroup:L},...y&&y!=="all"&&{status:y}},{data:B}=await re.post(`${s}/api/segment/searchTermMetrics/${a}`,H,{withCredentials:!0});B.success?(r(B.data),w(B.totalRecords),C(B.totalPages),d(u*c<B.totalRecords),b(B.campaignAdGroupPairs),I(B.statusOptions)):console.error("Failed to fetch search term metrics:",B.message)}catch(H){console.error("Error fetching search term metrics:",H)}finally{l(!1)}},[s,a,u,c,v,L,y,F,p]);n.useEffect(()=>{W();const H=setInterval(W,3e5);return()=>clearInterval(H)},[W]);const Z=H=>{k(H),M("all"),m(1)},Q=H=>{M(H),m(1)},U=H=>{R(H),m(1)},K=v!=="all"?((J=N==null?void 0:N.find(H=>H.campaignName===v))==null?void 0:J.adGroups)||[]:[];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(Ue,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Search Term Insights"})]}),e.jsx("div",{className:"bg-white rounded-xl overflow-hidden border border-gray-200 shadow-md",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsxs($s,{children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(z,{variant:"outline",className:"bg-white border-gray-300 hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Filter"]})}),e.jsx(ks,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Status"}),e.jsxs(us,{onValueChange:U,value:y,children:[e.jsx(is,{className:"w-full",children:e.jsx(hs,{placeholder:"Select Status"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:"all",children:"All Status"}),g.map(H=>e.jsx(Oe,{value:H,children:H},H))]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Campaign"}),e.jsxs(us,{onValueChange:Z,value:v,children:[e.jsx(is,{className:"w-full",children:e.jsx(hs,{placeholder:"Select Campaign"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:"all",children:"All Campaigns"}),N.map(H=>e.jsx(Oe,{value:H.campaignName,children:H.campaignName},H.campaignName))]})]})]}),v!=="all"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ad Group"}),e.jsxs(us,{disabled:v==="all",onValueChange:Q,value:L,children:[e.jsx(is,{className:"w-full",children:e.jsx(hs,{placeholder:"Select Ad Group"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:"all",children:"All Ad Groups"}),K.map(H=>e.jsx(Oe,{value:H,children:H},H))]})]})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ge,{}),e.jsxs(z,{variant:"outline",className:"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100",onClick:W,children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[380px] overflow-auto rounded-lg",children:o?e.jsx(ma,{}):e.jsxs("table",{className:"w-full text-center",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A] rounded-t-lg",children:e.jsx("tr",{children:i.map(H=>e.jsx("th",{className:"px-4 py-3 text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[200px] cursor-pointer",onClick:()=>j(H.id),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[H.icon,H.header,A===H.id?O==="asc"?e.jsx(Et,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(Pt,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(Dn,{className:"ml-1 w-4 h-6 text-gray-300"})]})},H.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[_.map((H,B)=>e.jsx("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:i.map(te=>{const me=H[te.id],$=te.id==="status",ee=te.id==="searchTerm",X=()=>{if($){const ae=me?String(me):"",Ne=(Fe=>{switch(Fe.trim().toUpperCase()){case"ADDED":return"bg-green-100 text-green-800";case"NONE":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(ae);return e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ne}`,children:ae})}if(ee){const ae=me?String(me):"",he=H.performance,Ne=he==="Best Performing Keyword";return e.jsxs("div",{className:"px-2 py-1 rounded-full font-medium flex flex-col items-center",children:[e.jsx("span",{className:`text-xs ${Ne?"text-green-600":"text-red-600"}`,children:he}),e.jsx("span",{className:"text-sm mt-1",children:ae})]})}return me};return e.jsx("td",{className:"px-4 py-2.5 text-sm min-w-[200px]",children:X()},te.id)})},B)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:i.length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(u-1)*c+1," to"," ",Math.min(u*c,f||0)," of"," ",f||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>m(H=>Math.max(H-1,1)),disabled:u===1,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:[e.jsx(Xs,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",u," of ",S]}),e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>m(H=>H+1),disabled:!h,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:["Next",e.jsx(Ss,{className:"h-4 w-4 ml-1"})]})]})]})]})]})})]})}function Tc(){const{brandId:s}=pe();return s?e.jsxs("div",{className:"bg-gray-100 min-h-screen overflow-hidden",children:[e.jsx("nav",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Segment Dashboard"}),e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})})]})}),e.jsxs("div",{className:"flex flex-col p-6 gap-6 overflow-auto",children:[e.jsx(Fc,{}),e.jsx(Ic,{})]})]}):(console.error("Brand ID is not defined"),e.jsx("div",{children:"Error: Brand ID is missing"}))}const Mc=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(Tc,{})})]}),$c=()=>{const s=Ke(),{toast:a}=Ot(),t=fe(),r="https://parallels.messold.com";return n.useEffect(()=>{(async()=>{try{const l=new URLSearchParams(window.location.search),u=l.get("token"),m=l.get("fbToken"),h=l.get("googleadRefreshToken"),d=l.get("googleanalyticsRefreshToken"),f=l.get("zohoToken"),w=l.get("userId"),S=l.get("shopify_token"),C=async(N,b,v)=>{var k,g;try{if((await re.put(`${r}${N}/${v}`,{},{params:{[v]:b},withCredentials:!0})).data.success){if(console.log(`${v} token updated successfully`),t(pr()),v==="zohoToken")console.log("Zoho token updated, redirecting to /profile"),s("/profile");else{const L=l.get("source")||"/dashboard";let M="";switch(v){case"googleadRefreshToken":M="googleAds";break;case"googleanalyticsRefreshToken":M="googleAnalytics";break;case"fbToken":M="facebook";break}return a({title:"Success",description:`${v} token updated successfully.`,variant:"default"}),s(M?`${L}?openModal=${M}`:L),!0}return!0}else return console.error(`Failed to update ${v} token`),a({title:"Update Failed",description:`Unable to update ${v} token.`,variant:"destructive"}),s("/dashboard"),!1}catch(I){return console.error(`Error updating ${v} token:`,I),a({title:"Update Failed",description:((g=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:g.message)||`Unable to update ${v} token.`,variant:"destructive"}),s("/"),!1}};if(u){console.log("Token found, proceeding with login");const N=await re.post(`${r}/api/auth/login/oauth?auth_token=${u}`,{email:null,password:null});if(N.data.success){console.log("Login successful");const b=N.data.user;t(rt(b)),!b.brands||b.brands.length===0?(console.log("No brands found, redirecting to /first-time-brand-setup"),s("/first-time-brand-setup")):(console.log("Brands found, redirecting to /dashboard"),s("/dashboard"));return}else{console.log("Login failed, redirecting to /"),a({title:"Login Failed",description:"Unable to authenticate with Google.",variant:"destructive"}),s("/");return}}if(m){await C("/api/auth/updateTokens",m,"fbToken");return}if(h){await C("/api/auth/updateTokens",h,"googleadRefreshToken");return}if(d){await C("/api/auth/updateTokens",d,"googleanalyticsRefreshToken");return}if(f){await C("/api/auth/updateTokens/zoho",f,"zohoToken");return}if(w&&S){console.log("Token found, proceeding with user saving");const N=await re.get(`${r}/api/users/getuser/${w}?token=${S}`);if(N.data.success){const b=N.data.user,v=N.data.brands;console.log("User brands:",b.brands),console.log("Brands data:",v),t(rt(b)),t(ta(v)),t(Nt(v[0]._id)),!b.brands||b.brands.length===0?(console.log("No brands found, redirecting to /brand-setup"),s("/brand-setup")):(console.log("Brands found, redirecting to /dashboard"),s("/dashboard"));return}else{console.log("Login failed, redirecting to /login"),a({title:"Login Failed",description:"Unable to authenticate with Google.",variant:"destructive"}),s("/login");return}}console.log("No token present, redirecting to /login"),s("/login")}catch(l){console.error("Error during OAuth callback:",l),a({title:"Error",description:"An error occurred while handling the login callback.",variant:"destructive"}),s("/login")}})()},[s,rt,a,r]),null},Ys=jo,Ks=bo,Lc=n.forwardRef(({className:s,inset:a,children:t,...r},o)=>e.jsxs(pn,{ref:o,className:se("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...r,children:[t,e.jsx(en,{className:"ml-auto"})]}));Lc.displayName=pn.displayName;const Ec=n.forwardRef(({className:s,...a},t)=>e.jsx(jn,{ref:t,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Ec.displayName=jn.displayName;const Bs=n.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(go,{children:e.jsx(bn,{ref:r,sideOffset:a,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));Bs.displayName=bn.displayName;const ps=n.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(vn,{ref:r,className:se("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",a&&"pl-8",s),...t}));ps.displayName=vn.displayName;const Pc=n.forwardRef(({className:s,children:a,checked:t,...r},o)=>e.jsxs(yn,{ref:o,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Nn,{children:e.jsx(Zt,{className:"h-4 w-4"})})}),a]}));Pc.displayName=yn.displayName;const Oc=n.forwardRef(({className:s,children:a,...t},r)=>e.jsxs(wn,{ref:r,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Nn,{children:e.jsx(po,{className:"h-2 w-2 fill-current"})})}),a]}));Oc.displayName=wn.displayName;const Rc=n.forwardRef(({className:s,inset:a,...t},r)=>e.jsx(Cn,{ref:r,className:se("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));Rc.displayName=Cn.displayName;const wt=n.forwardRef(({className:s,...a},t)=>e.jsx(Sn,{ref:t,className:se("-mx-1 my-1 h-px bg-muted",s),...a}));wt.displayName=Sn.displayName;function Fr({columns:s,onFiltersChange:a,filters:t,setFilters:r}){const[o,l]=n.useState(""),[u,m]=n.useState(">"),[h,d]=n.useState("");n.useEffect(()=>{a(t)},[t,a]);const f=()=>{o&&h&&(r([...t,{column:o,operator:u,value:h}]),l(""),d(""))};return e.jsx("div",{children:e.jsxs(Ys,{children:[e.jsx(Ks,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",children:e.jsx(Ms,{className:"h-4 w-4"})})}),e.jsx(Bs,{className:"w-80 p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(us,{value:o,onValueChange:w=>{l(w)},children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select column"})}),e.jsx(cs,{children:s.map(w=>e.jsx(Oe,{value:w,children:w},w))})]}),e.jsxs(us,{value:u,onValueChange:w=>m(w),children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select operator"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:">",children:"Greater than"}),e.jsx(Oe,{value:"<",children:"Less than"}),e.jsx(Oe,{value:"=",children:"Equal to"})]})]}),e.jsx(Pe,{type:"text",placeholder:"Enter filter value",value:h,onChange:w=>d(w.target.value)}),e.jsx(z,{onClick:f,children:"Add Filter"})]})})]})})}const Ea=(s,a)=>s>a?"bg-green-100 text-green-800":s<a?"bg-red-50 text-red-800":(Math.abs(s-a)<1e-4,"bg-yellow-100 text-yellow-700"),Dc=({columns:s=[],data:a=[],isFullScreen:t})=>{const[r,o]=n.useState(null),[l,u]=n.useState("asc"),[m,h]=n.useState([]),[d,f]=n.useState(1),[w,S]=n.useState([]),[C,N]=n.useState(s),[b,v]=n.useState(null),k=30,g=9,I=t?100:150,L=n.useRef(null),M=n.useRef(null),y=n.useRef([]),R=["Add To Cart Rate","Checkout Rate","Purchase Rate","Sessions"];n.useEffect(()=>{N(s)},[s]);const E=(U,K)=>{v(K),U.dataTransfer.effectAllowed="move"},T=U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},x=(U,K)=>{if(U.preventDefault(),!b||b===K)return;const J=[...C],H=J.indexOf(b),B=J.indexOf(K);J.splice(H,1),J.splice(B,0,b),N(J),v(null)},F=U=>typeof U=="number"?U:U&&parseFloat(U.replace("%","").trim())||0;n.useEffect(()=>{if(M.current){const U=M.current.clientWidth,K=s.length;let J;if(t){const H=Math.max(I,Math.floor(U/K));J=s.map(()=>H)}else J=s.map((H,B)=>B===0?160:150);h(J),y.current=J}},[s.length,t]);const p=n.useMemo(()=>{const U={};return R.forEach(K=>{const J=a.filter(B=>B[K]!==void 0&&!isNaN(F(B[K]||"0"))),H=J.length>0?J.reduce((B,te)=>B+F(te[K]||"0"),0)/J.length:0;U[K]=K==="Sessions"?Math.round(H):parseFloat(H.toFixed(2))}),U},[a]),c=n.useMemo(()=>a.map(U=>({...U,Sessions:Number((U==null?void 0:U.Sessions)||0),"Add To Cart Rate":F((U==null?void 0:U["Add To Cart Rate"])||"0"),"Checkout Rate":F((U==null?void 0:U["Checkout Rate"])||"0"),"Purchase Rate":F((U==null?void 0:U["Purchase Rate"])||"0")})),[a]),i=n.useMemo(()=>r?[...c].sort((U,K)=>{const J=U[r],H=K[r];if(r==="Date"){const me=X=>{const[ae,he,Ne]=X.split("-");return new Date(`${Ne}-${he}-${ae}`)},$=me(J),ee=me(H);return l==="asc"?$.getTime()-ee.getTime():ee.getTime()-$.getTime()}const B=typeof J=="number"?J:parseFloat((J||"0").toString().replace("%","").trim()),te=typeof H=="number"?H:parseFloat((H||"0").toString().replace("%","").trim());return B<te?l==="asc"?-1:1:B>te?l==="asc"?1:-1:0}):c,[c,r,l]),A=U=>["Date"].includes(U),G=U=>{A(U)&&(r===U?u(l==="asc"?"desc":"asc"):(o(U),u("asc")))};n.useEffect(()=>{t&&S(i.slice(0,k))},[t,i,k]);const O=()=>{if(t&&w.length<i.length){const U=i.slice(w.length,w.length+k);S(K=>[...K,...U])}},D=U=>{const K=U.currentTarget;K.scrollHeight-K.scrollTop<=K.clientHeight+100&&O()},j=n.useMemo(()=>t?w:i.slice((d-1)*g,d*g),[t,w,i,d,g]),_=Math.ceil(i.length/g),W=U=>{const K=Math.max(1,Math.min(U,_));f(K)},Z={"Add To Cart":"Add To Cart Rate",Checkouts:"Checkout Rate",Purchases:"Purchase Rate"},Q=(U,K)=>{var H;const J=R.includes(U);return e.jsx("th",{className:`
          relative font-bold p-1 text-gray-800 text-sm border-b-2
          capitalize border-r border-gray-300
          ${A(U)?"cursor-pointer":""}
          ${K===0&&!t?"sticky left-0 z-30 bg-gray-100":""}
          ${b===U?"opacity-50":""}
          hover:bg-gray-200 transition-colors duration-200
        `,style:{width:K===0?"180px":`${m[K]}px`},draggable:!0,onDragStart:B=>E(B,U),onDragOver:T,onDrop:B=>x(B,U),children:e.jsxs("div",{onClick:()=>G(U),className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Un,{className:"w-4 h-4 text-gray-400 cursor-grab"}),e.jsx("span",{children:U}),A(U)&&e.jsx("span",{className:"ml-2",children:r===U?l==="asc"?e.jsx(Et,{className:"w-4 h-4 text-blue-600"}):e.jsx(Pt,{className:"w-4 h-4 text-blue-600"}):""})]}),J&&p[U]!==void 0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["avg: ",U==="Sessions"?Math.round(p[U]):(H=p[U])==null?void 0:H.toFixed(2),U!=="Sessions"?"%":""]})]})},U)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:M,className:"rounded-md overflow-x-auto relative border",style:{width:"100%",maxHeight:t?"calc(100vh - 105px)":"calc(100vh - 200px)",overflowX:t?"hidden":"auto"},onScroll:t?D:void 0,children:e.jsxs("table",{ref:L,className:"w-full text-center shadow-lg rounded-lg border border-gray-200",style:{tableLayout:"fixed",width:t?"100%":"auto",borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsx("tr",{children:C.map((U,K)=>Q(U,K))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map((U,K)=>e.jsx("tr",{className:`${K%2===0?"bg-gray-50":"bg-white"} hover:bg-gray-100 transition-colors duration-200`,children:C.map((J,H)=>{const B=U[J],te=R.includes(J),me=J in Z;let $="text-gray-800";if(te)$=Ea(B,p[J]);else if(me){const ee=Z[J],X=U[ee];$=Ea(X,p[ee])}return e.jsx("td",{className:`p-3 text-sm font-normal border-r border-gray-300 ${$} ${H===0&&!t?"sticky left-0 z-20 bg-inherit":""}`,style:{width:H===0?"150px":`${m[H]}px`},children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:J.includes("Rate")?`${B.toFixed(2)}%`:B})},`${K}-${J}`)})},K))})]})}),!t&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(d-1)*g+1," to ",Math.min(d*g,i.length)," of ",i.length," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>W(1),disabled:d===1,children:e.jsx(Bn,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>W(d-1),disabled:d===1,children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",d," of ",_]}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>W(d+1),disabled:d===_,children:e.jsx(Ss,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>W(_),disabled:d===_,children:e.jsx(_n,{className:"h-4 w-4"})})]})]})]})},Ir=es.memo(Dc),zc=Ja,Gc=Xa,Bc=Za,Tr=n.forwardRef(({className:s,...a},t)=>e.jsx(At,{className:se("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));Tr.displayName=At.displayName;const _c=ct("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Mr=n.forwardRef(({side:s="right",className:a,children:t,...r},o)=>e.jsxs(Bc,{children:[e.jsx(Tr,{}),e.jsxs(Ft,{ref:o,className:se(_c({side:s}),a),...r,children:[e.jsxs(Qa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}));Mr.displayName=Ft.displayName;const $r=({className:s,...a})=>e.jsx("div",{className:se("flex flex-col space-y-2 text-center sm:text-left",s),...a});$r.displayName="SheetHeader";const Lr=n.forwardRef(({className:s,...a},t)=>e.jsx(It,{ref:t,className:se("text-lg font-semibold text-foreground",s),...a}));Lr.displayName=It.displayName;const Er=n.forwardRef(({className:s,...a},t)=>e.jsx(Tt,{ref:t,className:se("text-sm text-muted-foreground",s),...a}));Er.displayName=Tt.displayName;const Gt=({visibleColumns:s,columnOrder:a,frozenColumns:t=[],onVisibilityChange:r,onOrderChange:o,onFrozenChange:l})=>{const[u,m]=n.useState(""),[h,d]=n.useState(null),[f,w]=n.useState(null),S=a.filter(g=>g.toLowerCase().includes(u.toLowerCase())),C=g=>{d(g)},N=(g,I)=>{g.preventDefault(),I!==h&&w(I)},b=g=>{if(!h||h===g)return;const I=[...a],L=I.indexOf(h),M=I.indexOf(g);I.splice(L,1),I.splice(M,0,h),o(I),d(null),w(null)},v=g=>{const I=s.includes(g)?s.filter(L=>L!==g):[...s,g];r(I)},k=g=>{if(!l||g==="Campaign")return;const I=t.includes(g)?t.filter(L=>L!==g):[...t,g];l(I)};return e.jsxs(zc,{children:[e.jsx(Gc,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"ml-2",children:[e.jsx(Yo,{className:"w-4 h-4 mr-2"}),"Manage Columns"]})}),e.jsxs(Mr,{className:"w-[400px] sm:w-[540px]",children:[e.jsxs($r,{children:[e.jsx(Lr,{children:"Column Management"}),e.jsx(Er,{children:"Select columns to display, drag to reorder, and pin columns to freeze them"})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-1",children:[e.jsx(Js,{className:"w-4 h-4 text-slate-400"}),e.jsx(Pe,{placeholder:"Search columns...",value:u,onChange:g=>m(g.target.value),className:"h-8"})]}),e.jsx("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:S.map(g=>e.jsxs("div",{draggable:!0,onDragStart:()=>C(g),onDragOver:I=>N(I,g),onDrop:()=>b(g),className:`flex items-center space-x-3 p-3 border-b border-slate-200 hover:bg-slate-50 cursor-move
                  ${f===g?"bg-slate-100":""}`,children:[e.jsx(Un,{className:"w-4 h-4 text-slate-400"}),e.jsx(oa,{id:`col-${g}`,checked:s.includes(g),onCheckedChange:()=>v(g)}),e.jsx("label",{htmlFor:`col-${g}`,className:"flex-1 text-sm font-medium leading-none cursor-pointer",children:g}),l&&e.jsx(z,{variant:"ghost",size:"sm",className:`px-2 ${g==="Campaign"?"opacity-50 cursor-not-allowed":""}`,onClick:()=>k(g),disabled:g==="Campaign",children:t.includes(g)||g==="Campaign"?e.jsx(Ko,{className:"w-4 h-4 text-blue-500"}):e.jsx(Qo,{className:"w-4 h-4"})})]},g))})]})]})]})},Uc=({dateRange:s})=>{const a=P(Q=>Q.date.from),t=P(Q=>Q.date.to),r=P(Q=>Q.date.compareFrom),o=P(Q=>Q.date.compareTo),[l,u]=n.useState([]),[m,h]=n.useState([]),[d,f]=n.useState(!1),{brandId:w}=pe(),S=n.useMemo(()=>({from:a,to:t}),[a,t]),C=n.useMemo(()=>({from:r,to:o}),[r,o]),N=S!=null&&S.from?Y(new Date(S.from),"yyyy-MM-dd"):"",b=S!=null&&S.to?Y(new Date(S.to),"yyyy-MM-dd"):"",v=C!=null&&C.from?Y(new Date(C.from),"yyyy-MM-dd"):"",k=C!=null&&C.to?Y(new Date(C.to),"yyyy-MM-dd"):"",[g,I]=n.useState([]),[L,M]=n.useState([]),[y,R]=n.useState(!1),E=fe(),T=ke();n.useEffect(()=>{s&&E(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,E]);const x=()=>{R(!y)},F=n.useCallback(async()=>{var Q,U,K;f(!0);try{const J=[];if(N&&b&&J.push({startDate:N,endDate:b}),v&&k&&J.push({startDate:v,endDate:k}),J.length>0){const B=(await T.post(`/api/analytics/atcreport/${w}`,{dateRanges:J},{withCredentials:!0})).data.ranges||[];if(B.length>0){const te=B[0].Date;te?(h(B),u(B)):(h(((Q=B[0])==null?void 0:Q.data)||[]),u(((U=B[0])==null?void 0:U.data)||[]));const me=te?B:((K=B[0])==null?void 0:K.data)||[];if(me.length>0){const $=me[0],ee=Object.keys($);g.length===0?I(ee):I(X=>X.filter(ae=>ee.includes(ae)))}}}}catch(J){console.error("Error fetching e-commerce metrics data:",J)}finally{f(!1)}},[N,b,v,k,w]);n.useEffect(()=>{F();const Q=setInterval(F,15*60*1e3);return()=>clearInterval(Q)},[F]);const p=()=>{F()},[c,i]=n.useState(g),[A,G]=n.useState(g),O=Q=>{i(Q)},D=Q=>{G(Q),i(Q)};n.useEffect(()=>{i(g),G(g)},[g]);const j=n.useCallback(Q=>{let U=[...m];Q.forEach(K=>{U=U.filter(J=>{const H=J[K.column];if([">","<","="].includes(K.operator)){const B=parseFloat(H),te=parseFloat(K.value);switch(K.operator){case">":return B>te;case"<":return B<te;case"=":return B===te;default:return!0}}return!0})}),u(U)},[m]),_=n.useMemo(()=>l,[l]),W=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],Z=Q=>{M(L.filter((U,K)=>K!==Q))};return d?e.jsx(Se,{isLoading:d}):e.jsx(oe,{className:`mx-4 ${y?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(de,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Daily E-Commerce Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[y&&e.jsx(ge,{}),e.jsx(z,{onClick:p,disabled:d,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(Gt,{visibleColumns:c,columnOrder:A,onVisibilityChange:O,onOrderChange:D}),e.jsx(Fr,{columns:W,onFiltersChange:j,filters:L,setFilters:M}),e.jsx(z,{onClick:x,size:"icon",variant:"outline",children:y?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),L.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map((Q,U)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${Q.column} ${Q.operator} ${Q.value}`}),e.jsx("button",{onClick:()=>Z(U),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(xs,{className:"h-3 w-3"})})]},U))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:d?e.jsx(ma,{}):e.jsx(Ir,{columns:A,data:_,isFullScreen:y})})]})})})},Vc={"google analytics":{title:"Google analytics",description:"Unlock powerful insights for your store",icon:e.jsx(En,{className:"h-16 w-16 text-blue-500 animate-bounce"}),benefits:[{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Real-time Analytics",description:"Track visitor behavior as it happens"},{icon:e.jsx(ws,{className:"h-8 w-8 text-primary"}),title:"Performance Metrics",description:"Monitor your store's key metrics"},{icon:e.jsx(bt,{className:"h-8 w-8 text-primary"}),title:"Growth Insights",description:"Make data-driven decisions"}],buttonText:"Connect GA4 Now",guideText:"Need help setting up GA4?"},"google ads":{title:"Google Ads",description:"Supercharge your advertising performance",icon:e.jsx(Vn,{className:"h-16 w-16 text-red-500 animate-bounce"}),benefits:[{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Campaign Tracking",description:"Monitor ad performance in real-time"},{icon:e.jsx(ws,{className:"h-8 w-8 text-primary"}),title:"Conversion Analytics",description:"Track ROI and conversions"},{icon:e.jsx(bt,{className:"h-8 w-8 text-primary"}),title:"Budget Optimization",description:"Optimize spending across campaigns"}],buttonText:"Connect Google Ads",guideText:"New to Google Ads?"},facebook:{title:"Facebook Ads",description:"Scale your social media advertising",icon:e.jsx(Hn,{className:"h-16 w-16 text-blue-600 animate-bounce"}),benefits:[{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Audience Insights",description:"Understand your target audience"},{icon:e.jsx(ws,{className:"h-8 w-8 text-primary"}),title:"Ad Performance",description:"Track engagement and reach"},{icon:e.jsx(bt,{className:"h-8 w-8 text-primary"}),title:"ROAS Tracking",description:"Measure advertising return"}],buttonText:"Connect Facebook Ads",guideText:"First time with Facebook Ads?"}},st=({platform:s="google analytics",brandId:a,onSuccess:t})=>{const[r,o]=n.useState(!1),l=Vc[s],u=()=>{o(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-secondary/20 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto w-full space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:l.icon}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tight",children:["Connect ",l.title]}),e.jsx("p",{className:"text-xl text-muted-foreground",children:l.description})]}),e.jsx(oe,{className:"p-6 bg-card/50 backdrop-blur-sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-lg text-center",children:["You haven't connected ",l.title," yet. You're missing out on valuable insights about your store's performance!"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4 my-8",children:l.benefits.map((m,h)=>e.jsxs("div",{className:"flex flex-col items-center text-center p-4 space-y-2",children:[m.icon,e.jsx("h3",{className:"font-semibold",children:m.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description})]},h))}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(z,{size:"lg",className:"group",onClick:u,children:[l.buttonText,e.jsx(Ds,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]})}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[l.guideText," ",e.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Check out our guide"})]})]})}),e.jsx(ft,{platform:s,open:r,onOpenChange:o,brandId:a,onSuccess:t})]})},Hc=({dateRange:s})=>{const a=P(D=>D.date.from),t=P(D=>D.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState([]),[u,m]=n.useState([]),[h,d]=n.useState(!1),{brandId:f}=pe(),w=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",S=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",[C,N]=n.useState([]),[b,v]=n.useState([]),[k,g]=n.useState(!1),I=fe(),L=ke();n.useEffect(()=>{s&&I(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{k||s&&I(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[k,s]);const M=()=>{g(!k)},[y,R]=n.useState(C),[E,T]=n.useState(C),x=D=>{R(D)},F=D=>{T(D),R(D)};n.useEffect(()=>{R(C),T(C)},[C]);const p=n.useCallback(async()=>{d(!0);try{const j=(await L.post(`/api/analytics/dayAtcReport/${f}`,{startDate:w,endDate:S},{withCredentials:!0})).data.data||[];if(m(j),l(j),j.length>0)if(C.length===0){const _=Object.keys(j[0]);N(_)}else{const _=Object.keys(j[0]);N(W=>W.filter(Z=>_.includes(Z)))}}catch(D){console.error("Error fetching day wise metrics data:",D)}finally{d(!1)}},[w,S,f]);n.useEffect(()=>{p();const D=setInterval(p,3*60*60*1e3);return()=>clearInterval(D)},[p]);const c=()=>{p()},i=n.useCallback(D=>{let j=[...u];D.forEach(_=>{j=j.filter(W=>{const Z=W[_.column];if([">","<","="].includes(_.operator)){const Q=parseFloat(Z),U=parseFloat(_.value);switch(_.operator){case">":return Q>U;case"<":return Q<U;case"=":return Q===U;default:return!0}}return!0})}),l(j)},[u]),A=n.useMemo(()=>o,[o]),G=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],O=D=>{v(b.filter((j,_)=>_!==D))};return h?e.jsx(Se,{isLoading:h}):e.jsx(oe,{className:`mx-4 ${k?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(de,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Day wise E-Commerce Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[k&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:c,disabled:h,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Gt,{visibleColumns:y,columnOrder:E,onVisibilityChange:x,onOrderChange:F}),e.jsx(Fr,{columns:G,onFiltersChange:i,filters:b,setFilters:v}),e.jsx(z,{onClick:M,size:"icon",variant:"outline",children:k?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),b.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map((D,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${D.column} ${D.operator} ${D.value}`}),e.jsx("button",{onClick:()=>O(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(xs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(ma,{}):e.jsx(Ir,{columns:E,data:A,isFullScreen:k})})]})})})};function Bt({tabs:s,activeTab:a,onTabChange:t}){const r=n.useRef(null),[o,l]=n.useState(!1),[u,m]=n.useState(!1),[h,d]=n.useState(""),[f,w]=n.useState(!1),S=s.filter(b=>b.label.toLowerCase().includes(h.toLowerCase())),C=()=>{if(!r.current)return;const{scrollLeft:b,scrollWidth:v,clientWidth:k}=r.current;l(b>0),m(b<v-k-5)};n.useEffect(()=>{if(!r.current)return;const b=r.current.querySelector(`[data-value="${a}"]`);if(b){const v=r.current,k=v.getBoundingClientRect(),g=b.getBoundingClientRect(),I=g.left-k.left-k.width/2+g.width/2+v.scrollLeft;v.scrollTo({left:I,behavior:"smooth"})}C()},[a]),n.useEffect(()=>{const b=r.current;if(b)return b.addEventListener("scroll",C),C(),()=>{b.removeEventListener("scroll",C)}},[]);const N=b=>{if(!r.current)return;const v=r.current,k=v.clientWidth*.8;v.scrollBy({left:b==="left"?-k:k,behavior:"smooth"})};return e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(z,{variant:"ghost",size:"icon",className:se("flex-shrink-0 rounded-full h-8 w-8 bg-white shadow-sm transition-opacity",o?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>N("left"),children:[e.jsx(Xs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Scroll left"})]}),e.jsx("div",{ref:r,className:"flex-1 overflow-x-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsx("div",{className:"flex items-center justify-center gap-1 p-1 min-w-max",children:s.map(b=>e.jsx("button",{"data-value":b.value,className:se("px-4 py-2 text-sm rounded-md whitespace-nowrap transition-colors",b.value===a?"bg-blue-100 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-100"),onClick:()=>t(b.value),children:b.label},b.value))})}),e.jsxs(z,{variant:"ghost",size:"icon",className:se("flex-shrink-0 rounded-full h-8 w-8 bg-white shadow-sm transition-opacity",u?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>N("right"),children:[e.jsx(Ss,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Scroll right"})]}),e.jsxs($s,{open:f,onOpenChange:w,children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"icon",className:"ml-2 flex-shrink-0",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Search tabs"})]})}),e.jsxs(ks,{className:"w-64 p-0",align:"end",children:[e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Js,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),e.jsx(Pe,{type:"text",placeholder:"Search tabs...",className:"pl-9 pr-8",value:h,onChange:b=>d(b.target.value),autoFocus:!0}),h&&e.jsxs("button",{className:"absolute right-2.5 top-2.5 text-gray-400 hover:text-gray-600",onClick:()=>d(""),children:[e.jsx(xs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Clear search"})]})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto border-t",children:S.length>0?S.map(b=>e.jsx("button",{className:se("w-full text-left px-4 py-2 text-sm transition-colors",b.value===a?"bg-blue-50 text-blue-600 font-medium":"hover:bg-gray-50"),onClick:()=>{t(b.value),w(!1),d("")},children:b.label},b.value)):e.jsx("div",{className:"py-4 px-2 text-center text-sm text-gray-500",children:"No tabs match your search"})})]})]}),e.jsxs(Ys,{children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"icon",className:"ml-2 flex-shrink-0",children:[e.jsx(Zo,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"All tabs"})]})}),e.jsx(Bs,{align:"end",className:"w-56 max-h-80 overflow-y-auto",children:s.map(b=>e.jsx(ps,{className:se(b.value===a&&"bg-blue-50 text-blue-600 font-medium"),onClick:()=>t(b.value),children:b.label},b.value))})]})]})})}function gt(){return e.jsx("div",{className:"min-h-screen bg-slate-50 p-6 overflow-hidden relative  flex justify-center items-center",children:e.jsxs("div",{className:"max-w-3xl mx-auto relative",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-4 bg-amber-100 px-4 py-2 rounded-full",children:[e.jsx(Vn,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"text-amber-700 font-semibold text-sm",children:"Action Required"})]}),e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-slate-800 mb-3",children:["Date Range ",e.jsx("span",{className:"text-amber-500",children:"Missing"})]}),e.jsx("p",{className:"text-slate-600 max-w-xl mx-auto",children:"Please select a date range to continue. We need this information to display your data correctly."})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md border-l-4 border-amber-400 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-slate-500"}),e.jsx("h3",{className:"font-medium text-slate-700",children:"Select Dates"})]}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(Tn,{className:"h-3 w-3"}),e.jsx("span",{children:"Last 24 months available"})]})]}),e.jsx(ge,{})]})})})})]})})}function ys({platform:s,message:a,icon:t=e.jsx(dt,{className:"w-8 h-8 text-red-600"}),loginOptions:r}){const o=P(m=>m.user.user),l="https://parallels.messold.com",u=async(m,h)=>{try{let d;if(m==="google"){d=await re.get(`${l}/api/auth/google${h?`?context=${h}`:""}&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});const{authUrl:f}=d.data;window.location.href=f}else m==="facebook"&&(d=await re.get(`${l}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),d.data.success&&(window.location.href=d.data.authURL))}catch(d){console.error(`Error getting ${m} Auth URL:`,d)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:t}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Hey there!"}),e.jsx("p",{className:"text-gray-600",children:a})]}),(o==null?void 0:o.email)&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Xt,{className:"w-5 h-5 text-amber-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Currently signed in as:"}),e.jsx("p",{className:"font-medium text-gray-900",children:o.email})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Just a quick update to your ",s," token is needed to continue."]}),r.map((m,h)=>e.jsxs("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 group",onClick:()=>u(m.provider,m.context),children:[m.label,e.jsx(Ds,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]},h))]})]})})}const qc=()=>{const{brandId:s}=pe(),t=P(N=>N.brand.brands).find(N=>N._id===s),r=(t==null?void 0:t.ga4Account)??!1,o=P(N=>N.date.from),l=P(N=>N.date.to),u=P(Di),m=n.useMemo(()=>({from:o,to:l}),[o,l]),h={from:m.from?new Date(m.from):void 0,to:m.to?new Date(m.to):void 0},[d,f]=n.useState("daily"),w=[{label:"Daily Metrics",value:"daily"},{label:"Day wise Metrics",value:"day wise"}],S=N=>{f(N)},C=fe();return n.useEffect(()=>{r&&u&&C(pr())},[r]),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[u?e.jsx(ys,{platform:"Google Analytics",message:"We need access to your Google Analytics account to show you amazing insights about your website performance.",icon:e.jsx(qn,{className:"w-8 h-8 text-blue-600"}),loginOptions:[{label:"Connect Google Analytics",context:"googleAnalyticsSetup",provider:"google"}]}):r?!h.from||!h.to?e.jsx(gt,{}):e.jsxs(e.Fragment,{children:[e.jsx(vs,{title:"E-Commerce Insights",Icon:Jo,showDatePicker:!0}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(Bt,{tabs:w,activeTab:d,onTabChange:S})}),e.jsxs("section",{className:"my-3",children:[d==="daily"&&e.jsx(Uc,{dateRange:h}),d==="day wise"&&e.jsx(Hc,{dateRange:h})]})]}):e.jsx(e.Fragment,{children:e.jsx(st,{platform:"google analytics",brandId:s??"",onSuccess:(N,b,v)=>{console.log(`Successfully connected ${N} account: ${b} (${v})`)}})}),e.jsx(fs,{})]}),e.jsx(As,{})]})},Pr=n.createContext({tokenError:!1,setTokenError:()=>{}}),Wc=({children:s})=>{const[a,t]=n.useState(!1);return e.jsx(Pr.Provider,{value:{tokenError:a,setTokenError:t},children:s})},Yc=()=>n.useContext(Pr);function Ce({data:s,primaryColumn:a,secondaryColumns:t,monthlyDataKey:r,monthlyMetrics:o,isFullScreen:l,rows:u,isAdsTable:m,locale:h,filter:d}){const[f,w]=n.useState(1),[S,C]=n.useState([]),N=u||8,b=30,v=n.useMemo(()=>{let O=s;return d&&d.length>0&&(O=s.filter(D=>{const j=String(D[a]);return d.includes(j)})),O},[s,d,a]),k=()=>l?m?"max-h-[calc(100vh-90px)]":"max-h-[calc(100vh-130px)]":"max-h-[450px]",g=n.useMemo(()=>{if(!Array.isArray(v))return console.error("Data is not an array:",v),[];const O=j=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Number.parseInt(j)-1],D=new Set;return v.forEach(j=>{const _=j[r];Array.isArray(_)&&_.forEach(W=>{if(W!=null&&W.Month){const Z=W.Month.slice(0,4),Q=W.Month.slice(4);D.add(`${O(Q)}-${Z}`)}})}),Array.from(D).reverse()},[v,r]),I=n.useMemo(()=>{const O=[];return v.forEach((D,j)=>{o.forEach((_,W)=>{O.push({dataIndex:j,metricIndex:W})})}),O},[v,o]),L=()=>{C(O=>[...O,...I.slice(O.length,O.length+b)])};n.useEffect(()=>{l&&C(I.slice(0,b))},[l,I]);const M=O=>{const{scrollTop:D,scrollHeight:j,clientHeight:_}=O.currentTarget;j-D<=_+100&&L()},y=n.useMemo(()=>l?S:I.slice((f-1)*N,f*N),[l,I,S,f,N]),R=n.useMemo(()=>{let O=0,D=0,j=0,_=0,W=0,Z=0,Q=0,U=0,K=0;return s.forEach(J=>{const H=J[r];Array.isArray(H)&&H.forEach(B=>{typeof B.Sessions=="number"&&typeof B["Conv. Rate"]=="number"&&(O+=Number(B.Sessions),D+=Number(B["Conv. Rate"]),j++),typeof B.Spend=="number"&&typeof B["Purchase ROAS"]=="number"&&(_+=Number(B.Spend),W+=Number(B["Purchase ROAS"]),Z++),typeof B.Cost=="number"&&typeof B["Conv. Value/ Cost"]=="number"&&(Q+=Number(B.Cost),U+=Number(B["Conv. Value/ Cost"]),K++)})}),{avgSessions:j>0?O/j:0,avgConvRate:j>0?D/j:0,avgSpend:Z>0?_/Z:0,avgPurchaseROAS:Z>0?W/Z:0,avgCost:K>0?Q/K:0,avgConvValuePerCost:K>0?U/K:0}},[s,r]);n.useEffect(()=>{l||w(1)},[l]),n.useEffect(()=>{w(1),C([])},[d]);const E=({sessions:O,convRate:D,spend:j,purchaseROAS:_,cost:W,convValuePerCost:Z})=>{const Q=O!==void 0&&O>=R.avgSessions,U=D!==void 0&&D>=R.avgConvRate,K=j!==void 0&&j>=R.avgSpend,J=_!==void 0&&_>=R.avgPurchaseROAS,H=W!==void 0&&W>=R.avgCost,B=Z!==void 0&&Z>=R.avgConvValuePerCost;return Q&&U?{bg:ce.success.bg,text:ce.success.dark,indicator:"positive",sessionIndicator:"up",conversionIndicator:"up"}:K&&J?{bg:ce.success.bg,text:ce.success.dark,indicator:"positive",spendIndicator:"up",roasIndicator:"up"}:H&&B?{bg:ce.success.bg,text:ce.success.dark,indicator:"positive",costIndicator:"up",valueIndicator:"up"}:Q&&!U?{bg:ce.warning.bg,text:ce.warning.dark,indicator:"neutral-up",sessionIndicator:"up",conversionIndicator:"down"}:K&&!J?{bg:ce.warning.bg,text:ce.warning.dark,indicator:"neutral-up",spendIndicator:"up",roasIndicator:"down"}:H&&!B?{bg:ce.warning.bg,text:ce.warning.dark,indicator:"neutral-up",costIndicator:"up",valueIndicator:"down"}:!Q&&U?{bg:ce.neutral.bg,text:ce.neutral.dark,indicator:"neutral-down",sessionIndicator:"down",conversionIndicator:"up"}:!K&&J?{bg:ce.neutral.bg,text:ce.neutral.dark,indicator:"neutral-down",spendIndicator:"down",roasIndicator:"up"}:!H&&B?{bg:ce.neutral.bg,text:ce.neutral.dark,indicator:"neutral-down",costIndicator:"down",valueIndicator:"up"}:{bg:ce.danger.bg,text:ce.danger.dark,indicator:"negative",sessionIndicator:"down",conversionIndicator:"down",spendIndicator:"down",roasIndicator:"down",costIndicator:"down",valueIndicator:"down"}},T=(O,D)=>{if(typeof O=="number")switch(D){case"spend":return Math.round(O).toLocaleString(h);case"percentage":return`${Number.parseFloat(O.toLocaleString(h)).toFixed(2)}%`;case"sessions":return Math.round(O).toLocaleString(h);default:return Number.parseFloat(O.toLocaleString(h)).toFixed(2)}return O},x=(O,D)=>{if(!O)return e.jsx("td",{className:"w-[100px] text-right whitespace-nowrap p-3 text-sm font-medium border-r border-b border-slate-300 bg-white",style:{color:ce.text.muted},children:e.jsx("span",{style:{color:ce.text.muted},children:""})});const j=O[D];let _={bg:"white",text:ce.text.primary,indicator:""};return(D==="Sessions"||D==="Conv. Rate")&&typeof O.Sessions=="number"&&typeof O["Conv. Rate"]=="number"&&(_=E({sessions:Number(O.Sessions),convRate:Number(O["Conv. Rate"])})),(D==="Spend"||D==="Purchase ROAS")&&typeof O.Spend=="number"&&typeof O["Purchase ROAS"]=="number"&&(_=E({spend:Number(O.Spend),purchaseROAS:Number(O["Purchase ROAS"])})),(D==="Cost"||D==="Conv. Value/ Cost")&&typeof O.Cost=="number"&&typeof O["Conv. Value/ Cost"]=="number"&&(_=E({cost:Number(O.Cost),convValuePerCost:Number(O["Conv. Value/ Cost"])})),e.jsxs("td",{className:"w-[100px] text-right whitespace-nowrap p-3 text-sm font-medium border-r border-b border-slate-300",style:{backgroundColor:_.bg,color:_.text,transition:"background-color 0.2s ease-in-out",lineHeight:"1.4"},children:[e.jsx("div",{className:"flex items-center justify-end gap-1.5",children:e.jsx("span",{children:T(j,D==="Sessions"?"sessions":D.toLowerCase().includes("rate")?"percentage":D.toLowerCase().includes("spend")||D.toLowerCase().includes("cost")?"spend":"default")})}),D==="Conv. Rate"&&O.Purchases!==void 0&&e.jsx("div",{className:"text-xs mt-1",style:{color:ce.text.secondary},children:`Purchases: ${O.Purchases.toLocaleString(h)??0}`}),D==="Cost"&&O.Clicks!==void 0&&e.jsx("div",{className:"text-xs mt-1",style:{color:ce.text.secondary},children:`clicks: ${O.Clicks??0}`}),D==="Conv. Value/ Cost"&&O["Conversion Rate"]!==void 0&&e.jsx("div",{className:"text-xs mt-1",style:{color:ce.text.secondary},children:`conv. rate: ${O["Conversion Rate"].toLocaleString(h)??0}%`}),D==="Purchase ROAS"&&O["Purchase Conversion Value"]!==void 0&&e.jsx("div",{className:"text-xs mt-1",style:{color:ce.text.secondary},children:`PCV: ${O["Purchase Conversion Value"].toLocaleString(h)??0}`})]})},F=(O,D,j,_)=>{const W=O[D];if(typeof W!="number")return e.jsx("td",{className:"sticky top-0 min-w-[130px] p-3 text-sm font-medium border-r border-b border-slate-300 bg-white",style:{left:`${230+_*130}px`},children:""});let Z={bg:"white",text:ce.text.primary,indicator:""};if(j&&D&&(D.includes("Sessions")||D.includes("Rate"))){const J=O["Total Sessions"],H=O["Avg Conv. Rate"];Z=E({sessions:J,convRate:H})}if(j&&D&&(D.includes("Spend")||D.includes("ROAS"))){const J=O["Total Spend"],H=O["Total Purchase ROAS"];Z=E({spend:J,purchaseROAS:H})}if(j&&D&&(D.includes("Cost")||D.includes("Conv. Value / Cost"))){const J=O["Total Cost"],H=O["Conv. Value / Cost"];Z=E({cost:J,convValuePerCost:H})}const Q=typeof O["Total Purchases"]=="number"?O["Total Purchases"].toLocaleString(h):null,U=typeof O["Total Conv. Value"]=="number"?O["Total Conv. Value"].toLocaleString(h):null,K=typeof O["Total PCV"]=="number"?O["Total PCV"].toLocaleString(h):null;return e.jsx("td",{className:"sticky top-0 min-w-[130px] p-3 text-sm font-medium border-r border-b border-slate-200",style:{left:`${230+_*130}px`,backgroundColor:Z.bg,color:Z.text,transition:"background-color 0.2s ease-in-out"},children:j.toLowerCase()==="cost"&&D==="Total Cost"?e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W,"spend")})})}):j.toLowerCase()==="conv. value/ cost"&&D==="Conv. Value / Cost"?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W)})}),U&&e.jsxs("span",{className:"text-xs mt-0.5",style:{color:ce.text.muted},children:["Total Conv. Value: ",U]})]}):j.toLowerCase()==="sessions"&&D.includes("Sessions")?e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W,"sessions")})}):j.toLowerCase()==="conv. rate"&&D.includes("Rate")?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W,"percentage")})}),Q&&e.jsxs("span",{className:"text-xs mt-0.5",style:{color:ce.text.muted},children:["Total Purchases: ",Q]})]}):j.toLowerCase()==="spend"&&D.includes("Total Spend")?e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W,"spend")})}):j.toLowerCase()==="purchase roas"&&D.includes("Total Purchase ROAS")?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:T(W)})}),K&&e.jsxs("span",{className:"text-xs mt-0.5",style:{color:ce.text.muted},children:["PCV: ",K]})]}):""})},p=(O,D)=>{const j=o[D];let _={bg:"white",text:ce.text.primary,indicator:""};if(t){const W=O["Total Sessions"],Z=O["Avg Conv. Rate"],Q=O["Total Spend"],U=O["Total Purchase ROAS"],K=O["Total Cost"],J=O["Conv. Value / Cost"];j==="Sessions"||j==="Conv. Rate"?_=E({sessions:W,convRate:Z}):j==="Spend"||j==="Purchase ROAS"?_=E({spend:Q,purchaseROAS:U}):(j==="Cost"||j==="Conv. Value/ Cost")&&(_=E({cost:K,convValuePerCost:J}))}return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors duration-150 border-b border-slate-300",children:[e.jsx("td",{className:"sticky left-0 min-w-[130px] max-w-[200px] p-3 text-sm font-medium border-r border-b border-slate-300",style:{backgroundColor:_.bg,color:_.text,transition:"background-color 0.2s ease-in-out",letterSpacing:"-0.01em"},children:D===0?typeof O[a]=="string"||typeof O[a]=="number"?T(O[a]):"":null}),e.jsx("td",{className:"sticky left-[130px] min-w-[100px] whitespace-nowrap p-3 text-sm font-medium border-r border-b border-slate-300",style:{backgroundColor:_.bg,color:_.text,transition:"background-color 0.2s ease-in-out"},children:e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{children:j})})}),t==null?void 0:t.map((W,Z)=>F(O,W,j,Z)),g.map(W=>{const Z=B=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(B)+1,[Q,U]=W.split("-"),K=Z(Q),J=`${U}${K.toString().padStart(2,"0")}`,H=O[r].find(B=>B.Month===J);return x(H,j)})]},`${O[a]}-${j}`)},c=I.length,i=Math.ceil(c/N),A=O=>{const D=Math.max(1,Math.min(O,i));w(D)},G=(O,D)=>{let j="";return O==="Total Sessions"?j=`(avg: ${Math.round(R.avgSessions).toLocaleString()})`:O==="Avg Conv. Rate"?j=`(avg: ${R.avgConvRate.toFixed(2)}%)`:O==="Total Spend"?j=`(avg: ${Math.round(R.avgSpend).toLocaleString()})`:O==="Total Purchase ROAS"?j=`(avg: ${R.avgPurchaseROAS.toFixed(2)})`:O==="Total Cost"?j=`(avg: ${Math.round(R.avgCost).toLocaleString()})`:O==="Conv. Value / Cost"&&(j=`(avg: ${R.avgConvValuePerCost.toFixed(2)})`),e.jsx("th",{className:"sticky top-0 min-w-[130px] w-[150px] z-20 px-3 py-3 text-left text-sm font-medium border-r border-b border-slate-300 shadow-sm",style:{left:`${230+D*130}px`,background:"linear-gradient(to bottom, #F8FAFC, #F3F4F6)",color:ce.text.primary,letterSpacing:"-0.01em",borderBottom:`2px solid ${ce.border.dark}`},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:O}),j&&e.jsx("span",{className:"text-xs font-normal mt-0.5",style:{color:ce.text.secondary},children:j})]})},O)};return e.jsxs("div",{id:"age-report-table",className:"w-full rounded-xl overflow-hidden border border-slate-300 shadow-lg bg-white flex flex-col",style:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)"},children:[e.jsx("div",{className:`relative overflow-x-auto ${k()} scrollbar-thin`,onScroll:l?M:void 0,children:e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 top-0 min-w-[130px] w-[150px] z-20 px-3 py-3 text-left text-sm font-medium border-r border-b border-slate-200 shadow-sm",style:{background:ce.background.headerGradient,color:ce.text.primary,letterSpacing:"-0.01em",borderBottom:`2px solid ${ce.border.dark}`},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a}),d&&d.length>0&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700",children:"Filtered"})]})}),e.jsx("th",{className:"sticky left-[130px] top-0 min-w-[100px] w-[150px] z-20 px-3 py-3 text-left text-sm font-medium border-r border-b border-slate-200 shadow-sm",style:{background:ce.background.headerGradient,color:ce.text.primary,letterSpacing:"-0.01em",borderBottom:`2px solid ${ce.border.dark}`},children:"Metric"}),t==null?void 0:t.map((O,D)=>G(O,D)),g.map(O=>e.jsx("th",{className:"sticky top-0 min-w-[100px] z-10 px-3 py-3 text-right text-sm font-medium whitespace-nowrap border-r border-b border-slate-200 shadow-sm",style:{background:"linear-gradient(to bottom, #F8FAFC, #F3F4F6)",color:ce.text.primary,letterSpacing:"-0.01em",borderBottom:`2px solid ${ce.border.dark}`},children:O},O))]})}),e.jsx("tbody",{className:"divide-y divide-slate-300",children:y.length>0?y.map(({dataIndex:O,metricIndex:D})=>O<v.length&&D<o.length?p(v[O],D):null):e.jsx("tr",{children:e.jsx("td",{colSpan:2+((t==null?void 0:t.length)||0)+g.length,className:"p-4 text-center text-gray-500",children:d&&d.length>0?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{children:"No data matches the selected filter"}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Filter: ",d.join(", ")," | Total rows: ",s.length]})]}):"No data to display"})})})]})}),!l&&e.jsxs("div",{className:"border-t border-slate-200 px-3 py-2.5 flex items-center justify-between",style:{background:"linear-gradient(to bottom, white, #F4F4F4)"},children:[e.jsx("div",{className:"text-sm font-medium",style:{color:ce.text.secondary},children:c>0?e.jsxs(e.Fragment,{children:["Showing ",(f-1)*N+1,"-",Math.min(f*N,c)," of"," ",c," rows",d&&d.length>0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filtered from ",s.length," total rows)"]}):null]}):e.jsxs(e.Fragment,{children:["No rows to display",d&&d.length>0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filter: ",d.join(", "),") | Total rows: ",s.length]}):null]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",style:{borderColor:ce.border.main,color:ce.primary.main,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:"6px",transition:"all 0.15s ease"},onClick:()=>A(1),disabled:f===1,children:e.jsx(Bn,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0",style:{borderColor:ce.border.main,color:ce.primary.main,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:"6px",transition:"all 0.15s ease"},onClick:()=>A(f-1),disabled:f===1,children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium px-2",style:{color:ce.text.primary},children:["Page ",f," of ",i]}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0",style:{borderColor:ce.border.main,color:ce.primary.main,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:"6px",transition:"all 0.15s ease"},onClick:()=>A(f+1),disabled:f===i,children:e.jsx(Ss,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",style:{borderColor:ce.border.main,color:ce.primary.main,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",borderRadius:"6px",transition:"all 0.15s ease"},onClick:()=>A(i),disabled:f===i,children:e.jsx(_n,{className:"h-4 w-4"})})]})]})]})}const Kc=["Total Sessions","Avg Conv Rate","Total Cost","Conv. Value / Cost"];function Ve({componentId:s,availableColumns:a=Kc}){const t=fe(),r=P(v=>v.conversionFilters[s]||{}),[o,l]=n.useState(a[0]),[u,m]=n.useState(">"),[h,d]=n.useState(void 0),[f,w]=n.useState(!1),S=()=>{if(h===void 0||isNaN(h)){alert("Please enter a valid value");return}t(Ni({componentId:s,column:o,filter:{value:h,operator:u}})),w(!1)},C=()=>{t(wi(s)),l(a[0]),m(">"),d(void 0),w(!1)},N=Object.values(r).some(v=>v!==null),b=Object.entries(r).filter(([v,k])=>k!==null).map(([v,k])=>`${v}: ${k==null?void 0:k.operator} ${k==null?void 0:k.value}`).join(", ");return e.jsx(et,{children:e.jsxs(Je,{open:N,children:[e.jsxs(Ys,{open:f,onOpenChange:w,children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(Ms,{className:`h-4 w-4 ${N?"text-blue-500":""}`}),Object.values(r).filter(Boolean).length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:Object.values(r).filter(Boolean).length})]})}),e.jsxs(Bs,{className:"w-80 p-4 flex flex-col gap-4",children:[e.jsxs(us,{onValueChange:v=>l(v),value:o,children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select Column"})}),e.jsx(cs,{id:"metric-dropdown",children:a.map(v=>e.jsx(Oe,{value:v,children:v},v))})]}),e.jsxs(us,{onValueChange:m,value:u,children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select Operator"})}),e.jsxs(cs,{id:"condition-dropdown",children:[e.jsx(Oe,{value:">",children:"Greater Than ( > )"}),e.jsx(Oe,{value:">=",children:"Greater Than or Equal To ( >= )"}),e.jsx(Oe,{value:"<",children:"Less Than ( < )"}),e.jsx(Oe,{value:"<=",children:"Less Than or Equal To ( <= )"}),e.jsx(Oe,{value:"==",children:"Equal To ( == )"})]})]}),e.jsx(Pe,{id:"value-input",type:"number",placeholder:"Enter Value",value:h===void 0?"":h,onChange:v=>d(parseFloat(v.target.value)),className:"w-full"}),e.jsxs("div",{id:"Apply the Filter",className:"flex flex-row gap-2 items-center justify-center w-full",children:[e.jsx(z,{onClick:S,className:"w-full",children:"Add Filter"}),e.jsx(z,{id:"clear-button",variant:"destructive",className:"w-full",onClick:C,children:"Clear"})]}),Object.entries(r).filter(([v,k])=>k!==null).length>0&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Active Filters:"}),e.jsx("div",{className:"space-y-2",children:Object.entries(r).filter(([v,k])=>k!==null).map(([v,k])=>e.jsxs("div",{className:"flex items-center justify-between text-sm bg-slate-50 p-2 rounded",children:[e.jsx("span",{children:v}),e.jsxs("span",{className:"text-slate-600",children:[k==null?void 0:k.operator," ",k==null?void 0:k.value]})]},v))})]})]})]}),e.jsx(Ye,{children:b})]})})}const Qc=({dateRange:s})=>{const a=P(p=>p.date.from),t=P(p=>p.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),w=P(p=>p.locale.locale),S=P(p=>p.user.user,_e),{brandId:C}=pe(),N=()=>{f(!d)},b=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",v=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",k=ke(),g="google-ads-search-term",I=P(p=>p.conversionFilters[g]||{},_e),L=n.useMemo(()=>Object.entries(I).reduce((p,[c,i])=>{if(i){const A={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[c]||c;p[A]=i}return p},{}),[I]),M=n.useCallback(async()=>{var p;h(!0);try{const c=await k.post(`/api/google/searchTerm/${C}`,{userId:S==null?void 0:S.id,startDate:b,endDate:v,...L});u({reportType:"Search Term",data:((p=c.data)==null?void 0:p.data)||[]})}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[C,b,v,S==null?void 0:S.id,L]);n.useEffect(()=>{M();const p=setInterval(M,15*60*1e3);return()=>clearInterval(p)},[M]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,o]),n.useEffect(()=>{!d&&s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s,o]);const y=()=>{M()},R="Search Term",E=["Total Cost","Conv. Value / Cost"],T="MonthlyData",x=["Cost","Conv. Value/ Cost"],F=P(xt);return console.log(F),e.jsxs(e.Fragment,{children:[F?e.jsx(ys,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):m?e.jsx(Se,{isLoading:m}):(l==null?void 0:l.data)&&l.data.map((p,c)=>e.jsx("div",{className:`${d?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(oe,{className:"mb-4",children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ue,{})}),e.jsx("span",{className:"",children:p.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:y,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:g,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(z,{onClick:N,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),p.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",p.error]}):p.searchTerms.length===0?e.jsx("p",{className:"text-gray-500",children:"No search term data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ce,{data:p.searchTerms,primaryColumn:R,secondaryColumns:E,monthlyDataKey:T,monthlyMetrics:x,isFullScreen:d,locale:w})})]})},p.accountId)})),(l==null?void 0:l.data)&&l.data.length===0&&!m&&e.jsx(oe,{children:e.jsx(de,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No search term data available"})})})]})},Zc=({dateRange:s})=>{const a=P(p=>p.date.from),t=P(p=>p.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(!1),f=P(p=>p.locale.locale),w=fe(),S=P(xt);console.log(S);const C=P(p=>p.user.user,_e),{brandId:N}=pe(),b=()=>{d(!h)},v=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",k=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",g=ke(),I="google-ads-age",L=P(p=>p.conversionFilters[I]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((p,[c,i])=>{if(i){const A={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[c]||c;p[A]=i}return p},{}),[L]),y=n.useCallback(async()=>{m(!0);try{const c=(await g.post(`/api/google/age/${N}`,{userId:C==null?void 0:C.id,startDate:v,endDate:k,...M},{withCredentials:!0})).data||[];l(c)}catch(p){console.error("Error fetching data:",p)}finally{m(!1)}},[N,v,k,M,C==null?void 0:C.id]);n.useEffect(()=>{y();const p=setInterval(y,15*60*1e3);return()=>clearInterval(p)},[y]),n.useEffect(()=>{s&&w(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&w(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const R=()=>{y()},E="Age Range",T="MonthlyData",x=["Total Cost","Conv. Value / Cost"],F=["Cost","Conv. Value/ Cost"];return e.jsxs(e.Fragment,{children:[S?e.jsx(ys,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):u?e.jsx(Se,{isLoading:u}):(o==null?void 0:o.data)&&o.data.map((p,c)=>e.jsx("div",{className:`${h?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(oe,{className:"mb-4",children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ue,{})}),e.jsx("span",{className:"",children:p.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:R,disabled:u,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(Ve,{componentId:I,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(z,{onClick:b,size:"icon",variant:"outline",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),p.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",p.error]}):p.ageRanges.length===0?e.jsx("p",{className:"text-gray-500",children:"No Age data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ce,{data:p.ageRanges,primaryColumn:E,secondaryColumns:x,monthlyDataKey:T,monthlyMetrics:F,isFullScreen:h,locale:f})})]})},p.accountId)})),(o==null?void 0:o.data)&&o.data.length===0&&!u&&e.jsx(oe,{children:e.jsx(de,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No Age data available"})})})]})},Jc=({dateRange:s})=>{const a=P(p=>p.date.from),t=P(p=>p.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(!1),f=fe(),w=P(p=>p.user.user),{brandId:S}=pe(),C=()=>{d(!h)},N=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",b=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",v=ke(),k="google-ads-gender",g=P(p=>p.conversionFilters[k]||{},_e),I=n.useMemo(()=>Object.entries(g).reduce((p,[c,i])=>{if(i){const A={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[c]||c;p[A]=i}return p},{}),[g]),L=n.useCallback(async()=>{m(!0);try{const c=(await v.post(`/api/google/gender/${S}`,{userId:w==null?void 0:w.id,startDate:N,endDate:b,...I},{withCredentials:!0})).data||[];l(c)}catch(p){console.error("Error fetching data:",p)}finally{m(!1)}},[S,N,b,I,w==null?void 0:w.id]);n.useEffect(()=>{L();const p=setInterval(L,15*60*1e3);return()=>clearInterval(p)},[L]),n.useEffect(()=>{s&&f(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&f(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const M=()=>{L()},y="Gender",R="MonthlyData",E=["Total Cost","Conv. Value / Cost"],T=["Cost","Conv. Value/ Cost"],x=P(p=>p.locale.locale),F=P(xt);return console.log(F),e.jsxs(e.Fragment,{children:[F?e.jsx(ys,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):u?e.jsx(Se,{isLoading:u}):(o==null?void 0:o.data)&&o.data.map((p,c)=>e.jsx("div",{className:`${h?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(oe,{className:"mb-4",children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ue,{})}),e.jsx("span",{className:"",children:p.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:M,disabled:u,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(Ve,{componentId:k,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(z,{onClick:C,size:"icon",variant:"outline",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),p.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",p.error]}):p.genders.length===0?e.jsx("p",{className:"text-gray-500",children:"No gender data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ce,{data:p.genders,primaryColumn:y,secondaryColumns:E,monthlyDataKey:R,monthlyMetrics:T,isFullScreen:h,locale:x})})]})},p.accountId)})),(o==null?void 0:o.data)&&o.data.length===0&&!u&&e.jsx(oe,{children:e.jsx(de,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No gender data available"})})})]})},Xc=({dateRange:s})=>{const a=P(p=>p.date.from),t=P(p=>p.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(!1),f=fe(),w=P(p=>p.user.user),{brandId:S}=pe(),C=()=>{d(!h)},N=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",b=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",v=ke(),k="google-ads-keyword",g=P(p=>p.conversionFilters[k]||{},_e),I=n.useMemo(()=>Object.entries(g).reduce((p,[c,i])=>{if(i){const A={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[c]||c;p[A]=i}return p},{}),[g]),L=n.useCallback(async()=>{m(!0);try{const c=(await v.post(`/api/google/keyword/${S}`,{userId:w==null?void 0:w.id,startDate:N,endDate:b,...I},{withCredentials:!0})).data||[];l(c)}catch(p){console.error("Error fetching data:",p)}finally{m(!1)}},[S,N,b,I,w==null?void 0:w.id]);n.useEffect(()=>{L();const p=setInterval(L,15*60*1e3);return()=>clearInterval(p)},[L]),n.useEffect(()=>{s&&f(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&f(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const M=()=>{L()},y="Keyword",R="MonthlyData",E=["Total Cost","Conv. Value / Cost"],T=["Cost","Conv. Value/ Cost"],x=P(p=>p.locale.locale),F=P(xt);return console.log(F),e.jsxs(e.Fragment,{children:[F?e.jsx(ys,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):u?e.jsx(Se,{isLoading:u}):(o==null?void 0:o.data)&&o.data.map((p,c)=>e.jsx("div",{className:`${h?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(oe,{className:"mb-4",children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ue,{})}),e.jsx("span",{className:"",children:p.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:M,disabled:u,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(Ve,{componentId:k,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(z,{onClick:C,size:"icon",variant:"outline",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),p.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",p.error]}):p.keywords.length===0?e.jsx("p",{className:"text-gray-500",children:"No keyword data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ce,{data:p.keywords,primaryColumn:y,secondaryColumns:E,monthlyDataKey:R,monthlyMetrics:T,isFullScreen:h,locale:x})})]})},p.accountId)})),(o==null?void 0:o.data)&&o.data.length===0&&!u&&e.jsx(oe,{children:e.jsx(de,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No keyword data available"})})})]})},ed=({dateRange:s})=>{const[a,t]=n.useState(s),[r,o]=n.useState(null),[l,u]=n.useState(!0),[m,h]=n.useState(!1),d=P(E=>E.user.user),{brandId:f}=pe(),w=()=>{h(!m)},S=a!=null&&a.from?Y(a.from,"yyyy-MM-dd"):"",C=a!=null&&a.to?Y(a.to,"yyyy-MM-dd"):"",N=ke(),b=n.useCallback(async()=>{u(!0);try{const T=(await N.post(`/api/google/product/${f}`,{userId:d==null?void 0:d.id,startDate:S,endDate:C},{withCredentials:!0})).data||[];o(T)}catch(E){console.error("Error fetching data:",E)}finally{u(!1)}},[f,S,C]);n.useEffect(()=>{b();const E=setInterval(b,15*60*1e3);return()=>clearInterval(E)},[b]),n.useEffect(()=>{t(s)},[s]);const v=()=>{b()},k="Product",g="MonthlyData",I=["Total Cost","Conv. Value / Cost"],L=["Cost","Conv. Value/ Cost"],M="google-ads-product",y=P(E=>E.locale.locale),R=P(xt);return console.log(R),e.jsxs(e.Fragment,{children:[R?e.jsx(ys,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):l?e.jsx(Se,{isLoading:l}):(r==null?void 0:r.data)&&r.data.map((E,T)=>e.jsx("div",{className:`${m?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(oe,{className:"mb-4",children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ue,{})}),e.jsx("span",{className:"",children:E.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[m&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(z,{onClick:v,disabled:l,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${l?"animate-spin":""}`})}),e.jsx(Ve,{componentId:M,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(z,{onClick:w,size:"icon",variant:"outline",children:m?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),E.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",E.error]}):E.products.length===0?e.jsx("p",{className:"text-gray-500",children:"No product data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ce,{data:E.products,primaryColumn:k,secondaryColumns:I,monthlyDataKey:g,monthlyMetrics:L,isFullScreen:m,locale:y})})]})},E.accountId)})),(r==null?void 0:r.data)&&r.data.length===0&&!l&&e.jsx(oe,{children:e.jsx(de,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No product data available"})})})]})},sd=()=>{const s=P(S=>S.date.from),a=P(S=>S.date.to),t=n.useMemo(()=>({from:s,to:a}),[s,a]),[r,o]=n.useState("searchterm"),l=n.useRef(null),u=P(S=>S.brand.brands),{brandId:m}=pe(),h=u.find(S=>S._id===m),d=!!(h!=null&&h.googleAdAccount&&(h==null?void 0:h.googleAdAccount.length)>0),f=[{label:"Search Term",value:"searchterm"},{label:"Keyword",value:"keyword"},{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Product",value:"product"}],w=S=>{o(S)};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(vs,{showDatePicker:!0,Icon:Xo,title:"Google Ads Reports"}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(Bt,{tabs:f,activeTab:r,onTabChange:w})})]}),e.jsx("div",{ref:l,className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[r==="searchterm"&&e.jsx("div",{id:"searchterm",children:e.jsx(Qc,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),r==="keyword"&&e.jsx("div",{id:"keyword",children:e.jsx(Xc,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),r==="age"&&e.jsx("div",{id:"age",children:e.jsx(Zc,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),r==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(Jc,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),r==="product"&&e.jsx("div",{id:"product",children:e.jsx(ed,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})})]})})]}):e.jsx(e.Fragment,{children:e.jsx(st,{platform:"google ads",brandId:m??"",onSuccess:(S,C,N)=>{console.log(`Successfully connected ${S} account: ${C} (${N})`)}})}),e.jsx(fs,{})]}),e.jsx(As,{})]})},$e=({data:s,primaryColumn:a,metricConfig:t,onCategoryFilter:r})=>{const[o,l]=n.useState(null),u=n.useMemo(()=>{const d={[t.primary.key]:0,[t.secondary.key]:0};let f=0;return s.forEach(w=>{const S=w.MonthlyData;Array.isArray(S)&&S.forEach(C=>{const N=t.primary.key==="Total Sessions"?"Sessions":t.primary.key==="Total Spend"?"Spend":t.primary.key==="Total Cost"?"Cost":t.primary.key,b=t.secondary.key==="Avg Conv. Rate"?"Conv. Rate":t.secondary.key==="Total Purchase ROAS"?"Purchase ROAS":t.secondary.key==="Conv. Value / Cost"?"Conv. Value/ Cost":t.secondary.key,v=C[N],k=C[b];typeof v=="number"&&typeof k=="number"&&(d[t.primary.key]+=Number(v),d[t.secondary.key]+=Number(k),f++)})}),{[t.primary.key]:f>0?d[t.primary.key]/f:0,[t.secondary.key]:f>0?d[t.secondary.key]/f:0}},[s,t]),m=n.useMemo(()=>{const d={"Top Performers":[],[`High ${t.primary.name}`]:[],[`High ${t.secondary.name}`]:[],Underperformers:[]};return s.forEach(f=>{const w=Number(f[t.primary.key]),S=Number(f[t.secondary.key]),C=String(f[a]),N=w>=u[t.primary.key],b=S>=u[t.secondary.key];N&&b?d["Top Performers"].push(C):N&&!b?d[`High ${t.primary.name}`].push(C):!N&&b?d[`High ${t.secondary.name}`].push(C):d.Underperformers.push(C)}),[{name:"Top Performers",color:"text-green-700",bgColor:"bg-[#D7FFDF]",count:d["Top Performers"].length,items:d["Top Performers"],description:`Above average in both ${t.primary.name} (>${u[t.primary.key].toFixed(2)}) and ${t.secondary.name} (>${u[t.secondary.key].toFixed(2)})`},{name:`High ${t.primary.name}`,color:"text-blue-700",bgColor:"bg-[#EFF6FF]",count:d[`High ${t.primary.name}`].length,items:d[`High ${t.primary.name}`],description:`High ${t.primary.name} (>${u[t.primary.key].toFixed(2)}) but below average ${t.secondary.name} (<${u[t.secondary.key].toFixed(2)})`},{name:`High ${t.secondary.name}`,color:"text-yellow-700",bgColor:"bg-[#FFFBEB]",count:d[`High ${t.secondary.name}`].length,items:d[`High ${t.secondary.name}`],description:`High ${t.secondary.name} (>${u[t.secondary.key].toFixed(2)}) but below average ${t.primary.name} (<${u[t.primary.key].toFixed(2)})`},{name:"Underperformers",color:"text-red-700",bgColor:"bg-[#FFF1F2]",count:d.Underperformers.length,items:d.Underperformers,description:`Below average in both ${t.primary.name} (<${u[t.primary.key].toFixed(2)}) and ${t.secondary.name} (<${u[t.secondary.key].toFixed(2)})`}]},[s,u,a,t]),h=d=>{const f=m.find(w=>w.name===d);o===d?(l(null),r==null||r([])):(l(d),r==null||r((f==null?void 0:f.items)||[]))};return e.jsx(et,{children:e.jsx("div",{id:"age-report-performance",className:"space-y-4 py-2.5",children:e.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:e.jsx("div",{className:"flex items-stretch h-9",children:m.map(d=>e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx("div",{className:`relative flex-grow ${d.bgColor} border-r last:border-r-0 border-gray-300 cursor-pointer transition-all duration-300 ease-in-out hover:opacity-90`,onClick:()=>h(d.name),children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:`text-xs font-medium ${d.color} ${o===d.name?"underline":""}`,children:[d.name," (",d.count,")",o===d.name&&e.jsx("span",{className:"ml-1 inline-block w-2 h-2 bg-blue-500 rounded-full"})]})})})}),e.jsx(Ye,{className:"max-w-xs p-4 bg-gray-900 text-white border-0 shadow-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg ${d.bgColor} border border-white/20 flex items-center justify-center`,children:e.jsx("div",{className:`w-4 h-4 rounded-md ${d.color.replace("text-","bg-")}`})}),e.jsx("p",{className:"font-medium text-lg text-white",children:d.name})]}),e.jsx("p",{className:"text-sm text-gray-200",children:d.description})]})})]},d.name))})})})})},Le=({size:s="icon",variant:a="outline",iconSize:t="h-4 w-4",className:r=""})=>{const o=fe(),l=P(u=>u.locale.locale);return e.jsxs($s,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(z,{variant:a,size:s,className:r,children:e.jsx($t,{className:t})})}),e.jsx(ks,{className:"w-56",children:e.jsxs("div",{className:"grid gap-3",children:[e.jsx("h3",{className:"font-medium text-sm",children:"Number Format Preferences"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-IN",checked:l==="en-IN",onChange:()=>o(kt("en-IN")),className:"form-radio"}),e.jsx("span",{children:"Indian"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-US",checked:l==="en-US",onChange:()=>o(kt("en-US")),className:"form-radio"}),e.jsx("span",{children:"International"})]})]})]})})]})},td=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(""),[f,w]=n.useState([]),[S,C]=n.useState({}),N=fe(),{brandId:b}=pe(),v=i=>{d(h===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=n.useCallback(async()=>{m(!0);try{const A=(await I.post(`/api/meta/report/audience/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];l(A)}catch(i){console.error("Error fetching data:",i)}finally{m(!1)}},[b,k,g]);n.useEffect(()=>{L();const i=setInterval(L,3*60*60*1e3);return()=>clearInterval(i)},[L]),n.useEffect(()=>{s&&N(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&N(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const M=()=>{L()},y=i=>{w(i.map(A=>String(A)))},R=i=>A=>{C(G=>({...G,[i]:A.map(O=>String(O))}))},E=o==null?void 0:o.blendedAudienceData,T="Audience Segments",x="MonthlyData",F=["Total Spend","Total Purchase ROAS"],p=["Spend","Purchase ROAS"],c=P(i=>i.locale.locale);return u?e.jsx(Se,{isLoading:u}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Audience Segments Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[E&&E.length>0&&e.jsxs(oe,{className:`${h==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:h==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:E||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:y}),e.jsx(Ce,{data:Array.isArray(E)?E:[E],primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:h==="blended-summary",locale:c,filter:f})]})})]}),o==null?void 0:o.data.map((i,A)=>e.jsxs(oe,{className:`${h===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:h===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.audienceData||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:R(i.account_name)}),e.jsx(Ce,{data:i.audienceData,primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:h===i.account_name,locale:c,filter:S[i.account_name]||[]})]})})]},A))]})]})},ad=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(""),[w,S]=n.useState([]),[C,N]=n.useState({}),{brandId:b}=pe(),v=i=>{f(d===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=n.useCallback(async()=>{h(!0);try{const A=(await I.post(`/api/meta/report/placement/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];u(A)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[b,k,g]);n.useEffect(()=>{L();const i=setInterval(L,3*60*60*1e3);return()=>clearInterval(i)},[L]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const M=()=>{L()},y=i=>{S(i.map(A=>String(A)))},R=i=>A=>{N(G=>({...G,[i]:A.map(O=>String(O))}))},E=l==null?void 0:l.blendedPlacementData,T="Placements",x="MonthlyData",F=["Total Spend","Total Purchase ROAS"],p=["Spend","Purchase ROAS"],c=P(i=>i.locale.locale);return m?e.jsx(Se,{isLoading:m}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Placements Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[E&&E.length>0&&e.jsxs(oe,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:E||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:y}),e.jsx(Ce,{data:Array.isArray(E)?E:[E],primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d==="blended-summary",locale:c,filter:w})]})})]}),l==null?void 0:l.data.map((i,A)=>e.jsxs(oe,{className:`${d===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.placementData||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:R(i.account_name)}),e.jsx(Ce,{data:i.placementData,primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d===i.account_name,locale:c,filter:C[i.account_name]||[]})]})})]},A))]})]})},nd=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(""),[f,w]=n.useState([]),[S,C]=n.useState({}),N=fe(),{brandId:b}=pe(),v=i=>{d(h===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=P(i=>i.locale.locale),L=ke(),M=n.useCallback(async()=>{m(!0);try{const A=(await L.post(`/api/meta/report/platform/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];l(A)}catch(i){console.error("Error fetching data:",i)}finally{m(!1)}},[b,k,g]);n.useEffect(()=>{M();const i=setInterval(M,3*60*60*1e3);return()=>clearInterval(i)},[M]),n.useEffect(()=>{s&&N(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&N(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const y=()=>{M()},R=i=>{w(i.map(A=>String(A)))},E=i=>A=>{C(G=>({...G,[i]:A.map(O=>String(O))}))},T=o==null?void 0:o.blendedPlatformData,x="Platforms",F="MonthlyData",p=["Total Spend","Total Purchase ROAS"],c=["Spend","Purchase ROAS"];return u?e.jsx(Se,{isLoading:u}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Platform Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[T&&T.length>0&&e.jsxs(oe,{className:`${h==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:y,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:h==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:T||[],primaryColumn:x,metricConfig:Me.spendAndRoas||{},onCategoryFilter:R}),e.jsx(Ce,{data:Array.isArray(T)?T:[T],primaryColumn:x,secondaryColumns:p,monthlyDataKey:F,monthlyMetrics:c,isFullScreen:h==="blended-summary",locale:I,filter:f})]})})]}),o==null?void 0:o.data.map((i,A)=>e.jsxs(oe,{className:`${h===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:y,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:h===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.platformData,primaryColumn:x,metricConfig:Me.spendAndRoas||{},onCategoryFilter:E(i.account_name)}),e.jsx(Ce,{data:i.platformData,primaryColumn:x,secondaryColumns:p,monthlyDataKey:F,monthlyMetrics:c,isFullScreen:h===i.account_name,locale:I,filter:S[i.account_name]||[]})]})})]},A))]})]})},rd=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(""),[w,S]=n.useState([]),[C,N]=n.useState({}),{brandId:b}=pe(),v=i=>{f(d===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=n.useCallback(async()=>{h(!0);try{const A=(await I.post(`/api/meta/report/country/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];u(A)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[b,k,g]);n.useEffect(()=>{L();const i=setInterval(L,3*60*60*1e3);return()=>clearInterval(i)},[L]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const M=l==null?void 0:l.blendedCountryData,y=()=>{L()},R=i=>{S(i.map(A=>String(A)))},E=i=>A=>{N(G=>({...G,[i]:A.map(O=>String(O))}))},T="Country",x="MonthlyData",F=["Total Spend","Total Purchase ROAS"],p=["Spend","Purchase ROAS"],c=P(i=>i.locale.locale);return m?e.jsx(Se,{isLoading:m}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Country Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[M&&M.length>0&&e.jsxs(oe,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:y,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:M||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:R}),e.jsx(Ce,{data:Array.isArray(M)?M:[M],primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d==="blended-summary",locale:c,filter:w})]})})]}),l==null?void 0:l.data.map((i,A)=>e.jsxs(oe,{className:`${d===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:y,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.countryData||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:E(i.account_name)}),e.jsx(Ce,{data:i.countryData,primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d===i.account_name,locale:c,filter:C[i.account_name]||[]})]})})]},A))]})]})},od=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(""),[w,S]=n.useState([]),[C,N]=n.useState({}),{brandId:b}=pe(),v=i=>{f(d===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=n.useCallback(async()=>{h(!0);try{const A=(await I.post(`/api/meta/report/device/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];u(A)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[b,k,g]);n.useEffect(()=>{L();const i=setInterval(L,3*60*60*1e3);return()=>clearInterval(i)},[L]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const M=()=>{L()},y=i=>{S(i.map(A=>String(A)))},R=i=>A=>{N(G=>({...G,[i]:A.map(O=>String(O))}))},E=l==null?void 0:l.blendedDeviceData,T="Device",x="MonthlyData",F=["Total Spend","Total Purchase ROAS"],p=["Spend","Purchase ROAS"],c=P(i=>i.locale.locale);return m?e.jsx(Se,{isLoading:m}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Device Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[E&&E.length>0&&e.jsxs(oe,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:E||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:y}),e.jsx(Ce,{data:Array.isArray(E)?E:[E],primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d==="blended-summary",locale:c,filter:w})]})})]}),l==null?void 0:l.data.map((i,A)=>e.jsxs(oe,{className:`${d===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.deviceData||[],primaryColumn:T,metricConfig:Me.spendAndRoas||{},onCategoryFilter:R(i.account_name)}),e.jsx(Ce,{data:i.deviceData,primaryColumn:T,secondaryColumns:F,monthlyDataKey:x,monthlyMetrics:p,isFullScreen:d===i.account_name,locale:c,filter:C[i.account_name]||[]})]})})]},A))]})]})},ld=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(""),[w,S]=n.useState([]),[C,N]=n.useState({}),{brandId:b}=pe(),v=i=>{f(d===i?"":i)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=n.useCallback(async()=>{h(!0);try{const A=(await I.post(`/api/meta/report/gender/${b}`,{startDate:k,endDate:g},{withCredentials:!0})).data||[];u(A)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[b,k,g]);n.useEffect(()=>{L();const i=setInterval(L,3*60*60*1e3);return()=>clearInterval(i)},[L]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const M=()=>{L()},y=l==null?void 0:l.blendedGenderData,R="Gender",E="MonthlyData",T=["Total Spend","Total Purchase ROAS"],x=["Spend","Purchase ROAS"],F=P(i=>i.locale.locale),p=i=>{S(i.map(A=>String(A)))},c=i=>A=>{N(G=>({...G,[i]:A.map(O=>String(O))}))};return m?e.jsx(Se,{isLoading:m}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Gender Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[y&&y.length>0&&e.jsxs(oe,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:y||[],primaryColumn:R,metricConfig:Me.spendAndRoas||{},onCategoryFilter:p}),e.jsx(Ce,{data:Array.isArray(y)?y:[y],primaryColumn:R,secondaryColumns:T,monthlyDataKey:E,monthlyMetrics:x,isFullScreen:d==="blended-summary",locale:F,filter:w})]})})]}),l==null?void 0:l.data.map((i,A)=>e.jsxs(oe,{className:`${d===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>v(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.genderData||[],primaryColumn:R,metricConfig:Me.spendAndRoas||{},onCategoryFilter:c(i.account_name)}),e.jsx(Ce,{data:i.genderData,primaryColumn:R,secondaryColumns:T,monthlyDataKey:E,monthlyMetrics:x,isFullScreen:d===i.account_name,isAdsTable:!0,locale:F,filter:C[i.account_name]||[]})]})})]},A))]})]})},id=({dateRange:s})=>{const a=P(i=>i.date.from),t=P(i=>i.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(""),[f,w]=n.useState([]),[S,C]=n.useState({}),N=fe(),b=P(i=>i.locale.locale),{brandId:v}=pe(),k=i=>{d(h===i?"":i)},g=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",I=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",L=ke(),M=n.useCallback(async()=>{m(!0);try{const A=(await L.post(`/api/meta/report/age/${v}`,{startDate:g,endDate:I},{withCredentials:!0})).data||[];l(A)}catch(i){console.error("Error fetching data:",i)}finally{m(!1)}},[v,g,I]);n.useEffect(()=>{M();const i=setInterval(M,3*60*60*1e3);return()=>clearInterval(i)},[M]),n.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&N(ie({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,N]);const y="Age",R=["Total Spend","Total Purchase ROAS"],E="MonthlyData",T=["Spend","Purchase ROAS"],x=()=>{M()},F=i=>{w(i.map(A=>String(A)))},p=i=>A=>{C(G=>({...G,[i]:A.map(O=>String(O))}))},c=o==null?void 0:o.blendedAgeData;return u?e.jsx(Se,{isLoading:u}):e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Age Insights"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[c&&c.length>0&&e.jsxs(oe,{className:`${h==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:x,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>k("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:h==="blended-summary"?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:c||[],primaryColumn:y,metricConfig:Me.spendAndRoas||{},onCategoryFilter:F}),e.jsx(Ce,{data:Array.isArray(c)?c:[c],primaryColumn:y,secondaryColumns:R,monthlyDataKey:E,monthlyMetrics:T,isFullScreen:h==="blended-summary",locale:b,filter:f})]})})]}),o==null?void 0:o.data.map((i,A)=>e.jsxs(oe,{className:`${h===i.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:i.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:x,disabled:u,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>k(i.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:h===i.account_name?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]})}),e.jsx(de,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx($e,{data:i.ageData||[],primaryColumn:y,metricConfig:Me.spendAndRoas||{},onCategoryFilter:p(i.account_name)}),e.jsx(Ce,{data:Array.isArray(i.ageData)?i.ageData:[i.ageData],primaryColumn:y,secondaryColumns:R,monthlyDataKey:E,monthlyMetrics:T,isFullScreen:h===i.account_name,locale:b,filter:S[i.account_name]||[]})]})})]},A))]})]})},cd=()=>{const s=P(C=>C.date.from),a=P(C=>C.date.to),t=n.useMemo(()=>({from:s,to:a}),[s,a]),[r,o]=n.useState("age"),{brandId:l}=pe(),m=P(C=>C.brand.brands).find(C=>C._id===l),h=!!(m!=null&&m.fbAdAccounts&&(m==null?void 0:m.fbAdAccounts.length)>0),d=P(la),f={from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0},w=[{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Country",value:"country"},{label:"Platform",value:"platform"},{label:"Placement",value:"placement"},{label:"Impression Device",value:"impressionDevice"},{label:"Audience Segments",value:"audienceSegments"}],S=C=>{o(C)};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(vs,{title:"Meta Reports",Icon:Mt,showDatePicker:!0}),d?e.jsx(ys,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):h?!t.from||!t.to?e.jsx(gt,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(Bt,{tabs:w,activeTab:r,onTabChange:S})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[r==="audienceSegments"&&e.jsx("div",{id:"audienceSegments",children:e.jsx(td,{dateRange:f})}),r==="placement"&&e.jsx("div",{id:"placement",children:e.jsx(ad,{dateRange:f})}),r==="platform"&&e.jsx("div",{id:"platform",children:e.jsx(nd,{dateRange:f})}),r==="country"&&e.jsx("div",{id:"country",children:e.jsx(rd,{dateRange:f})}),r==="impressionDevice"&&e.jsx("div",{id:"impressionDevice",children:e.jsx(od,{dateRange:f})}),r==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(ld,{dateRange:f})}),r==="age"&&e.jsx("div",{id:"age",children:e.jsx(id,{dateRange:f})})]})})]}):e.jsx(st,{platform:"facebook",brandId:l??"",onSuccess:(C,N,b)=>{console.log(`Successfully connected ${C} account: ${N} (${b})`)}}),e.jsx(As,{})]})]})},dd=vo,Or=n.forwardRef(({className:s,...a},t)=>e.jsx(kn,{ref:t,className:se("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));Or.displayName=kn.displayName;const Us=n.forwardRef(({className:s,...a},t)=>e.jsx(An,{ref:t,className:se("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));Us.displayName=An.displayName;const Kt=n.forwardRef(({className:s,...a},t)=>e.jsx(Fn,{ref:t,className:se("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));Kt.displayName=Fn.displayName;function md({isOpen:s,onClose:a,brandId:t,brandName:r,brandData:o,platformIcons:l}){var b,v,k;const[u,m]=n.useState("overview"),[h,d]=n.useState(!1),[f,w]=n.useState(""),S=[{key:"shopify",icon:l.shopify.icon,name:l.shopify.name,isConnected:!!o.shopifyAccount,accountNumber:"1 Store",accountName:(b=o.shopifyAccount)==null?void 0:b.shopName,data:o.shopifyAccount,allowMultipleAccounts:!1},{key:"googleAds",icon:l.googleAds.icon,name:l.googleAds.name,isConnected:o.googleAdAccount&&o.googleAdAccount.length>0,accountNumber:o.googleAdAccount?`${o.googleAdAccount.length} Account(s)`:void 0,accountName:o.googleAdAccount&&o.googleAdAccount.length>0?`${o.googleAdAccount.map(g=>g.clientId).join(", ")}`:void 0,data:o.googleAdAccount,allowMultipleAccounts:!0},{key:"googleAnalytics",icon:l.googleAnalytics.icon,name:l.googleAnalytics.name,isConnected:!!((v=o.ga4Account)!=null&&v.PropertyID),accountNumber:"1 Property",accountName:(k=o.ga4Account)!=null&&k.PropertyID?`Property ${o.ga4Account.PropertyID}`:void 0,data:o.ga4Account,allowMultipleAccounts:!1},{key:"facebook",icon:l.facebook.icon,name:l.facebook.name,isConnected:o.fbAdAccounts&&o.fbAdAccounts.length>0,accountNumber:o.fbAdAccounts?`${o.fbAdAccounts.length} Account(s)`:void 0,accountName:o.fbAdAccounts&&o.fbAdAccounts.length>0?`${o.fbAdAccounts.join(", ")}`:void 0,data:o.fbAdAccounts,allowMultipleAccounts:!0}];n.useEffect(()=>{console.log(t)},[]);const C=g=>{w(g),d(!0)},N=(g,I,L)=>{console.log(`Successfully connected ${g} account: ${I} (${L})`)};return e.jsxs(zt,{open:s,onOpenChange:a,children:[e.jsxs(mt,{className:"sm:max-w-4xl max-h-[100vh] overflow-y-auto",children:[e.jsxs(ut,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(ea,{className:"h-5 w-5 text-teal-600"})}),e.jsx(ht,{className:"text-xl",children:r})]}),e.jsx(ra,{children:"Manage platform integrations for this brand"})]}),e.jsxs(dd,{defaultValue:"overview",value:u,onValueChange:m,className:"mt-2",children:[e.jsxs(Or,{className:"grid grid-cols-5 mb-4",children:[e.jsx(Us,{value:"overview",children:"Overview"}),e.jsx(Us,{value:"shopify",children:"Shopify"}),e.jsx(Us,{value:"googleAds",children:"Google Ads"}),e.jsx(Us,{value:"googleAnalytics",children:"Analytics"}),e.jsx(Us,{value:"facebook",children:"Facebook"})]}),e.jsx(Kt,{value:"overview",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:S.map(g=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(g.icon,{className:"h-4 w-4 text-slate-700"})}),e.jsx("h3",{className:"font-medium",children:g.name})]}),e.jsx(js,{className:g.isConnected?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700",children:g.isConnected?"Connected":"Not Connected"})]}),e.jsx("div",{className:"text-sm text-slate-600 space-y-2",children:g.isConnected?e.jsxs(e.Fragment,{children:[g.accountNumber&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Account(s):"}),e.jsx("span",{className:"font-medium",children:g.accountNumber})]}),e.jsx(z,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>m(g.key),children:"View Details"})]}):e.jsxs(z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>C(g.key),children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),"Add ",g.key==="shopify"?"Store":"Account"]})})]},g.key))})}),S.map(g=>e.jsxs(Kt,{value:g.key,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(g.icon,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-lg",children:g.name}),e.jsx("span",{className:"text-sm text-slate-500",children:g.isConnected?`Connected to ${g.accountName}`:"Not connected"})]})]}),e.jsx(js,{className:g.isConnected?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700",children:g.isConnected?"Active":"Inactive"})]}),e.jsxs("div",{className:"border rounded-lg p-5 bg-slate-50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Connection Details"}),g.isConnected?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-slate-500",children:"Account Name"}),e.jsx("p",{className:"font-medium",children:g.accountName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-slate-500",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx("span",{children:"Connected"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-4 justify-end",children:[g.allowMultipleAccounts&&e.jsxs(z,{size:"sm",onClick:()=>C(g.key),children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),"Add ",g.key==="shopify"?"Store":"Account"]}),e.jsx(z,{variant:"destructive",size:"sm",className:"text-white hover:bg-red-800",children:"Disconnect"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(el,{className:"h-5 w-5"}),e.jsx("span",{children:"Not connected"})]}),e.jsxs("div",{className:"bg-white p-4 rounded border text-sm",children:[e.jsxs("h5",{className:"font-medium mb-2",children:["Why connect ",g.name,"?"]}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-slate-600",children:[e.jsx("li",{children:"Get comprehensive analytics across all your marketing channels"}),e.jsx("li",{children:"Track performance metrics in one dashboard"}),e.jsx("li",{children:"Generate insights from combined data sources"})]})]}),e.jsxs(z,{className:"mt-2",onClick:()=>C(g.key),children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),"Add ",g.key==="shopify"?"Store":"Account"]})]})]})]},g.key))]})]}),f&&e.jsx(ft,{platform:f==="googleAds"?"Google Ads":f==="googleAnalytics"?"Google Analytics":f==="facebook"?"Facebook":"Shopify",open:h,onOpenChange:d,brandId:t,onSuccess:N})]})}const ud={shopify:{icon:sl,name:"Shopify"},googleAds:{icon:Vs,name:"Google Ads"},googleAnalytics:{icon:ws,name:"Google Analytics"},facebook:{icon:Hn,name:"Facebook"}};function hd({userBrands:s=[]}){const a=Ke(),[t,r]=n.useState(null),[o,l]=n.useState(null),u=P(S=>S.brand.brands),m=fe(),h=(s==null?void 0:s.map(S=>{const C=u.find(N=>N._id===S);return C?{_id:C._id,name:C.name}:{_id:S,name:"Unknown Brand"}}))||[];n.useEffect(()=>{(async()=>{if(t)try{const C=await re.get(`${Te}/api/brands/${t.id}`,{withCredentials:!0});l(C.data)}catch(C){console.error("Error fetching brand details:",C)}})()},[t]);const d=S=>{r(S)},f=()=>{r(null),l(null)},w=async S=>{try{await re.delete(`${Te}/api/brands/delete/${S}`,{withCredentials:!0}),m(Hl(S)),m(Ll(S))}catch(C){console.error("Error deleting brand:",C)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(z,{onClick:()=>a("/brand-setup"),variant:"outline",className:"text-slate-700",children:[e.jsx(Ct,{className:"h-5 w-5 mr-2"}),"Add New Brand"]}),h.map(S=>e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-5 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d({id:S._id,name:S.name}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(ea,{className:"h-5 w-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900",children:S.name}),e.jsx("span",{className:"text-sm text-slate-500",children:"Connected"})]})]}),e.jsx(z,{variant:"ghost",size:"icon",className:"text-slate-600",onClick:C=>{C.stopPropagation()},children:e.jsx($t,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Integration Status"}),e.jsx(js,{className:"bg-teal-100 text-teal-700",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{variant:"outline",size:"sm",className:"text-slate-700",onClick:C=>{C.stopPropagation(),d({id:S._id,name:S.name})},children:"Manage"}),e.jsx(z,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",onClick:C=>{C.stopPropagation(),w(S._id)},children:e.jsx(Pn,{className:"h-4 w-4"})})]})]})]},S._id))]}),t&&o&&e.jsx(md,{isOpen:!0,onClose:f,brandId:t.id,brandName:t.name,brandData:o,platformIcons:ud})]})}function xd(){const[s,a]=n.useState("brands"),t=P(o=>o.user.user);console.log(t==null?void 0:t.brands);const r=async()=>{try{const o=await re.get(`${Te}/api/auth/zoho?source=${encodeURIComponent(window.location.pathname)}`),{authUrl:l}=o.data;window.location.href=l}catch(o){console.error("Error getting Zoho Auth URL:",o)}};return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx("span",{className:"text-4xl font-bold text-slate-600",children:t==null?void 0:t.username[0]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:t==null?void 0:t.username}),(t==null?void 0:t.isAdmin)&&e.jsxs(js,{className:"bg-teal-100 text-teal-700 px-3 py-1 rounded-full",children:[e.jsx(tl,{className:"h-4 w-4 mr-1"}),"Administrator"]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{children:t==null?void 0:t.email})]})})]})]})}),e.jsx("div",{className:"border-b border-slate-200",children:e.jsx("div",{className:"flex px-6",children:["Brands"].map(o=>e.jsxs("button",{onClick:()=>a(o.toLowerCase()),className:`px-6 py-4 font-medium text-sm transition-colors relative ${s===o.toLowerCase()?"text-teal-600":"text-slate-600 hover:text-slate-900"}`,children:[o,s===o.toLowerCase()&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-teal-600"})]},o))})}),s.toLowerCase()==="brands"&&e.jsx(hd,{userBrands:t==null?void 0:t.brands}),s.toLowerCase()==="support"&&(t==null?void 0:t.isAdmin)&&e.jsx("div",{className:"py-8 flex gap-4 items-center justify-center",children:e.jsxs(z,{onClick:r,className:"bg-teal-600 hover:bg-teal-700",children:[e.jsx(Ln,{className:"h-5 w-5 mr-2"}),"Connect Zoho Help Desk"]})})]})})})})]})}const ua=[{id:"business-performance",title:"Business Performance",route:"/dashboard",description:"Period wise Metrics Performance"},{id:"report-tab",title:"Report Tab",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",priority:2,relatedTutorials:["age-conversion-report"]},{id:"age-conversion-report",title:"Age Conversion Report",description:"Understanding the age conversion report",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,componentId:"age-report",priority:1},{id:"marketing-insights",title:"Marketing Insights",description:"Understanding the marketing insights iver different months",route:/^\/ad-metrics\/[a-zA-Z0-9]+$/}],fd={"business-performance":[{element:"#analytics-section",popover:{title:"Analytics Overview",description:"This section provides key business metrics such as Sessions, Cart Additions, Checkouts, and Purchases.",position:"top"}},{element:"#sessions-metric",popover:{title:"Sessions Overview",description:`This section shows the total number of sessions on your website:

            - Yesterday: Displays the total sessions for yesterday and its comparison to the previous day.

            - Last 7 Days: Aggregates data for the last 7 days and compares it with the previous 7-day period.

            - Last 30 Days: Shows trends over the last month, compared with the previous 30-day period.`,position:"bottom"}}],"report-tab":[{element:"#report-tab",popover:{title:"Report Tab",description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",position:"bottom"}}],"age-conversion-report":[{element:"#age-report",popover:{title:"Age based Report",description:"Review detailed monthly conversion numbers for each age group here.",position:"top"}},{element:"#age-report-performance",popover:{title:"Key Performers",description:"These metrics highlight your best and worst performing age segments.",position:"left"}},{element:"#age-report-table",popover:{title:"Detailed Data",description:"Analyze session counts, conversion rates, and purchase trends for different age groups over time.",position:"top"}},{element:"#refresh",popover:{title:"Refresh for Updated Values",description:"Refresh to see the latest performance metrics for different age segments",position:"bottom"}},{element:"#filters",popover:{title:"Filter Your Data",description:"Use filters to refine your data by selecting a metric, condition, and value. Click 'Add Filter' to apply.",position:"bottom"}},{element:"#download-button",popover:{title:"Download Your Excel Report",description:"Click to download the report as an Excel file for further analysis.",position:"bottom"}},{element:"#expand-button",popover:{title:"Expand the Table for a Better View",description:"Click to enlarge the table for easier data analysis and readability.",position:"bottom"}}],"marketing-insights":[{element:"#metrics-table",popover:{title:"Monthly Performance Overview",description:"This table displays key performance metrics for each month over the last two years, including ad spend, sales, and ROAS for Meta, Google, and Shopify.",position:"left"}},{element:"#expand-month",popover:{title:"Expand to View Daily Breakdown",description:"Click on a month to expand and see the daily breakdown of ad performance metrics.",position:"top"}}]},gd=s=>ua.filter(a=>typeof a.route=="string"?a.route===s:a.route.test(s)).sort((a,t)=>(t.priority||0)-(a.priority||0)),pd=s=>{const a=ha(s);return a!=null&&a.steps&&a.steps.length>0?a.steps:fd[s]||[]},ha=s=>ua.find(a=>a.id===s),jd=s=>{const a=ha(s);return(a==null?void 0:a.relatedTutorials)||[]},bd=s=>{const t=[...gd(s)].sort((u,m)=>(m.priority||0)-(u.priority||0)),r=new Map,o=u=>{if(!r.has(u.id)&&(r.set(u.id,u),u.relatedTutorials&&u.relatedTutorials.length>0))for(const m of u.relatedTutorials){const h=ha(m);h&&o(h)}};for(const u of t)o(u);const l=Array.from(r.values());return console.log("Available tutorials:",l.map(u=>u.id).join(", ")),l},vd={};ua.forEach(s=>{vd[s.id]=s.route});const yd=({children:s})=>{const a=fe(),r=sa().pathname,o=P(f=>f.tutorials.isFirstTimeLogin),l=P(f=>f.user.user),u=P(f=>f.tutorials.isTutorialActive),m=P(f=>f.tutorials.tutorialQueue),h=P(f=>f.tutorials.activeTutorial),d=es.useRef(!1);return n.useEffect(()=>{if(l&&!d.current){const f=l.loginCount===1;console.log("User login status:",{loginCount:l.loginCount,isFirstLogin:f}),a(Li(f))}},[l,a]),n.useEffect(()=>{console.log("Tutorial queue updated:",{active:h,queueLength:m.length,queue:m})},[h,m]),n.useEffect(()=>{d.current&&h===null&&!u&&(console.log("Tutorial session ended, marking first-time login as complete"),a(Pi()))},[h,u,a]),n.useEffect(()=>{if(d.current)return;const f=o&&l&&!u&&m.length===0;if(console.log("Tutorial conditions:",{isFirstTimeLogin:o,hasUser:!!l,isTutorialActive:u,queueLength:m.length,shouldQueueTutorials:f}),f){const w=setTimeout(()=>{const S=bd(r);if(console.log("Available tutorials for path:",{path:r,allTutorials:S}),S.length>0){const C=S.map(N=>N.id);console.log("Queueing tutorials:",C),a(fr(C)),d.current=!0}else console.log("No tutorials available for this path")},1500);return()=>clearTimeout(w)}},[o,l,r,u,m,a]),e.jsx(e.Fragment,{children:s})},Nd=()=>{const s=fe(),a=n.useRef(null),t=P(u=>u.tutorials.activeTutorial),r=P(u=>u.tutorials.isTutorialActive),o=P(u=>u.tutorials.activeTutorialStep),l=P(u=>u.tutorials.tutorialQueue);return n.useEffect(()=>{if(t&&r){console.log(`Starting tutorial: ${t}, Queue: [${l.join(", ")}]`);const u=pd(t);u&&u.length>0?(a.current&&(a.current.destroy(),a.current=null),setTimeout(()=>{let m=!0;if(u.forEach(d=>{document.querySelector(d.element)||(console.warn(`Element ${d.element} not found for tutorial ${t}`),m=!1)}),!m){console.warn(`Not all elements for tutorial ${t} exist on the page. Moving to next tutorial.`),s(Ht());return}const h=Sl({showProgress:!0,smoothScroll:!0,animate:!0,allowClose:!0,stagePadding:10,steps:u,onHighlightStarted:d=>{const f=u.findIndex(w=>w.element===(d==null?void 0:d.id));s(Ei(f>=0?f:0))},onDestroyed:()=>{a.current=null;const d=jd(t);d.length>0&&(console.log(`Queueing related tutorials: ${d.join(", ")}`),s(fr(d))),console.log("Moving to next tutorial"),s(Ht())}});o>0&&o<u.length?h.highlight(u[o]):h.drive(),a.current=h},500)):(console.error(`No steps defined for tutorial: ${t}`),s(Ht()))}return()=>{a.current&&(a.current.destroy(),a.current=null)}},[t,r,s]),null};function wd(){return e.jsx("section",{className:"w-full py-12 md:py-8 lg:py-16 gradient-bg text-white",children:e.jsx("div",{className:"container px-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 text-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tighter md:text-4xl",children:"Youve made it this farwhy stop now?"}),e.jsx("p",{className:"max-w-[900px] md:text-xl",children:"Lets take your marketing to the next level. Start your 14-day free trial today."})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-[400px]:flex-row",children:[e.jsx(Ze,{to:"/login",children:e.jsx(z,{size:"lg",variant:"secondary",className:"bg-white text-primary hover:bg-blue-50",children:"Start Free Trial"})}),e.jsx(z,{size:"lg",variant:"outline",className:"border-white text-black hover:bg-blue-50",children:"Schedule a Demo"})]}),e.jsxs("p",{className:"text-sm text-blue-100",children:["Got questions?"," ",e.jsx(Ze,{to:"#",className:"text-white underline underline-offset-2",children:"Chat with our sales team"})]})]})})})}const Cd=({title:s,description:a,icon:t,index:r})=>e.jsxs("div",{className:se("flex flex-col lg:border-r  py-10 relative group/feature dark:border-neutral-800",(r===0||r===4)&&"lg:border-l dark:border-neutral-800",r<4&&"lg:border-b dark:border-neutral-800"),children:[r<4&&e.jsx("div",{className:"opacity-0 group-hover/feature:opacity-100 transition duration-200 absolute inset-0 h-full w-full bg-gradient-to-t from-gray-200 dark:from-neutral-800 to-transparent pointer-events-none"}),r>=4&&e.jsx("div",{className:"opacity-0 group-hover/feature:opacity-100 transition duration-200 absolute inset-0 h-full w-full bg-gradient-to-b from-gray-200 dark:from-neutral-800 to-transparent pointer-events-none"}),e.jsx("div",{className:"mb-4 relative z-10 px-10 text-neutral-600 dark:text-neutral-400",children:t}),e.jsxs("div",{className:"text-lg font-bold mb-2 relative z-10 px-10",children:[e.jsx("div",{className:"absolute left-0 inset-y-0 h-6 group-hover/feature:h-8 w-1 rounded-tr-full rounded-br-full bg-neutral-300 dark:bg-neutral-700 group-hover/feature:bg-blue-500 transition-all duration-200 origin-center"}),e.jsx("span",{className:"group-hover/feature:translate-x-2 transition duration-200 inline-block text-neutral-800 dark:text-neutral-100",children:s})]}),e.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-300 max-w-xs relative z-10 px-10",children:a})]}),Sd=[{title:"Unified Dashboard",description:"View all your marketing data in one place with customizable widgets",icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"})},{title:"Multi-platform Integration",description:"Connect with Shopify, Meta, Google Ads, and GA4 seamlessly",icon:e.jsx(On,{className:"h-8 w-8 text-primary"})},{title:"Performance Tracking",description:"Monitor business performance across platforms and time periods",icon:e.jsx(ws,{className:"h-8 w-8 text-primary"})},{title:"Demographic Analysis",description:"Track conversions based on location, demographics, brands, and products",icon:e.jsx(zn,{className:"h-8 w-8 text-primary"})},{title:"Automated Email Reports",description:"Receive regular performance updates directly in your inbox",icon:e.jsx(dt,{className:"h-8 w-8 text-primary"})},{title:"Campaign Grouping",description:"Group campaigns by category to analyze performance at a glance",icon:e.jsx(al,{className:"h-8 w-8 text-primary"})},{title:"Compare Date Ranges",description:"Easily compare analytics across different time periods",icon:e.jsx(Lt,{className:"h-8 w-8 text-primary"})},{title:"Easy & Transparent Pricing",description:"Simple, no-surprise pricing plans to fit every business",icon:e.jsx(Gn,{className:"h-8 w-8 text-primary"})}];function kd(){return e.jsx("section",{id:"features",className:"w-full py-12 md:py-8 lg:py-16 bg-slate-100 px-4",children:e.jsxs("div",{className:"container px-4 md:px-6",children:[e.jsx("div",{className:"flex flex-col items-center justify-center space-y-4 text-center mb-5",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tighter md:text-4xl lg:text-3xl gradient-text",children:"Smarter Marketing, Better Results"}),e.jsx("p",{className:"max-w-[900px] text-muted-foreground md:text-lg",children:"Track performance, scale campaigns, and maximize ROIall with ease."})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4  relative z-10 pt-6 max-w-7xl mx-auto",children:Sd.map((s,a)=>e.jsx(Cd,{...s,index:a},s.title))})]})})}const Ad=()=>{const s=[],a=new Date;let t=25e3;for(let r=0;r<30;r++){const o=new Date(a);o.setDate(o.getDate()-(29-r));const l=o.getDate();t+=Math.random()*1500+500;const u=Math.random()>.7?Math.random()*1e4-5e3:Math.random()*3e3-1500,m=Math.round(t+u);s.push({name:l,value:Math.max(m,5e3)})}return s},Fd=Ad();function Id(){return e.jsxs("div",{className:"relative min-h-screen w-full overflow-hidden gradient-bg",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.3),rgba(255,255,255,0))]"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"grid gap-12 lg:grid-cols-2 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col justify-center items-start",children:[e.jsx("div",{className:"mb-8 flex justify-center",children:e.jsxs("div",{className:"animate-fade-in rounded-full border border-[#1E1B4B]/20 bg-[#0E0E2C] px-3 py-1 text-sm text-slate-300 backdrop-blur-sm",children:[e.jsx("span",{className:"mr-2 inline-block text-indigo-500",children:""}),"Unified Marketing Analytics Platform"]})}),e.jsx("h1",{className:"text-center text-4xl font-bold tracking-tight text-white lg:text-left lg:text-6xl",children:e.jsx("span",{className:"block mb-2",children:"All Your Marketing Data,  One Place."})}),e.jsx("p",{className:"mt-6 text-center text-lg text-slate-200 lg:text-left",children:"Connect Shopify, Meta, Google Ads, and GA4 in one dashboard. Track performance, analyze conversions, and get automated email reports."}),e.jsxs("div",{className:"mt-8 flex flex-col items-center gap-4 sm:flex-row lg:justify-start",children:[e.jsx(Ze,{to:"/login",children:e.jsxs(z,{size:"lg",className:"w-full bg-white text-black hover:bg-blue-100 sm:w-auto",children:["Start Free Trial ",e.jsx(Ds,{className:"ml-2 h-4 w-4"})]})}),e.jsx(z,{size:"lg",variant:"outline",className:"w-full border-slate-800 text-black hover:bg-blue-100 sm:w-auto",children:"View Demo"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative rounded-2xl border border-slate-800 bg-[#0A0A1B] p-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#FF5F57]"}),e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#FFBD2E]"}),e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#28C840]"})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-slate-800/50 px-3 py-1",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-xs text-slate-300",children:"Last 30 days"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-300",children:"Analytics Overview"}),e.jsx(z,{variant:"outline",size:"sm",className:"border-slate-800",children:"Export"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-slate-100",children:[e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Revenue"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"$48.2K"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+12.4%"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Orders"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"2,567"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+8.2%"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Customers"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"1.2M"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+4.7%"})]})]}),e.jsx("div",{className:"h-[300px] rounded-lg bg-slate-800/30 p-4",children:e.jsx(Yn,{width:"100%",height:"100%",children:e.jsxs(wl,{data:Fd,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(Kn,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:12},interval:"preserveStartEnd"}),e.jsx(Qn,{axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:12},tickFormatter:s=>`$${s/1e3}k`}),e.jsx(Cl,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:2,fill:"url(#colorValue)"})]})})})]})]}),e.jsx("div",{className:"absolute -right-4 bottom-20",children:e.jsxs("div",{className:"rounded-2xl border border-green-500/20 bg-green-400/20 p-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-500",children:"New Milestone!"})]}),e.jsx("p",{className:"mt-1 text-xs text-green-300",children:"Revenue target achieved"})]})})]})]})})})]})}function xa(){const s=P(o=>o.user.user),a=fe(),t=Ke(),r=async()=>{try{(await re.post(`${Te}/api/auth/logout`,{},{withCredentials:!0})).status===200&&(a(Rt()),a(Dt()),t("/"))}catch(o){console.error("Error logging out:",o)}};return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container px-10 flex h-16 items-center justify-between",children:[e.jsx(Ze,{to:"/",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl",children:[e.jsx("img",{src:aa,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{children:"Parallels"})]})}),e.jsxs("nav",{className:"hidden md:flex gap-6",children:[e.jsx(Ze,{to:"#features",className:"text-sm font-medium hover:text-primary",children:"Features"}),e.jsx(Ze,{to:"#integrations",className:"text-sm font-medium hover:text-primary",children:"Integrations"}),e.jsx(Ze,{to:"#analytics",className:"text-sm font-medium hover:text-primary",children:"Analytics"})]}),e.jsx("div",{className:"flex items-center gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{to:"/dashboard",className:"text-sm font-medium hover:text-primary",children:"Dashboard"}),e.jsx(z,{variant:"outline",onClick:r,children:"Log Out"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{to:"/login",className:"text-sm font-medium hover:text-primary",children:"Log in"}),e.jsx(Ze,{to:"/login",children:e.jsx(z,{children:"Get Started"})})]})})]})})}function Td(){return e.jsxs("div",{className:"flex min-h-screen flex-col gradient-bg",children:[e.jsx(xa,{}),e.jsxs("main",{className:"flex-1",children:[e.jsx(Id,{}),e.jsx(kd,{}),e.jsx(wd,{})]}),e.jsx(fs,{})]})}function Md(){return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 text-slate-800",children:[e.jsx(xa,{}),e.jsx("div",{className:"max-w-4xl mx-auto p-6 my-5",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-center text-gray-900 mb-6",children:"Privacy Policy"}),Rl.map(s=>e.jsxs("section",{className:"mb-6 border-b pb-4 last:border-none",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:s.title}),s.content.map(a=>{var t;return typeof a=="string"?e.jsx("p",{className:"text-gray-700 mb-2",children:a},`${s.title}-${a.slice(0,20)}`):e.jsx("ul",{className:"list-disc pl-5 text-gray-700",children:a.map(r=>e.jsx("li",{children:r},`${s.title}-item-${r.slice(0,20)}`))},`${s.title}-list-${(t=a[0])==null?void 0:t.slice(0,20)}`)})]},s.title))]})}),e.jsx(fs,{})]})}function $d(){return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 text-slate-800",children:[e.jsx(xa,{}),e.jsx("div",{className:"max-w-4xl mx-auto p-6 my-5",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-center text-gray-900 mb-6",children:"Terms and Conditions"}),Dl.map(s=>e.jsxs("section",{className:"mb-6 border-b pb-4 last:border-none",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:s.title}),s.content.map(a=>{var t;return typeof a=="string"?e.jsx("p",{className:"text-gray-700 mb-2",children:a},`${s.title}-${a.slice(0,20)}`):e.jsx("ul",{className:"list-disc pl-5 text-gray-700",children:a.map(r=>e.jsx("li",{children:r},`${s.title}-item-${r.slice(0,20)}`))},`${s.title}-list-${(t=a[0])==null?void 0:t.slice(0,20)}`)})]},s.title))]})}),e.jsx(fs,{})]})}const Ld={green:{patternType:"solid",fgColor:{rgb:"DCFCE7"}},blue:{patternType:"solid",fgColor:{rgb:"DBEAFE"}},yellow:{patternType:"solid",fgColor:{rgb:"FEF9C3"}},red:{patternType:"solid",fgColor:{rgb:"FEF2F2"}},header:{patternType:"solid",fgColor:{rgb:"F1F5F9"}}},Ed=s=>{let a=0,t=0,r=0;return s.forEach(o=>{typeof o["Total Sessions"]=="number"&&typeof o["Avg Conv. Rate"]=="number"&&(a+=Number(o["Total Sessions"]),t+=Number(o["Avg Conv. Rate"]),r++)}),{avgSessions:a/r,avgConvRate:t/r}},Pd=(s,a,t,r,o)=>{if((s==="Sessions"||s==="Conv. Rate")&&typeof a=="number"&&typeof t=="number"){const l=a>=r.avgSessions,u=t>=r.avgConvRate;return l&&u?o.green:l&&!u?o.blue:!l&&u?o.yellow:o.red}},Od=(s,a,t,r,o,l,u,m)=>{const h=Rs.utils.decode_range(s["!ref"]||"A1");for(let d=h.s.c;d<=h.e.c;d++){const f=Rs.utils.encode_cell({r:0,c:d});s[f]||(s[f]={v:""}),s[f].s={fill:u.header,font:{bold:!0,color:{rgb:"64748B"}},alignment:{horizontal:"left"}}}a.forEach((d,f)=>{l.forEach((w,S)=>{const C=f*l.length+S+2,N=2,b=t.length+r.length+1;for(let v=N;v<=b;v++){const k=Rs.utils.encode_cell({r:C-1,c:v});s[k]||(s[k]={v:""});let g={font:{color:{rgb:"000000"}},alignment:{horizontal:"right"},format:w==="Conv. Rate"?"0.00%":"#,##0"},I,L;if(v<N+r.length)I=d["Total Sessions"],L=d["Avg Conv. Rate"];else{const y=v-(N+r.length),R=t[y],E=d[o].find(T=>`${T.Month.slice(0,4)}-${T.Month.slice(4)}`===R);E&&(I=E.Sessions,L=E["Conv. Rate"])}const M=Pd(w,I,L,m,u);M&&(g.fill=M),s[k].s=g}})})},Xe=({data:s,fileName:a,primaryColumn:t,secondaryColumns:r,monthlyDataKey:o,monthlyMetrics:l,buttonClassName:u="",disabled:m=!1})=>{const h=()=>{const d=Rs.utils.book_new(),f=[],w=Ed(s),S=Array.from(new Set(s.flatMap(v=>v[o].map(k=>`${k.Month.slice(0,4)}-${k.Month.slice(4)}`)))).sort().reverse(),C=[t,"Metric",...r,...S];f.push(C),s.forEach(v=>{l.forEach(k=>{const g=[];g.push(k===l[0]?v[t]:""),g.push(k),r.forEach(I=>{const L=v[I];g.push(typeof L=="number"?Number(L.toFixed(2)):null)}),S.forEach(I=>{const L=v[o].find(y=>`${y.Month.slice(0,4)}-${y.Month.slice(4)}`===I),M=L?L[k]:null;g.push(typeof M=="number"?Number(M.toFixed(2)):null)}),f.push(g)})});const N=Rs.utils.aoa_to_sheet(f);Od(N,s,S,r,o,l,Ld,w);const b=[{wch:20},{wch:12},...r.map(()=>({wch:15})),...S.map(()=>({wch:12}))];N["!cols"]=b,Rs.utils.book_append_sheet(d,N,"Conversion Data"),Rs.writeFile(d,`${a}.xlsx`)};return e.jsx(z,{id:"download-button",onClick:h,size:"icon",variant:"outline",className:u,disabled:m,children:e.jsx(nl,{className:"h-4 w-4"})})},Rd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="device-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=ke(),g=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",I=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await k.post(`/api/analytics/deviceTypeConversionReport/${b}`,{startDate:g,endDate:I,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,g,I,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=c=>{S(c.map(i=>String(i)))},E=()=>{y()},T="Device",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Device based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:E,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:R}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Dd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="gender-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/genderConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E="Gender",T=["Total Sessions","Avg Conv. Rate"],x="MonthlyData",F=["Sessions","Conv. Rate"],p=c=>{S(c.map(i=>String(i)))};return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Gender based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${E}_Conversion_Report`,primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:E,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:p}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,isFullScreen:d,locale:N,filter:w})]})})]})})},zd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(!1),[f,w]=n.useState([]),S=fe(),C="age-conversion",N=P(c=>c.conversionFilters[C]||{},_e),b=P(c=>c.locale.locale),{brandId:v}=pe(),k=()=>{d(!h)},g=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",I=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",L=ke(),M=n.useMemo(()=>Object.entries(N).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[N]),y=n.useCallback(async()=>{m(!0);try{const i=(await L.post(`/api/analytics/ageConversionReport/${v}`,{startDate:g,endDate:I,...M},{withCredentials:!0})).data||[];l(i)}catch(c){console.error("Error fetching data:",c)}finally{m(!1)}},[v,g,I,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&S(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&S(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const R=()=>{y()},E=c=>{w(c.map(i=>String(i)))},T="Age",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return u?e.jsx(Se,{isLoading:u}):e.jsx(oe,{id:"age-report",className:`${h?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Age based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(Le,{}),e.jsx(z,{id:"refresh",onClick:R,disabled:u,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx("div",{id:"filters",children:e.jsx(Ve,{componentId:C})}),e.jsx(Xe,{data:(o==null?void 0:o.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:u}),e.jsx(z,{id:"expand-button",onClick:k,size:"icon",variant:"outline",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(o==null?void 0:o.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(o==null?void 0:o.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:h,locale:b,filter:f})]})})]})})},Gd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="interest-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/interestConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=c=>{S(c.map(i=>String(i)))},E=()=>{y()},T="Interest",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Interest based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:E,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:R}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Bd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="operatingSystem-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/operatingSystemConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E=c=>{S(c.map(i=>String(i)))},T="Operating System",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Operating System based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},_d=({dateRange:s})=>{const a=P(A=>A.date.from),t=P(A=>A.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="browser-conversion",N=P(A=>A.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},{sessionsFilter:k,convRateFilter:g}=P(A=>A.conversionFilters[C]||{sessionsFilter:null,convRateFilter:null}),I=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",L=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",M=ke(),y=P(A=>A.conversionFilters[C]||{},_e),R=n.useMemo(()=>Object.entries(y).reduce((A,[G,O])=>{if(O){const D={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[G]||G;A[D]=O}return A},{}),[y]),E=n.useCallback(async()=>{h(!0);try{const G=(await M.post(`/api/analytics/browserConversionReport/${b}`,{startDate:I,endDate:L,sessionsFilter:k,convRateFilter:g})).data||[];u(G)}catch(A){console.error("Error fetching data:",A)}finally{h(!1)}},[b,I,L,R]);n.useEffect(()=>{E();const A=setInterval(E,3*60*60*1e3);return()=>clearInterval(A)},[E]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const T=()=>{E()},x=A=>{S(A.map(G=>String(G)))},F="Browser",p=["Total Sessions","Avg Conv. Rate"],c="MonthlyData",i=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{id:"browser-report",className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Browser based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(Le,{}),e.jsx(z,{id:"refresh",onClick:T,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx("div",{id:"filters",children:e.jsx(Ve,{componentId:C})}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${F}_Conversion_Report`,primaryColumn:F,secondaryColumns:p,monthlyDataKey:c,monthlyMetrics:i,disabled:m}),e.jsx(z,{id:"expand-button",onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:F,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:x}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:F,secondaryColumns:p,monthlyDataKey:c,monthlyMetrics:i,isFullScreen:d,locale:N,filter:w})]})})]})})},Ud=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),[o,l]=n.useState(null),[u,m]=n.useState(!0),[h,d]=n.useState(!1),[f,w]=n.useState([]),S=fe(),C="source-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{d(!h)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{m(!0);try{const i=(await I.post(`/api/analytics/sourceConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];l(i)}catch(c){console.error("Error fetching data:",c)}finally{m(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&S(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{h||s&&S(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[h,s]);const R=()=>{y()},E=c=>{w(c.map(i=>String(i)))},T="Source",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return u?e.jsx(Se,{isLoading:u}):e.jsx(oe,{id:"source-report",className:`${h?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Source based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(Le,{}),e.jsx(z,{id:"refresh",onClick:R,disabled:u,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${u?"animate-spin":""}`})}),e.jsx("div",{id:"filters",children:e.jsx(Ve,{componentId:C})}),e.jsx(Xe,{data:(o==null?void 0:o.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:u}),e.jsx(z,{id:"expand-button",onClick:v,size:"icon",variant:"outline",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(o==null?void 0:o.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(o==null?void 0:o.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:h,locale:N,filter:f})]})})]})})},Vd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="pageTitle-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/pageTitleConversionReport/${b}`,{startDate:k,endDate:g,...M},{withCredentials:!0})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E=c=>{S(c.map(i=>String(i)))},T="Page Title",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Page Title based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Hd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="pagePath-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/pagePathConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E=c=>{S(c.map(i=>String(i)))},T="Page Path",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Page path based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},qd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="landingPage-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/pageConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=c=>{S(c.map(i=>String(i)))},E=()=>{y()},T="Landing Page",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Landing Page based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:E,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:R}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Wd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="region-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/regionConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E=c=>{S(c.map(i=>String(i)))},T="Region",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Region based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Yd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="city-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/cityConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E="City",T=["Total Sessions","Avg Conv. Rate"],x="MonthlyData",F=["Sessions","Conv. Rate"],p=c=>{S(c.map(i=>String(i)))};return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"City based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${E}_Conversion_Report`,primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:E,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:p}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,isFullScreen:d,locale:N,filter:w})]})})]})})},Kd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="country-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/countryConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E="Country",T=["Total Sessions","Avg Conv. Rate"],x="MonthlyData",F=["Sessions","Conv. Rate"],p=c=>{S(c.map(i=>String(i)))};return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Country based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${E}_Conversion_Report`,primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:E,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:p}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,isFullScreen:d,locale:N,filter:w})]})})]})})},Qd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="campaign-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/campaignConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E="Campaign",T=["Total Sessions","Avg Conv. Rate"],x="MonthlyData",F=["Sessions","Conv. Rate"];if(m)return e.jsx(Se,{isLoading:m});const p=c=>{S(c.map(i=>String(i)))};return e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Campaign based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${E}_Conversion_Report`,primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:E,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:p}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:E,secondaryColumns:T,monthlyDataKey:x,monthlyMetrics:F,isFullScreen:d,locale:N,filter:w})]})})]})})},Zd=({dateRange:s})=>{const a=P(c=>c.date.from),t=P(c=>c.date.to),r=n.useMemo(()=>({from:a,to:t}),[a,t]),o=fe(),[l,u]=n.useState(null),[m,h]=n.useState(!0),[d,f]=n.useState(!1),[w,S]=n.useState([]),C="channel-conversion",N=P(c=>c.locale.locale),{brandId:b}=pe(),v=()=>{f(!d)},k=r!=null&&r.from?Y(r.from,"yyyy-MM-dd"):"",g=r!=null&&r.to?Y(r.to,"yyyy-MM-dd"):"",I=ke(),L=P(c=>c.conversionFilters[C]||{},_e),M=n.useMemo(()=>Object.entries(L).reduce((c,[i,A])=>{if(A){const G={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[i]||i;c[G]=A}return c},{}),[L]),y=n.useCallback(async()=>{h(!0);try{const i=(await I.post(`/api/analytics/channelConversionReport/${b}`,{startDate:k,endDate:g,...M})).data||[];u(i)}catch(c){console.error("Error fetching data:",c)}finally{h(!1)}},[b,k,g,M]);n.useEffect(()=>{y();const c=setInterval(y,3*60*60*1e3);return()=>clearInterval(c)},[y]),n.useEffect(()=>{s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),n.useEffect(()=>{d||s&&o(ie({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const R=()=>{y()},E=c=>{S(c.map(i=>String(i)))},T="Channel",x=["Total Sessions","Avg Conv. Rate"],F="MonthlyData",p=["Sessions","Conv. Rate"];return m?e.jsx(Se,{isLoading:m}):e.jsx(oe,{className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(de,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Channel based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(ge,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(Le,{}),e.jsx(z,{onClick:R,disabled:m,size:"icon",variant:"outline",children:e.jsx(je,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(Xe,{data:(l==null?void 0:l.data)||[],fileName:`${T}_Conversion_Report`,primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,disabled:m}),e.jsx(z,{onClick:v,size:"icon",variant:"outline",children:d?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{children:[e.jsx($e,{data:(l==null?void 0:l.data)||[],primaryColumn:T,metricConfig:Me.sessionsAndConversion||{},onCategoryFilter:E}),e.jsx(Ce,{data:(l==null?void 0:l.data)||[],primaryColumn:T,secondaryColumns:x,monthlyDataKey:F,monthlyMetrics:p,isFullScreen:d,locale:N,filter:w})]})})]})})},Jd=()=>{const s=P(S=>S.date.from),a=P(S=>S.date.to),t=n.useMemo(()=>({from:s,to:a}),[s,a]),{brandId:r}=pe(),l=P(S=>S.brand.brands).find(S=>S._id===r),u=(l==null?void 0:l.ga4Account)??!1,{tokenError:m}=Yc(),[h,d]=n.useState("age"),f=[{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Interest",value:"interest"},{label:"Device",value:"device"},{label:"Operating System",value:"operatingSystem"},{label:"Browser",value:"browser"},{label:"Source",value:"source"},{label:"Channel",value:"channel"},{label:"Campaign",value:"campaign"},{label:"Country",value:"country"},{label:"City",value:"city"},{label:"Region",value:"region"},{label:"Landing Page",value:"landingPage"},{label:"Page Path",value:"pagePath"},{label:"Page Title",value:"pageTitle"}],w=S=>{d(S)};return m?e.jsx(ys,{platform:"Google Analytics",message:"We need access to your Google Analytics account to show you amazing insights about your website performance.",icon:e.jsx(qn,{className:"w-8 h-8 text-blue-600"}),loginOptions:[{label:"Connect Google Analytics",context:"googleAnalyticsSetup",provider:"google"}]}):u?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col",children:!t.from||!t.to?e.jsx(gt,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(vs,{title:"Conversion Lens",Icon:rl,showDatePicker:!0}),e.jsx("div",{id:"report-tab",className:"bg-white px-6 sticky top-0 z-10 w-full",children:e.jsx(Bt,{tabs:f,activeTab:h,onTabChange:w})})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[h==="age"&&e.jsx("div",{id:"age-conversion-report",children:e.jsx(zd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(Dd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="interest"&&e.jsx("div",{id:"interest",children:e.jsx(Gd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="device"&&e.jsx("div",{id:"device",children:e.jsx(Rd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="operatingSystem"&&e.jsx("div",{id:"operatingSystem",children:e.jsx(Bd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="browser"&&e.jsx("div",{id:"browser",children:e.jsx(_d,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="source"&&e.jsx("div",{id:"source",children:e.jsx(Ud,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="channel"&&e.jsx("div",{id:"channel",children:e.jsx(Zd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="campaign"&&e.jsx("div",{id:"campaign",children:e.jsx(Qd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="country"&&e.jsx("div",{id:"country",children:e.jsx(Kd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="city"&&e.jsx("div",{id:"city",children:e.jsx(Yd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="region"&&e.jsx("div",{id:"region",children:e.jsx(Wd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="landingPage"&&e.jsx("div",{id:"landingPage",children:e.jsx(qd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="pagePath"&&e.jsx("div",{id:"pagePath",children:e.jsx(Hd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})}),h==="pageTitle"&&e.jsx("div",{id:"pageTitle",children:e.jsx(Vd,{dateRange:{from:t.from?new Date(t.from):void 0,to:t.to?new Date(t.to):void 0}})})]}),e.jsx(fs,{}),e.jsx(As,{})]})]})})]}):e.jsx(st,{platform:"google analytics",brandId:r??"",onSuccess:(S,C,N)=>{console.log(`Successfully connected ${S} account: ${C} (${N})`)}})},Pa=["bg-red-100 text-red-800 border border-red-200 hover:bg-red-200","bg-blue-100 text-blue-800 border border-blue-200 hover:bg-blue-200","bg-green-100 text-green-800 border border-green-200 hover:bg-green-200","bg-yellow-100 text-yellow-800 border border-yellow-200 hover:bg-yellow-200","bg-purple-100 text-purple-800 border border-purple-200 hover:bg-purple-200","bg-pink-100 text-pink-800 border border-pink-200 hover:bg-pink-200","bg-indigo-100 text-indigo-800 border border-indigo-200 hover:bg-indigo-200","bg-orange-100 text-orange-800 border border-orange-200 hover:bg-orange-200"],Oa="85px",Ra=({data:s,height:a,type:t})=>{const r=fe(),[o,l]=n.useState(null),[u,m]=n.useState(null),[h,d]=n.useState(!1),[f,w]=n.useState(null),[S,C]=n.useState(null),[N,b]=n.useState(null),[v,k]=n.useState(""),[g,I]=n.useState(!1),[L,M]=n.useState([]),[y,R]=n.useState([]),[E,T]=n.useState(["Campaign","Labels"]),[x,F]=n.useState(0),p=n.useRef(null);n.useEffect(()=>{T(V=>["Campaign","Labels",...V.filter(q=>q!=="Campaign"&&q!=="Labels")])},[]);const[c,i]=n.useState(!0),[A,G]=n.useState([]),[O,D]=n.useState([]),[j,_]=n.useState("all"),W=n.useRef(null),Z=n.useRef({}),Q=n.useRef(null),{labels:U}=P(V=>V.campaignLabels),K=n.useMemo(()=>s.account_id?U[s.account_id]||{}:{},[U,s.account_id]),J=["TOFU","MOFU","BOFU","TOFU+MOFU"],H=n.useMemo(()=>{const V=new Set;return Object.values(K).forEach(le=>{le==null||le.forEach(q=>{V.add(q)})}),Array.from(V)},[K]),B=n.useMemo(()=>H.length>0,[H]),te=V=>j==="all"?V:V.filter(le=>{const q=le.status||le.Status||"",xe=String(q).toLowerCase();return j==="active"?xe==="active":xe==="paused"}),me=n.useMemo(()=>te(s.campaigns),[s.campaigns,j]);n.useEffect(()=>{if(s.campaigns.length>0){const le=Object.keys(s.campaigns[0]).filter(ue=>ue!=="Labels"&&ue!=="campaignId"&&ue!=="accountId"&&ue!=="accountName"),q=[...le,"Labels"];M(q);const ne=["Campaign","Labels",...[...le].filter(ue=>ue!=="Campaign"&&ue!=="campaignName"&&ue!=="Labels")];R(ne)}},[s.campaigns]),n.useEffect(()=>{if(c&&B){const V={};H.forEach(xe=>{V[xe]=[]});const le=[];me.forEach(xe=>{const ne=K[xe.campaignId]||[];ne.length>0?ne.forEach(ue=>{V[ue].push(xe)}):le.push(xe)});const q=Object.entries(V).filter(([,xe])=>xe.length>0).map(([xe,ne])=>({label:xe,campaigns:ne,isExpanded:!0}));G(q),D(le)}else G([]),D(me)},[me,K,c,B,H]);const $=es.useMemo(()=>{const V=new Map;let le=0;return H.forEach(q=>{V.set(q,Pa[le%Pa.length]),le++}),V},[H]),ee=V=>{let le=0;const q=y.filter(xe=>L.includes(xe));for(let xe=0;xe<V;xe++){const ne=q[xe];if(E.includes(ne)){const ue=Z.current[ne];ue&&(le+=ue.offsetWidth)}}return le},X=V=>{if(x<=0)return!1;const q=y.filter(ne=>L.includes(ne)).filter(ne=>E.includes(ne));if(q.length===0)return!1;const xe=q[q.length-1];return V===xe},ae=V=>X(V)?"relative after:content-[''] after:absolute after:right-0 after:top-0 after:bottom-0 after:w-[3px] after:bg-gradient-to-r after:from-slate-400 after:to-transparent after:shadow-lg before:content-[''] before:absolute before:right-0 before:top-0 before:bottom-0 before:w-[1px] before:bg-slate-300":"",he=(V,le)=>{le&&r(Ii({accountId:s.account_id,campaignId:V,label:le}))},Ne=(V,le)=>{r(Ti({accountId:s.account_id,campaignId:V,label:le}))},Fe=V=>{v&&(he(V,v),k(""),b(null))},Ee=V=>V==="Campaign"?{width:"auto",minWidth:"200px"}:V==="Labels"?{width:"auto",minWidth:"150px"}:{width:Oa,minWidth:Oa},Ge=V=>{l(V)},rs=(V,le)=>{V.preventDefault(),le!==o&&m(le)},os=V=>{!o||o===V||(l(null),m(null),console.log(`Dragged ${o} and dropped on ${V}`))},Es=()=>{l(null),m(null)},Ns=V=>{w(V)},gs=(V,le)=>{V.preventDefault(),le!==f&&C(le)},Rr=V=>{if(!f||f===V)return;const le=y.indexOf(f),q=y.indexOf(V);if(le!==-1&&q!==-1){const xe=[...y];xe.splice(le,1),xe.splice(q,0,f),R(xe)}w(null),C(null)},Dr=()=>{w(null),C(null)},zr=()=>{d(!h)},Gr=V=>{const le=[...A];le[V].isExpanded=!le[V].isExpanded,G(le)},fa=V=>{const le={},q=y.filter(ne=>L.includes(ne)&&ne!=="Campaign"&&ne!=="Labels"),xe={"Conversion Rate":(ne,ue)=>{const Ie=ue.reduce((we,ze)=>we+Number(ze["Link Click"]||0),0),De=ue.reduce((we,ze)=>we+Number(ze.Purchases||0),0);return Ie===0?0:De/Ie*100},"CPM (Reach Based)":(ne,ue)=>{const Ie=ue.reduce((we,ze)=>we+Number(ze.Reach||0),0);return ue.reduce((we,ze)=>we+Number(ze["Amount spend"]||0),0)/(Ie/1e3)},"Audience Saturation Score":(ne,ue)=>{const Ie=ue.reduce((we,ze)=>we+Number(ze["Outbound CTR"]||0),0),De=ue.reduce((we,ze)=>we+Number(ze.Frequency||0),0);return Ie===0?0:De/Ie*100},"Reach v/s Unique Click":(ne,ue)=>{const Ie=ue.reduce((we,ze)=>we+Number(ze["Unique Link Click"]||0),0),De=ue.reduce((we,ze)=>we+Number(ze.Reach||0),0);return Ie===0?0:De/Ie},"High-Intent Click Rate":(ne,ue)=>{const Ie=ue.reduce((Ps,Os)=>Ps+Number(Os["Add To Cart (ATC)"]||0),0),De=ue.reduce((Ps,Os)=>Ps+Number(Os["Checkout Initiate (CI)"]||0),0),ls=ue.reduce((Ps,Os)=>Ps+Number(Os["Landing Page View"]||0),0),we=ue.reduce((Ps,Os)=>Ps+Number(Os["Link Click"]||0),0);return we===0?0:(Ie+De+ls)/we*100},HookRate:(ne,ue)=>{const Ie=ue.reduce((we,ze)=>we+Number(ze["Three Seconds View"]||0),0),De=ue.reduce((we,ze)=>we+Number(ze.Impressions||0),0);return De===0?0:Ie/De*100},DEFAULT:(ne,ue)=>ne.reduce((Ie,De)=>Ie+De,0)};return q.forEach(ne=>{const ue=V.map(De=>Number(De[ne]||0)).filter(De=>!isNaN(De)),Ie=xe[ne]||xe.DEFAULT;le[ne]=Ie(ue,V).toFixed(2)}),le},Br=()=>h?"max-h-[calc(100vh-100px)]":a,ga=V=>{const le=K[V.campaignId]||[];return e.jsxs(Ys,{children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"h-7 w-full justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 overflow-hidden",children:[e.jsx(Rn,{className:"h-3.5 w-3.5 text-slate-500 shrink-0"}),e.jsx("span",{className:"truncate",children:le.length>0?`${le.length} label${le.length>1?"s":""}`:"Add label"})]}),e.jsx(Zs,{className:"h-3.5 w-3.5 opacity-70"})]})}),e.jsx(Bs,{align:"start",className:"w-56",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-2",children:"Predefined labels"}),J.map(q=>{const xe=le.includes(q);return e.jsx(ps,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{xe?Ne(V.campaignId,q):he(V.campaignId,q)},children:e.jsx(js,{className:"bg-slate-100 text-slate-800 border border-slate-200 hover:bg-slate-200 text-xs py-0.5 px-2 w-full",children:q})},q)}),H.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(wt,{}),e.jsx("div",{className:"text-xs font-medium text-slate-500 my-2",children:"Custom labels"}),H.filter(q=>!J.includes(q)).map(q=>{const xe=le.includes(q);return e.jsx(ps,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{xe?Ne(V.campaignId,q):he(V.campaignId,q)},children:e.jsx(js,{className:`${$.get(q)} text-xs py-0.5 px-2`,children:q})},q)})]}),e.jsx(wt,{}),N===V.campaignId?e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1",children:[e.jsx(Pe,{ref:Q,value:v,onChange:q=>k(q.target.value),placeholder:"New label name",className:"h-7 text-xs",autoFocus:!0,onKeyDown:q=>{q.key==="Enter"?Fe(V.campaignId):q.key==="Escape"&&(b(null),k(""))}}),e.jsx(z,{size:"sm",className:"h-7 px-2",onClick:()=>Fe(V.campaignId),children:e.jsx(Qs,{className:"h-3.5 w-3.5"})})]}):e.jsxs(ps,{className:"flex items-center gap-2 cursor-pointer",onClick:q=>{q.preventDefault(),b(V.campaignId),k(""),setTimeout(()=>{var xe;(xe=Q.current)==null||xe.focus()},0)},children:[e.jsx(Ct,{className:"h-3.5 w-3.5 text-slate-500"}),e.jsx("span",{className:"text-sm",children:"Create new label"})]})]})})]})};return n.useEffect(()=>()=>{p.current&&clearTimeout(p.current)},[]),e.jsx(et,{children:e.jsxs(oe,{className:`overflow-hidden ${h?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{height:"1rem",width:"1rem"}),e.jsxs("div",{className:"text-base font-semibold text-slate-800",children:["Campaign Performance ",e.jsxs("span",{children:["(",s.account_name,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ys,{children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:`gap-1 font-medium ${j!=="all"?"bg-blue-50 text-blue-600 border-blue-200":""}`,children:[e.jsx(Ms,{className:`h-4 w-4 ${j!=="all"?"text-blue-600":"text-slate-500"}`}),j==="all"?"All Status":j==="active"?"Active":"Paused"]})}),e.jsxs(Bs,{align:"end",className:"w-32",children:[e.jsx(ps,{onClick:()=>_("all"),className:j==="all"?"bg-blue-50":"",children:"All Status"}),e.jsx(ps,{onClick:()=>_("active"),className:j==="active"?"bg-blue-50":"",children:"Active"}),e.jsx(ps,{onClick:()=>_("paused"),className:j==="paused"?"bg-blue-50":"",children:"Paused"})]})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(z,{variant:"outline",onClick:()=>I(!g),size:"sm",className:`gap-1 font-medium ${g?"bg-blue-50 text-blue-600 border-blue-200":""}`,disabled:!c,children:e.jsx(ol,{className:`h-4 w-4 ${g?"text-blue-600":"text-slate-500"}`})})}),e.jsx(Ye,{children:g?"Exit Edit Mode":"Edit Labels"})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(z,{variant:"outline",onClick:()=>i(!c),size:"sm",className:"gap-1 font-medium",children:c?e.jsx(e.Fragment,{children:e.jsx(ba,{className:"h-4 w-4 text-blue-600"})}):e.jsx(e.Fragment,{children:e.jsx(ba,{className:"h-4 w-4 text-slate-500"})})})}),e.jsx(Ye,{children:c?"Disable Grouping":"Enable Grouping"})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx("div",{children:e.jsx(Gt,{visibleColumns:L,columnOrder:y,frozenColumns:E,onVisibilityChange:M,onOrderChange:R,onFrozenChange:T})})}),e.jsx(Ye,{children:"Manage Columns"})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",onClick:zr,className:"font-medium",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})}),e.jsx(Ye,{children:h?"Exit Fullscreen":"Enter Fullscreen"})]})]})]}),e.jsx("div",{className:"p-3",children:e.jsx("div",{ref:W,className:`overflow-auto ${Br()} bg-white rounded-lg border border-slate-200 shadow-sm`,onScroll:V=>{const q=V.target.scrollLeft;F(q),p.current&&clearTimeout(p.current)},children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:y.filter(V=>L.includes(V)).filter(V=>!c||V!=="campaignName").map((V,le)=>{const q=E.includes(V),xe=q?`${ee(le)}px`:void 0,ne=Ee(V);return e.jsx("th",{ref:ue=>Z.current[V]=ue,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${q?"sticky z-20 bg-slate-50":""} ${S===V?"bg-blue-50":""} ${ae(V)}`,style:{left:xe,...ne},draggable:!0,onDragStart:()=>Ns(V),onDragOver:ue=>gs(ue,V),onDrop:()=>Rr(V),onDragEnd:Dr,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:V}),e.jsx(Wn,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},V)})})}),e.jsxs("tbody",{children:[c&&A.map((V,le)=>e.jsxs(es.Fragment,{children:[e.jsx("tr",{className:"bg-gradient-to-r from-slate-100 to-slate-50 font-medium hover:bg-slate-100 transition-colors",children:y.filter(q=>L.includes(q)).filter(q=>!c||q!=="campaignName").map((q,xe)=>{const ne=E.includes(q),ue=ne?`${ee(xe)}px`:void 0,Ie=Ee(q),De=fa(V.campaigns);return q==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50 ${ae(q)}`,style:{left:ue,...Ie},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>Gr(le),className:"mr-2 focus:outline-none rounded-full p-0.5 hover:bg-slate-200 transition-colors",children:V.isExpanded?e.jsx(Zs,{className:"h-4 w-4 text-slate-600"}):e.jsx(Ss,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("span",{className:"font-medium text-slate-700",children:["Group: ",V.campaigns.length," campaigns"]})]})},q):q==="Labels"?e.jsx("td",{className:`p-2 border-r ${ne?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"} ${ae(q)}`,style:{left:ue,...Ie},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(js,{className:`${$.get(V.label)} w-fit flex items-center gap-1 cursor-default text-xs py-0.5 px-2 rounded-md`,children:V.label}),g&&e.jsx(z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-red-50",onClick:()=>{V.campaigns.forEach(ls=>{Ne(ls.campaignId,V.label)})},children:e.jsx(xs,{className:"h-3.5 w-3.5 text-red-500"})})]})},q):e.jsx("td",{className:`p-2 border-r ${ne?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"} font-semibold`,style:{left:ue,...Ie},children:e.jsx("div",{children:De[q]})},q)})}),V.isExpanded&&V.campaigns.map((q,xe)=>e.jsx("tr",{className:`border-b border-2 hover:bg-slate-50 transition-colors ${u===q.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>Ge(q.campaignName),onDragOver:ne=>rs(ne,q.campaignName),onDrop:()=>os(q.campaignName),onDragEnd:Es,children:y.filter(ne=>L.includes(ne)).filter(ne=>!c||ne!=="campaignName").map((ne,ue)=>{const Ie=E.includes(ne),De=Ie?`${ee(ue)}px`:void 0,ls=Ee(ne);return ne==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky bg-white z-10 ${ae(ne)}`,style:{left:De,paddingLeft:"30px",...ls},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium",children:q.campaignName}),t==="blended-summary"&&q.accountName&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded whitespace-nowrap",children:q.accountName})]})},ne):ne==="Labels"?e.jsx("td",{className:`p-2 border-r ${Ie?"sticky z-10 bg-white":""} ${ae(ne)}`,style:{left:De,...ls},children:g&&c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(js,{className:`${$.get(V.label)} w-fit flex items-center gap-1 text-xs py-0.5 px-2 rounded-md`,children:V.label}),e.jsx(z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-red-50",onClick:()=>Ne(q.campaignId,V.label),children:e.jsx(xs,{className:"h-3.5 w-3.5 text-red-500"})}),e.jsxs(Ys,{children:[e.jsx(Ks,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",className:"h-7",children:"Change"})}),e.jsx(Bs,{align:"start",className:"w-56",children:e.jsxs("div",{className:"p-2",children:[H.filter(we=>we!==V.label).map(we=>e.jsx(ps,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{Ne(q.campaignId,V.label),he(q.campaignId,we)},children:e.jsx(js,{className:`${$.get(we)} text-xs py-0.5 px-2`,children:we})},we)),e.jsx(wt,{}),e.jsxs(ps,{className:"flex items-center gap-2 cursor-pointer",onClick:we=>{we.preventDefault(),b(q.campaignId),k(""),setTimeout(()=>{var ze;(ze=Q.current)==null||ze.focus()},0)},children:[e.jsx(Ct,{className:"h-3.5 w-3.5 text-slate-500"}),e.jsx("span",{className:"text-sm",children:"Create new label"})]}),N===q.campaignName&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 mt-2",children:[e.jsx(Pe,{ref:Q,value:v,onChange:we=>k(we.target.value),placeholder:"New label name",className:"h-7 text-xs",autoFocus:!0,onKeyDown:we=>{we.key==="Enter"?(Fe(q.campaignId),Ne(q.campaignId,V.label)):we.key==="Escape"&&(b(null),k(""))}}),e.jsx(z,{size:"sm",className:"h-7 px-2",onClick:()=>{Fe(q.campaignId),Ne(q.campaignId,V.label)},children:e.jsx(Qs,{className:"h-3.5 w-3.5"})})]})]})})]})]}):ga(q)},ne):e.jsx("td",{className:`p-2 border-r ${Ie?"sticky z-10 bg-white":""} ${ae(ne)}`,style:{left:De,...ls},children:e.jsx("div",{children:q[ne]})},ne)})},`group-${V.label}-campaign-${q.campaignId}-${xe}`))]},`group-${V.label}`)),c&&O.length>0&&e.jsx("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-50 font-medium hover:bg-gray-100 transition-colors",children:y.filter(V=>L.includes(V)).filter(V=>!c||V!=="campaignName").map((V,le)=>{const q=E.includes(V),xe=q?`${ee(le)}px`:void 0,ne=Ee(V);if(V==="Campaign")return e.jsx("td",{className:`p-2 border-r sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50 ${ae(V)}`,style:{left:xe,...ne},children:e.jsxs("div",{className:"font-medium text-slate-700 flex items-center",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2 text-slate-500"}),"Unlabeled: ",O.length," campaigns"]})},V);if(V==="Labels")return e.jsx("td",{className:`p-2 border-r ${q?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":""} ${ae(V)}`,style:{left:xe,...ne},children:"-"},V);const ue=fa(O);return e.jsx("td",{className:`p-2 border-r ${q?"sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50":"bg-gradient-to-r from-gray-100 to-gray-50"} font-semibold`,style:{left:xe,...ne},children:e.jsx("div",{children:ue[V]})},V)})}),(c?O:me).map((V,le)=>e.jsx("tr",{className:`border-b border-2 hover:bg-slate-50 transition-colors ${u===V.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>Ge(V.campaignName),onDragOver:q=>rs(q,V.campaignName),onDrop:()=>os(V.campaignName),onDragEnd:Es,children:y.filter(q=>L.includes(q)).filter(q=>!c||q!=="campaignName").map((q,xe)=>{const ne=E.includes(q),ue=ne?`${ee(xe)}px`:void 0,Ie=Ee(q);return q==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky z-10 bg-white ${ae(q)}`,style:{left:ue,...Ie},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium",children:V.campaignName}),t==="blended-summary"&&V.accountName&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded whitespace-nowrap",children:V.accountName})]})},q):q==="Labels"?e.jsx("td",{className:`p-2 border-r ${ne?"sticky z-10 bg-white":""} ${ae(q)}`,style:{left:ue,...Ie},children:ga(V)},q):e.jsx("td",{className:`p-2 border-r ${ne?"sticky z-10 bg-white":""} ${ae(q)}`,style:{left:ue,...Ie},children:e.jsx("div",{children:V[q]})},q)})},`${c?"ungrouped":"all"}-${V.campaignName}-${le}`))]})]})})})]})})};function Xd(){const[s,a]=n.useState(!1),[t,r]=n.useState(),o=P(g=>g.date.from),l=P(g=>g.date.to),u=n.useMemo(()=>({from:o,to:l}),[o,l]),m=ke(),{brandId:h}=pe(),f=P(g=>g.brand.brands).find(g=>g._id===h),w=!!(f!=null&&f.fbAdAccounts&&(f==null?void 0:f.fbAdAccounts.length)>0),S=P(la),C=Ke(),N=n.useCallback(async()=>{var g;a(!0);try{const I=u!=null&&u.from?Y(u.from,"yyyy-MM-dd"):"",L=u!=null&&u.to?Y(u.to,"yyyy-MM-dd"):"";try{const y=(await m.post(`/api/meta/campaign/${h}`,{startDate:I,endDate:L},{withCredentials:!0})).data;r(y)}catch(M){console.error("Error fetching Facebook ad data:",M)}}catch(I){console.error("Error fetching ad data:",I),re.isAxiosError(I)&&((g=I.response)==null?void 0:g.status)===401&&(alert("Your session has expired. Please log in again."),C("/"))}finally{a(!1)}},[C,u,h]);n.useEffect(()=>{N()},[N]),n.useEffect(()=>{N();const g=setInterval(N,3*60*60*1e3);return()=>clearInterval(g)},[N]),n.useEffect(()=>{console.log("meta campaign",t)},[]);const b=t==null?void 0:t.blendedSummary,v=t==null?void 0:t.accountData;let k="";return t!=null&&t.blendedSummary&&(t==null?void 0:t.blendedSummary.length)>1?k="max-h-[calc(100vh-400px)]":k="max-h-[calc(100vh-210px)]",e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(vs,{title:"Meta Campaign Trends",Icon:Mt,showDatePicker:!0}),S?e.jsx(ys,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):w?!u.from||!u.to?e.jsx(gt,{}):s?e.jsx(Se,{isLoading:s}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-none"}),e.jsx("main",{className:"p-4 md:p-6 lg:px-8 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[b&&b.length>0&&e.jsx(Ra,{data:{account_name:"Blended Summary",account_id:"blended_summary",campaigns:b.map(g=>({...g,Campaign:g.campaignName}))},height:k,type:"blended-summary"}),v&&v.map(g=>e.jsx(Ra,{data:{account_name:g.account_name,account_id:g.account_id,campaigns:g.campaigns.map(I=>({...I,Campaign:I.campaignName}))},height:k},g.account_id))]})})]}):e.jsx(e.Fragment,{children:e.jsx(st,{platform:"facebook",brandId:h??"",onSuccess:(g,I,L)=>{console.log(`Successfully connected ${g} account: ${I} (${L})`)}})}),e.jsx(fs,{}),e.jsx(As,{})]})]})}const em=({columns:s,tableId:a})=>{const t=fe(),r=P(w=>w.interestFilter.filters[a]||[]),[o,l]=n.useState(!1),[u,m]=n.useState({column:s[0],operator:">",value:""}),h=()=>{u.value&&(t(Bi({tableId:a,filter:{...u,value:u.column==="Interest"?u.value:Number(u.value)}})),m({...u,value:""}),l(!1))},d=w=>{t(_i({tableId:a,index:w}))},f=()=>{t(Ui({tableId:a}))};return e.jsxs($s,{open:o,onOpenChange:l,children:[e.jsx(Ls,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(Ms,{className:"h-4 w-4"}),r.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:r.length})]})}),e.jsx(ks,{className:"w-80",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(us,{value:u.column,onValueChange:w=>m({...u,column:w}),children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Select column"})}),e.jsx(cs,{children:s.map(w=>e.jsx(Oe,{value:w,children:w},w))})]}),e.jsxs(us,{value:u.operator,onValueChange:w=>m({...u,operator:w}),children:[e.jsx(is,{children:e.jsx(hs,{placeholder:"Operator"})}),e.jsxs(cs,{children:[e.jsx(Oe,{value:">",children:">"}),e.jsx(Oe,{value:"<",children:"<"}),e.jsx(Oe,{value:"=",children:"="}),e.jsx(Oe,{value:">=",children:">="}),e.jsx(Oe,{value:"<=",children:"<="})]})]}),e.jsx(Pe,{type:u.column==="Interest"?"text":"number",value:u.value,onChange:w=>m({...u,value:w.target.value}),placeholder:"Enter value"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{onClick:h,className:"flex-1",children:"Add Filter"}),e.jsx(z,{variant:"outline",onClick:f,className:"flex-1",children:"Clear All"})]}),r.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Active Filters"}),r.map((w,S)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 rounded-md",children:[e.jsxs("div",{className:"flex-1 text-sm",children:[w.column," ",w.operator," ",w.value]}),e.jsx(z,{variant:"ghost",size:"icon",onClick:()=>d(S),className:"h-6 w-6",children:e.jsx(xs,{className:"h-3 w-3"})})]},S))]})]})})]})},Da="100px",za=({data:s,height:a="max-h-96",accountName:t,showAccounts:r=!1})=>{var H;const[o,l]=n.useState(null),[u,m]=n.useState(null),[h,d]=n.useState(!1),[f,w]=n.useState(null),[S,C]=n.useState(null),N=P(B=>B.interestFilter.filters[t||"blended"]||[]),[b,v]=n.useState(r?["Interest","Spend","Revenue","Roas","accounts"]:["Interest","Spend","Revenue","Roas"]),[k,g]=n.useState(r?["Interest","Spend","Revenue","Roas","accounts"]:["Interest","Spend","Revenue","Roas"]),[I,L]=n.useState(["Interest"]),M=n.useRef(null),y=n.useRef({}),R=B=>B.filter(te=>N.every(me=>{const $=te[me.column],ee=me.value;switch(me.operator){case">":return Number($)>Number(ee);case"<":return Number($)<Number(ee);case"=":return String($).toLowerCase()===String(ee).toLowerCase();case">=":return Number($)>=Number(ee);case"<=":return Number($)<=Number(ee);default:return!0}})),E=t?((H=s.resultsByAccount[t])==null?void 0:H.interestMetrics)||[]:s.blendedSummary||[],T=R(E),x=t||"All Accounts",F=B=>{let te=0;const me=k.filter($=>b.includes($));for(let $=0;$<B;$++){const ee=me[$];if(I.includes(ee)){const X=y.current[ee];X&&(te+=X.offsetWidth)}}return te},p=B=>B==="Interest"?{width:"auto",minWidth:"200px"}:B==="accounts"?{width:"auto",minWidth:"120px"}:{width:Da,minWidth:Da},c=B=>{l(B)},i=(B,te)=>{B.preventDefault(),te!==o&&m(te)},A=B=>{!o||o===B||(l(null),m(null),console.log(`Dragged ${o} and dropped on ${B}`))},G=()=>{l(null),m(null)},O=B=>{w(B)},D=(B,te)=>{B.preventDefault(),te!==f&&C(te)},j=B=>{if(!f||f===B)return;const te=k.indexOf(f),me=k.indexOf(B);if(te!==-1&&me!==-1){const $=[...k];$.splice(te,1),$.splice(me,0,f),g($)}w(null),C(null)},_=()=>{w(null),C(null)},W=()=>{d(!h)},Z=()=>h?"max-h-screen":a,Q=B=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(B),U=B=>B.toFixed(2)+"x",K=B=>!B||B.length===0?"-":B.length<=2?B.join(", "):`${B[0]}, ${B[1]} +${B.length-2} more`,J=(B,te)=>{switch(te){case"Interest":return B.Interest;case"Spend":return Q(B.Spend);case"Revenue":return Q(B.Revenue);case"Roas":return U(B.Roas);case"accounts":return K(B.accounts);default:return B[te]||"-"}};return!E||E.length===0?e.jsx(oe,{className:"p-4",children:e.jsx("div",{className:"text-center text-slate-500",children:"No interest data available"})}):e.jsx(et,{children:e.jsxs(oe,{className:`overflow-hidden ${h?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{height:"1rem",width:"1rem"}),e.jsxs("div",{className:"text-base font-semibold text-slate-800",children:["Interest Performance ",e.jsxs("span",{children:["(",x,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(em,{columns:b,tableId:t||"blended"})}),e.jsx(Ye,{children:"Apply Filter"})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",onClick:W,className:"font-medium",children:h?e.jsx(ve,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})}),e.jsx(Ye,{children:h?"Exit Fullscreen":"Enter Fullscreen"})]}),e.jsxs(Je,{children:[e.jsx(ss,{asChild:!0,children:e.jsx("div",{children:e.jsx(Gt,{visibleColumns:b,columnOrder:k,frozenColumns:I,onVisibilityChange:v,onOrderChange:g,onFrozenChange:L})})}),e.jsx(Ye,{children:"Manage Columns"})]})]})]}),e.jsx("div",{className:"p-3",children:e.jsx("div",{ref:M,className:`overflow-auto ${Z()} bg-white rounded-lg border border-slate-200 shadow-sm `,children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:k.filter(B=>b.includes(B)).map((B,te)=>{const me=I.includes(B),$=me?`${F(te)}px`:void 0,ee=p(B);return e.jsx("th",{ref:X=>y.current[B]=X,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${me?"sticky z-20 bg-slate-50":""} ${S===B?"bg-blue-50":""}`,style:{left:$,...ee},draggable:!0,onDragStart:()=>O(B),onDragOver:X=>D(X,B),onDrop:()=>j(B),onDragEnd:_,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:B}),e.jsx(Wn,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},B)})})}),e.jsx("tbody",{children:T.map(B=>e.jsx("tr",{className:`border-b hover:bg-slate-50 transition-colors ${u===B.InterestId?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>c(B.InterestId),onDragOver:te=>i(te,B.InterestId),onDrop:()=>A(B.InterestId),onDragEnd:G,children:k.filter(te=>b.includes(te)).map((te,me)=>{const $=I.includes(te),ee=$?`${F(me)}px`:void 0,X=p(te);return e.jsx("td",{className:`p-2 border-b border-r text-slate-700 ${$?"sticky z-10 bg-inherit":""}`,style:{left:ee,...X},children:J(B,te)},`${B.InterestId}-${te}`)})},B.InterestId))})]})})})]})})};function sm(){var y;const[s,a]=n.useState(!1),[t,r]=n.useState(null),[o,l]=n.useState(null),u=P(R=>R.brand.brands),{brandId:m}=pe(),h=u.find(R=>R._id===m),d=!!(h!=null&&h.fbAdAccounts&&(h==null?void 0:h.fbAdAccounts.length)>0),f=P(la),w=P(R=>R.date.from),S=P(R=>R.date.to),C=n.useMemo(()=>({from:w,to:S}),[w,S]),N=ke(),b=Ke(),v=n.useCallback(async()=>{var R,E,T;if(!(!C.from||!C.to)){a(!0),l(null);try{const x=Y(C.from,"yyyy-MM-dd"),F=Y(C.to,"yyyy-MM-dd"),p=await N.post(`/api/meta/interest/${m}`,{startDate:x,endDate:F},{withCredentials:!0});console.log("API Response:",p.data),p.data&&p.data.data?r(p.data.data):(console.error("Invalid data structure:",p.data),l("Invalid data structure received from API"))}catch(x){console.error("Error fetching interest data:",x),re.isAxiosError(x)?((R=x.response)==null?void 0:R.status)===401?(alert("Your session has expired. Please log in again."),b("/")):l(`API Error: ${((T=(E=x.response)==null?void 0:E.data)==null?void 0:T.message)||x.message}`):l("An unexpected error occurred")}finally{a(!1)}}},[b,C,m]);n.useEffect(()=>{C.from&&C.to&&v()},[v,C]),n.useEffect(()=>{const R=setInterval(()=>{C.from&&C.to&&v()},108e5);return()=>clearInterval(R)},[v,C]);const k=n.useMemo(()=>{if(!(t!=null&&t.resultsByAccount))return console.log("No resultsByAccount found in metaInterest:",t),[];const R=Object.keys(t.resultsByAccount);return console.log("Found accounts:",R),R.filter(E=>{var x,F;const T=((F=(x=t.resultsByAccount[E])==null?void 0:x.interestMetrics)==null?void 0:F.length)>0;return console.log(`Account ${E} has interests: ${T}`),T})},[t]),g=n.useMemo(()=>{const R="max-h-[calc(100vh-210px)]";return!(t!=null&&t.resultsByAccount)||Object.keys(t.resultsByAccount).length<=1?R:"max-h-[calc(100vh-400px)]"},[t]),I=(t==null?void 0:t.blendedSummary)&&t.blendedSummary.length>0;console.log("Has blended data:",I,(y=t==null?void 0:t.blendedSummary)==null?void 0:y.length);const L=k.length>0;console.log("Has account data:",L,k.length);const M=I||L;return console.log("Has any data:",M),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(vs,{title:"Meta Interest Analysis",Icon:Mt,showDatePicker:!0}),f?e.jsx(ys,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(bs,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):d?!C.from||!C.to?e.jsx(gt,{}):s?e.jsx(Se,{isLoading:s}):e.jsx("main",{className:"p-4 md:p-6 lg:px-8 overflow-auto",children:o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500",children:o}),e.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]}):t?e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[I&&e.jsx(za,{data:t,height:g,showAccounts:!0}),L&&k.map(R=>e.jsx(za,{data:{resultsByAccount:{[R]:t.resultsByAccount[R]},blendedSummary:t.resultsByAccount[R].interestMetrics},height:g,accountName:R,showAccounts:!1},R)),!M&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No interest data available. Please try adjusting your date range."})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No interest data available. Please try adjusting your date range."})})}):e.jsx(st,{platform:"facebook",brandId:m??"",onSuccess:(R,E,T)=>{console.log(`Successfully connected ${R} account: ${E} (${T})`)}}),e.jsx(fs,{}),e.jsx(As,{})]})]})}function tm(){const[s,a]=n.useState(!0),[t,r]=n.useState(null),o=sa();return n.useEffect(()=>{async function l(){var u,m;try{const h=new URLSearchParams(o.search),d={};for(const[w,S]of h.entries())d[w]=S;if(!d.shop){r("Shop parameter is missing"),a(!1);return}const f=await re.post(`${Te}/api/auth/shopify-install`,d);f.data&&f.data.success&&f.data.authUrl?window.location.href=f.data.authUrl:(r("Failed to get authorization URL"),a(!1))}catch(h){re.isAxiosError(h)?r(((m=(u=h.response)==null?void 0:u.data)==null?void 0:m.error)||h.message||"An error occurred"):r((h==null?void 0:h.message)||"An error occurred"),a(!1)}}l()},[o]),s?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner mb-4"}),e.jsx("p",{className:"text-lg",children:"Connecting to Dashboard..."})]})}):t?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-6 max-w-md",children:[e.jsx("h2",{className:"text-red-700 text-lg font-medium mb-2",children:"Authentication Error"}),e.jsx("p",{className:"text-red-600",children:t}),e.jsx("button",{className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded",onClick:()=>window.location.href="/",children:"Return to Home"})]})}):null}const am=()=>{const s=Ke(),[a,t]=n.useState(!0),[r,o]=n.useState(""),l="https://parallels.messold.com";return n.useEffect(()=>{(async()=>{var m,h;try{const d=new URLSearchParams(window.location.search),f=d.get("shop"),w=d.get("charge_id");if(!f||!w){console.error("Missing required parameters: shop or charge_id"),o("Missing required parameters"),t(!1),setTimeout(()=>s("/dashboard"),2e3);return}console.log(`Processing subscription for shop: ${f}, charge ID: ${w}`),await re.get(`${l}/api/pricing/callback`,{params:{shop:f,charge_id:w}}),console.log("Subscription processed successfully"),t(!1),s("/dashboard")}catch(d){console.error("Error processing subscription:",d),o(((h=(m=d.response)==null?void 0:m.data)==null?void 0:h.error)||"An error occurred"),t(!1),setTimeout(()=>s("/dashboard"),2e3)}})()},[s,l]),a?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-lg font-medium",children:"Processing your subscription..."})]}):r?e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[e.jsxs("p",{children:["Error: ",r]}),e.jsx("p",{className:"mt-2",children:"Redirecting to dashboard..."})]})}):null};function nm(){return e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("div",{className:"w-full",children:e.jsx(wr,{})}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fadeInUp",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2 group-hover:bg-primary/20 transition-colors",children:e.jsx(jt,{className:"h-5 w-5 text-primary"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Connect Multiple Platforms"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Link all your marketing platforms for comprehensive analytics and insights"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-success/10 p-2 group-hover:bg-success/20 transition-colors",children:e.jsx(jt,{className:"h-5 w-5 text-success"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Real-time Updates"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your data will be automatically synced every 3 hours for accurate reporting"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-warning/10 p-2 group-hover:bg-warning/20 transition-colors",children:e.jsx(jt,{className:"h-5 w-5 text-warning"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Easy Management"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage all your brands and their performance from a single dashboard"})]})]})]})})]})}const rm=()=>{const s=fe(),a=Ke(),t=n.useRef(null),r=async()=>{try{return(await re.get(`${Te}/api/auth/check-token`,{withCredentials:!0})).data}catch(u){return console.error("Error checking token validity:",u),null}},o=async()=>{try{await re.post(`${Te}/api/auth/logout`,{},{withCredentials:!0})}catch(u){console.error("Error during logout API call:",u)}s(Rt()),s(Dt()),a("/login")},l=async()=>{const u=await r();if(!u){console.log("Failed to check token validity");return}if(!u.isValid){console.log("Token is invalid or expired:",u.message),o();return}};return n.useEffect(()=>(l(),t.current=setInterval(l,6e4),()=>{t.current&&clearInterval(t.current)}),[]),{checkTokenStatus:l,isTokenValid:async()=>{const u=await r();return(u==null?void 0:u.isValid)||!1}}},om=({children:s})=>(rm(),e.jsx(e.Fragment,{children:s}));function lm(){return e.jsx(wo,{store:_s,children:e.jsx(bl,{loading:null,persistor:Zi,children:e.jsx(Wc,{children:e.jsx(Vr,{children:e.jsx(om,{children:e.jsxs(yd,{children:[e.jsx(Nd,{}),e.jsx(Ul,{}),e.jsxs(ll,{children:[e.jsx(Be,{path:"/",element:e.jsx(Td,{})}),e.jsx(Be,{path:"/login",element:e.jsx(zl,{})}),e.jsx(Be,{path:"/dashboard",element:e.jsx(jc,{})}),e.jsx(Be,{path:"/admetrics/:brandId",element:e.jsx(xc,{})}),e.jsx(Be,{path:"/ecommerce-reports/:brandId",element:e.jsx(qc,{})}),e.jsx(Be,{path:"/marketing-insights/:brandId",element:e.jsx(yc,{})}),e.jsx(Be,{path:"/performance-metrics",element:e.jsx(Ac,{})}),e.jsx(Be,{path:"/segment-dashboard/:brandId",element:e.jsx(Mc,{})}),e.jsx(Be,{path:"/meta-reports/:brandId",element:e.jsx(cd,{})}),e.jsx(Be,{path:"/google-reports/:brandId",element:e.jsx(sd,{})}),e.jsx(Be,{path:"/conversion-reports/:brandId",element:e.jsx(Jd,{})}),e.jsx(Be,{path:"/callback",element:e.jsx($c,{})}),e.jsx(Be,{path:"/profile",element:e.jsx(xd,{})}),e.jsx(Be,{path:"/shopify",element:e.jsx(tm,{})}),e.jsx(Be,{path:"/brand-setup",element:e.jsx(nm,{})}),e.jsx(Be,{path:"/privacy-policy",element:e.jsx(Md,{})}),e.jsx(Be,{path:"/terms-and-conditions",element:e.jsx($d,{})}),e.jsx(Be,{path:"/meta-campaigns/:brandId",element:e.jsx(Xd,{})}),e.jsx(Be,{path:"/meta-interest/:brandId",element:e.jsx(sm,{})}),e.jsx(Be,{path:"/pricing_callback",element:e.jsx(am,{})}),e.jsx(Be,{path:"/first-time-brand-setup",element:e.jsx(Sr,{})})]})]})})})})})})}_r(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(lm,{})}));
//# sourceMappingURL=index-CksSuyd5.js.map
