import{r,j as e,R as Se}from"./react-CkuKL7a9.js";import{c as hl}from"./react-dom-CtYNSMMY.js";import{N as xl,L as nt,B as gl}from"./react-router-dom-CMpnQT-m.js";import{V as tn,R as an,A as rn,C as nn,a as Wa,T as on,D as ln,P as fl,b as pl,c as cn,d as bl,e as jl,f as yl,g as dn,h as vl,i as Nl,S as mn,j as wl,O as ma,k as ua,l as Ha,m as ha,n as xa,o as un,p as hn,q as xn,r as Cl,s as Sl,t as gn,u as kl,v as fn,w as Al,x as Ml,y as pn,I as Tl,z as qa,B as bn,E as jn,F as yn,G as vn,H as Nn,J as wn,K as $l,L as Ya,M as Cn,N as Fl,Q as Sn,U as _l,W as kn,X as Il,Y as An,Z as Mn,_ as Pl,$ as El,a0 as Tn,a1 as Ll,a2 as Dl,a3 as $n,a4 as Fn,a5 as Rl,a6 as _n,a7 as In,a8 as Pn,a9 as En,aa as Ln,ab as Ol,ac as Dn,ad as Rn,ae as zl,af as Bl,ag as On,ah as zn,ai as Bn,aj as Gl,ak as Gn,al as Ul,am as Vl,an as Un,ao as Vn,ap as Wl}from"./@radix-ui-COjV9agS.js";import{c as $t}from"./class-variance-authority-Bb4qSo10.js";import{c as Hl}from"./clsx-B-dksMZM.js";import{t as ql}from"./tailwind-merge-Dnoi3Axr.js";import{c as ws,a as Yl}from"./@reduxjs-CoJy1jWf.js";import{a as ne}from"./axios-CCb-kr4I.js";import{u as V,a as Me,s as St,P as Kl}from"./react-redux-BFum93nM.js";import{S as ga,L as Wn,C as fa,a as Ls,b as Hn,c as Hs,d as us,e as Je,f as qn,g as Ka,h as os,P as qs,H as Ql,i as Yn,j as Jl,G as Kn,k as bt,l as Zl,E as Qn,m as Vs,n as Qa,T as Is,o as kt,U as Xl,p as ei,q as si,r as Jn,B as ti,V as ai,s as ri,X as hs,R as $e,t as At,u as Cs,M as ni,v as js,w as Zn,x as oi,y as it,z as li,A as Qe,D as ii,F as na,I as pa,J as ba,K as Rt,N as ci,O as ys,Q as Ss,W as Xn,Y as Ue,Z as Ve,_ as di,$ as mi,a0 as ja,a1 as ui,a2 as eo,a3 as hi,a4 as Mt,a5 as oa,a6 as Tt,a7 as xi,a8 as Ft,a9 as za,aa as Ba,ab as so,ac as to,ad as ao,ae as ro,af as no,ag as gi,ah as fi,ai as pi,aj as bi,ak as Ja,al as Za,am as Xa,an as ji,ao as yi,ap as er,aq as vi,ar as Ut,as as Ni,at as oo,au as lo,av as sr,aw as wi,ax as Ci,ay as io,az as Ms,aA as Si,aB as ki,aC as Ai,aD as ya,aE as Mi,aF as Ti,aG as $i,aH as Fi,aI as _i,aJ as Ii,aK as Pi,aL as Ei,aM as Li,aN as vr,aO as Di,aP as Ri,aQ as Oi,aR as Nr,aS as co,aT as zi,aU as Vt,aV as Ga,aW as Bi,aX as wr,aY as Fa,aZ as Gi,a_ as Ui,a$ as Vi,b0 as Wi,b1 as Hi,b2 as mo,b3 as Cr,b4 as qi}from"./lucide-react-ChRciy3v.js";import{F as uo,a as Yi,b as Ki,c as Qi,d as Ji,e as Zi,I as Xi}from"./react-icons-DR5y97sq.js";import{C as Y,s as fs,a as ec,F as sc,b as _a,G as xt,e as Ot,H as Sr,t as tc,I as ac,J as rc,K as pt,L as kr,M as nc}from"./date-fns-Dd9czdL5.js";import{b as tr,a as Xe,e as ge,f as oc,g as Ee}from"./react-router-Ce0QG7_t.js";import{c as lc}from"./reselect-NCCDNIWx.js";import{D as ic}from"./react-day-picker-C_bBQlJG.js";import{l as cc}from"./socket.io-client-CDVIIGn8.js";import{p as dc,a as mc,d as uc,P as hc}from"./redux-persist-C3zyQnfy.js";import{c as xc}from"./redux-DITMfSWq.js";import{R as ar,A as gc,C as fc,X as ho,Y as xo,T as rr,L as go,a as pc,P as bc,b as jc,c as yc,B as vc,d as Jt}from"./recharts-Bdd4zEL5.js";import{x as at}from"./xlsx-js-style-D9kuvFD2.js";import{A as Nc}from"./driver.js-D-7DVtGF.js";import{u as wc}from"./embla-carousel-react-JUSBs7yY.js";import{P as Cc}from"./papaparse-BKn68-VO.js";import"./eventemitter3-CJ9KO17d.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-BSEpXHBb.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-CPmXGeA2.js";import"./react-style-singleton-DfON9R_v.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DyqfL0R5.js";import"./use-callback-ref-wNvar0eO.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-C5ifrSBn.js";import"./@floating-ui-C6Fk-jMm.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./use-sync-external-store-xms5UOqV.js";import"./engine.io-client-C44f3zIw.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./lodash-DlN4eHER.js";import"./react-is-DcfIKM1A.js";import"./react-smooth-z42qxpQa.js";import"./prop-types-DNLruqPx.js";import"./fast-equals-C7I1S-bJ.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-DjFPhhqo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-6_AdwBXU.js";import"./d3-scale-BYIooUZQ.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-BKO53YJi.js";import"./d3-time-QpEiTrED.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";import"./embla-carousel-reactive-utils-DkegjUUZ.js";import"./embla-carousel-CMPFBS9o.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const Sc=1,kc=1e6;let Ia=0;function Ac(){return Ia=(Ia+1)%Number.MAX_SAFE_INTEGER,Ia.toString()}const Pa=new Map,Ar=s=>{if(Pa.has(s))return;const a=setTimeout(()=>{Pa.delete(s),zt({type:"REMOVE_TOAST",toastId:s})},kc);Pa.set(s,a)},Mc=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Sc)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?Ar(t):s.toasts.forEach(l=>{Ar(l.id)}),{...s,toasts:s.toasts.map(l=>l.id===t||t===void 0?{...l,open:!1}:l)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},ta=[];let aa={toasts:[]};function zt(s){aa=Mc(aa,s),ta.forEach(a=>{a(aa)})}function Tc({...s}){const a=Ac(),t=o=>zt({type:"UPDATE_TOAST",toast:{...o,id:a}}),l=()=>zt({type:"DISMISS_TOAST",toastId:a});return zt({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:o=>{o||l()}}}),{id:a,dismiss:l,update:t}}function mt(){const[s,a]=r.useState(aa);return r.useEffect(()=>(ta.push(a),()=>{const t=ta.indexOf(a);t>-1&&ta.splice(t,1)}),[s]),{...s,toast:Tc,dismiss:t=>zt({type:"DISMISS_TOAST",toastId:t})}}function Q(...s){return ql(Hl(s))}const $c=fl,fo=r.forwardRef(({className:s,...a},t)=>e.jsx(tn,{ref:t,className:Q("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));fo.displayName=tn.displayName;const Fc=$t("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),po=r.forwardRef(({className:s,variant:a,...t},l)=>e.jsx(an,{ref:l,className:Q(Fc({variant:a}),s),...t}));po.displayName=an.displayName;const _c=r.forwardRef(({className:s,...a},t)=>e.jsx(rn,{ref:t,className:Q("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));_c.displayName=rn.displayName;const bo=r.forwardRef(({className:s,...a},t)=>e.jsx(nn,{ref:t,className:Q("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Wa,{className:"h-4 w-4"})}));bo.displayName=nn.displayName;const jo=r.forwardRef(({className:s,...a},t)=>e.jsx(on,{ref:t,className:Q("text-sm font-semibold [&+div]:text-xs",s),...a}));jo.displayName=on.displayName;const yo=r.forwardRef(({className:s,...a},t)=>e.jsx(ln,{ref:t,className:Q("text-sm opacity-90",s),...a}));yo.displayName=ln.displayName;function Ic(){const{toasts:s}=mt();return e.jsxs($c,{children:[s.map(function({id:a,title:t,description:l,action:o,...i}){return e.jsxs(po,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(jo,{children:t}),l&&e.jsx(yo,{children:l})]}),o,e.jsx(bo,{})]},a)}),e.jsx(fo,{})]})}const Pc={selectedBrandId:null,brands:[]},vo=ws({name:"brand",initialState:Pc,reducers:{setSelectedBrandId:(s,a)=>{s.selectedBrandId=a.payload},setBrands:(s,a)=>{s.brands=a.payload},deleteBrand:(s,a)=>{s.brands=s.brands.filter(t=>t._id!==a.payload),s.selectedBrandId===a.payload&&(s.selectedBrandId=null)},resetBrand:s=>{s.selectedBrandId=null,s.brands=[]}}}),{setSelectedBrandId:yt,setBrands:va,deleteBrand:Ec,resetBrand:Na}=vo.actions,Lc=vo.reducer,_t=bl,cs=jl,ds=yl,ns=r.forwardRef(({className:s,sideOffset:a=4,...t},l)=>e.jsx(pl,{children:e.jsx(cn,{ref:l,sideOffset:a,className:Q("z-50 overflow-hidden rounded-md bg-black px-3 py-1.5 text-xs text-white animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));ns.displayName=cn.displayName;const nr="/assets/messold-icon-jcccRy_s.png",or=r.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(dn,{ref:l,className:Q("relative overflow-hidden",s),...t,children:[e.jsx(vl,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(No,{}),e.jsx(Nl,{})]}));or.displayName=dn.displayName;const No=r.forwardRef(({className:s,orientation:a="vertical",...t},l)=>e.jsx(mn,{ref:l,orientation:a,className:Q("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...t,children:e.jsx(wl,{className:"relative flex-1 rounded-full bg-border"})}));No.displayName=mn.displayName;const Dc={user:null},wo=ws({name:"user",initialState:Dc,reducers:{setUser:(s,a)=>{s.user=a.payload},clearUser:s=>{s.user=null},removeBrandFromUser:(s,a)=>{s.user&&(s.user.brands=s.user.brands.filter(t=>t!==a.payload))},addBrandToUser:(s,a)=>{s.user&&!s.user.brands.includes(a.payload)&&s.user.brands.push(a.payload)}}}),{setUser:Bt,clearUser:wa,removeBrandFromUser:Rc,addBrandToUser:Yx}=wo.actions,Oc=wo.reducer,be="https://parallels.messold.com",zc="parallels-x-messold",Bc=[{id:"FREE",title:"Free Plan",price:"Free",description:"Perfect for getting started with analytics",features:["Basic Analytics Dashboard","Shopify Integration","Daily Data Updates","Basic Reports","Email Support"],buttonText:"Get Started"},{id:"STARTUP",title:"Startup Plan",price:"$10",period:"/month",description:"Ideal for growing businesses",features:["Everything in Free Plan","Real-time Analytics","Custom Dashboards","Advanced Reports","Priority Email Support"],isPopular:!0,buttonText:"Subscribe Now"},{id:"GROWTH",title:"Growth Plan",price:"$50",period:"/month",description:"For businesses ready to scale",features:["Everything in Startup Plan","AI-Powered Insights","White-label Reports","Custom Integrations","Team Collaboration"],buttonText:"Subscribe Now"}],Mr=[{id:1,title:"Brand Setup",description:"Configure your brand details and identity",icon:ga},{id:2,title:"Connect Platforms",description:"Link your marketing and analytics accounts",icon:Wn}],Gc=[{title:"1. Introduction",content:['Welcome to Messold ("we," "our," or "us"). Your privacy is important to us. This Privacy Policy explains how we collect, use, share, and protect your information when you use our Parallels application.']},{title:"2. Information We Collect",content:["Our application accesses and processes the following user data from Google and Meta:",["Google Ads Data: We access advertising campaign performance and spend data.","Google Analytics Data: We access read-only analytics data and may edit settings.","Meta Ads Data: We access ad account data, campaign insights, and interest-based targeting information."]]},{title:"3. How We Use Google and Meta User Data",content:[["To provide analytics and advertising insights.","To display relevant reports and campaign performance data.","To personalize the user experience.","To enhance and improve our services through data analysis."]]},{title:"4. Data Sharing & Disclosure",content:["We do not sell, rent, or trade your personal information. However, we may share your data:",["With authorized service providers assisting in hosting, analytics, or customer support.","For legal compliance if required by law.","With your consent."]]},{title:"5. Data Retention & Deletion",content:["Users can request:",["Deletion of their data by contacting us at info@messold.com.","Access to stored data via email.","Revocation of Meta data access via Facebook's security settings."]]},{title:"6. Data Security",content:["We take appropriate security measures including encryption, access control, and regular security audits."]},{title:"7. User Rights & Control",content:["You have the right to:",["Revoke our application's access via Google Security Settings.","Revoke our application's access via Meta App Settings.","Request access, correction, or deletion of your data.","Opt-out of non-essential data collection."]]},{title:"8. Compliance with Google API Services Policy & Meta Platform Terms",content:["We comply with the Google API Services User Data Policy, including the Limited Use requirements.","We comply with Meta's Platform Terms and ensure that we process Platform Data only as described in this policy and in accordance with applicable laws."]},{title:"9. GDPR/CCPA Compliance",content:["Residents of the EEA or California have additional rights, including:",["The right to access, correct, or delete your data.","The right to data portability.","The right to restrict or object to data processing."]]},{title:"10. Updates to This Privacy Policy",content:["We may update this Privacy Policy periodically. Any significant changes will be communicated via email or within the application."]},{title:"11. Contact Us",content:["If you have any questions, contact us at:","Email: info@messold.com"]}],Uc=[{title:"1. Terms",content:["By accessing this web site, you are agreeing to be bound by these web site Terms and Conditions of Use, applicable laws and regulations and their compliance. If you disagree with any of the stated terms and conditions, you are prohibited from using or accessing this site. The materials contained in this site are secured by relevant copyright and trade mark law."]},{title:"2. Use License",content:["Permission is allowed to temporarily download one duplicate of the materials (data or programming) on Messold Technologies's site for individual and non-business use only. This is the just a permit of license and not an exchange of title, and under this permit you may not:",["modify or copy the materials;","use the materials for any commercial use, or for any public presentation (business or non-business);","attempt to decompile or rebuild any product or material contained on Messold Technologies's site;","remove any copyright or other restrictive documentations from the materials; or",'transfer the materials to someone else or even "mirror" the materials on other server.'],"This permit might consequently be terminated if you disregard any of these confinements and may be ended by Messold Technologies whenever deemed. After permit termination or when your viewing permit is terminated, you must destroy any downloaded materials in your ownership whether in electronic or printed form."]},{title:"3. Disclaimer",content:[`The materials on Messold Technologies's site are given "as is". Messold Technologies makes no guarantees, communicated or suggested, and thus renounces and nullifies every single other warranties, including without impediment, inferred guarantees or states of merchantability, fitness for a specific reason, or non-encroachment of licensed property or other infringement of rights. Further, Messold Technologies does not warrant or make any representations concerning the precision, likely results, or unwavering quality of the utilization of the materials on its Internet site or generally identifying with such materials or on any destinations connected to this website.`]},{title:"4. Constraints",content:["In no occasion should Messold Technologies or its suppliers subject for any harms (counting, without constraint, harms for loss of information or benefit, or because of business interference,) emerging out of the utilization or powerlessness to utilize the materials on Messold Technologies's Internet webpage, regardless of the possibility that Messold Technologies or a Messold Technologies approved agent has been told orally or in written of the likelihood of such harm. Since a few purviews don't permit constraints on inferred guarantees, or impediments of obligation for weighty or coincidental harms, these confinements may not make a difference to you."]},{title:"5. Amendments and Errata",content:["The materials showing up on Messold Technologies's site could incorporate typographical, or photographic mistakes. Messold Technologies does not warrant that any of the materials on its site are exact, finished, or current. Messold Technologies may roll out improvements to the materials contained on its site whenever without notification. Messold Technologies does not, then again, make any dedication to update the materials."]},{title:"6. Links",content:["Messold Technologies has not checked on the majority of the websites or links connected to its website and is not in charge of the substance of any such connected webpage. The incorporation of any connection does not infer support by Messold Technologies of the site. Utilization of any such connected site is at the user's own risk."]},{title:"7. Site Terms of Use Modifications",content:["Messold Technologies may update these terms of utilization for its website whenever without notification. By utilizing this site you are consenting to be bound by the then current form of these Terms and Conditions of Use."]},{title:"8. Governing Law",content:["Any case identifying with Messold Technologies's site should be administered by the laws of the country of India Messold Technologies State without respect to its contention of law provisions."]},{title:"9. Refunds",content:["Any amount charged is non-refundable."]},{title:"10. Contact Us",content:["If you have any questions about these Terms and Conditions, please contact us at:","Email: info@messold.com"]}],ls={sessionsAndConversion:{primary:{key:"Total Sessions",name:"Sessions"},secondary:{key:"Avg Conv. Rate",name:"Conversion"}},spendAndRoas:{primary:{key:"Total Spend",name:"Spend"},secondary:{key:"Total Purchase ROAS",name:"Purchase ROAS"}},googleAds:{primary:{key:"Total Cost",name:"Sessions"},secondary:{key:"Conv. Value / Cost",name:"Conversion"}}},vs=({width:s="1.25rem",height:a="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:a,width:s},children:[e.jsx("rect",{x:"17",y:"2",width:"2rem",height:"2rem",rx:"2.5",fill:"#F9AB00"}),e.jsx("path",{d:"M9.5 13.5C9.5 12.1193 10.6193 11 12 11C13.3807 11 14.5 12.1193 14.5 13.5V19.5C14.5 20.8807 13.3807 22 12 22C10.6193 22 9.5 20.8807 9.5 19.5V13.5Z",fill:"#E37400"}),e.jsx("path",{d:"M2 19.5C2 18.1193 3.11929 17 4.5 17C5.88071 17 7 18.1193 7 19.5C7 20.8807 5.88071 22 4.5 22C3.11929 22 2 20.8807 2 19.5Z",fill:"#E37400"}),e.jsx("path",{d:"M6.92162 10C6.36184 10 5.95724 9.68838 5.95724 9.05977V8.55474H3.2304C2.49881 8.55474 2 8.1088 2 7.45332C2 7.07723 2.12193 6.70651 2.40459 6.22297C2.93666 5.29349 3.57403 4.31565 4.31116 3.23573C4.92637 2.31162 5.39747 2 6.20111 2C7.2209 2 7.88044 2.54265 7.88044 3.38617V7.02351H8.19082C8.72842 7.02351 9 7.34587 9 7.79181C9 8.23774 8.72288 8.55474 8.19082 8.55474H7.88044V9.05977C7.88044 9.68838 7.47585 10 6.92162 10ZM6.01267 7.09335V3.48287H5.97387C5.0095 4.8368 4.34996 5.83076 3.7015 7.03962V7.09335H6.01267Z",fill:"#E37400"})]}),vt=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{viewBox:"0 0 64 64",style:{height:a,width:s},xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{children:[e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-11.703,9.951-12.889,15.008    c-3.078,0.956-5.266,1.638-5.542,1.728C9.943,18.42,9.89,18.474,9.667,20.1C9.495,21.331,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#95C675"})}),e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-9.873,9.951-11.059,15.008    c-3.078,0.956-5.44,6.219-5.719,6.307c-1.719,0.542-1.772,0.596-1.996,2.223C11.148,25.91,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#79B259"})}),e.jsx("path",{d:"M40.022,62.857L59,58.731c0,0-6.661-45.261-6.703-45.572c-0.042-0.311-0.313-0.482-0.538-0.5   c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631c-0.192-0.194-0.479-0.249-0.75-0.251   c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839L40.022,62.857z",fill:"#55932C"}),e.jsx("path",{d:"M33.583,2.977c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844   c-7.887,0-11.674,9.873-12.875,14.947l2.447-0.759c1.354-4.609,4.545-12.053,10.209-12.053c0.346,0,0.688,0.116,1.018,0.345   c-2.532,1.195-5.244,4.209-6.398,10.213l2.43-0.75c1.182-4.541,3.381-6.739,5.307-7.569c0.484,1.227,0.803,2.988,0.803,5.363   c0,0.108,0,0.211-0.002,0.314l2.078-0.643c0-0.2,0.002-0.4,0.002-0.617c0-1.966-0.273-3.551-0.709-4.807   c1.746,0.218,2.912,2.213,3.662,4.508l1.938-0.601C38.906,5.876,36.976,2.977,33.583,2.977z",fill:"#4A7A2B"}),e.jsx("path",{d:"M47.611,12.348c-0.474-0.037-0.793-0.06-0.793-0.06s-3.28-3.271-3.639-3.631   c-0.192-0.194-0.479-0.249-0.75-0.251c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839l0.396,0.075l10.098-2.196L47.611,12.348z",fill:"#4C822A"})]})}),_s=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{style:{height:a,width:s},fill:"#1877F2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),ms=({width:s="1.25rem",height:a="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:a,width:s},children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),Vc=({width:s="1.25rem",height:a="1.25rem"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",style:{width:s,height:a},fill:"#ffffff",children:e.jsx("path",{d:"M 25.167969 5.0058594 C 24.781877 4.9968865 24.394532 5.014912 24.007812 5.0625 C 22.976561 5.1894012 21.954004 5.5214624 21 6.0722656 C 19.738126 6.8008205 18.867614 7.8795934 18.189453 9.0625 L 18.074219 8.9960938 L 4.0742188 32.996094 L 4.1894531 33.0625 C 3.5013617 34.243015 3 35.539748 3 37 C 3 41.406432 6.5935644 45 11 45 C 13.946182 45 16.422265 43.319288 17.810547 40.9375 L 17.925781 41.003906 L 25 28.876953 L 32.074219 41.003906 C 34.278505 44.817 39.185255 46.130214 43 43.927734 C 46.816027 41.724515 48.130947 36.816015 45.927734 33 L 45.927734 32.998047 L 31.927734 9 C 30.481872 6.4957324 27.870611 5.0686695 25.167969 5.0058594 z M 25.130859 6.9960938 C 27.155284 7.0392142 29.104113 8.1100176 30.195312 10 L 30.197266 10.001953 L 30.197266 10.003906 L 44.197266 34.003906 C 45.856861 36.883192 44.878669 40.533286 42 42.195312 C 39.120015 43.8581 35.467467 42.879973 33.804688 40 L 33.802734 39.998047 L 19.804688 16 L 19.804688 15.998047 L 19.802734 15.996094 C 18.143139 13.116808 19.121331 9.4667144 22 7.8046875 C 22.719996 7.3889907 23.488252 7.1380832 24.261719 7.0410156 C 24.551769 7.0046153 24.841656 6.9899337 25.130859 6.9960938 z M 17.212891 14.441406 C 17.372969 15.315284 17.603702 16.188437 18.072266 17 L 18.072266 17.001953 L 23.841797 26.892578 L 18.728516 35.658203 C 18.065728 31.912371 14.931107 29 11 29 C 10.084587 29 9.236334 29.238188 8.4160156 29.523438 L 17.212891 14.441406 z M 11 31 C 14.325556 31 17 33.674446 17 37 C 17 40.325554 14.325556 43 11 43 C 7.6744439 43 5 40.325554 5 37 C 5 33.674446 7.6744439 31 11 31 z"})}),ut=un,Co=hn,Wc=xn,Tr=Ha,So=r.forwardRef(({className:s,...a},t)=>e.jsx(ma,{ref:t,className:Q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));So.displayName=ma.displayName;const Ks=r.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(Wc,{children:[e.jsx(So,{}),e.jsxs(ua,{ref:l,className:Q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t,children:[a,e.jsxs(Ha,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ks.displayName=ua.displayName;const Qs=({className:s,...a})=>e.jsx("div",{className:Q("flex flex-col space-y-1.5 text-center sm:text-left",s),...a});Qs.displayName="DialogHeader";const lr=({className:s,...a})=>e.jsx("div",{className:Q("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a});lr.displayName="DialogFooter";const Js=r.forwardRef(({className:s,...a},t)=>e.jsx(ha,{ref:t,className:Q("text-lg font-semibold leading-none tracking-tight",s),...a}));Js.displayName=ha.displayName;const It=r.forwardRef(({className:s,...a},t)=>e.jsx(xa,{ref:t,className:Q("text-sm text-muted-foreground",s),...a}));It.displayName=xa.displayName;function Es({className:s,...a}){return e.jsx("div",{className:Q("animate-pulse rounded-md bg-primary/10",s),...a})}function Hc({open:s,onOpenChange:a}){var p,N;const{selectedBrandId:t,brands:l}=V(j=>j.brand),[o,i]=r.useState(null),[c,d]=r.useState(!0),u=l.find(j=>j._id===t),m=((N=(p=u==null?void 0:u.shopifyAccount)==null?void 0:p.shopName)==null?void 0:N.replace(".myshopify.com",""))||"",h=zc,v=V(j=>j.brand.selectedBrandId);r.useEffect(()=>{s&&y()},[s]);const y=async()=>{try{d(!0);const j=await ne.get(`${be}/api/pricing/details/${v}`,{withCredentials:!0});i(j.data)}catch(j){console.error("Error fetching subscription details:",j)}finally{d(!1)}},x=o?(j=>({"Free Plan":"FREE","Startup Plan":"STARTUP","Growth Plan":"GROWTH"})[j]||"FREE")(o.planName):null;return e.jsx(ut,{open:s,onOpenChange:a,children:e.jsxs(Ks,{className:"max-w-5xl p-0 overflow-auto max-h-[90vh]",children:[e.jsx(Qs,{className:"p-6 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(Js,{className:"text-2xl font-bold text-center",children:"Find Your Perfect Plan"})})}),c?e.jsx("div",{className:"px-6 pt-6",children:e.jsx(Es,{className:"h-24 w-full rounded-lg"})}):o?e.jsx("div",{className:"px-6",children:e.jsx("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:["Current Plan:"," ",e.jsx("span",{className:`ml-2 ${x==="FREE"?"text-teal-600":x==="STARTUP"?"text-violet-600":"text-rose-600"}`,children:o.planName})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["Status: ",e.jsx("span",{className:"font-medium text-green-600 capitalize",children:o.status})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.trialDaysRemaining>0&&e.jsxs("div",{className:"flex items-center bg-amber-50 text-amber-700 px-4 py-2 rounded-md border border-amber-200",children:[e.jsx(fa,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Trial ends in ",o.trialDaysRemaining," days"]}),e.jsx("p",{className:"text-xs",children:Y(new Date(o.trialEndsOn),"MMM dd, yyyy")})]})]}),e.jsxs("div",{className:"flex items-center bg-blue-50 text-blue-700 px-4 py-2 rounded-md border border-blue-200",children:[e.jsx(Ls,{className:"h-4 w-4 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Next billing in ",o.daysUntilBilling," days"]}),e.jsx("p",{className:"text-xs",children:Y(new Date(o.billingOn),"MMM dd, yyyy")})]})]})]})]})})}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid lg:grid-cols-3 gap-6",children:Bc.map(j=>{const w=x===j.id;return e.jsxs("div",{className:`relative bg-white rounded-xl overflow-hidden border transition-all duration-300 hover:shadow-lg ${w?"border-2 border-blue-500 shadow-md":j.isPopular&&!w?"border-slate-200 shadow-md hover:scale-105":"border-slate-100 hover:scale-105"}`,children:[w&&e.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white text-xs font-semibold py-1 px-3 rounded-bl-lg",children:"CURRENT PLAN"}),j.isPopular&&!w&&e.jsxs("div",{className:"absolute top-0 left-0 bg-amber-500 text-white text-xs font-semibold py-1 px-3 rounded-br-lg",children:[e.jsx(Hn,{className:"h-3.5 w-3.5 fill-white inline-block mr-1"})," POPULAR"]}),e.jsxs("div",{className:`p-6 flex flex-col items-center ${j.id==="FREE"?"bg-gradient-to-b from-teal-50 to-white":j.id==="STARTUP"?"bg-gradient-to-b from-violet-50 to-white":"bg-gradient-to-b from-rose-50 to-white"}`,children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:j.title}),e.jsxs("div",{className:"flex items-baseline mt-4",children:[e.jsx("span",{className:`text-4xl font-bold ${j.id==="FREE"?"text-teal-600":j.id==="STARTUP"?"text-violet-600":"text-rose-600"}`,children:j.price}),j.period&&e.jsx("span",{className:"text-slate-500 ml-1",children:j.period})]}),e.jsx("p",{className:"mt-3 text-slate-600 text-sm text-center",children:j.description})]}),e.jsx("div",{className:"w-full h-px bg-slate-100"}),e.jsxs("div",{className:"p-6 bg-white",children:[e.jsx("ul",{className:"space-y-4",children:j.features.map((P,g)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 rounded-full p-0.5 mt-0.5 ${j.id==="FREE"?"bg-teal-100 text-teal-600":j.id==="STARTUP"?"bg-violet-100 text-violet-600":"bg-rose-100 text-rose-600"}`,children:e.jsx(Hs,{className:"h-4 w-4"})}),e.jsx("span",{className:"ml-3 text-slate-700 text-sm",children:P})]},g))}),e.jsx("div",{className:"mt-8",children:e.jsx("a",{href:`https://admin.shopify.com/store/${m}/charges/${h}/pricing_plans`,children:e.jsx("button",{className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 ${w?"bg-slate-200 text-slate-700 cursor-default":j.id==="FREE"?"bg-teal-600 hover:bg-teal-700 text-white":j.id==="STARTUP"?"bg-violet-600 hover:bg-violet-700 text-white":"bg-rose-600 hover:bg-rose-700 text-white"}`,disabled:w,children:w?"Current Plan":j.buttonText})})})]})]},j.id)})})})]})})}function Re(){var $;const[s,a]=r.useState(!0),[t,l]=r.useState(!1),[o,i]=r.useState(!1),c=tr(),d=Xe(),u=r.useRef(null),m=Me(),h=V(F=>F.brand.selectedBrandId),v=V(F=>F.brand.brands),y=V(F=>F.user.user),S=r.useCallback(async()=>{try{if(!(y!=null&&y.brands)||y.brands.length===0){console.warn("No brand IDs found in user context.");return}const F=await ne.post(`${be}/api/brands/filter`,{brandIds:y.brands},{withCredentials:!0});m(va(F.data)),!h&&F.data.length>0&&(m(yt(F.data[0]._id)),o&&(d("/dashboard"),i(!1)))}catch(F){console.error("Error fetching brands:",F)}},[y==null?void 0:y.brands,m,h,o,d]);r.useEffect(()=>{S()},[S]);const x=()=>a(F=>!F),p=async()=>{try{(await ne.post(`${be}/api/auth/logout`,{},{withCredentials:!0})).status===200&&(m(wa()),m(Na()),console.log("Logged out redirected to home page"),d("/"),i(!0))}catch(F){console.error("Error logging out:",F)}};r.useEffect(()=>{const F=c.pathname.split("/");F[2]&&m(yt(F[2]))},[c.pathname,m]);const N=()=>{const F=c.pathname.split("/");return F.length>=2?F[1]:"dashboard"},j=F=>{if(m(yt(F)),!o){const A=N();if(A==="dashboard"){d("/dashboard");return}const C=c.pathname.split("/");C.length>=3?(C[2]=F,d(C.join("/"))):d(`/${A}/${F}`)}},w=()=>{l(!0)},P=[{name:"Dashboard",path:"/dashboard",icon:e.jsx(Ql,{size:20})},{name:"Marketing Insights",path:`/marketing-insights/${h}`,icon:e.jsx(Yn,{size:20})},{name:"Revenue Analytics",path:`/location-analytics/${h}`,icon:e.jsx(Jl,{size:20})},{name:"Festival Calendar",path:`/festival-calendar/${h}`,icon:e.jsx(Ls,{size:20})},{name:"Speed Insights",path:"/speed-insights",icon:e.jsx(Kn,{size:20})},{name:"D2C Calculator",path:`/d2c-calculator/${h}`,icon:e.jsx(bt,{size:20})},{name:"Creatives Library",path:`/creatives-library/${h}`,icon:e.jsx(Zl,{size:20})},{name:"Ad Market",path:`/followed-brands/${h}`,icon:e.jsx(Qn,{size:20})},{name:"Ad Metrics",path:`/admetrics/${h}`,icon:e.jsx(Vs,{size:20})},{name:"E-Commerce Reports",path:`/ecommerce-reports/${h}`,icon:e.jsx(Qa,{size:20})},{name:"Conversion Reports",path:`/conversion-reports/${h}`,icon:e.jsx(Is,{size:20})},{name:"Meta Ads",path:"#",icon:e.jsx(uo,{size:20}),subItems:[{name:"Campaign Analysis",path:`/meta-campaigns/${h}`},{name:"Interest Reports",path:`/meta-interest/${h}`},{name:"Performance Reports",path:`/meta-reports/${h}`}]},{name:"Google Ads",path:`/google-reports/${h}`,icon:e.jsx(Vc,{})},{name:"Page Analytics",path:`/page-analytics/${h}`,icon:e.jsx(kt,{size:20})}],g=F=>{if(!h)return!0;const A=v.find(C=>C._id===h);return(F.name==="Analytics Dashboard"||F.name==="Campaign Metrics")&&!(A!=null&&A.fbAdAccounts)&&!(A!=null&&A.googleAdAccount)};return e.jsxs(_t,{children:[e.jsxs("div",{ref:u,className:`bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 text-white transition-all duration-300 ease-in-out flex flex-col shadow-2xl relative ${s?"w-60":"w-16"}`,style:{height:"100vh"},children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center cursor-pointer group",onClick:()=>d("/dashboard"),children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:nr,alt:"Messold Logo",className:"h-8 w-8 rounded-lg shadow-lg"}),e.jsx("div",{className:"absolute inset-0 bg-blue-500/20 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]}),s&&e.jsx("span",{className:"ml-3 text-lg font-bold text-slate-200",children:"Parallels"})]}),s&&e.jsx("button",{onClick:x,className:"p-0.5 rounded-md text-white hover:text-slate-50 border border-slate-200 hover:bg-slate-700/30 transition-all duration-200 opacity-60 hover:opacity-100",title:"Collapse sidebar",children:e.jsx(us,{size:14})})]}),!s&&e.jsx("div",{className:"flex justify-center mt-3",children:e.jsx("button",{onClick:x,className:"p-0.5 rounded-md text-white border border-slate-200 hover:text-slate-50 hover:bg-slate-700/30 transition-all duration-200 opacity-60 hover:opacity-100",title:"Expand sidebar",children:e.jsx(Je,{size:14})})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(or,{className:`h-full ${s?"px-3":"px-2"}`,children:e.jsxs("nav",{className:"space-y-2 py-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(Fr,{icon:e.jsx(qn,{size:20,className:"text-slate-300"}),text:h?(($=v.find(F=>F._id===h))==null?void 0:$.name.replace(/_/g," "))||"Select Brand":"Your Brands",isExpanded:s,openIcon:e.jsx(Ka,{size:16}),closeIcon:e.jsx(os,{size:16}),isSelected:!!h,tooltipContent:"Brand Management",autoOpenOnSelect:!1,children:[v.map(F=>e.jsx($r,{path:"#",text:F.name.replace(/_/g," "),onClick:()=>j(F._id),isSelected:h===F._id},F._id)),e.jsx("div",{className:"mx-3 mt-2",children:e.jsxs("button",{className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-xs text-slate-400 hover:text-slate-200 transition-colors duration-200 border border-dashed border-slate-600 rounded-lg hover:border-slate-400 hover:bg-slate-600/30",children:[e.jsx(qs,{size:14}),e.jsx("span",{children:"Add Brand"})]})})]})}),e.jsx("div",{className:"space-y-1",children:P.map((F,A)=>{var I,B;const C=(I=F.subItems)==null?void 0:I.some(O=>c.pathname===O.path),_=c.pathname.startsWith(F.path)&&F.path!=="#"||C;return e.jsx("div",{children:e.jsx(Fr,{icon:F.icon,text:F.name,isExpanded:s,openIcon:e.jsx(os,{size:16}),closeIcon:e.jsx(os,{size:16}),isSelected:!!_,tooltipContent:F.name,onClick:()=>{!g(F)&&F.path&&F.path!=="#"&&!F.subItems&&d(F.path)},disabled:g(F),children:(B=F.subItems)==null?void 0:B.map((O,E)=>{const M=g(O)||!1;return e.jsx($r,{path:O.path,text:O.name,isSelected:c.pathname===O.path,disabled:M},E)})})},A)})})]})})}),e.jsxs("div",{className:`flex-shrink-0 border-t border-slate-700/50 space-y-1 ${s?"p-3":"p-2"}`,children:[e.jsx(Kc,{isExpanded:s,handlePricing:w}),e.jsx(qc,{isExpanded:s,user:y}),e.jsx(Yc,{handleLogout:p,isExpanded:s})]})]}),e.jsx(Hc,{open:t,onOpenChange:l})]})}function $r({path:s,text:a,onClick:t,disabled:l=!1,isSelected:o=!1,children:i}){const[c,d]=r.useState(!1),u=Se.Children.count(i)>0,m=()=>{u&&d(p=>!p)},h=Se.Children.toArray(i).some(p=>{var N;return(N=p==null?void 0:p.props)==null?void 0:N.isSelected}),v=o||h;r.useEffect(()=>{v&&d(!0)},[v]);const y=`flex items-center text-xs w-full px-4 py-3 rounded-lg transition-all duration-200 ${v?"text-white bg-slate-600/30  shadow-lg":"text-slate-300 hover:text-white hover:bg-slate-700/50"} ${l?"cursor-not-allowed opacity-50":"cursor-pointer"}`,S=e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:"font-medium capitalize",children:a}),u&&e.jsx("span",{className:"ml-2",children:c?e.jsx(Ka,{size:14}):e.jsx(os,{size:14})})]})}),x=l?e.jsx("div",{className:y,children:S}):e.jsx(xl,{to:s,className:y,onClick:p=>{(s==="/#"||!s||s==="#")&&p.preventDefault(),u&&m(),t&&t()},children:S});return e.jsxs("div",{children:[x,c&&u&&e.jsxs("div",{className:"relative pl-4 mt-1",children:[e.jsx("div",{className:"absolute top-0 left-4 w-px h-full bg-slate-600/50"}),i]})]})}function Fr({icon:s,text:a,isExpanded:t,openIcon:l,closeIcon:o,children:i,isSelected:c,tooltipContent:d,onClick:u,disabled:m,autoOpenOnSelect:h=!0}){const[v,y]=r.useState(!1),S=Se.Children.count(i)>0,x=()=>{S&&y(w=>!w)},p=Se.Children.toArray(i).some(w=>{var P,g;return(P=w==null?void 0:w.props)!=null&&P.isSelected?!0:(g=w==null?void 0:w.props)!=null&&g.children?Se.Children.toArray(w.props.children).some($=>{var F;return(F=$==null?void 0:$.props)==null?void 0:F.isSelected}):!1}),N=c||p;r.useEffect(()=>{h&&N&&y(!0)},[N,h]);const j=e.jsxs("div",{onClick:()=>{S&&x(),!m&&u&&u()},className:`flex items-center px-3 py-2.5 rounded-lg transition-all duration-200 cursor-pointer group capitalize ${N?"text-white bg-slate-600/30 border-l-2 border-slate-400 shadow-lg":"text-slate-300 hover:text-white hover:bg-slate-700/50"} ${m?"cursor-not-allowed opacity-50":""}`,children:[e.jsx("span",{className:`mr-3 transition-colors duration-200 ${N?"text-slate-300":"text-slate-400 group-hover:text-slate-300"}`,children:s}),t&&e.jsx("span",{className:"text-sm font-medium flex-1 capitalize",children:a}),t&&S&&e.jsx("span",{className:"text-slate-400 group-hover:text-white transition-colors",children:v?l:o})]});return e.jsxs("div",{children:[t?j:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:j}),e.jsxs(ns,{side:"right",className:"bg-slate-800 border-slate-700",children:[e.jsx("p",{className:"font-medium",children:d}),Se.Children.map(i,w=>e.jsx("div",{className:"relative",children:w}))]})]}),v&&t&&e.jsxs("div",{className:"relative pl-4 mt-1",children:[e.jsx("div",{className:"absolute top-0 left-4 w-px h-full bg-slate-600/50"}),Se.Children.map(i,w=>e.jsx("div",{children:w}))]})]})}function qc({isExpanded:s,user:a}){const t=Xe(),l=e.jsxs("div",{onClick:()=>t("/profile"),className:`flex items-center gap-3 py-2.5 rounded-lg text-slate-300 hover:bg-slate-700/50 hover:text-white transition-all duration-200 cursor-pointer group ${s?"px-3":"px-2"}`,children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-slate-700/50 group-hover:bg-blue-600/20 transition-colors duration-200",children:e.jsx(Xl,{size:18,className:"text-slate-400 group-hover:text-blue-400 transition-colors"})}),s&&e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:(a==null?void 0:a.username)||"User"}),e.jsx("div",{className:"text-xs text-slate-400",children:"View Profile"})]})]});return e.jsx("div",{children:s?l:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:l}),e.jsxs(ns,{side:"right",className:"bg-slate-800 border-slate-700",children:[e.jsx("p",{className:"font-medium",children:(a==null?void 0:a.username)||"User"}),e.jsx("p",{className:"text-sm text-slate-400",children:"View Profile"})]})]})})}function Yc({handleLogout:s,isExpanded:a}){const t=e.jsxs("div",{onClick:s,className:`flex items-center gap-3 py-2.5 rounded-lg text-slate-300 hover:bg-red-600/20 hover:text-red-400 transition-all duration-200 cursor-pointer group ${a?"px-3":"px-2"}`,children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-slate-700/50 group-hover:bg-red-600/20 transition-colors duration-200",children:e.jsx(ei,{size:18,className:"text-slate-400 group-hover:text-red-400 transition-colors"})}),a&&e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Logout"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Sign out"})]})]});return e.jsx("div",{children:a?t:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:t}),e.jsxs(ns,{side:"right",className:"bg-slate-800 border-slate-700",children:[e.jsx("p",{className:"font-medium",children:"Logout"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Sign out"})]})]})})}function Kc({handlePricing:s,isExpanded:a}){const t=e.jsxs("div",{onClick:s,className:`flex items-center gap-3 py-2.5 rounded-lg text-slate-300 hover:bg-yellow-600/20 hover:text-yellow-400 transition-all duration-200 cursor-pointer group ${a?"px-3":"px-2"}`,children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-slate-700/50 group-hover:bg-yellow-600/20 transition-colors duration-200",children:e.jsx(si,{size:18,className:"text-slate-400 group-hover:text-yellow-400 transition-colors"})}),a&&e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Pricing"}),e.jsx("div",{className:"text-xs text-slate-400",children:"View Plans"})]})]});return e.jsx("div",{children:a?t:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:t}),e.jsxs(ns,{side:"right",className:"bg-slate-800 border-slate-700",children:[e.jsx("p",{className:"font-medium",children:"Pricing"}),e.jsx("p",{className:"text-sm text-slate-400",children:"View Plans"})]})]})})}const ue=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:Q("rounded-xl border bg-card text-card-foreground shadow",s),...a}));ue.displayName="Card";const bs=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:Q("flex flex-col space-y-1.5 p-3",s),...a}));bs.displayName="CardHeader";const Ts=r.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:Q("font-semibold leading-none tracking-tight",s),...a}));Ts.displayName="CardTitle";const ir=r.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:Q("text-sm text-muted-foreground",s),...a}));ir.displayName="CardDescription";const he=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:Q("p-4 pt-3",s),...a}));he.displayName="CardContent";const Qc=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:Q("flex items-center p-6 pt-0",s),...a}));Qc.displayName="CardFooter";const Jc=()=>e.jsxs(ue,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(bs,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(Es,{className:"w-4 h-4 rounded-full"}),e.jsx(Es,{className:"h-6 w-24"})]}),e.jsx(Es,{className:"h-4 w-32 mt-2"})]}),e.jsx(he,{children:e.jsx(Es,{className:"h-8 w-20 mt-2"})})]}),Zc=({label:s,value:a,date:t,icon:l,tooltipContent:o})=>{const i=c=>c?(typeof c=="string"&&(c=new Date(c)),c.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})):"";return e.jsxs(ue,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(bs,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[l==="Facebook"?e.jsx(_s,{width:"1rem",height:"1rem"}):l==="Google"?e.jsx(ms,{width:"1rem",height:"1rem"}):null,e.jsx("div",{className:"text-base font-medium",children:s}),o&&e.jsx(_t,{children:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("button",{className:"p-0 m-0","aria-label":`Info about ${s}`,children:e.jsx(Jn,{className:"w-3 h-3 text-gray-400"})})}),e.jsxs(ns,{className:"w-64 p-0 bg-white text-black border shadow-sm",children:[e.jsx("div",{className:"p-2 font-semibold border-black",children:s}),e.jsx("div",{className:"w-full h-[0.5px] bg-black"}),e.jsx("div",{className:"p-2",children:o})]})]})})]}),e.jsxs("div",{className:"text-xs text-gray-500 font-bold",children:[i(t.from),t.from&&t.to?" - ":"",i(t.to)]})]}),e.jsx(he,{children:e.jsx("p",{className:"text-lg lg:text-xl 2xl:text-2xl font-bold text-teal-800",children:a})})]})},Ea=({title:s,metrics:a=[],date:t,isLoading:l=!1,icon:o,errorMessage:i})=>i&&!l?e.jsx("section",{className:s?"mt-10":"",children:e.jsxs(ue,{className:"p-4",children:[e.jsx(bs,{children:e.jsx("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})})}),e.jsx(he,{children:e.jsx("p",{className:"text-red-600 text-sm",children:i})})]})}):e.jsxs("section",{className:s?"mt-10":"",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:l?Array(a.length).fill(0).map((c,d)=>e.jsx(Jc,{},d)):a.map((c,d)=>e.jsx(e.Fragment,{children:e.jsx(Zc,{label:c.label,value:c.value,date:t,icon:o,tooltipContent:c.tooltipContent},d)}))})]}),Ua=$t("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),z=r.forwardRef(({className:s,variant:a,size:t,asChild:l=!1,...o},i)=>{const c=l?Cl:"button";return e.jsx(c,{className:Q(Ua({variant:a,size:t,className:s})),ref:i,...o})});z.displayName="Button";function la({className:s,classNames:a,showOutsideDays:t=!0,...l}){return e.jsx(ic,{showOutsideDays:t,className:Q("px-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-xs font-medium",nav:"space-x-1 flex items-center",nav_button:Q(Ua({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-7 font-normal text-[0.6rem]",row:"flex w-full mt-2",cell:Q("relative p-0 text-center text-[0.7rem] focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",l.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Q(Ua({variant:"ghost"}),"h-7 w-7 p-0 font-normal aria-selected:opacity-100 text-[0.7rem]"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-black text-white hover:bg-black hover:text-white focus:bg-black focus:text-white",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-gray-400 opacity-50  aria-selected:bg-gray-400/50 aria-selected:text-accent-foreground aria-selected:opacity-30",day_disabled:"text-accent-foreground opacity-50",day_range_middle:"aria-selected:bg-gray-100 aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:()=>e.jsx(Sl,{className:"h-4 w-4"}),IconRight:()=>e.jsx(gn,{className:"h-4 w-4"})},...l})}la.displayName="Calendar";const ct=Al,dt=Ml,Ys=r.forwardRef(({className:s,align:a="start",sideOffset:t=4,...l},o)=>e.jsx(kl,{children:e.jsx(fn,{ref:o,align:a,sideOffset:t,className:Q("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})}));Ys.displayName=fn.displayName;const ve=r.forwardRef(({className:s,type:a,...t},l)=>e.jsx("input",{type:a,className:Q("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:l,...t}));ve.displayName="Input";const rt=r.forwardRef(({className:s,...a},t)=>e.jsx(pn,{ref:t,className:Q("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(Tl,{className:Q("flex items-center justify-center text-current"),children:e.jsx(qa,{className:"h-4 w-4"})})}));rt.displayName=pn.displayName;const Xc={from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString(),to:new Date().toISOString()},ko=ws({name:"date",initialState:Xc,reducers:{setDate:(s,a)=>{s.from=a.payload.from,s.to=a.payload.to,s.compareFrom=a.payload.compareFrom,s.compareTo=a.payload.compareTo},clearDate:s=>{s.from=void 0,s.to=void 0,s.compareFrom=void 0,s.compareTo=void 0}}}),{setDate:es,clearDate:ed}=ko.actions,sd=ko.reducer,td=lc(s=>{var a;return(a=s.date)==null?void 0:a.from},s=>{var a;return(a=s.date)==null?void 0:a.to},(s,a)=>({from:s,to:a}));function Le({defaultDate:s,resetToFirstPage:a}){const t=Me(),l=V(td),o=r.useMemo(()=>l?{from:l.from?new Date(l.from):void 0,to:l.to?new Date(l.to):void 0}:s?{from:s.from?new Date(s.from):void 0,to:s.to?new Date(s.to):void 0}:void 0,[l,s]),[i,c]=r.useState(o),[d,u]=r.useState(),[m,h]=r.useState(!1),[v,y]=r.useState(null),[S,x]=r.useState(!1),[p,N]=r.useState("primary"),[j,w]=r.useState(i!=null&&i.from?Y(i.from,"yyyy-MM-dd"):""),[P,g]=r.useState(i!=null&&i.to?Y(i.to,"yyyy-MM-dd"):""),[$,F]=r.useState(""),[A,C]=r.useState(""),_=r.useMemo(()=>{const n=new Date,b=n.getDay(),T=fs(n,b),U=ec(T,6),D=new Date(n.getFullYear(),n.getMonth(),1),W=new Date(n.getFullYear(),n.getMonth()+1,0),K=fs(T,7),q=fs(T,1),ee=Math.floor(n.getMonth()/3),J=new Date(n.getFullYear(),ee*3,1),ae=new Date(n.getFullYear(),(ee+1)*3,0),pe=n.getMonth()<3?3:Math.floor((n.getMonth()-3)/3),G=n.getMonth()<3?n.getFullYear()-1:n.getFullYear(),se=new Date(G,pe*3,1),te=new Date(G,(pe+1)*3,0);return{today:n,startOfThisWeek:T,endOfThisWeek:U,startOfThisMonth:D,endOfThisMonth:W,startOfLastWeek:K,endOfLastWeek:q,startOfThisQuarter:J,endOfThisQuarter:ae,startOfLastQuarter:se,endOfLastQuarter:te}},[]),I=r.useCallback(n=>{try{const b=sc(n,"yyyy-MM-dd",new Date);return isNaN(b.getTime())?void 0:b}catch{return}},[]),B=r.useCallback(()=>{const n=I(j),b=I(P);n&&b&&(c({from:n,to:b}),y(null))},[j,P,I]),O=r.useCallback(()=>{const n=I($),b=I(A);n&&b&&u({from:n,to:b})},[$,A,I]),E=r.useCallback((n,b)=>{p==="primary"?(c({from:n,to:b}),w(Y(n,"yyyy-MM-dd")),g(Y(b,"yyyy-MM-dd"))):p==="comparison"&&(u({from:n,to:b}),F(Y(n,"yyyy-MM-dd")),C(Y(b,"yyyy-MM-dd"))),y(null)},[p]),M=r.useMemo(()=>[{label:"Today",fn:()=>E(_.today,_.today)},{label:"Yesterday",fn:()=>E(fs(_.today,1),fs(_.today,1))},{label:"This Week",fn:()=>E(_.startOfThisWeek,_.endOfThisWeek)},{label:"Last week",fn:()=>E(_.startOfLastWeek,_.endOfLastWeek)},{label:"Last 7 Days",fn:()=>E(fs(_.today,6),fs(_.today,1))},{label:"Last 30 Days",fn:()=>E(fs(_.today,30),fs(_.today,1))},{label:"Last 90 Days",fn:()=>E(fs(_.today,90),fs(_.today,1))},{label:"Last 365 Days",fn:()=>E(fs(_.today,365),fs(_.today,1))},{label:"This Month",fn:()=>E(_.startOfThisMonth,_.today)},{label:"Last Month",fn:()=>E(_a(xt(_.today,1)),Ot(xt(_.today,1)))},{label:"Last 3 Months",fn:()=>E(_a(xt(_.today,3)),Ot(xt(_.today,1)))},{label:"Last 6 Months",fn:()=>E(_a(xt(_.today,6)),Ot(xt(_.today,1)))},{label:"This Quarter",fn:()=>E(_.startOfThisQuarter,_.endOfThisQuarter)},{label:"Last Quarter",fn:()=>E(_.startOfLastQuarter,_.endOfLastQuarter)},{label:"This Year",fn:()=>E(new Date(new Date().getFullYear(),0,1),_.today)},{label:"Last Year",fn:()=>E(Sr(tc(new Date),1),Sr(ac(new Date),1))}],[_,E]),R=r.useCallback(n=>{p==="primary"?(n!=null&&n.from&&!n.to?(c({from:n.from,to:n.from}),w(Y(n.from,"yyyy-MM-dd")),g(Y(n.from,"yyyy-MM-dd"))):n!=null&&n.from&&(n!=null&&n.to)&&n.from>n.to?(c({from:n.from,to:n.from}),w(Y(n.from,"yyyy-MM-dd")),g(Y(n.from,"yyyy-MM-dd"))):n!=null&&n.from&&(n!=null&&n.to)?(c(n),w(Y(n.from,"yyyy-MM-dd")),g(Y(n.to,"yyyy-MM-dd"))):(c(void 0),w(""),g("")),y(null)):n!=null&&n.from&&!n.to?(u({from:n.from,to:n.from}),F(Y(n.from,"yyyy-MM-dd")),C(Y(n.from,"yyyy-MM-dd"))):n!=null&&n.from&&(n!=null&&n.to)&&n.from>n.to?(u({from:n.from,to:n.from}),F(Y(n.from,"yyyy-MM-dd")),C(Y(n.from,"yyyy-MM-dd"))):n!=null&&n.from&&(n!=null&&n.to)?(u(n),F(Y(n.from,"yyyy-MM-dd")),C(Y(n.to,"yyyy-MM-dd"))):(u(void 0),F(""),C(""))},[p]),L=r.useCallback(n=>n?n.from?n.to?`${Y(n.from,"LLL dd, y")} - ${Y(n.to,"LLL dd, y")}`:Y(n.from,"LLL dd, y"):"Pick a date":s&&s.from&&s.to?`${Y(s.from,"LLL dd, y")} - ${Y(s.to,"LLL dd, y")}`:"Pick a date",[s]),k=r.useCallback(()=>{c(void 0),u(void 0),y(null),x(!1),w(""),g(""),F(""),C(""),t(ed()),a&&a(),h(!1)},[t,a]),f=r.useCallback(()=>{i&&t(es({from:i.from?i.from.toISOString():void 0,to:i.to?i.to.toISOString():void 0,compareFrom:S&&(d!=null&&d.from)?d.from.toISOString():void 0,compareTo:S&&(d!=null&&d.to)?d.to.toISOString():void 0})),a&&a(),h(!1)},[t,a,i,d,S]);return e.jsxs(ct,{open:m,onOpenChange:h,children:[e.jsx(dt,{asChild:!0,children:e.jsxs(z,{variant:"outline",className:Q("w-[250px] justify-start text-left font-normal",!i&&!s&&"text-muted-foreground","hover:bg-muted/50 transition-colors rounded-lg border-muted-foreground/20"),children:[e.jsx(Ls,{className:"mr-2 h-4 w-4 text-primary"}),L(i)]})}),e.jsxs(Ys,{className:"w-auto p-0 max-w-[650px]",align:"start",children:[e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"border-r p-3 w-full md:w-[150px] overflow-y-auto bg-gradient-to-b from-muted/50 to-muted/10",style:{maxHeight:"400px"},children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h1",{className:"text-sm pb-2 font-semibold border-b border-border/50 text-black",children:"Quick Select"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-1",children:M.map(n=>e.jsx(z,{size:"sm",variant:v===n.label?"default":"ghost",className:Q("w-full justify-start text-xs font-normal h-8 rounded-md",v===n.label?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground hover:text-foreground"),onClick:()=>{n.fn(),y(n.label)},children:n.label},n.label))})]})}),e.jsxs("div",{className:"p-3 flex-grow",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(rt,{id:"compare-toggle",checked:S,onCheckedChange:()=>x(!S),className:"text-primary"}),e.jsx("label",{htmlFor:"compare-toggle",className:"text-sm font-medium",children:"Compare with another period"})]}),e.jsxs("div",{className:"grid gap-3 mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Primary Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ve,{placeholder:"YYYY-MM-DD",value:j,onChange:n=>w(n.target.value),onBlur:B,onClick:()=>{N("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ve,{placeholder:"YYYY-MM-DD",value:P,onChange:n=>g(n.target.value),onBlur:B,onClick:()=>{N("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]}),S&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Comparison Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ve,{placeholder:"YYYY-MM-DD",value:$,onChange:n=>F(n.target.value),onBlur:O,onClick:()=>{N("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ve,{placeholder:"YYYY-MM-DD",value:A,onChange:n=>C(n.target.value),onBlur:O,onClick:()=>{N("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]})]}),e.jsx("div",{className:"border rounded-lg p-2 bg-background/80 shadow-sm",children:e.jsx(la,{initialFocus:!0,mode:"range",defaultMonth:p==="primary"?(i==null?void 0:i.from)||(s==null?void 0:s.from)||_.today:(d==null?void 0:d.from)||_.today,selected:p==="primary"?i:d,onSelect:R,numberOfMonths:2,disabled:n=>n>new Date||n<new Date("2023-01-01"),className:"rounded-md"})})]})]}),e.jsxs("div",{className:"border-t p-2 flex justify-end gap-2 bg-muted/10",children:[e.jsx(z,{variant:"outline",size:"sm",onClick:k,className:"rounded-md h-8 text-xs",children:"Clear"}),e.jsx(z,{size:"sm",onClick:f,className:"rounded-md h-8 text-xs bg-primary hover:bg-primary/90",children:"Apply"})]})]})]})}const ad={locale:"en-IN"},Ao=ws({name:"locale",initialState:ad,reducers:{setLocale:(s,a)=>{s.locale=a.payload}}}),{setLocale:ia}=Ao.actions,rd=Ao.reducer,nd={notifications:[],unreadCount:0,isSoundEnabled:!0},Mo=ws({name:"notifications",initialState:nd,reducers:{addNotification:(s,a)=>{const t={...a.payload,id:Date.now().toString(),timestamp:new Date().toISOString(),isRead:!1};s.notifications.unshift(t),s.unreadCount+=1,s.notifications.length>50&&(s.notifications=s.notifications.slice(0,50))},markAsRead:(s,a)=>{const t=s.notifications.find(l=>l.id===a.payload);t&&!t.isRead&&(t.isRead=!0,s.unreadCount=Math.max(0,s.unreadCount-1))},markAllAsRead:s=>{s.notifications.forEach(a=>{a.isRead=!0}),s.unreadCount=0},removeNotification:(s,a)=>{const t=s.notifications.find(l=>l.id===a.payload);t&&!t.isRead&&(s.unreadCount=Math.max(0,s.unreadCount-1)),s.notifications=s.notifications.filter(l=>l.id!==a.payload)},clearAllNotifications:s=>{s.notifications=[],s.unreadCount=0},toggleSound:s=>{s.isSoundEnabled=!s.isSoundEnabled},setSoundEnabled:(s,a)=>{s.isSoundEnabled=a.payload}}}),{addNotification:To,markAsRead:od,markAllAsRead:ld,removeNotification:id,clearAllNotifications:cd,toggleSound:dd,setSoundEnabled:Kx}=Mo.actions,md=Mo.reducer,ud=$t("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ps({className:s,variant:a,...t}){return e.jsx("div",{className:Q(ud({variant:a}),s),...t})}const $o=()=>{const[s,a]=r.useState(!1),t=r.useRef(null),l=Me(),{notifications:o,unreadCount:i,isSoundEnabled:c}=V(x=>x.notifications);r.useEffect(()=>{const x=p=>{t.current&&!t.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const d=x=>{l(od(x))},u=(x,p)=>{x.stopPropagation(),l(id(p))},m=()=>{l(ld())},h=()=>{l(cd())},v=()=>{l(dd())},y=x=>{switch(x){case"success":return"";case"error":return"";case"warning":return"";default:return""}},S=x=>{switch(x){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"warning":return"border-yellow-200 bg-yellow-50";default:return"border-blue-200 bg-blue-50"}};return e.jsxs("div",{className:"relative",ref:t,children:[e.jsxs(z,{variant:"outline",size:"icon",className:"relative transition-transform duration-300 ease-in-out hover:scale-105",onClick:()=>a(!s),children:[e.jsx(ti,{className:"h-4 w-4"}),i>0&&e.jsx(ps,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 text-xs flex items-center justify-center",children:i>99?"99+":i})]}),s&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"ghost",size:"icon",onClick:v,className:"h-8 w-8",children:c?e.jsx(ai,{className:"h-4 w-4"}):e.jsx(ri,{className:"h-4 w-4"})}),i>0&&e.jsx(z,{variant:"ghost",size:"sm",onClick:m,className:"text-xs",children:"Mark all read"})]})]}),e.jsx(or,{className:"max-h-96",children:o.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"}):e.jsx("div",{className:"p-2",children:o.map(x=>e.jsx("div",{className:`p-3 rounded-lg border mb-2 cursor-pointer transition-colors hover:bg-gray-50 group ${x.isRead?"opacity-75":""} ${S(x.type)}`,onClick:()=>d(x.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("span",{className:"text-lg",children:y(x.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-medium text-sm ${x.isRead?"text-gray-600":"text-gray-900"}`,children:x.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:x.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:rc(new Date(x.timestamp),{addSuffix:!0})})]})]}),e.jsx(z,{variant:"ghost",size:"icon",onClick:p=>u(p,x.id),className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(hs,{className:"h-3 w-3"})})]})},x.id))})}),o.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 border-t border-gray-200",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[o.length," notification",o.length!==1?"s":""]}),e.jsx(z,{variant:"ghost",size:"sm",onClick:h,className:"text-xs text-red-600 hover:text-red-700",children:"Clear all"})]})]})]})},hd={},xd=ws({name:"conversionFilters",initialState:hd,reducers:{setFilter:(s,a)=>{const{componentId:t,column:l,filter:o}=a.payload;s[t]||(s[t]={}),JSON.stringify(s[t][l])!==JSON.stringify(o)&&(s[t][l]=o)},clearFilters:(s,a)=>{const t=a.payload;Object.keys(s[t]||{}).length>0&&(s[t]={})}}}),gd=xd.reducer,fd={groups:[],selectedCampaigns:[],editingGroupId:null,expandedGroups:[],isCreatingGroup:!1},zs=(s,a)=>{s.accounts||(s.accounts={}),s.accounts[a]||(s.accounts[a]={...fd})},pd=ws({name:"campaignGroups",initialState:{accounts:{}},reducers:{createGroup:(s,a)=>{const{accountId:t,name:l,campaigns:o,color:i}=a.payload;zs(s,t);const c={id:Date.now().toString(),name:l,campaigns:o,color:i};s.accounts[t].groups.push(c),s.accounts[t].selectedCampaigns=[],s.accounts[t].isCreatingGroup=!1},deleteGroup:(s,a)=>{const{accountId:t,groupId:l}=a.payload;zs(s,t),s.accounts[t].groups=s.accounts[t].groups.filter(o=>o.id!==l),s.accounts[t].editingGroupId===l&&(s.accounts[t].editingGroupId=null)},addCampaignToGroup:(s,a)=>{const{accountId:t,groupId:l,campaignName:o}=a.payload;zs(s,t);const i=s.accounts[t].groups.find(c=>c.id===l);i&&!i.campaigns.includes(o)&&i.campaigns.push(o)},removeCampaignFromGroup:(s,a)=>{const{accountId:t,groupId:l,campaignName:o}=a.payload;zs(s,t);const i=s.accounts[t].groups.find(c=>c.id===l);i&&(i.campaigns=i.campaigns.filter(c=>c!==o))},setSelectedCampaigns:(s,a)=>{const{accountId:t,campaigns:l}=a.payload;zs(s,t),s.accounts[t].selectedCampaigns=l},toggleEditingGroup:(s,a)=>{const{accountId:t,groupId:l}=a.payload;zs(s,t),s.accounts[t].editingGroupId=l},toggleGroupExpansion:(s,a)=>{const{accountId:t,groupId:l}=a.payload;zs(s,t);const o=s.accounts[t].expandedGroups;o.includes(l)?s.accounts[t].expandedGroups=o.filter(i=>i!==l):s.accounts[t].expandedGroups.push(l)},setIsCreatingGroup:(s,a)=>{const{accountId:t,isCreating:l}=a.payload;zs(s,t),s.accounts[t].isCreatingGroup=l,l||(s.accounts[t].selectedCampaigns=[])}}}),bd=pd.reducer,jd={labels:{},isAddingLabel:!1},Fo=ws({name:"campaignLabels",initialState:jd,reducers:{addLabelToCampaign:(s,a)=>{const{accountId:t,campaignId:l,label:o}=a.payload;s.labels[t]||(s.labels[t]={}),s.labels[t][l]||(s.labels[t][l]=[]),s.labels[t][l].includes(o)||s.labels[t][l].push(o)},removeLabelFromCampaign:(s,a)=>{const{accountId:t,campaignId:l,label:o}=a.payload;s.labels[t]&&s.labels[t][l]&&(s.labels[t][l]=s.labels[t][l].filter(i=>i!==o))},toggleAddingLabel:(s,a)=>{s.isAddingLabel=a.payload},clearAccountLabels:(s,a)=>{const t=a.payload;s.labels[t]&&(s.labels[t]={})},deleteLabel:(s,a)=>{const{accountId:t,label:l}=a.payload;s.labels[t]&&(Object.keys(s.labels[t]).forEach(o=>{s.labels[t][o]=s.labels[t][o].filter(i=>i!==l),s.labels[t][o].length===0&&delete s.labels[t][o]}),Object.keys(s.labels[t]).length===0&&delete s.labels[t])},copyLabels:(s,a)=>{const{accountId:t,sourceCampaignId:l,targetCampaignId:o}=a.payload;s.labels[t]&&s.labels[t][l]&&(s.labels[t][o]||(s.labels[t][o]=[]),s.labels[t][l].forEach(i=>{s.labels[t][o].includes(i)||s.labels[t][o].push(i)}))}}}),{addLabelToCampaign:yd,removeLabelFromCampaign:vd,toggleAddingLabel:Qx,clearAccountLabels:Jx,copyLabels:Zx,deleteLabel:Xx}=Fo.actions,Nd=Fo.reducer,wd={isFirstTimeLogin:!1,activeTutorial:null,isTutorialActive:!1,activeTutorialStep:0,tutorialQueue:[],completedTutorials:{}},_o=ws({name:"tutorial",initialState:wd,reducers:{setFirstTimeLogin:(s,a)=>{s.isFirstTimeLogin=a.payload},queueTutorials:(s,a)=>{const t=a.payload.filter(l=>!s.tutorialQueue.includes(l)&&l!==s.activeTutorial);if(t.length===0){console.log("No new tutorials to queue");return}s.tutorialQueue=[...t,...s.tutorialQueue],console.log(`Queued tutorials: ${t.join(", ")}, Queue is now: ${s.tutorialQueue.join(", ")}`),!s.isTutorialActive&&s.tutorialQueue.length>0&&(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Auto-starting tutorial: ${s.activeTutorial}`))},startTutorial:(s,a)=>{s.activeTutorial=a.payload,s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Manually starting tutorial: ${a.payload}`)},nextTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Completed tutorial: ${s.activeTutorial}`)),console.log(`nextTutorial called, queue length: ${s.tutorialQueue.length}, queue: [${s.tutorialQueue.join(", ")}]`),s.tutorialQueue.length>0?(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.activeTutorialStep=0,s.isTutorialActive=!0,console.log(`Starting next tutorial: ${s.activeTutorial}, remaining queue: [${s.tutorialQueue.join(", ")}]`)):(s.activeTutorial=null,s.isTutorialActive=!1,console.log("No more tutorials in queue, stopping tutorial mode"))},setTutorialStep:(s,a)=>{s.activeTutorialStep=a.payload},stopTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Tutorial stopped, marking ${s.activeTutorial} as completed`)),s.isTutorialActive=!1,s.activeTutorial=null,s.tutorialQueue=[],s.activeTutorialStep=0,console.log("Tutorial stopped, queue cleared")},completeFirstTimeLogin:s=>{s.isFirstTimeLogin=!1},resetTutorial:(s,a)=>{s.completedTutorials[a.payload]&&(s.completedTutorials[a.payload]=!1)},resetAllTutorials:s=>{s.completedTutorials={}}}}),{setFirstTimeLogin:Cd,queueTutorials:Io,startTutorial:eg,nextTutorial:La,setTutorialStep:Sd,stopTutorial:sg,completeFirstTimeLogin:kd,resetTutorial:tg,resetAllTutorials:ag}=_o.actions,Ad=_o.reducer,Md={fbToken:!1,googleAnalyticsToken:!1,googleAdsToken:!1},Po=ws({name:"tokenError",initialState:Md,reducers:{setFbTokenError:(s,a)=>{s.fbToken=a.payload},setGoogleAnalyticsTokenError:(s,a)=>{s.googleAnalyticsToken=a.payload},setGoogleAdsTokenError:(s,a)=>{s.googleAdsToken=a.payload},resetAllTokenErrors:s=>{s.fbToken=!1,s.googleAnalyticsToken=!1,s.googleAdsToken=!1}}}),{setFbTokenError:ca,setGoogleAnalyticsTokenError:_r,setGoogleAdsTokenError:Ir,resetAllTokenErrors:Eo}=Po.actions,cr=s=>s.tokenError.fbToken,Td=s=>s.tokenError.googleAnalyticsToken,Ca=s=>s.tokenError.googleAdsToken,$d=Po.reducer,Fd={filters:{}},Lo=ws({name:"interestFilter",initialState:Fd,reducers:{addFilter:(s,a)=>{const{tableId:t,filter:l}=a.payload,o=s.filters[t]||[];s.filters={...s.filters,[t]:[...o,l]}},removeFilter:(s,a)=>{const{tableId:t,index:l}=a.payload,o=s.filters[t]||[];s.filters={...s.filters,[t]:o.filter((i,c)=>c!==l)}},updateFilter:(s,a)=>{const{tableId:t,index:l,filter:o}=a.payload,i=s.filters[t]||[];s.filters={...s.filters,[t]:i.map((c,d)=>d===l?o:c)}},clearFilters:(s,a)=>{const{tableId:t}=a.payload;s.filters={...s.filters,[t]:[]}}}}),{addFilter:_d,removeFilter:Id,updateFilter:rg,clearFilters:Pd}=Lo.actions,Ed=Lo.reducer,Pr={brandName:"",connectedAccounts:{},googleAdsConnections:[],ga4Id:"",fbAdId:[],shop:"",shopifyAccessToken:""},Do=ws({name:"brandForm",initialState:Pr,reducers:{setBrandFormData:(s,a)=>({...s,...a.payload}),clearBrandFormData:()=>Pr}}),{setBrandFormData:Ld,clearBrandFormData:Dd}=Do.actions,Rd=Do.reducer,Od=xc({conversionFilters:gd,brand:Lc,user:Oc,date:sd,campaignGroups:bd,campaignLabels:Nd,tutorials:Ad,locale:rd,tokenError:$d,interestFilter:Ed,brandForm:Rd,notifications:md}),zd={key:"root",storage:uc,whitelist:["tokenError","conversionFilters","brand","user","date","campaignGroups","campaignLabels","tutorials","locale","interestFilter","brandForm","notifications"],transforms:[{in:s=>{if(s.notifications&&s.notifications.notifications){const a=new Date;a.setDate(a.getDate()-7);const t=s.notifications.notifications.filter(l=>new Date(l.timestamp)>a).slice(0,50);return{...s,notifications:{...s.notifications,notifications:t,unreadCount:t.filter(l=>!l.isRead).length}}}return s},out:s=>s}]},Bd=mc(zd,Od),Ds=Yl({reducer:Bd,middleware:s=>s({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE","persist/REGISTER"]}})}),Gd=dc(Ds);let ke=null,Us=!1,ks=!1,Gt=null,Nt=null,wt=0;const Er=5;let ot=null;const Va="https://parallels.messold.com";console.log("Socket Service Environment:",{PROD:!0,baseURL:Va});const Ud=(s,a)=>{if(console.log(" initializeSocket called with:",{userId:s,brandId:a,isConnecting:Us,isConnected:ks}),Us){console.log(" Connection already in progress, skipping...");return}if(s&&(Gt=s),a&&(Nt=a),ke!=null&&ke.connected&&ks){console.log(" Socket already connected, handling room changes..."),zo();return}ke&&!ke.connected&&(console.log(" Cleaning up disconnected socket..."),ke.removeAllListeners(),ke=null,ks=!1),Ro()},Ro=()=>{console.log(" Creating new socket connection to:",Va),console.log(" Connection details:",{withCredentials:!0,transports:["polling","websocket"],timeout:2e4,autoConnect:!0,reconnection:!1,forceNew:!0}),Us=!0,wt++,ot&&(clearTimeout(ot),ot=null),ke=cc(Va,{withCredentials:!0,transports:["polling","websocket"],timeout:2e4,autoConnect:!0,reconnection:!1,forceNew:!0,extraHeaders:{"X-Requested-With":"XMLHttpRequest"}}),ke.on("connect",()=>{console.log(" Socket connected successfully:",ke==null?void 0:ke.id),Us=!1,ks=!0,wt=0,zo()}),ke.on("connect_error",s=>{console.error(" Socket connection error:",s),Us=!1,ks=!1,Vd(s)}),ke.on("disconnect",s=>{if(console.log(" Socket disconnected, reason:",s),Us=!1,ks=!1,s==="io server disconnect"){console.log("Server initiated disconnect, not reconnecting");return}Oo()}),ke.on("error",s=>{console.error(" Socket error:",s)}),Wd()},Vd=s=>{var a,t,l,o,i;if(console.error("Connection error details:",{message:s.message,name:s.name,type:s.type,code:s.code}),(a=s.message)!=null&&a.includes("Authentication")||(t=s.message)!=null&&t.includes("Unauthorized")){console.error(" Authentication failed for socket connection"),Ds.dispatch(To({type:"error",title:"Connection Error",message:"Authentication failed. Please log in again."}));return}(l=s.message)!=null&&l.includes("server error")&&console.error(" Server error detected - check server logs"),((o=s.message)!=null&&o.includes("Network Error")||(i=s.message)!=null&&i.includes("timeout"))&&console.error(" Network error detected"),Oo()},Oo=()=>{if(wt>=Er){console.error(" Max reconnection attempts reached, giving up");return}const s=Math.min(1e3*Math.pow(2,wt),3e4);console.log(` Attempting reconnection in ${s}ms (attempt ${wt+1}/${Er})`),ot=setTimeout(()=>{!ks&&!Us&&Ro()},s)},zo=()=>{if(!(ke!=null&&ke.connected)){console.warn(" Socket not connected, cannot handle room changes");return}Gt&&(console.log(" Joining user room:",Gt),ke.emit("join-user-room",Gt)),Nt&&(console.log(" Joining brand room:",Nt),ke.emit("join-brand-room",Nt))},Wd=()=>{ke&&(ke.on("brand-notification",s=>{console.log(" Brand notification received:",s),Lr(s)}),ke.on("notification",s=>{console.log(" User notification received:",s),Lr(s)}),ke.on("pong",s=>{console.log(" Pong received:",s)}))},Lr=s=>{const{type:a,data:t}=s;let l="info",o="Notification",i="You have a new notification";switch(a){case"metrics-calculation-complete":l=t.success?"success":"error",o="Metrics Calculation",i=t.success?"Metrics calculation completed successfully!":`Calculation failed: ${t.message}`;break;case"metrics-calculation-error":l="error",o="Calculation Error",i=`Error calculating metrics: ${t.error}`;break;default:o="System Notification",i=t.message||"You have a new notification"}Ds.dispatch(To({type:l,title:o,message:i,brandId:t.brandId,actionUrl:t.actionUrl})),Hd()},Hd=()=>{const{isSoundEnabled:s}=Ds.getState().notifications;if(s)try{const a=new(window.AudioContext||window.webkitAudioContext),t=a.createOscillator(),l=a.createGain();t.connect(l),l.connect(a.destination),t.frequency.setValueAtTime(800,a.currentTime),t.frequency.setValueAtTime(600,a.currentTime+.1),l.gain.setValueAtTime(.3,a.currentTime),l.gain.exponentialRampToValueAtTime(.01,a.currentTime+.2),t.start(a.currentTime),t.stop(a.currentTime+.2)}catch(a){console.warn(" Could not play notification sound:",a)}},qd=s=>{console.log(" joinBrandRoom called with:",s),Nt=s,ke!=null&&ke.connected&&ks?(console.log(` Emitting join-brand-room for brand: ${s}`),ke.emit("join-brand-room",s)):console.warn(" Socket not connected, will join brand room after connection")},Yd=s=>{ke!=null&&ke.connected&&ks&&(ke.emit("leave-brand-room",s),console.log(` Left brand room: ${s}`))},Dr=()=>{console.log(" Disconnecting socket..."),ot&&(clearTimeout(ot),ot=null),ke&&(ke.removeAllListeners(),ke.disconnect(),ke=null),Us=!1,ks=!1,Gt=null,Nt=null,wt=0},Lt=()=>!!(ke!=null&&ke.connected&&ks),Kd=()=>{const s=V(c=>c.user.user),a=V(c=>c.brand.selectedBrandId),t=r.useRef(null),l=r.useRef(null),o=r.useRef(!1),i=r.useRef(!1);return console.log("useSocketConnection - Current state:",{hasUser:!!s,userId:s==null?void 0:s.id,selectedBrandId:a,previousBrandId:t.current,isInitialized:o.current,isInitializing:i.current,isSocketConnected:Lt()}),r.useEffect(()=>{const c=s==null?void 0:s.id;if(!c){console.log(" No user ID available, cleaning up socket connection"),o.current&&(Dr(),o.current=!1,i.current=!1,l.current=null,t.current=null);return}const d=l.current!==c,u=!o.current,m=!Lt(),h=(u||d||m)&&!i.current;if(h){console.log(" Initializing socket connection for user:",c,"brand:",a),console.log(" Initialization reason:",{isFirstTime:u,userChanged:d,socketNotConnected:m}),i.current=!0;try{Ud(c,a||void 0),o.current=!0,l.current=c,t.current=a}catch(y){console.error(" Error initializing socket connection:",y),i.current=!1}}else console.log(" Skipping socket initialization:",{shouldInitialize:h,isFirstTime:u,userChanged:d,socketNotConnected:m,isInitializing:i.current});const v=setTimeout(()=>{i.current=!1},1e3);return()=>{clearTimeout(v)}},[s==null?void 0:s.id]),r.useEffect(()=>{const c=a,d=t.current!==c;if(d&&Lt()&&o.current){console.log(" Brand changed from",t.current,"to",c);try{t.current&&(console.log(" Leaving previous brand room:",t.current),Yd(t.current)),c&&(console.log(" Joining new brand room:",c),qd(c)),t.current=c}catch(u){console.error(" Error handling brand change:",u)}}else d&&console.log(" Skipping brand change:",{brandChanged:d,isSocketConnected:Lt(),isInitialized:o.current})},[a]),r.useEffect(()=>()=>{try{console.log(" Component unmounting, disconnecting socket"),Dr(),o.current=!1,i.current=!1,l.current=null,t.current=null}catch(c){console.error(" Error disconnecting socket on unmount:",c)}},[]),{isConnected:Lt()}};function Sa({title:s,Icon:a,showDatePicker:t=!1,showSettings:l=!1,showRefresh:o=!1,isLoading:i=!1,handleManualRefresh:c}){const d=Me(),u=V(m=>m.locale.locale);return Kd(),e.jsx("header",{className:"sticky top-0 z-40 bg-white border-b px-6 py-3 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"rounded-lg bg-secondary p-2 transition-transform duration-300 ease-in-out hover:scale-110",children:e.jsx(a,{className:"h-6 w-6 text-secondary-foreground"})}),e.jsx("h1",{className:"text-2xl font-semibold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-secondary-foreground to-primary",children:s})]}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[t&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),o&&e.jsx("div",{className:"md:flex items-center hidden",children:e.jsx(z,{onClick:c,disabled:i,className:"flex items-center",children:e.jsx($e,{className:`h-4 w-4 ${i?"animate-spin":""}`})})}),e.jsx($o,{}),l&&e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",children:e.jsx(ga,{className:"h-4 w-4"})})}),e.jsx(Ys,{children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx("h3",{className:"font-medium",children:"Locale Settings"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-IN",checked:u==="en-IN",onChange:()=>d(ia("en-IN")),className:"mr-2"}),"Indian Formatting"]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-US",checked:u==="en-US",onChange:()=>d(ia("en-US")),className:"mr-2"}),"Western Formatting"]})]})]})})]})]})]})})}function Ae({isLoading:s}){const[a,t]=r.useState(0),[l,o]=r.useState(0),[i,c]=r.useState(!1),d=["Just a moment, we're getting things ready...","Almost there, hang tight!","Brewing some magic for you...","The best things are worth waiting for...","Gathering all the awesome stuff...","Just putting on the finishing touches...","We're working our digital magic...","Your experience is being crafted...","Just a few more seconds of patience...","You're going to love what's coming..."];return r.useEffect(()=>{const u=setInterval(()=>{t(h=>s&&h>=95?95:!s&&h<100?(clearInterval(u),t(100),setTimeout(()=>{c(!0)},300),100):h<95?h+1:h)},80),m=setInterval(()=>{i||o(h=>(h+1)%d.length)},2500);return()=>{clearInterval(u),clearInterval(m)}},[s,i]),e.jsxs("div",{className:"flex flex-col items-center justify-center bg-white text-black text-center px-4 z-50 min-h-screen",children:[e.jsx("div",{className:"h-20 flex items-center justify-center mb-6 overflow-hidden",children:e.jsx("h3",{className:"text-xl font-medium text-black/80 animate-fadeIn",children:i?"Ready!":d[l]},l)}),e.jsx("div",{className:"relative w-full max-w-md mx-auto mb-4",children:e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full transition-all duration-300 ease-out",style:{width:`${a}%`}})})}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 font-mono mb-8 w-full max-w-md",children:[e.jsx("span",{children:"Loading"}),e.jsxs("span",{children:[a,"%"]})]}),i&&e.jsx("div",{className:"mt-6 animate-fadeIn",children:e.jsxs("div",{className:"text-xl font-medium text-primary flex items-center justify-center gap-2",children:[e.jsx(At,{className:"w-5 h-5"}),e.jsx("span",{children:"You've arrived! Welcome."})]})}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-in forwards;
        }
      `})]})}const Ce=()=>{const s=Xe(),a=Me(),t=ne.create({baseURL:"https://parallels.messold.com",withCredentials:!0});return t.interceptors.response.use(l=>{var o,i,c,d,u,m;return(i=(o=l.config)==null?void 0:o.url)!=null&&i.includes("/meta")?a(ca(!1)):(d=(c=l.config)==null?void 0:c.url)!=null&&d.includes("/analytics")?a(_r(!1)):(m=(u=l.config)==null?void 0:u.url)!=null&&m.includes("/google")&&a(Ir(!1)),l},l=>{var o,i,c,d,u,m,h,v;return((o=l.response)==null?void 0:o.status)===401?(console.log("401 Unauthorized - Token expired or invalid"),Ds.dispatch(wa()),Ds.dispatch(Na()),ne.post(`${be}/api/auth/logout`,{},{withCredentials:!0}).catch(()=>{}),s("/login")):((i=l.response)==null?void 0:i.status)===403&&((d=(c=l.config)==null?void 0:c.url)!=null&&d.includes("/meta")?a(ca(!0)):(m=(u=l.config)==null?void 0:u.url)!=null&&m.includes("/analytics")?a(_r(!0)):(v=(h=l.config)==null?void 0:h.url)!=null&&v.includes("/google")?a(Ir(!0)):console.warn("Token error occurred but type could not be determined:",l)),Promise.reject(l)}),t};function Ht({platform:s,open:a,onOpenChange:t,brandId:l,onSuccess:o}){const[i,c]=r.useState(""),[d,u]=r.useState([]),[m,h]=r.useState([]),[v,y]=r.useState([]),[S,x]=r.useState(!1),[p,N]=r.useState(!1),[j,w]=r.useState([]),[P,g]=r.useState([]),$="https://parallels.messold.com",F=Me(),A=V(L=>L.brand.brands);r.useEffect(()=>{const L=new URLSearchParams(window.location.search),k=L.get("openModal");if(k&&t){switch(k.toLowerCase()){case"googleads":s.toLowerCase()==="google ads"&&t(!0);break;case"googleanalytics":s.toLowerCase()==="google analytics"&&t(!0);break;case"facebook":s.toLowerCase()==="facebook"&&t(!0);break}L.delete("openModal");const f=`${window.location.pathname}${L.toString()?`?${L.toString()}`:""}`;window.history.replaceState({},"",f)}},[s,t]),r.useEffect(()=>{a&&l&&(async()=>{var k,f;try{const b=(await ne.get(`${$}/api/brands/${l}`,{withCredentials:!0})).data,T=[];(k=b.fbAdAccounts)!=null&&k.length&&T.push(...b.fbAdAccounts),b.googleAdAccount&&T.push(b.googleAdAccount),(f=b.ga4Account)!=null&&f.PropertyID&&T.push(b.ga4Account.PropertyID),w(T)}catch(n){console.error("Error fetching connected accounts:",n)}})()},[l,a]),r.useEffect(()=>{(async()=>{var k;if(a){N(!0);try{let f="",n=null;switch(s.toLowerCase()){case"google ads":f=`/api/setup/google-accounts/${l}`,n=u;break;case"google analytics":f=`/api/setup/ga4-propertyIds/${l}`,n=h;break;case"facebook":f=`/api/setup/fb-ad-accounts/${l}`,n=y;break}if(console.log(`Calling API: ${$}${f} with brandId: ${l}`),!f)throw new Error("Invalid platform");const b=await ne.get(`${$}${f}`,{withCredentials:!0});b.status===200&&(x(!1),s.toLowerCase()==="google ads"?n((k=b.data)==null?void 0:k.clientAccounts.filter(T=>!T.hidden)):s.toLowerCase()==="google analytics"?n(b.data.propertiesList||[]):s.toLowerCase()==="facebook"&&n(b.data.adAccounts||[]))}catch(f){C(f,x)}finally{N(!1)}}})()},[s,l,a]);const C=(L,k)=>{const f=L;if(f.response){const{status:n,data:b}=f.response,T=b==null?void 0:b.code;if(n===401&&(T==="OAUTH_NOT_AUTHORIZED"||T==="TOKEN_EXPIRED"))s.toLowerCase()==="facebook"&&T==="OAUTH_NOT_AUTHORIZED"||alert("Your session has expired. Please log in again."),k(!0);else if(n===400){const U=b==null?void 0:b.error;(U==null?void 0:U.code)===190&&(U==null||U.error_subcode),k(!0)}else n===403?k(!0):(console.error("Unhandled Error Status:",n),console.error("Error Message:",b))}else f.request?console.error("No response received:",f.request):console.error("Unexpected Error:",f.message)},_=async(L,k,f)=>{var n;try{let b={};switch(s.toLowerCase()){case"facebook":const U=A.find(G=>G._id===l),D=(U==null?void 0:U.fbAdAccounts)||[];b={fbAdAccounts:[...new Set([...D,...L])]};break;case"google ads":const K=A.find(G=>G._id===l),q=(K==null?void 0:K.googleAdAccount)||[],ee=L.map((G,se)=>({clientId:G,managerId:f[se]||""})),J=[...q];ee.forEach(G=>{J.some(te=>te.clientId===G.clientId&&te.managerId===G.managerId)||J.push({clientId:G.clientId,managerId:G.managerId||""})}),b={googleAdAccount:J};break;case"google analytics":const ae=A.find(G=>G._id===l);((n=ae==null?void 0:ae.ga4Account)==null?void 0:n.PropertyID)?b={ga4Account:{PropertyID:L[0]}}:b={ga4Account:{PropertyID:L[0]}};break}const T=await ne.patch(`${$}/api/brands/update/${l}`,b,{withCredentials:!0});if(T.status===200){const U=T.data,D=A.map(W=>W._id===l?U:W);F(va(D)),L.forEach((W,K)=>{o==null||o(s,k[K],W)})}}catch(b){console.error("Error updating brand:",b)}},I=L=>{g(k=>k.includes(L)?k.filter(f=>f!==L):[...k,L])},B=async()=>{if(P.length===0)return;const L=P.map(k=>{var T;const f=(T=R())==null?void 0:T.find(U=>s.toLowerCase()==="google ads"?U.clientId===k:s.toLowerCase()==="facebook"?U.id===k:U.propertyId===k);if(!f)return null;let n,b;if("clientId"in f)b=f.managerId,n=b?`${f.name} (${f.clientId}/${b})`:`${f.name} (${f.clientId})`;else if("propertyId"in f)n=`${f.propertyName} (${f.propertyId})`;else if("id"in f)n=`${f.adname}`;else return null;return{accountId:k,displayName:n,managerId:b}}).filter(Boolean);if(L.length>0){const k=L.map(b=>b.accountId),f=L.map(b=>b.displayName),n=L.map(b=>b.managerId);await _(k,f,n),console.log(`Successfully connected ${L.length} account(s)`),g([]),t(!1)}},O=async()=>{try{const L=await ne.get(`${$}/api/auth/google?context=googleAdSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:k}=L.data;window.location.href=k}catch(L){console.error("Error getting Google Auth URL:",L)}},E=async()=>{try{const L=await ne.get(`${$}/api/auth/google?context=googleAnalyticsSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:k}=L.data;window.location.href=k}catch(L){console.error("Error getting Google Auth URL:",L)}},M=async()=>{try{const L=await ne.get(`${$}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});L.data.success&&(window.location.href=L.data.authURL)}catch(L){console.error("Error getting Facebook Auth URL:",L)}},R=()=>s.toLowerCase()==="google ads"?!d||d.length===0?[]:d.filter(L=>{const k=i.toLowerCase();return L.name&&L.name.toLowerCase().includes(k)||L.clientId&&L.clientId.toLowerCase().includes(k)||L.managerId&&L.managerId.toLowerCase().includes(k)}):s.toLowerCase()==="google analytics"?!m||m.length===0?[]:m.filter(L=>{const k=i.toLowerCase();return L.propertyName&&L.propertyName.toLowerCase().includes(k)||L.propertyId&&L.propertyId.toLowerCase().includes(k)}):s.toLowerCase()==="facebook"?!v||v.length===0?[]:v.filter(L=>{const k=i.toLowerCase();return L.adname&&L.adname.toLowerCase().includes(k)||L.id&&L.id.toLowerCase().includes(k)}):[];return e.jsx(ut,{open:a,onOpenChange:t,children:e.jsxs(Ks,{className:"sm:max-w-[600px]",children:[e.jsx(Qs,{children:e.jsxs(Js,{children:["Connect ",s," Account"]})}),e.jsx("div",{className:"space-y-4",children:p?e.jsx("div",{className:"flex justify-center py-4",children:"Loading..."}):S?e.jsxs("div",{className:"space-y-3",children:[s.toLowerCase()==="facebook"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-3",children:e.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Your Facebook authorization has expired. Please reconnect your account to continue."})}),e.jsxs(z,{size:"sm",onClick:s.toLowerCase()==="facebook"?M:s.toLowerCase()==="google ads"?O:E,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(ms,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(vs,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(_s,{height:"1rem",width:"1rem"}),"Reconnect Facebook Account"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(ve,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:i,onChange:L=>c(L.target.value)})]}),P.length>0&&e.jsx("div",{className:"sticky top-0 z-10 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-blue-800",children:[P.length," account(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{size:"sm",variant:"outline",onClick:()=>{g([]),t(!1)},className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs(z,{size:"sm",onClick:B,className:"bg-blue-600 hover:bg-blue-700",children:["Save (",P.length,")"]})]})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(()=>{const L=R();return!L||L.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:i?"No accounts found matching your search.":"No accounts available."}):L.map((k,f)=>{const n=s.toLowerCase()==="google ads",b=s.toLowerCase()==="facebook",T=n?k.clientId:b?k.id:k.propertyId,U=n?k.managerId:void 0,D=n?k.name:b?k.adname:k.propertyName,W=n&&U?`${T}-${U}`:T,K=n?e.jsx(ms,{height:"1rem",width:"1rem"}):b?e.jsx(_s,{height:"1rem",width:"1rem"}):e.jsx(vs,{height:"1rem",width:"1rem"}),q=j.includes(T),ee=P.includes(T),J=n&&U?`${D} (${T}/${U})`:b?`${D}`:`${D} (${T})`;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[K,J]})})}),e.jsxs(z,{size:"sm",onClick:()=>I(T),disabled:q,className:q?"bg-gray-400":ee?"bg-green-600":"bg-blue-600",children:[q&&e.jsx(Hs,{className:"h-4 w-4 mr-2"}),q?"Connected":ee?"Selected":"Select"]})]},W)})})()})]})})]})})}const Rr="https://parallels.messold.com";function Bo({onClose:s}){var w,P;const[a,t]=r.useState({brandName:"",description:"",departmentId:""}),[l,o]=r.useState([]),[i,c]=r.useState(!1),[d,u]=r.useState(!1),[m,h]=r.useState({}),[v,y]=r.useState(!1),S=V(g=>g.brand.selectedBrandId),x=V(g=>{var $;return($=g.brand.brands.find(F=>F._id===S))==null?void 0:$.name});r.useEffect(()=>{x&&t(g=>({...g,brandName:x}))},[x]),r.useEffect(()=>{(async()=>{var $,F,A,C;c(!0),y(!1);try{const _=await ne.get(`${Rr}/api/zoho/departments`,{withCredentials:!0});_.data&&_.data.departments&&_.data.departments.length>0&&(o(_.data.departments),t(I=>({...I,departmentId:_.data.departments[0].id})))}catch(_){console.error("Error fetching departments:",_),(($=_.response)==null?void 0:$.status)===401||(C=(A=(F=_.response)==null?void 0:F.data)==null?void 0:A.message)!=null&&C.includes("Zoho integration not configured")?y(!0):h({form:"Failed to load departments. Please try again later."})}finally{c(!1)}})()},[]);const p=g=>{const{name:$,value:F}=g.target;t(A=>({...A,[$]:F})),m[$]&&h(A=>{const C={...A};return delete C[$],C})},N=()=>{const g={};return(a.brandName||x||"").trim()||(g.brandName="Brand name is required"),a.description.trim()||(g.description="Description is required"),a.departmentId||(g.departmentId="Department is required"),h(g),Object.keys(g).length===0},j=async g=>{if(g.preventDefault(),!!N()){u(!0);try{const $=(a.brandName||x||"").trim();if(!$){h({brandName:"Brand name is required"}),u(!1);return}const F={brandName:$,description:a.description.trim(),departmentId:a.departmentId};console.log("Submitting ticket with data:",{brandName:F.brandName,hasDescription:!!F.description,departmentId:F.departmentId}),(await ne.post(`${Rr}/api/zoho/create-ticket`,F,{withCredentials:!0})).data.success&&s()}catch($){console.error("Error submitting ticket:",$),h({form:"There was an error submitting your tickets. Please try again."})}finally{u(!1)}}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-800 px-6 py-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center",children:[e.jsx(ni,{className:"mr-2 h-5 w-5"}),"Submit your requirements"]}),e.jsx("button",{onClick:s,className:"text-slate-300 hover:text-white transition-colors",children:e.jsx(hs,{className:"h-6 w-6"})})]}),v&&e.jsx("div",{className:"mx-6 mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(js,{className:"h-5 w-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-800 mb-1",children:"Zoho Integration Not Configured"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-2",children:"The Zoho integration needs to be set up before you can submit tickets. Please contact your administrator to configure Zoho."})]})]})}),m.form&&!v&&e.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(js,{className:"h-5 w-5 text-red-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-red-700 text-sm",children:m.form})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"brandName",children:["Brand Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Zn,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"brandName",name:"brandName",type:"text",value:a.brandName||x||"",onChange:p,readOnly:!!x,className:`pl-10 block w-full px-3 py-2.5 border ${m.brandName?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 ${x?"bg-slate-50 cursor-not-allowed":""}`,placeholder:"Your brand name"})]}),m.brandName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.brandName})]}),!i&&l.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Department"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(oi,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:"text",value:((w=l.find(g=>g.id===a.departmentId))==null?void 0:w.name)||((P=l[0])==null?void 0:P.name)||"No department available",readOnly:!0,className:"pl-10 block w-full px-3 py-2.5 border border-slate-300 rounded-md shadow-sm bg-slate-50 cursor-not-allowed text-slate-600"})]}),m.departmentId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.departmentId})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"description",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:p,rows:5,className:`block w-full px-3 py-2.5 border ${m.description?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Please provide detailed information about your requirements"}),m.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.description})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{type:"submit",disabled:d||v,className:`flex-1 bg-slate-700 text-white py-2.5 px-4 rounded-md hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors ${d||v?"opacity-70 cursor-not-allowed":""}`,children:d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(it,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(li,{className:"w-4 h-4"}),"Submit Ticket"]})}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-white text-slate-700 py-2.5 px-4 border border-slate-300 rounded-md hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors",children:"Cancel"})]})]})]})}function Qd({onNavigate:s,brandId:a,startDate:t,endDate:l}){const[o,i]=r.useState(null),[c,d]=r.useState(!0),u=Ce();if(r.useEffect(()=>{a&&(async()=>{try{d(!0);let y=t,S=l;if(!y||!S){const p=new Date,N=new Date(p.getFullYear(),p.getMonth(),1),j=new Date(p.getFullYear(),p.getMonth(),p.getDate()),w=P=>{const g=P.getFullYear(),$=String(P.getMonth()+1).padStart(2,"0"),F=String(P.getDate()).padStart(2,"0");return`${g}-${$}-${F}`};y=w(N),S=w(j)}const x=await u.post(`/api/highlights/conversion-funnel/${a}`,{startDate:y,endDate:S},{withCredentials:!0});x.data&&x.data.success&&x.data.data&&i(x.data.data)}catch(y){console.error("Error fetching conversion funnel data:",y)}finally{d(!1)}})()},[a,t,l]),c)return e.jsxs("div",{className:"bg-white border rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer flex flex-col h-[380px]",onClick:s,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(vs,{width:"1.2rem",height:"1.2rem"})}),e.jsx("h3",{className:"font-semibold text-slate-800",children:"E-Commerce Funnel"})]})})}),e.jsxs("div",{className:"p-4 animate-pulse space-y-4 flex-1 overflow-y-auto",children:[e.jsx("div",{className:"h-48 bg-slate-100 rounded"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"h-16 bg-slate-100 rounded"}),e.jsx("div",{className:"h-16 bg-slate-100 rounded"})]})]})]});if(!o)return e.jsxs("div",{className:"bg-white border rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer flex flex-col h-[450px]",onClick:s,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(vs,{width:"1.2rem",height:"1.2rem"})}),e.jsx("h3",{className:"font-semibold text-slate-800",children:"E-Commerce Funnel"})]})}),e.jsx("div",{className:"p-4 flex-1 flex items-center justify-center overflow-y-auto",children:e.jsxs("div",{className:"text-center text-slate-400",children:[e.jsx("p",{className:"text-sm",children:"No data available"}),e.jsx("p",{className:"text-xs mt-1",children:"Connect Google Analytics to see metrics"})]})})]});const m=[{stage:"Sessions",count:o.Sessions,rate:"-"},{stage:"Add To Cart",count:o["Add To Cart"],rate:o["Add To Cart Rate"]},{stage:"Checkouts",count:o.Checkouts,rate:o["Checkout Rate"]},{stage:"Purchases",count:o.Purchases,rate:o["Purchase Rate"]}],h=({active:v,payload:y})=>{if(v&&y&&y.length){const S=y[0].payload;return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"font-semibold text-slate-700 mb-2",children:S.stage}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"Count:"}),e.jsx("span",{className:"font-bold",children:S.count.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"Rate:"}),e.jsx("span",{className:"font-bold",children:S.rate})]})]})]})}return null};return e.jsxs("div",{className:"bg-white border rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer group flex flex-col h-[380px]",onClick:s,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg group-hover:bg-blue-100 transition-colors",children:e.jsx(vs,{width:"1.2rem",height:"1.2rem"})}),e.jsx("h3",{className:"font-semibold text-slate-800",children:"E-Commerce Funnel"})]})})}),e.jsxs("div",{className:"p-4 space-y-4 flex-1 overflow-y-auto",children:[e.jsx("div",{className:"h-56",children:e.jsx(ar,{width:"100%",height:"100%",children:e.jsxs(gc,{data:m,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})}),e.jsx(fc,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(ho,{dataKey:"stage",tick:{fontSize:11},stroke:"#64748b"}),e.jsx(xo,{tick:{fontSize:11},stroke:"#64748b"}),e.jsx(rr,{content:e.jsx(h,{})}),e.jsx(go,{wrapperStyle:{fontSize:"12px"},iconType:"circle"}),e.jsx(pc,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:3,fillOpacity:1,fill:"url(#colorCount)",name:"Count"})]})})}),e.jsx("div",{className:"pt-2 border-t border-slate-100 flex-shrink-0",children:e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Click to view detailed analytics "})})]})]})}function Jd({onNavigate:s,brandId:a}){const[t,l]=r.useState([]),[o,i]=r.useState(!0),c=Ce();r.useEffect(()=>{a&&(async()=>{try{i(!0);const x=await c.get(`/api/highlights/marketing/${a}`);x.data.success&&l(x.data.monthlyMetrics)}catch(x){console.error("Error fetching marketing insights:",x)}finally{i(!1)}})()},[a]);const d=S=>`${S.toFixed(0)}`;if(o)return e.jsx(Ct,{title:"Marketing Insights",icon:e.jsx(Qe,{className:"h-5 w-5 text-purple-600"}),onNavigate:s,children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-8 bg-slate-100 rounded"}),e.jsx("div",{className:"h-20 bg-slate-100 rounded"}),e.jsx("div",{className:"h-20 bg-slate-100 rounded"})]})});if(!t||t.length===0)return e.jsx(Ct,{title:"Marketing Insights",icon:e.jsx(Qe,{className:"h-5 w-5 text-purple-600"}),onNavigate:s,children:e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx("p",{className:"text-sm",children:"No data available"}),e.jsx("p",{className:"text-xs mt-1",children:"Monthly metrics will appear here"})]})});const m=(()=>{if(t.length===0)return[];const S=["period","month","year"];return Object.keys(t[0]).filter(x=>!S.includes(x))})(),h=S=>({totalSales:"Total Sales",totalRefunds:"Total Refunds",metaSpend:"Meta Spend",metaRevenue:"Meta Sales",metaROAS:"Meta ROAS",googleSpend:"Google Spend",googleSales:"Google Sales",googleROAS:"Google ROAS",totalSpend:"Total Ad Spend",grossROI:"Gross ROI"})[S]||S,v=(S,x)=>S.toLowerCase().includes("roas")||S.toLowerCase().includes("roi")?x.toFixed(2)+"x":d(x),y=(S,x)=>S==="grossROI"?x>=2?"text-green-600 font-bold":x>=1?"text-amber-600 font-semibold":"text-red-600 font-semibold":S==="metaROAS"?x>=3?"text-green-600 font-semibold":x>=2?"text-amber-600":"text-slate-600":S==="totalSales"?"font-semibold text-slate-800":"text-slate-600";return e.jsx(Ct,{title:"Marketing Insights",icon:e.jsx(Qe,{className:"h-5 w-5 text-purple-600"}),onNavigate:s,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-2 flex-1",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"sticky top-0 bg-white z-10",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"text-left p-2 font-semibold text-slate-600 sticky left-0 bg-white",children:"Period"}),m.map(S=>e.jsx("th",{className:"text-right p-2 font-semibold text-slate-600 whitespace-nowrap",children:h(S)},S))]})}),e.jsx("tbody",{children:t.map((S,x)=>e.jsxs("tr",{className:Q("border-b border-slate-100 hover:bg-slate-50 transition-colors",x===0&&"bg-blue-50/30"),children:[e.jsxs("td",{className:"p-2 font-medium text-slate-700 sticky left-0 bg-white whitespace-nowrap",children:[S.period,x===0&&e.jsx("span",{className:"ml-1 text-blue-600 text-[10px]",children:""})]}),m.map(p=>e.jsx("td",{className:Q("p-2 text-right whitespace-nowrap",y(p,S[p])),children:v(p,S[p])},p))]},`${S.period}-${x}`))})]})}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-100 flex-shrink-0",children:e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Click to view full monthly breakdown "})})]})})}function Zd({performanceData:s,apiStatus:a,onRefresh:t,loading:l}){const[o,i]=r.useState(!1),c={yesterday:"Yesterday",last7Days:"Last 7 Days",last14Days:"Last 14 Days",last30Days:"Last 30 Days",quarterly:"Quarterly"},d={metaspend:"Meta Spend",metaroas:"Meta ROAS",googlespend:"Google Spend",googleroas:"Google ROAS",sessions:"Sessions",addToCarts:"Add to Carts",checkouts:"Checkouts",purchases:"Purchases",addToCartRate:"Add to Cart Rate",checkoutRate:"Checkout Rate",purchaseRate:"Purchase Rate"},u=j=>j.startsWith("meta")?e.jsx(_s,{width:"1rem",height:"1rem"}):j.startsWith("google")?e.jsx(ms,{width:"1rem",height:"1rem"}):e.jsx(vs,{width:"1rem",height:"1rem"}),h=(()=>{const j=new Set;return["yesterday","last7Days","last14Days","last30Days","quarterly"].forEach(w=>{var P,g,$;(P=s.meta)!=null&&P[w]&&a.meta&&Object.keys(s.meta[w]).forEach(F=>j.add(F)),(g=s.google)!=null&&g[w]&&a.google&&Object.keys(s.google[w]).forEach(F=>j.add(F)),($=s.analytics)!=null&&$[w]&&a.analytics&&Object.keys(s.analytics[w]).forEach(F=>j.add(F))}),Array.from(j)})(),v=(j,w)=>{var P,g,$,F,A,C;return(g=(P=s.meta)==null?void 0:P[j])!=null&&g[w]&&a.meta?s.meta[j][w]:(F=($=s.google)==null?void 0:$[j])!=null&&F[w]&&a.google?s.google[j][w]:(C=(A=s.analytics)==null?void 0:A[j])!=null&&C[w]&&a.analytics?s.analytics[j][w]:null},y=(j,w)=>w.toLowerCase().includes("roas")||w.toLowerCase().includes("rate")?j.toFixed(2):j>=1e3?Math.round(j).toLocaleString():j;if(h.length===0)return e.jsx("div",{className:"bg-white border rounded-lg shadow-md p-6",children:e.jsx("div",{className:"text-center text-slate-500 py-8",children:"No performance data available. Connect your platforms to see metrics."})});const S=["yesterday","last7Days","last14Days","last30Days","quarterly"],x=4,p=o?h:h.slice(0,x),N=h.length>x;return e.jsxs("div",{className:"bg-white border rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Performance Overview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{onClick:t,disabled:l,size:"sm",variant:"outline",className:"hover:bg-slate-100",title:"Refresh data",children:e.jsx($e,{className:Q("h-4 w-4",l&&"animate-spin")})}),N&&e.jsx(z,{onClick:()=>i(!o),size:"sm",variant:"outline",className:"hover:bg-slate-100",title:o?"Collapse table":"Expand table",children:o?e.jsx(ii,{className:"h-4 w-4"}):e.jsx(na,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-slate-200",children:[e.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 bg-slate-50 sticky left-0 z-10 min-w-[180px]",children:"Metric"}),S.map(j=>e.jsxs("th",{className:"text-center p-3 font-semibold text-slate-700 bg-slate-50 min-w-[220px]",children:[e.jsx("div",{className:"mb-2",children:c[j]}),e.jsxs("div",{className:"flex justify-around text-xs font-normal text-slate-500",children:[e.jsx("span",{className:"w-16",children:"Current"}),e.jsx("span",{className:"w-16",children:"Previous"}),e.jsx("span",{className:"w-16",children:"Change"})]})]},j))]})}),e.jsx("tbody",{className:"transition-all duration-300",children:p.map((j,w)=>e.jsxs("tr",{className:Q("border-b border-slate-100 hover:bg-slate-50 transition-colors",w%2===0?"bg-white":"bg-slate-25"),children:[e.jsx("td",{className:"p-3 font-medium text-slate-800 bg-slate-50 sticky left-0 z-10 border-r border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[u(j),e.jsx("span",{children:d[j]||j})]})}),S.map(P=>{const g=v(P,j);return g?e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex justify-around items-center text-sm",children:[e.jsx("div",{className:"w-16 text-center font-semibold text-slate-800",children:y(g.current,j)}),e.jsx("div",{className:"w-16 text-center text-slate-600",children:y(g.previous,j)}),e.jsxs("div",{className:Q("w-16 text-center font-medium flex items-center justify-center gap-1",{"text-green-600":g.trend==="up","text-red-600":g.trend==="down","text-slate-600":g.trend==="neutral"}),children:[g.trend==="up"&&e.jsx(pa,{className:"h-3 w-3"}),g.trend==="down"&&e.jsx(ba,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs",children:[Math.abs(g.change),"%"]})]})]})},P):e.jsx("td",{className:"p-3 text-center text-slate-400 text-sm",children:e.jsxs("div",{className:"flex justify-around",children:[e.jsx("span",{className:"w-16",children:"-"}),e.jsx("span",{className:"w-16",children:"-"}),e.jsx("span",{className:"w-16",children:"-"})]})},P)})]},j))})]})}),!o&&N&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(z,{onClick:()=>i(!0),size:"sm",variant:"ghost",className:"text-slate-600 hover:text-slate-900",children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),"Show ",h.length-x," more metrics"]})})]})}function Xd({onNavigate:s,brandId:a,startDate:t,endDate:l}){const[o,i]=r.useState([]),[c,d]=r.useState(!0),u=Ce();r.useEffect(()=>{a&&(async()=>{try{d(!0);let N=t,j=l;if(!N||!j){const P=new Date,g=new Date(P.getFullYear(),P.getMonth(),1),$=new Date(P.getFullYear(),P.getMonth(),P.getDate()),F=A=>{const C=A.getFullYear(),_=String(A.getMonth()+1).padStart(2,"0"),I=String(A.getDate()).padStart(2,"0");return`${C}-${_}-${I}`};N=F(g),j=F($)}const w=await u.post(`/api/shopify/payment-orders/${a}`,{startDate:N,endDate:j},{withCredentials:!0});w.data&&w.data.success&&w.data.data&&i(w.data.data)}catch(N){console.error("Error fetching payment orders data:",N)}finally{d(!1)}})()},[a,t,l]);const m=o.reduce((p,N)=>p+(N.codOrderCount||0),0),h=o.reduce((p,N)=>p+(N.prepaidOrderCount||0),0),v=m+h,y=[{name:"COD Orders",value:m,color:"#155E95"},{name:"Prepaid Orders",value:h,color:"#80C4E9"}],S=({active:p,payload:N})=>{if(p&&N&&N.length){const j=N[0],w=v>0?(j.value/v*100).toFixed(1):0;return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"font-semibold text-slate-700 mb-2",children:j.name}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"Orders:"}),e.jsx("span",{className:"font-bold",children:j.value.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"Percentage:"}),e.jsxs("span",{className:"font-bold",children:[w,"%"]})]})]})]})}return null},x=p=>`${v>0?(p.value/v*100).toFixed(1):0}%`;return c?e.jsx(Ct,{title:"Payment Orders",icon:e.jsx(vt,{width:"1.25rem",height:"1.25rem"}),onNavigate:s,children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-48 bg-slate-100 rounded"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"h-16 bg-slate-100 rounded"}),e.jsx("div",{className:"h-16 bg-slate-100 rounded"})]})]})}):!o||o.length===0||v===0?e.jsx(Ct,{title:"Payment Orders",icon:e.jsx(vt,{width:"1.25rem",height:"1.25rem"}),onNavigate:s,children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center text-slate-400",children:[e.jsx("p",{className:"text-sm",children:"No data available"}),e.jsx("p",{className:"text-xs mt-1",children:"No orders found in the selected period"})]})})}):e.jsx(Ct,{title:"Payment Orders",icon:e.jsx(vt,{width:"1.25rem",height:"1.25rem"}),onNavigate:s,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-56",children:e.jsx(ar,{width:"100%",height:"100%",children:e.jsxs(bc,{children:[e.jsx(jc,{data:y,cx:"50%",cy:"50%",labelLine:!1,label:x,outerRadius:80,fill:"#8884d8",dataKey:"value",children:y.map(p=>e.jsx(yc,{fill:p.color},`cell-${p.name}`))}),e.jsx(rr,{content:e.jsx(S,{})}),e.jsx(go,{wrapperStyle:{fontSize:"12px"},iconType:"circle",formatter:p=>{const N=y.find(j=>j.name===p);return N?`${p} (${N.value.toLocaleString()})`:p}})]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t border-slate-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-800"}),e.jsx("p",{className:"text-xs text-slate-600",children:"COD"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:m.toLocaleString()}),e.jsxs("p",{className:"text-xs text-slate-500",children:[v>0?(m/v*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Prepaid"})]}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:h.toLocaleString()}),e.jsxs("p",{className:"text-xs text-slate-500",children:[v>0?(h/v*100).toFixed(1):0,"%"]})]})]})]})})}function lt({platform:s,onClick:a}){const t=()=>{switch(s){case"Facebook":return e.jsx(_s,{width:"2rem",height:"2rem"});case"Google Ads":return e.jsx(ms,{width:"2rem",height:"2rem"});case"Google Analytics":return e.jsx(vs,{width:"2rem",height:"2rem"});default:return null}};return e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:a,children:[e.jsx("div",{className:"mb-3",children:t()}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:["Connect ",s]}),e.jsxs("p",{className:"text-sm text-slate-500 text-center mb-4",children:["Get better insights by connecting your ",s," account"]}),e.jsxs(z,{variant:"outline",className:"gap-2",children:[e.jsx(Rt,{className:"h-4 w-4"}),"Connect"]})]})}function Ct({title:s,icon:a,children:t,onNavigate:l,className:o}){return e.jsxs("div",{className:Q("bg-white border rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer group flex flex-col h-[380px]",o),onClick:l,children:[e.jsx("div",{className:"p-4 border-b border-slate-100 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg group-hover:bg-blue-100 transition-colors",children:a}),e.jsx("h3",{className:"font-semibold text-slate-800",children:s})]}),e.jsx(Je,{className:"h-5 w-5 text-slate-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})}),e.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:t})]})}const em=()=>{const s=V(A=>A.user.user),a=V(A=>A.brand.selectedBrandId),t=s==null?void 0:s.username,[l,o]=r.useState(!1),[i,c]=r.useState({}),d=Xe(),[u,m]=r.useState({meta:!0,google:!0,analytics:!0}),[h,v]=r.useState(!1),[y,S]=r.useState(null),[x,p]=r.useState(!0),[N,j]=r.useState(!1);r.useEffect(()=>{const A=new URLSearchParams(window.location.search),C=A.get("openModal");if(C&&a){let _=null;switch(C.toLowerCase()){case"googleads":_="Google Ads";break;case"googleanalytics":_="Google Analytics";break;case"facebook":_="Facebook";break}if(_){S(_),v(!0),A.delete("openModal");const I=`${window.location.pathname}${A.toString()?`?${A.toString()}`:""}`;window.history.replaceState({},"",I)}}},[a]);const w=Ce(),P=r.useCallback(async()=>{if(!a){console.log("No brand ID available, skipping API calls");return}o(!0),c({}),m({meta:!0,google:!0,analytics:!0});try{const A=w.get(`api/summary/facebook-ads/${a}`,{withCredentials:!0}).catch(E=>(console.error("Error fetching Meta data:",E),m(M=>({...M,meta:!1})),{data:{success:!1}})),C=w.get(`api/summary/google-ads/${a}`,{withCredentials:!0}).catch(E=>(console.error("Error fetching Google data:",E),m(M=>({...M,google:!1})),{data:{success:!1}})),_=w.get(`api/summary/analytics/${a}`,{withCredentials:!0}).catch(E=>(console.error("Error fetching Analytics data:",E),m(M=>({...M,analytics:!1})),{data:{success:!1}})),[I,B,O]=await Promise.all([A,C,_]);c({meta:I.data.success?I.data.periodData:void 0,google:B.data.success?B.data.periodData:void 0,analytics:O.data.success?O.data.periodData:void 0}),m({meta:I.data.success,google:B.data.success,analytics:O.data.success})}catch(A){console.error("Error in fetchPerformanceData:",A),m({meta:!1,google:!1,analytics:!1})}finally{o(!1)}},[a]),g=A=>{S(A),v(!0)},$=(A,C,_)=>{console.log(`Successfully connected ${A} - ${C} (${_})`),P()};if(r.useEffect(()=>{P()},[P]),l)return e.jsx(Ae,{isLoading:l});const F=u.meta&&u.google&&u.analytics;return e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:[e.jsxs("div",{className:"mx-auto p-6 max-w-7xl",children:[e.jsx("div",{className:"mb-6 animate-fade-up",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-12 w-1 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:["Welcome Back, ",t]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Here's your performance overview"})]})]}),e.jsx("div",{className:"flex flex-row items-center gap-3"})]})}),x&&e.jsx("div",{className:"mb-6 animate-fade-up",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg shadow-lg p-6 relative overflow-hidden",children:[e.jsx("button",{onClick:()=>p(!1),className:"absolute top-4 right-4 text-white hover:text-blue-100 transition-colors","aria-label":"Close banner",children:e.jsx(hs,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-start gap-4 pr-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Have Custom Requirements?"}),e.jsx("p",{className:"text-blue-50",children:"If you have any requirements, fill the form and we will try to integrate in 15 days."})]}),e.jsx(z,{variant:"secondary",className:"bg-white text-blue-600 hover:bg-blue-50 font-medium",onClick:()=>j(!0),children:"Fill Form"})]})]})}),!F&&e.jsx("div",{className:"mb-8 animate-fade-up",children:e.jsxs("div",{className:"bg-white border rounded-lg shadow-md p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Connect Your Platforms"})}),e.jsx("p",{className:"text-slate-600",children:"Connect your advertising and analytics platforms to see all your performance data in one place."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[!u.meta&&e.jsx(lt,{platform:"Facebook",onClick:()=>g("Facebook")}),!u.google&&e.jsx(lt,{platform:"Google Ads",onClick:()=>g("Google Ads")}),!u.analytics&&e.jsx(lt,{platform:"Google Analytics",onClick:()=>g("Google Analytics")})]})]})}),e.jsx(Zd,{performanceData:i,apiStatus:u,onRefresh:P,loading:l}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Quick Insights"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Click any card to explore detailed reports"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a&&e.jsx(Qd,{onNavigate:()=>d(`/ecommerce-reports/${a}`),brandId:a}),a&&e.jsx(Jd,{onNavigate:()=>d(`/marketing-insights/${a}`),brandId:a}),a&&e.jsx(Xd,{onNavigate:()=>d(`/reports/${a}`),brandId:a})]})]})]}),y&&a&&e.jsx(Ht,{platform:y,open:h,onOpenChange:v,brandId:a,onSuccess:$}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsx(Bo,{onClose:()=>j(!1)})})})]})};function sm(){const[s,a]=r.useState(!1),[t,l]=r.useState(null),{brandId:o}=ge(),i=c=>{l(c),a(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(Sa,{title:"AdMetrics Dashboard",Icon:Vs,showDatePicker:!1,showSettings:!1,showRefresh:!1,isLoading:!1}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Connect Your Advertising Accounts"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Connect your Facebook and Google Ads accounts to start tracking your advertising performance metrics in one place."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 hover:border-blue-500 transition-colors",children:[e.jsx(lt,{platform:"Facebook",onClick:()=>i("Facebook")}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Facebook Ads Benefits:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Track ad spend and performance"}),e.jsx("li",{children:"Monitor ROAS and conversions"}),e.jsx("li",{children:"Analyze audience insights"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 hover:border-blue-500 transition-colors",children:[e.jsx(lt,{platform:"Google Ads",onClick:()=>i("Google Ads")}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Google Ads Benefits:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Track campaign performance"}),e.jsx("li",{children:"Monitor conversion rates"}),e.jsx("li",{children:"Analyze keyword performance"})]})]})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500 mb-8",children:[e.jsx("div",{className:"h-px w-16 bg-gray-300"}),e.jsx("span",{children:"or"}),e.jsx("div",{className:"h-px w-16 bg-gray-300"})]}),e.jsx("p",{className:"text-gray-600",children:"Need help? Contact our support team for assistance with connecting your accounts."})]})]}),e.jsx(Ht,{open:s,onOpenChange:a,platform:t||"Facebook",brandId:o||""})]})}function tm(){var T,U,D,W,K,q,ee,J,ae,pe;const[s,a]=r.useState(!1),[t,l]=r.useState([]),[o,i]=r.useState(),[c,d]=r.useState(!1),[u,m]=r.useState(null),h=V(G=>G.locale.locale),{brandId:v}=ge(),y=Xe(),S=V(G=>G.date.from),x=V(G=>G.date.to),p=V(G=>G.brand.brands),N=V(G=>G.user.user),[j,w]=r.useState({totalSpent:0,totalRevenue:0,totalROAS:0,totalPurchases:0,totalCTR:0,totalCPC:0,totalCPM:0,totalCPP:0}),P=r.useMemo(()=>({from:S,to:x}),[S,x]),g=Ce(),$=p.find(G=>G._id===v),F=!!((T=$==null?void 0:$.googleAdAccount)!=null&&T.length),A=!!((U=$==null?void 0:$.fbAdAccounts)!=null&&U.length),C=F||A,_=N==null?void 0:N.id,I=async(G,se)=>{try{return(await g.post(`/api/metrics/fbAd/${v}`,{startDate:G,endDate:se,userId:_},{withCredentials:!0})).data.data}catch(te){return console.error("Error fetching Facebook ad data:",te),[]}},B=async(G,se)=>{var te;try{return((te=(await g.post(`/api/metrics/googleAdAndCampaign/${v}`,{startDate:G,endDate:se},{withCredentials:!0})).data)==null?void 0:te.data)||[]}catch(me){return console.error("Error fetching Google ad data:",me),[]}},O=r.useCallback(async()=>{var G;a(!0);try{const se=P!=null&&P.from?Y(P.from,"yyyy-MM-dd"):"",te=P!=null&&P.to?Y(P.to,"yyyy-MM-dd"):"",[me,je]=await Promise.all([I(se,te),B(se,te)]);l(me),i(je),R(me,je)}catch(se){console.error("Error fetching ad data:",se),ne.isAxiosError(se)&&((G=se.response)==null?void 0:G.status)===401&&(alert("Your session has expired. Please log in again."),y("/"))}finally{a(!1)}},[y,P,v,_]);r.useEffect(()=>{O()},[O]),r.useEffect(()=>{O();const G=setInterval(O,3*60*60*1e3);return()=>clearInterval(G)},[O]);const E=G=>{let se=0,te=0,me=0,je=0,Ne=0;return G!=null&&G.length&&G.forEach(Te=>{var Fe,Z;se+=parseFloat(String(Te.spend||"0")),te+=parseFloat(String(((Fe=Te.Revenue)==null?void 0:Fe.value)||"0")),me+=parseFloat(String(((Z=Te.purchases)==null?void 0:Z.value)||"0")),je+=parseFloat(String(Te.clicks||"0")),Ne+=parseFloat(String(Te.impressions||"0"))}),{totalSpent:se,totalRevenue:te,totalPurchases:me,totalClicks:je,totalImpressions:Ne}},M=G=>{let se=0,te=0,me=0,je=0,Ne=0;return G!=null&&G.adMetrics&&(se+=parseFloat(G.adMetrics.totalSpend||"0"),te+=parseFloat(G.adMetrics.totalConversionsValue||"0"),me+=parseFloat(G.adMetrics.totalConversions||"0"),je+=parseFloat(G.adMetrics.totalClicks||"0"),Ne+=parseFloat(G.adMetrics.totalImpressions||"0")),{totalSpent:se,totalRevenue:te,totalPurchases:me,totalClicks:je,totalImpressions:Ne}},R=r.useCallback((G,se)=>{const te=E(G),me=M(se),je=te.totalSpent+me.totalSpent,Ne=te.totalRevenue+me.totalRevenue,Te=te.totalPurchases+me.totalPurchases,Fe=te.totalClicks+me.totalClicks,Z=te.totalImpressions+me.totalImpressions;w({totalSpent:je,totalRevenue:Ne,totalROAS:Ne/je||0,totalPurchases:Te,totalCTR:Fe/Z*100||0,totalCPC:je/Fe||0,totalCPM:je*1e3/Z||0,totalCPP:Te>0?je/Te:0})},[]),L=r.useMemo(()=>({totalSpent:`${j.totalSpent.toLocaleString(h)}`,totalRevenue:`${j.totalRevenue.toLocaleString(h)}`,totalROAS:Number(j.totalROAS.toFixed(2)).toLocaleString(h),totalPurchases:j.totalPurchases.toLocaleString(h),totalCTR:`${Number(j.totalCTR.toFixed(2)).toLocaleString(h)} %`,totalCPC:Number(j.totalCPC.toFixed(2)).toLocaleString(h),totalCPM:Number(j.totalCPM.toFixed(2)).toLocaleString(h),totalCPP:Number(j.totalCPP.toFixed(2)).toLocaleString(h)}),[j,h]),k=[{label:"Amount Spent",value:L.totalSpent,tooltipContent:"The sum of ad spends for all advertising platforms"},{label:"Revenue",value:L.totalRevenue,tooltipContent:"Revenue from Ads Purchases"},{label:"ROAS (Ads only)",value:L.totalROAS,tooltipContent:"Blended ROAS = Ads Purchases value / Blended Ad Spend"},{label:"Ads Purchases",value:L.totalPurchases,tooltipContent:"Ads Purchases = Fb Ads Purchase + Google Conversions"},{label:"CPC",value:L.totalCPC,tooltipContent:"Average CPC from all advertising platforms = (Blended Ad Spend / Blended Clicks)"},{label:"CPM",value:L.totalCPM,tooltipContent:"Average CPM from all advertising platforms = (Blended Ad Spend * 1000 / Blended Impressions)"},{label:"CTR",value:L.totalCTR,tooltipContent:"Average CTR from all advertising platforms = (Blended Clicks / Blended Impressions)*100"},{label:"CPP",value:L.totalCPP,tooltipContent:"Average CPP from all advertising platforms = (Blended Ad Spend / Blended Purchases)"}],f=[{label:"Total Cost",value:o?`${parseFloat(((D=o==null?void 0:o.adMetrics)==null?void 0:D.totalSpend)||"0").toLocaleString(h)}`:"0"},{label:"Conversion Value",value:o?`${parseFloat((W=o==null?void 0:o.adMetrics)==null?void 0:W.totalConversionsValue).toLocaleString(h)}`:"0"},{label:"ROAS",value:o?parseFloat((K=o==null?void 0:o.adMetrics)==null?void 0:K.roas).toLocaleString(h):"0.00"},{label:"Conversions",value:o?parseFloat((q=o==null?void 0:o.adMetrics)==null?void 0:q.totalConversions).toLocaleString(h):"0"},{label:"CPC",value:o?`${parseFloat((ee=o==null?void 0:o.adMetrics)==null?void 0:ee.totalCPC).toLocaleString(h)}`:"0"},{label:"CPM",value:o?`${parseFloat((J=o==null?void 0:o.adMetrics)==null?void 0:J.totalCPM).toLocaleString(h)}`:"0"},{label:"CTR",value:o?`${parseFloat((ae=o==null?void 0:o.adMetrics)==null?void 0:ae.totalCTR).toLocaleString(h)} %`:"0"},{label:"Cost Per Conversion",value:o?`${parseFloat((pe=o==null?void 0:o.adMetrics)==null?void 0:pe.totalCostPerConversion).toLocaleString(h)}`:"0"}],n=G=>{m(G),d(!0)},b=(G,se,te)=>{console.log(`Successfully connected ${G} account: ${se} (${te})`),window.location.reload()};return C?s?e.jsx(Ae,{isLoading:s}):e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(Sa,{title:"AdMetrics Dashboard",Icon:Vs,showDatePicker:!0,showSettings:!0,showRefresh:!0,isLoading:!1,handleManualRefresh:()=>{O()}}),!C&&e.jsxs("div",{className:"p-4 md:p-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Connect Your Ad Accounts"}),e.jsx("p",{className:"text-gray-600",children:"Connect your advertising accounts to start tracking your metrics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:[e.jsx(lt,{platform:"Facebook",onClick:()=>n("Facebook")}),e.jsx(lt,{platform:"Google Ads",onClick:()=>n("Google Ads")})]}),e.jsx("div",{className:"text-center mt-8",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-500",children:[e.jsx("div",{className:"h-px w-16 bg-gray-300"}),e.jsx("span",{children:"or"}),e.jsx("div",{className:"h-px w-16 bg-gray-300"})]})})]}),e.jsx(Ht,{open:c,onOpenChange:d,platform:u||"Facebook",brandId:v||"",onSuccess:b}),e.jsxs("main",{className:"p-4 md:p-6 lg:px-8",children:[C?e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{id:"all",children:[e.jsx("h2",{className:"text-xl font-semibold flex flex-row items-center justify-between",children:e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx(ci,{className:"h-5 w-5"}),e.jsx("span",{children:"Blended summary"}),e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]})}),e.jsx(Ea,{metrics:k,date:{from:P.from?new Date(P.from):void 0,to:P.to?new Date(P.to):void 0},isLoading:s})]})}):e.jsx(e.Fragment,{}),(t==null?void 0:t.length)>0&&t.map((G,se)=>{var me,je;const te=[{label:"Amount Spent",value:`${parseFloat(String(G.spend||"0")).toLocaleString(h)}`},{label:"Revenue",value:`${parseFloat(String(((me=G.Revenue)==null?void 0:me.value)||"0")).toLocaleString(h)}`},{label:"ROAS (Ads only)",value:G.purchase_roas&&G.purchase_roas.length>0?parseFloat(String(G.purchase_roas[0].value)).toLocaleString(h,{minimumFractionDigits:2,maximumFractionDigits:2}):"0"},{label:"Ads Purchases",value:((je=G.purchases)==null?void 0:je.value)||"0"},{label:"CPC (All clicks)",value:`${new Intl.NumberFormat(h).format(parseFloat(G.cpc||"0"))}`},{label:"CPM",value:`${new Intl.NumberFormat(h,{minimumFractionDigits:2}).format(parseFloat(G.cpm||"0"))}`},{label:"CTR",value:`${parseFloat(G.ctr||"0").toFixed(2)} %`},{label:"Cost per Purchase (All)",value:`${new Intl.NumberFormat(h).format(parseFloat(G.cpp||"0"))}`}];return e.jsx("div",{id:"facebook",children:e.jsx(Ea,{icon:"Facebook",title:`Facebook - ${G.account_name}`,metrics:te,date:{from:P.from?new Date(P.from):void 0,to:P.to?new Date(P.to):void 0},isLoading:s,errorMessage:G.message})},se)}),!A&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"facebook",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Facebook Ad Metrics"})]}),e.jsxs("div",{className:"text-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Facebook Ad Account connected for this brand."}),e.jsx("button",{onClick:()=>n("Facebook"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Connect Facebook Ads"})]})]})}),A&&!F&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"google",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(ms,{width:"1.5rem",height:"1.5rem"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Google Ad Metrics"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Google Ad Account connected for this brand."}),e.jsxs("button",{onClick:()=>n("Google Ads"),className:"flex flex-row items-center justify-center gap-3 px-4 py-2 border-2 border-green-800 text-blackk rounded-md transition-colors",children:[e.jsx(ms,{width:"1.5rem",height:"1.5rem"}),"Connect Google Ads"]})]})]})}),o&&Object.keys(o).length>0&&e.jsx("div",{id:"google",children:e.jsx(Ea,{icon:"Google",title:`Google Ads - ${o==null?void 0:o.adAccountName}`,metrics:f,date:{from:P.from?new Date(P.from):void 0,to:P.to?new Date(P.to):void 0},isLoading:s})},"google"),!F&&!A&&e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{className:"mt-10",id:"google",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx(ms,{width:"1.5rem",height:"1.5rem"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Google Ad Metrics"})]}),e.jsxs("div",{className:"text-center text-gray-500 mt-4 bg-white p-6 rounded-md",children:[e.jsx("p",{className:"mb-4",children:"No Google Ad Account connected for this brand."}),e.jsx("button",{onClick:()=>n("Google Ads"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Connect Google Ads"})]})]})})]})]}):e.jsx(sm,{})}const Ps=()=>{const[s,a]=r.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-8 right-8 z-30 flex items-center gap-2 bg-indigo-600 text-white p-3 rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-200 group",children:e.jsx(Yi,{className:"w-5 h-5 group-hover:animate-pulse"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsx(Bo,{onClose:()=>a(!1)})})})]})},am=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(tm,{}),e.jsx(Ps,{})]})]}),rm=()=>{const s=V(t=>t.user.user),a=Xe();return r.useEffect(()=>{if(!s){a("/");return}},[s,a]),!s||!s.brands||s.brands.length===0?null:e.jsxs("div",{className:"flex h-screen relative",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(em,{})}),e.jsx(Ps,{})]})};function nm(){const{brandId:s}=ge(),[a,t]=r.useState("Fetching table data"),l=["Fetching table data","Processing sales records","Aggregating metrics","Organizing table columns","Calculating performance indicators","Preparing data tables"];return r.useEffect(()=>{const o=setInterval(()=>{t(i=>{const d=(l.indexOf(i)+1)%l.length;return l[d]})},2500);return()=>clearInterval(o)},[]),e.jsxs("div",{className:"bg-slate-50 flex flex-col w-full min-h-screen",children:[e.jsx(Sa,{title:"Marketing Insights Tracker",Icon:Yn,showDatePicker:!0}),e.jsx("main",{className:"container max-w-6xl mx-auto px-4 py-8 flex flex-col h-screen justify-center",children:e.jsxs("div",{className:"w-full text-center mb-12",children:[e.jsx("h1",{className:"text-xl md:text-4xl font-bold text-primary mb-3",children:"Preparing your dashboard..."}),e.jsx("div",{className:"h-8 my-8",children:e.jsxs("p",{className:"text-base md:text-lg text-violet-600 font-medium animate-pulse",children:[a,"..."]})}),e.jsx("p",{className:"text-sm md:text-base text-gray-700 max-w-4xl mx-auto mb-2",children:"We're loading data from the past two years up to yesterday. Going forward, new data will update daily."}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 max-w-4xl mx-auto mb-8",children:["This process may take ",e.jsx("span",{className:"font-medium",children:"1-2 hours"})," to complete."]}),e.jsx("p",{className:"text-sm md:text-base text-gray-700 max-w-4xl mx-auto mb-10",children:"In the meantime, you can explore these dashboards:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-6",children:[e.jsx(nt,{to:`/admetrics/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-violet-100 flex items-center justify-center mb-3",children:e.jsx(ys,{className:"w-6 h-6 text-violet-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"AdMetrics Hub"}),e.jsxs("div",{className:"flex items-center text-violet-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ss,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})}),e.jsx(nt,{to:`/ecommerce-reports/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center mb-3",children:e.jsx(Xn,{className:"w-6 h-6 text-pink-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Ecommerce Insights"}),e.jsxs("div",{className:"flex items-center text-pink-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ss,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})}),e.jsx(nt,{to:`/meta-campaigns/${s}`,className:"bg-white rounded-lg shadow-md border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:translate-y-[-2px] group flex-1 max-w-xs mx-auto sm:mx-0",children:e.jsxs("div",{className:"p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mb-3",children:e.jsx(Vs,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Campaign Analysis"}),e.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium",children:[e.jsx("span",{children:"View dashboard"}),e.jsx(Ss,{className:"w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1"})]})]})})]})]})})]})}const da=(s,a="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(s);function as({title:s,tooltip:a,colSpan:t=1,rowSpan:l,isSubHeader:o=!1,isImportant:i=!1,isFirstInSection:c=!1}){return e.jsx("th",{className:`
        ${o?"text-xs font-medium":"font-semibold text-sm"}
        text-center whitespace-nowrap p-2
        ${o?"bg-slate-100":"bg-slate-200"}
        ${i?"bg-blue-50 !font-bold text-blue-800":""}
        relative overflow-hidden
        ${o?"":"sticky top-0 z-10"}
        font-inter border-b border-r border-slate-300
        ${c?"border-l-2 border-l-slate-300 shadow-sm":""}
      `,colSpan:t,rowSpan:l,children:e.jsx(bn,{children:e.jsxs(jn,{children:[e.jsx(yn,{asChild:!0,children:e.jsxs("span",{className:`
                flex items-center justify-center gap-1 cursor-help
                ${i?"text-blue-800":""}
              `,children:[i&&e.jsx("span",{className:"text-blue-500",children:""}),s]})}),e.jsx(vn,{className:"mb-3 z-20 w-fit",children:e.jsxs("div",{className:"text-gray-700 bg-white p-2 rounded-md text-sm border shadow-lg max-w-fit",children:[i&&e.jsx("div",{className:"font-semibold text-blue-600 mb-1",children:"Key Metric"}),a]})})]})})})}function De({children:s,isNumeric:a=!1,isHeader:t=!1,isSticky:l=!1,isExpanded:o=!1,isImportant:i=!1,isFirstInSection:c=!1,className:d=""}){return e.jsx("td",{className:`
        border-b border-r border-slate-200
        ${a?"text-right font-roboto tabular-nums":"text-left"} 
        ${t?"font-medium font-dm-sans":""}
        ${l?"sticky z-10":""}
        ${o?"bg-blue-50/30":"bg-white hover:bg-slate-50/80"}
        ${l&&o?"bg-blue-50/30":""}
        ${i?"font-semibold text-blue-700":""}
        ${c?"border-l-2 border-l-slate-300 shadow-sm":""}
        transition-colors
        ${d}
      `,children:s})}const om=()=>{const[s,a]=r.useState([]),[t,l]=r.useState(!0),[o,i]=r.useState(null),[c,d]=r.useState(!1),[u,m]=r.useState("USD"),h=V(M=>M.date.from),v=V(M=>M.date.to),[y,S]=r.useState([]),{brandId:x}=ge(),p=V(M=>M.brand.selectedBrandId),N=V(M=>{var R;return(R=M.brand.brands.find(L=>L._id===p))==null?void 0:R.name}),j=r.useMemo(()=>({from:h,to:v}),[h,v]),w=j!=null&&j.from?Y(j.from,"yyyy-MM-dd"):"",P=j!=null&&j.to?Y(j.to,"yyyy-MM-dd"):"",g=()=>{d(!c)},$=()=>c?"h-screen":"h-full";r.useEffect(()=>{(async()=>{var R,L;l(!0),i(null);try{const k={};w&&(k.startDate=w),P&&(k.endDate=P);const f=await ne.get(`${be}/api/brands/currency/${x}`,{withCredentials:!0});m(f.data);const b=(await ne.get(`${be}/api/report/${x}`,{params:k,withCredentials:!0})).data.data;a(b)}catch(k){console.error(k);const f=ne.isAxiosError(k)&&((L=(R=k.response)==null?void 0:R.data)!=null&&L.message)?k.response.data.message:"Something went wrong";i(f)}finally{l(!1)}})()},[x,w,P,be]);const F=M=>{S(R=>R.includes(M)?R.filter(L=>L!==M):[...R,M])},A=M=>da(M,u),C=M=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(M),_=M=>`${M.toFixed(2)}`,I=r.useMemo(()=>{const M=(R,L)=>L?R/L:0;return s.map(R=>{const L=R.dailyMetrics.map(b=>({...b,metaROAS:M(b.metaRevenue,b.metaSpend),googleSales:b.googleSpend*b.googleROAS,adSales:b.totalSpend*(b.grossROI||0),ROI:M(b.totalSales,b.totalSpend)})),k=L.reduce((b,T)=>b+(T.metaRevenue||0),0),f=L.reduce((b,T)=>b+T.googleSales,0),n=k+f||0;return{...R,metaSales:k,googleSales:f,totalAdSales:n,metaROAS:M(k,R.metaSpend),googleROAS:M(f,R.googleSpend),grossROI:M(n,R.totalSpend),netROI:M(R.shopifySales,R.totalSpend),ROI:M(R.totalSales,R.totalSpend),dailyMetrics:L}})},[s]);r.useMemo(()=>{if(!I.length)return null;const M=I.reduce((D,W)=>D+W.totalSales,0),R=I.reduce((D,W)=>D+W.totalSpend,0),L=R?M/R:0,k=I.reduce((D,W)=>D+W.metaSpend,0),f=I.reduce((D,W)=>D+W.googleSpend,0),n=I.reduce((D,W)=>D+W.metaSales,0),b=I.reduce((D,W)=>D+W.googleSales,0),T=k?n/k:0,U=f?b/f:0;return{totalSales:M,totalSpend:R,totalROI:L,metaSpend:k,googleSpend:f,metaSales:n,googleSales:b,metaROAS:T,googleROAS:U}},[I]);const B=()=>o?e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-red-600 border border-red-200",children:o}):e.jsx("div",{className:"border rounded-lg shadow-sm overflow-hidden bg-white h-full flex flex-col font-karla",children:e.jsx("div",{className:`${$()} overflow-auto flex-1`,children:e.jsxs("table",{className:"w-full border-collapse font-inter",children:[e.jsxs("thead",{className:"sticky top-0 z-20",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 sticky left-0 z-30 bg-slate-200 border-b border-r border-slate-300",rowSpan:2}),e.jsx("th",{className:"sticky left-[40px] z-20 text-center whitespace-nowrap p-2 font-semibold text-sm bg-slate-200 border-b border-r border-slate-300 border-l-2 border-l-slate-300 ",rowSpan:2,children:"Date"}),e.jsx(as,{title:"Shopify (Actual Sales Data)",tooltip:"Shopify Metrics",colSpan:3,isFirstInSection:!0}),e.jsx(as,{title:"Meta + Google",tooltip:"Meta + Google",colSpan:3,isFirstInSection:!0}),e.jsx(as,{title:"Meta (Facebook & Instagram Ads)",tooltip:"Meta Metrics",colSpan:3,isFirstInSection:!0}),e.jsx(as,{title:"Google Ads",tooltip:"Google Metrics",colSpan:3,isFirstInSection:!0})]}),e.jsxs("tr",{children:[e.jsx(as,{title:"Total Sales",tooltip:"Total Sales",isSubHeader:!0,isFirstInSection:!0}),e.jsx(as,{title:"Total Returns",tooltip:"Net Returns + Shipping Returned + Return Fees + Taxes Returned",isSubHeader:!0}),e.jsx(as,{title:"ROAS",tooltip:"ROAS = Total Sales / Total Spend",isSubHeader:!0,isImportant:!0}),e.jsx(as,{title:"Spend",tooltip:"Total Spent = Meta Spent + Google Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(as,{title:"Sales",tooltip:"Sales = (MetaSales + GoogleSales)",isSubHeader:!0}),e.jsx(as,{title:"ROI",tooltip:"ROI = (MetaSales + GoogleSales)/ Total Spent",isSubHeader:!0,isImportant:!0}),e.jsx(as,{title:"Spend",tooltip:"Meta Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(as,{title:"Sales",tooltip:"Meta Sales = Meta Spent * Meta ROAS",isSubHeader:!0}),e.jsx(as,{title:"ROAS",tooltip:"Meta ROAS",isSubHeader:!0,isImportant:!0}),e.jsx(as,{title:"Spend",tooltip:"Google Spent",isSubHeader:!0,isFirstInSection:!0}),e.jsx(as,{title:"Sales",tooltip:"Google Sales = Google Spent * Google ROAS",isSubHeader:!0}),e.jsx(as,{title:"ROAS",tooltip:"Google ROAS",isSubHeader:!0,isImportant:!0})]})]}),e.jsx("tbody",{children:I.map(M=>{const R=`${M.year}-${M.month.toString().padStart(2,"0")}`,L=y.includes(R);return e.jsxs(Se.Fragment,{children:[e.jsxs("tr",{className:`
                        ${L?"bg-blue-50":"bg-white hover:bg-slate-50/80"} 
                        cursor-pointer transition-colors 
                      `,onClick:()=>F(R),children:[e.jsx(De,{isSticky:!0,isExpanded:L,className:"w-10 px-2 py-2 sticky left-0",children:e.jsx("div",{className:`
                            w-6 h-6 rounded-full flex items-center justify-center
                            transition-all duration-300 transform
                            ${L?"rotate-180 bg-blue-500":"bg-blue-100 hover:bg-blue-200"}
                          `,children:e.jsx(os,{className:`w-4 h-4 ${L?"text-white":"text-blue-500"}`})})}),e.jsx(De,{isHeader:!0,isSticky:!0,isExpanded:L,className:"sticky left-[40px] px-3 py-2.5 whitespace-nowrap bg-slate-50/80 text-sm border-l-2 border-l-slate-300 ",children:Y(new Date(M.year,M.month-1),"MMM yyyy")}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 font-medium text-sm",isFirstInSection:!0,children:A(M.totalSales)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",children:A(M.refundAmount)}),e.jsx(De,{isNumeric:!0,isExpanded:L,isImportant:!0,className:"px-3 py-2.5 text-sm",children:_(M.ROI)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:C(M.totalSpend)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",children:C(M.totalAdSales)}),e.jsx(De,{isNumeric:!0,isExpanded:L,isImportant:!0,className:"px-3 py-2.5 text-sm",children:_(M.grossROI)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:C(M.metaSpend)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",children:C(M.metaSales)}),e.jsx(De,{isNumeric:!0,isExpanded:L,isImportant:!0,className:"px-3 py-2.5 text-sm",children:_(M.metaROAS)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",isFirstInSection:!0,children:C(M.googleSpend)}),e.jsx(De,{isNumeric:!0,isExpanded:L,className:"px-3 py-2.5 text-sm",children:C(M.googleSales)}),e.jsx(De,{isNumeric:!0,isExpanded:L,isImportant:!0,className:"px-3 py-2.5 text-sm",children:_(M.googleROAS)})]}),L&&M.dailyMetrics.map(k=>e.jsxs("tr",{className:"bg-slate-50/50 hover:bg-slate-100/50 transition-colors",children:[e.jsx(De,{isSticky:!0,className:"w-10 px-2 py-1.5 sticky left-0 bg-slate-50/50"}),e.jsx(De,{isSticky:!0,className:"sticky left-[40px] px-3 py-1.5 text-xs text-gray-600 bg-slate-50/80 border-l-2 border-l-slate-300 ",children:Y(new Date(k.date),"dd/MM/yyyy")}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:A(k.totalSales)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:A(k.refundAmount)}),e.jsx(De,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:_(k.ROI)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:C(k.totalSpend)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:C(k.adSales)}),e.jsx(De,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:_(k.grossROI)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:C(k.metaSpend)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:C(k.metaRevenue)}),e.jsx(De,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:_(k.metaROAS)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",isFirstInSection:!0,children:C(k.googleSpend)}),e.jsx(De,{isNumeric:!0,className:"px-3 py-1.5 text-xs",children:C(k.googleSales)}),e.jsx(De,{isNumeric:!0,isImportant:!0,className:"px-3 py-1.5 text-xs",children:_(k.googleROAS)})]},k._id))]},R)})})]})})}),O=()=>{try{if(!I||!I.length){window.alert("No metrics data available to export for the selected date range.");return}const M=["Level","Month","Date","Total Sales","Refund Amount","ROI","Total Spend","Total Ad Sales","Gross ROI","Meta Spend","Meta Sales","Meta ROAS","Google Spend","Google Sales","Google ROAS"],R=[];I.forEach(W=>{const K=Y(new Date(W.year,W.month-1),"MMM yyyy");R.push(["Month",K,"",W.totalSales??0,W.refundAmount??0,W.ROI??0,W.totalSpend??0,W.totalAdSales??0,W.grossROI??0,W.metaSpend??0,W.metaSales??0,W.metaROAS??0,W.googleSpend??0,W.googleSales??0,W.googleROAS??0]),W.dailyMetrics.forEach(q=>{R.push(["Day",K,Y(new Date(q.date),"dd/MM/yyyy"),q.totalSales??0,q.refundAmount??0,q.ROI??0,q.totalSpend??0,q.adSales??0,q.grossROI??0,q.metaSpend??0,q.metaRevenue??0,q.metaROAS??0,q.googleSpend??0,q.googleSales??0,q.googleROAS??0])})});const L=W=>`"${String(W??"").replace(/"/g,'""')}"`,f=`\uFEFF${[M,...R].map(W=>W.map(L).join(",")).join(`\r
`)}`,n=new Blob([f],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(n),T=document.createElement("a"),U=w||"start",D=P||"end";T.href=b,T.download=`monthly-ad-metrics-${N??"brand"}-${U}-to-${D}.csv`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(b)}catch(M){console.error("Failed to export metrics CSV",M),window.alert("Something went wrong while exporting. Please check the console for details.")}},E=()=>t?e.jsx(Ae,{isLoading:t}):o==="No metrics data available yet. Please try again later."?e.jsx(nm,{}):e.jsx("div",{className:"flex-1 h-screen overflow-hidden bg-slate-100 flex flex-col",children:e.jsx("div",{className:"p-3 flex-1 flex flex-col min-h-0",children:e.jsx(ue,{id:"metrics-table",className:`${c?"fixed inset-0 z-50 m-0 rounded-none":""} shadow-md flex-1 flex flex-col min-h-0`,children:e.jsxs(he,{className:"p-2 md:p-3 flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-3 gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Cross-Platform Performance"}),e.jsxs("div",{className:"flex flex-row gap-3 items-center",children:[e.jsx(vt,{width:20,height:20}),e.jsx(_s,{width:20,height:20}),e.jsx(ms,{width:20,height:20})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}}),e.jsx(z,{onClick:g,size:"icon",variant:"outline",className:"bg-white",children:c?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})}),e.jsxs(z,{onClick:O,variant:"outline",size:"sm",className:"gap-2 bg-white",children:[e.jsx(di,{className:"h-4 w-4"}),"Export"]}),e.jsx($o,{})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:B()})]})})})});return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:E()}),e.jsx(Ps,{})]})},lm=$t("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ye=r.forwardRef(({className:s,...a},t)=>e.jsx(Nn,{ref:t,className:Q(lm(),s),...a}));ye.displayName=Nn.displayName;const ka=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:Q("w-full caption-bottom text-sm",s),...a})}));ka.displayName="Table";const Aa=r.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:Q("[&_tr]:border-b",s),...a}));Aa.displayName="TableHeader";const Ma=r.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:Q("[&_tr:last-child]:border-0",s),...a}));Ma.displayName="TableBody";const im=r.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:Q("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));im.displayName="TableFooter";const Ws=r.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:Q("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));Ws.displayName="TableRow";const rs=r.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:Q("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));rs.displayName="TableHead";const Ke=r.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:Q("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));Ke.displayName="TableCell";const cm=r.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:Q("mt-4 text-sm text-muted-foreground",s),...a}));cm.displayName="TableCaption";const We=Ll,He=Dl,Be=r.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(wn,{ref:l,className:Q("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...t,children:[a,e.jsx($l,{asChild:!0,children:e.jsx(Ya,{className:"h-4 w-4 opacity-50"})})]}));Be.displayName=wn.displayName;const Go=r.forwardRef(({className:s,...a},t)=>e.jsx(Cn,{ref:t,className:Q("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Fl,{className:"h-4 w-4"})}));Go.displayName=Cn.displayName;const Uo=r.forwardRef(({className:s,...a},t)=>e.jsx(Sn,{ref:t,className:Q("flex cursor-default items-center justify-center py-1",s),...a,children:e.jsx(Ya,{className:"h-4 w-4"})}));Uo.displayName=Sn.displayName;const Ge=r.forwardRef(({className:s,children:a,position:t="popper",...l},o)=>e.jsx(_l,{children:e.jsxs(kn,{ref:o,className:Q("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...l,children:[e.jsx(Go,{}),e.jsx(Il,{className:Q("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(Uo,{})]})}));Ge.displayName=kn.displayName;const dm=r.forwardRef(({className:s,...a},t)=>e.jsx(An,{ref:t,className:Q("px-2 py-1.5 text-sm font-semibold",s),...a}));dm.displayName=An.displayName;const ie=r.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(Mn,{ref:l,className:Q("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Pl,{children:e.jsx(qa,{className:"h-4 w-4"})})}),e.jsx(El,{children:a})]}));ie.displayName=Mn.displayName;const mm=r.forwardRef(({className:s,...a},t)=>e.jsx(Tn,{ref:t,className:Q("-mx-1 my-1 h-px bg-muted",s),...a}));mm.displayName=Tn.displayName;function um(){const s=V(M=>M.brand.brands),[a,t]=r.useState([]),[l,o]=r.useState({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:Ot(new Date)}),[i,c]=r.useState(null),[d,u]=r.useState(null),[m,h]=r.useState({}),[v,y]=r.useState(!1),S=Xe(),x=r.useCallback(async M=>{var R;try{return(await ne.get(`${be}/api/performance/metaMetrics/${M}`,{withCredentials:!0})).data}catch(L){return console.error("Error fetching Meta metrics data:",L),ne.isAxiosError(L)&&((R=L.response)==null?void 0:R.status)===401&&(alert("Your session has expired. Please log in again."),S("/")),{success:!1,data:{spend:0,Revenue:0,purchase_roas:"0.00"}}}},[be,S]),p=r.useCallback(async M=>{try{return(await ne.get(`${be}/api/performance/googleAdMetrics/${M}`,{withCredentials:!0})).data}catch(R){return console.error("Error fetching Google metrics data:",R),{success:!1,data:{spend:0,Revenue:0,purchase_roas:"0.00"}}}},[be]),N=r.useCallback(async()=>{y(!0);try{const M={};await Promise.all(a.map(async R=>{const[L,k]=await Promise.all([x(R.brandId),p(R.brandId)]);M[R.brandId]={meta:L.success?L.data:{spend:0,Revenue:0,purchase_roas:"0.00"},google:k.success?k.data:{spend:0,Revenue:0,purchase_roas:"0.00"}}})),h(M)}catch(M){console.error("Error fetching metrics data:",M)}finally{y(!1)}},[a,x,p]);r.useEffect(()=>{a.length>0&&N()},[N,a]);const j=M=>{const{name:R,value:L}=M.target;o(k=>({...k,[R]:["brandId","name"].includes(R)?L:Number(L)}))},w=M=>{o(R=>({...R,source:M}))},P=async()=>{const M=s.find(R=>String(R._id)===String(l.brandId));if(M)try{const R={brandId:M._id,name:M.name,source:l.source,targetSales:l.targetSales,targetSpend:l.targetSpend,targetROAS:l.targetROAS,targetDate:l.targetDate},L=await ne.post(`${be}/api/performance/addTarget`,R,{withCredentials:!0});t(k=>[...k,L.data]),o({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:Ot(new Date)})}catch(R){console.error("Error adding brand:",R)}else console.log("Brand not found")},g=M=>{const R=a.find(L=>L.brandId===M);R&&(c(M),u({...R,targetDate:new Date(R.targetDate)}))},$=async M=>{if(d)try{const R=await ne.patch(`${be}/api/performance/updateTarget/${M}`,d,{withCredentials:!0});t(L=>L.map(k=>k.brandId===M?{...k,...R.data}:k)),c(null),u(null),alert("Brand updated successfully!")}catch(R){console.error("Error saving brand edit:",R),alert("Failed to update brand")}},F=()=>{c(null),u(null)},A=async M=>{try{await ne.delete(`${be}/api/performance/deleteTarget/${M}`,{withCredentials:!0}),t(R=>R.filter(L=>L.brandId!==M)),console.log("Brand deleted successfully")}catch(R){console.error("Error deleting brand:",R)}},C=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-500"}),_=(M,R)=>{var K;const L=((K=m[M.brandId])==null?void 0:K[R])||{spend:0,Revenue:0,purchase_roas:"0.00"},k=L.spend||0,f=Number(L.Revenue)||0,n=Math.max(M.targetSales-f,0).toFixed(2),b=parseFloat(L.purchase_roas)||0,T=new Date;T.setHours(0,0,0,0);const U=new Date(M.targetDate);U.setHours(0,0,0,0);const D=Math.max(Math.ceil((U.getTime()-T.getTime())/(1e3*60*60*24)),0),W=D>0?parseFloat(n)/D:0;return{achievedSales:f,remainingSales:n,achievedSpend:k,achievedROAS:b,remainingDays:D,requiredSalesPerDay:W}},I=a.map(M=>{const R=_(M,"meta"),L=_(M,"google");return{name:M.name,"Meta Achieved":R.achievedSales,"Meta Remaining":R.remainingSales,"Google Achieved":L.achievedSales,"Google Remaining":L.remainingSales}}),B=a.filter(M=>M.source==="Meta"),O=a.filter(M=>M.source==="Google");r.useEffect(()=>{(async()=>{try{const L=(await ne.get(`${be}/api/performance/brandTarget`,{withCredentials:!0})).data.map(k=>({...k,targetDate:new Date(k.targetDate)}));t(L)}catch(R){console.error("Error fetching brands:",R)}})()},[be]);const E=(M,R,L)=>e.jsxs(ue,{className:"mb-4",children:[e.jsx(bs,{children:e.jsxs(Ts,{children:[L," Performance Table"]})}),e.jsx(he,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ka,{children:[e.jsx(Aa,{children:e.jsxs(Ws,{children:[e.jsx(rs,{children:"Brand"}),e.jsx(rs,{children:"Month"}),e.jsx(rs,{children:"Target Spend"}),e.jsx(rs,{children:"Target Sales"}),e.jsx(rs,{children:"Target ROAS"}),e.jsx(rs,{children:"Achieved Spend"}),e.jsx(rs,{children:"Achieved Sales"}),e.jsx(rs,{children:"Achieved ROAS"}),e.jsx(rs,{children:"Remaining Sales"}),e.jsx(rs,{children:"Remaining Days"}),e.jsx(rs,{children:"Required Sales/Day"}),e.jsx(rs,{children:"Actions"})]})}),e.jsx(Ma,{children:M.map(k=>{const{achievedSales:f,remainingSales:n,achievedSpend:b,achievedROAS:T,remainingDays:U,requiredSalesPerDay:D}=_(k,R),W=i===k.brandId;return e.jsxs(Ws,{children:[e.jsx(Ke,{className:"font-bold text-sm",children:k.name}),e.jsx(Ke,{children:W?e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(z,{variant:"outline",children:d!=null&&d.targetDate?Y(d.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(Ys,{className:"w-auto p-0",children:e.jsx(la,{mode:"single",selected:d==null?void 0:d.targetDate,onSelect:K=>K&&u(q=>q?{...q,targetDate:K}:null),initialFocus:!0})})]}):Y(new Date(k.targetDate),"MMM yyyy")}),e.jsx(Ke,{children:W?e.jsx(ve,{type:"number",value:d==null?void 0:d.targetSpend,onChange:K=>u(q=>q?{...q,targetSpend:Number(K.target.value)}:null)}):`${k.targetSpend.toLocaleString()}`}),e.jsx(Ke,{children:W?e.jsx(ve,{type:"number",value:d==null?void 0:d.targetSales,onChange:K=>u(q=>q?{...q,targetSales:Number(K.target.value)}:null)}):`${k.targetSales.toLocaleString()}`}),e.jsx(Ke,{children:W?e.jsx(ve,{type:"number",step:"0.01",value:d==null?void 0:d.targetROAS,onChange:K=>u(q=>q?{...q,targetROAS:Number(K.target.value)}:null)}):k.targetROAS.toFixed(2)}),e.jsx(Ke,{children:v?e.jsx(C,{}):`${b.toLocaleString("en-IN")}`}),e.jsx(Ke,{children:v?e.jsx(C,{}):`${f.toLocaleString("en-IN")}`}),e.jsx(Ke,{children:v?e.jsx(C,{}):T.toFixed(2)}),e.jsx(Ke,{children:new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(Number(n))}),e.jsx(Ke,{children:U}),e.jsxs(Ke,{children:["",new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(D)]}),e.jsx(Ke,{children:W?e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:()=>$(k.brandId),className:"mr-2",children:"Save"}),e.jsx(z,{onClick:F,variant:"outline",children:e.jsx(hs,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(z,{size:"sm",onClick:()=>g(k.brandId),children:e.jsx(mi,{className:"h-2 w-2"})}),e.jsx(z,{size:"sm",onClick:()=>A(k.brandId),variant:"destructive",children:e.jsx(ja,{className:"h-2 w-2"})})]})})]},k.brandId)})})]})})})]});return e.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Brands Performance Metrics"})})}),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs(ue,{className:"mb-4",children:[e.jsx(bs,{children:e.jsx(Ts,{children:"Add New Brand Target"})}),e.jsxs(he,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"brandName",children:"Brand Name"}),e.jsxs(We,{onValueChange:M=>{const R=s.find(L=>L._id===M);o(L=>({...L,brandId:M,name:(R==null?void 0:R.name)||""}))},children:[e.jsx(Be,{children:e.jsx(He,{placeholder:"Select brand"})}),e.jsx(Ge,{children:s.map(M=>e.jsx(ie,{value:M._id,children:M.name},M._id))})]})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"source",children:"Source"}),e.jsxs(We,{onValueChange:w,value:l.source,children:[e.jsx(Be,{children:e.jsx(He,{placeholder:"Select source"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"Meta",children:"Meta"}),e.jsx(ie,{value:"Google",children:"Google"})]})]})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"targetSales",children:"Target Sales"}),e.jsx(ve,{id:"targetSales",name:"targetSales",type:"number",value:l.targetSales,onChange:j,placeholder:"Enter target sales"})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"targetSpend",children:"Target Spend"}),e.jsx(ve,{id:"targetSpend",name:"targetSpend",type:"number",value:l.targetSpend,onChange:j,placeholder:"Enter target spend"})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"targetROAS",children:"Target ROAS"}),e.jsx(ve,{id:"targetROAS",name:"targetROAS",type:"number",value:l.targetROAS,onChange:j,placeholder:"Enter target ROAS",step:"0.01"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(z,{onClick:P,className:"w-full",children:[e.jsx(Rt,{className:"mr-2 h-4 w-4"})," Add Brand Target"]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ye,{children:"Target Date"}),e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(z,{variant:"outline",className:Q("w-full justify-start text-left font-normal mt-2",!l.targetDate&&"text-muted-foreground"),children:l.targetDate?Y(l.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(Ys,{className:"w-auto p-0",children:e.jsx(la,{mode:"single",selected:l.targetDate,onSelect:M=>M&&o(R=>({...R,targetDate:M})),initialFocus:!0})})]})]})]})]}),E(B,"meta","Meta"),E(O,"google","Google"),e.jsxs(ue,{children:[e.jsx(bs,{children:e.jsx(Ts,{children:"Sales Progress"})}),e.jsx(he,{children:e.jsx(ar,{width:"100%",height:300,children:e.jsxs(vc,{data:I,children:[e.jsx(ho,{dataKey:"name"}),e.jsx(xo,{}),e.jsx(rr,{formatter:M=>`${Number(M).toLocaleString()}`}),e.jsx(Jt,{dataKey:"Meta Achieved",stackId:"meta",fill:"#4ade80"}),e.jsx(Jt,{dataKey:"Meta Remaining",stackId:"meta",fill:"#f87171"}),e.jsx(Jt,{dataKey:"Google Achieved",stackId:"google",fill:"#60a5fa"}),e.jsx(Jt,{dataKey:"Google Remaining",stackId:"google",fill:"#fbbf24"})]})})})]})]})]})}const hm=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(um,{})})]});function xm(){var W,K,q,ee,J,ae,pe;const s="https://parallels.messold.com",{brandId:a}=ge(),[t,l]=r.useState([{id:"products",label:"Products",apiEndpoint:`${s}/api/segment/productMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"categories",label:"Categories",apiEndpoint:`${s}/api/segment/categoryMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"brands",label:"Brands",apiEndpoint:`${s}/api/segment/brandMetrics/${a}`,columns:[],data:[],lastUpdated:null},{id:"productTypes",label:"Product types",apiEndpoint:`${s}/api/segment/typeMetrics/${a}`,columns:[],data:[],lastUpdated:null}]),[o,i]=r.useState(t[0].id),[c,d]=r.useState(1),[u,m]=r.useState(new Set),[h,v]=r.useState(!1),[y,S]=r.useState(!1),x=100,[p,N]=r.useState({}),j=r.useRef({}),w=5*60*1e3,P=V(G=>G.date.from),g=V(G=>G.date.to),$=r.useMemo(()=>({from:P,to:g}),[P,g]),F=$!=null&&$.from?Y($.from,"yyyy-MM-dd"):"",A=$!=null&&$.to?Y($.to,"yyyy-MM-dd"):"",[C,_]=r.useState(null),[I,B]=r.useState("asc"),O=G=>{i(G),d(1),m(new Set)},E=r.useCallback(async(G,se={},te=!1)=>{if(h)return;v(!0);const me=t.find(Z=>Z.id===G);if(!me){console.warn(`Tab not found for ID: ${G}`),v(!1);return}const je={...se,...F&&{startDate:F},...A&&{endDate:A}},Ne=`${G}-${F||"default"}-${A||"default"}`,Te=j.current[Ne],Fe=Date.now();if(!te&&G==="products"&&delete j.current[Ne],!te&&Te&&Fe-Te.timestamp<w){l(Z=>Z.map(le=>le.id===G?{...le,data:Te.data,lastUpdated:Te.timestamp}:le)),v(!1);return}try{const Z=await ne.post(me.apiEndpoint,je,{withCredentials:!0});if(Z.data.success){const oe=Z.data[`${G}Data`]||[];console.log("New Data for Tab:",G,oe);const _e=Object.keys(oe[0]||{}).map(Pe=>({id:Pe,header:Pe.charAt(0).toUpperCase()+Pe.slice(1),accessorKey:Pe,cell:Ze=>Pe==="issues"&&Array.isArray(Ze)?Ze.length>0?Ze[0].description:"No issues":String(Ze)}));console.log("Columns for Tab:",_e),l(Pe=>Pe.map(Ze=>Ze.id===G?{...Ze,columns:_e,data:oe,lastUpdated:Fe}:Ze)),j.current[Ne]={data:oe,timestamp:Fe}}else console.error(`Failed to fetch data for ${G}`)}catch(Z){console.error(`Error fetching data for ${G}:`,Z)}finally{v(!1)}},[t,h,j,F,A]);r.useEffect(()=>{const G={...p,...F&&{startDate:F},...A&&{endDate:A}};E(o,y?G:{},!!y)},[o,$,y,p]);const M=(G,se)=>{const te={brands:"Brand",productTypes:"Type",categories:"name",products:"status"},me={brands:"brands",productTypes:"productType",categories:"categoryName",products:"status"},je=te[G],Ne=me[G];if(je&&Ne){const Te=se[je];if(Te){const Fe={[Ne]:Te};G==="categories"&&se.level&&(Fe.categoryLevel=se.level),N(Fe),S(!0),i("products")}else console.warn(`No value found for column "${je}" in row`,se)}else console.warn(`No column or body key mapping found for tab: ${G}`)},R=G=>{m(se=>{const te=new Set(se);return te.has(G)?te.delete(G):te.add(G),te})},L=(G,se=0,te="")=>{const me=te?`${te}.${G.name}`:G.name,je=u.has(me);return e.jsxs(Se.Fragment,{children:[e.jsxs("tr",{className:`${je?"bg-gray-100":"bg-white"}`,children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm flex items-center",children:e.jsxs("div",{style:{marginLeft:`${se*20}px`},onClick:()=>R(me),className:"flex items-center cursor-pointer",children:[G.subcategories.length>0&&e.jsx("button",{className:"mr-2",children:je?e.jsx(os,{className:"h-4 w-4"}):e.jsx(Je,{className:"h-4 w-4"})}),G.name]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm cursor-pointer text-blue-500 underline",onClick:()=>M(o,G),children:G.metrics.products}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.totalCost}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ROAS}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.conversions}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ConversionValue}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ConversionRate}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.totalClicks}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ctr}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.AvgCPC})]}),je&&G.subcategories.map(Ne=>L(Ne,se+1,me))]},me)},k=G=>{C===G?B(se=>se==="asc"?"desc":"asc"):(_(G),B("asc"))},f=()=>{const G=t.find(je=>je.id===o);if(!G||G.id==="categories")return{columns:[],data:[]};let se=G.data;C&&(se=[...se].sort((je,Ne)=>{const Te=je[C],Fe=Ne[C];if(typeof Te=="number"&&typeof Fe=="number")return I==="asc"?Te-Fe:Fe-Te;const Z=String(Te||"").toLowerCase(),le=String(Fe||"").toLowerCase();return Z<le?I==="asc"?-1:1:Z>le?I==="asc"?1:-1:0}));const te=(c-1)*x,me=te+x;return{columns:G.columns,data:se.slice(te,me)}},{columns:n,data:b}=f(),T=Math.ceil((((W=t.find(G=>G.id===o))==null?void 0:W.data.length)||0)/x),U=[{id:"name",header:"Name"},{id:"products",header:"Products"},{id:"totalCost",header:"Cost"},{id:"ROAS",header:"ROAS"},{id:"conversions",header:"Conversions"},{id:"ConversionValue",header:"Conv. Value"},{id:"ConversionRate",header:"Conv. Rate"},{id:"totalClicks",header:"Clicks"},{id:"ctr",header:"CTR"},{id:"AvgCPC",header:"Avg CPC"}];function D(){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map((G,se)=>e.jsx("th",{className:"px-4 py-2 border-b",children:e.jsx(Es,{className:`h-4 ${G}`})},se))})}),e.jsx("tbody",{children:Array.from({length:8}).map((G,se)=>e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map((te,me)=>e.jsx("td",{className:"px-4 py-2 border-b",children:e.jsx(Es,{className:`h-4 ${te}`})},me))},se))})]})})}return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(ms,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Product Insights"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2 mb-2",children:[e.jsx("div",{className:"flex space-x-2",role:"tablist",children:t.map(G=>e.jsxs(z,{variant:o===G.id?"default":"ghost",onClick:()=>O(G.id),className:"relative",children:[G.id==="products"&&e.jsx(kt,{className:"w-4 h-4 mr-2"}),G.id==="categories"&&e.jsx(ui,{className:"w-4 h-4 mr-2"}),G.id==="brands"&&e.jsx(eo,{className:"w-4 h-4 mr-2"}),G.id==="productTypes"&&e.jsx(hi,{className:"w-4 h-4 mr-2"}),G.label,o===G.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]},G.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{}),e.jsx(z,{variant:"outline",size:"icon",children:e.jsx(Mt,{className:`h-4 w-4 ${y?"text-blue-600":"text-gray-600"}`})}),e.jsx(bn,{children:e.jsxs(jn,{children:[e.jsx(yn,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",onClick:()=>E(o,{},!1),children:e.jsx($e,{className:`h-4 w-4 ${h?"animate-spin":""}`})})}),((K=t.find(G=>G.id===o))==null?void 0:K.lastUpdated)&&e.jsx(vn,{children:e.jsxs("p",{children:["Last updated: ",new Date(((q=t.find(G=>G.id===o))==null?void 0:q.lastUpdated)||0).toLocaleString()]})})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[y&&e.jsxs("div",{className:"flex items-center gap-2 w-fit p-2 bg-blue-50 rounded-full",children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:Object.entries(p).map(([G,se])=>`${G}: ${se}`).join(", ")}),e.jsx(z,{variant:"ghost",size:"sm",onClick:()=>{S(!1),N({}),i("products"),j.current.products=null,E("products",{},!1)},className:"text-blue-700 hover:text-blue-800 hover:bg-blue-100 p-1 h-auto",children:e.jsx(hs,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[350px] overflow-auto",children:h?e.jsx(D,{}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A]",children:e.jsx("tr",{children:(o==="categories"?U:n).map(G=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[150px] cursor-pointer",onClick:()=>k(G.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[G.header,C===G.id?I==="asc"?e.jsx(pa,{className:"h-4 w-4"}):e.jsx(ba,{className:"h-4 w-4"}):e.jsx(oa,{className:"h-4 w-4"})]})},G.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[o==="categories"?(ee=t.find(G=>G.id==="categories"))==null?void 0:ee.data.map(G=>L(G)):b.map((G,se)=>e.jsx("tr",{className:"hover:bg-gray-50",children:n.map(te=>{const me=te.cell(G[te.accessorKey]),je=te.id==="issues",Ne=te.id==="Products",Te=te.id==="status",Fe=typeof me=="string"&&me.trim().toLowerCase()==="no issues",Z=oe=>{switch(oe.trim().toUpperCase()){case"UNSPECIFIED":return"bg-gray-100 text-gray-800";case"UNKNOWN":return"bg-yellow-100 text-yellow-800";case"NOT_ELIGIBLE":return"bg-red-100 text-red-800";case"ELIGIBLE_LIMITED":return"bg-orange-100 text-orange-800";case"ELIGIBLE":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-700"}},le=()=>{if(je)return e.jsxs("div",{className:`flex items-center ${Fe?"text-green-600":"text-red-600"}`,children:[Fe?e.jsx(At,{className:"w-4 h-4 mr-2"}):e.jsx(js,{className:"w-4 h-4 mr-2"}),me]});if(Te){const oe=me?String(me):"",_e=Z(oe);return e.jsx("div",{className:`px-2 py-1.5 rounded-full text-xs font-medium w-full ${_e} cursor-pointer`,onClick:()=>M(o,G),children:oe})}return te.cell?te.cell(me):me};return e.jsx("td",{className:`px-4 py-2.5 text-sm whitespace-nowrap min-w-[150px] ${Ne?"cursor-pointer text-blue-600 hover:text-blue-800":""}`,onClick:()=>Ne&&M(o,G),children:le()},te.id)})},se)),(o==="categories"?((J=t.find(G=>G.id==="categories"))==null?void 0:J.data.length)===0:b.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:(o==="categories"?U:n).length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(c-1)*x+1," to ",Math.min(c*x,((ae=t.find(G=>G.id===o))==null?void 0:ae.data.length)||0)," of ",((pe=t.find(G=>G.id===o))==null?void 0:pe.data.length)||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>d(G=>Math.max(G-1,1)),disabled:c===1,children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",c," of ",T]}),e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>d(G=>Math.min(G+1,T)),disabled:c===T,children:["Next",e.jsx(Je,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})]})}const gm=()=>e.jsxs(ka,{className:"text-center min-w-full",children:[e.jsx(Aa,{className:"bg-gray-200 sticky top-0 z-10",children:e.jsx(Ws,{children:Array(8).fill(0).map((s,a)=>e.jsx(Ke,{className:"font-bold px-4 text-black min-w-[150px]",children:e.jsx(Es,{className:"h-6 w-full"})},a))})}),e.jsx(Ma,{children:Array(10).fill(0).map((s,a)=>e.jsx(Ws,{children:Array(8).fill(0).map((t,l)=>e.jsx(Ke,{className:"px-4 py-2 max-w-[200px]",children:e.jsx(Es,{className:"h-6 w-full"})},l))},a))})]});function fm(){var q;const s="https://parallels.messold.com",{brandId:a}=ge(),[t,l]=r.useState([]),[o,i]=r.useState(!0),[c,d]=r.useState(1),[u,m]=r.useState(!0),[h,v]=r.useState(0),[y,S]=r.useState(0),[x,p]=r.useState([]),[N,j]=r.useState("all"),[w,P]=r.useState([]),[g,$]=r.useState("all"),[F,A]=r.useState("all"),C=V(ee=>ee.date.from),_=V(ee=>ee.date.to),I=r.useMemo(()=>({from:C,to:_}),[C,_]),B=I!=null&&I.from?Y(I.from,"yyyy-MM-dd"):"",O=I!=null&&I.to?Y(I.to,"yyyy-MM-dd"):"",E=100,M=[{id:"searchTerm",header:"Search Term",icon:e.jsx(Cs,{className:"w-4 h-4"})},{id:"matchType",header:"Match Type",icon:e.jsx(Tt,{className:"w-4 h-4"})},{id:"status",header:"Status",icon:e.jsx(Mt,{className:"w-4 h-4"})},{id:"campaignName",header:"Campaign Name",icon:e.jsx(xi,{className:"w-4 h-4"})},{id:"adGroupName",header:"Ad Group",icon:e.jsx(Ft,{className:"w-4 h-4"})},{id:"cost",header:"Cost",icon:e.jsx(za,{className:"w-4 h-4"})},{id:"conversions",header:"Conversions",icon:e.jsx(Is,{className:"w-4 h-4"})},{id:"conversionsValue",header:"Conv. Value",icon:e.jsx(Qe,{className:"w-4 h-4"})},{id:"conversionsRate",header:"Conv. Rate",icon:e.jsx(Ba,{className:"w-4 h-4"})},{id:"clicks",header:"Clicks",icon:e.jsx(so,{className:"w-4 h-4"})},{id:"ctr",header:"CTR",icon:e.jsx(Ba,{className:"w-4 h-4"})},{id:"avg_cpc",header:"Avg. CPC",icon:e.jsx(to,{className:"w-4 h-4"})}],[R,L]=r.useState(null),[k,f]=r.useState("asc"),n=ee=>{R===ee?f(J=>J==="asc"?"desc":"asc"):(L(ee),f("asc"))},b=r.useMemo(()=>R?[...t].sort((ee,J)=>{const ae=ee[R],pe=J[R];if(typeof ae=="number"&&typeof pe=="number")return k==="asc"?ae-pe:pe-ae;const G=String(ae).toLowerCase(),se=String(pe).toLowerCase();return G<se?k==="asc"?-1:1:G>se?k==="asc"?1:-1:0}):t,[t,R,k]),T=r.useCallback(async()=>{i(!0);try{const ee={limit:E,page:c,startDate:B,endDate:O,...N&&N!=="all"&&{campaign:N},...g&&g!=="all"&&{adGroup:g},...F&&F!=="all"&&{status:F}},{data:J}=await ne.post(`${s}/api/segment/searchTermMetrics/${a}`,ee,{withCredentials:!0});J.success?(l(J.data),v(J.totalRecords),S(J.totalPages),m(c*E<J.totalRecords),p(J.campaignAdGroupPairs),P(J.statusOptions)):console.error("Failed to fetch search term metrics:",J.message)}catch(ee){console.error("Error fetching search term metrics:",ee)}finally{i(!1)}},[s,a,c,E,N,g,F,B,O]);r.useEffect(()=>{T();const ee=setInterval(T,3e5);return()=>clearInterval(ee)},[T]);const U=ee=>{j(ee),$("all"),d(1)},D=ee=>{$(ee),d(1)},W=ee=>{A(ee),d(1)},K=N!=="all"?((q=x==null?void 0:x.find(ee=>ee.campaignName===N))==null?void 0:q.adGroups)||[]:[];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(ms,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Search Term Insights"})]}),e.jsx("div",{className:"bg-white rounded-xl overflow-hidden border border-gray-200 shadow-md",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsxs(z,{variant:"outline",className:"bg-white border-gray-300 hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Filter"]})}),e.jsx(Ys,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Status"}),e.jsxs(We,{onValueChange:W,value:F,children:[e.jsx(Be,{className:"w-full",children:e.jsx(He,{placeholder:"Select Status"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Status"}),w.map(ee=>e.jsx(ie,{value:ee,children:ee},ee))]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Campaign"}),e.jsxs(We,{onValueChange:U,value:N,children:[e.jsx(Be,{className:"w-full",children:e.jsx(He,{placeholder:"Select Campaign"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Campaigns"}),x.map(ee=>e.jsx(ie,{value:ee.campaignName,children:ee.campaignName},ee.campaignName))]})]})]}),N!=="all"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ad Group"}),e.jsxs(We,{disabled:N==="all",onValueChange:D,value:g,children:[e.jsx(Be,{className:"w-full",children:e.jsx(He,{placeholder:"Select Ad Group"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Ad Groups"}),K.map(ee=>e.jsx(ie,{value:ee,children:ee},ee))]})]})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Le,{}),e.jsxs(z,{variant:"outline",className:"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100",onClick:T,children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[380px] overflow-auto rounded-lg",children:o?e.jsx(gm,{}):e.jsxs("table",{className:"w-full text-center",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A] rounded-t-lg",children:e.jsx("tr",{children:M.map(ee=>e.jsx("th",{className:"px-4 py-3 text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[200px] cursor-pointer",onClick:()=>n(ee.id),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[ee.icon,ee.header,R===ee.id?k==="asc"?e.jsx(pa,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(ba,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(oa,{className:"ml-1 w-4 h-6 text-gray-300"})]})},ee.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[b.map((ee,J)=>e.jsx("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:M.map(ae=>{const pe=ee[ae.id],G=ae.id==="status",se=ae.id==="searchTerm",te=()=>{if(G){const me=pe?String(pe):"",Ne=(Te=>{switch(Te.trim().toUpperCase()){case"ADDED":return"bg-green-100 text-green-800";case"NONE":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(me);return e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ne}`,children:me})}if(se){const me=pe?String(pe):"",je=ee.performance,Ne=je==="Best Performing Keyword";return e.jsxs("div",{className:"px-2 py-1 rounded-full font-medium flex flex-col items-center",children:[e.jsx("span",{className:`text-xs ${Ne?"text-green-600":"text-red-600"}`,children:je}),e.jsx("span",{className:"text-sm mt-1",children:me})]})}return pe};return e.jsx("td",{className:"px-4 py-2.5 text-sm min-w-[200px]",children:te()},ae.id)})},J)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:M.length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(c-1)*E+1," to"," ",Math.min(c*E,h||0)," of"," ",h||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>d(ee=>Math.max(ee-1,1)),disabled:c===1,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:[e.jsx(us,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",c," of ",y]}),e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>d(ee=>ee+1),disabled:!u,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:["Next",e.jsx(Je,{className:"h-4 w-4 ml-1"})]})]})]})]})]})})]})}function pm(){const{brandId:s}=ge();return s?e.jsxs("div",{className:"bg-gray-100 min-h-screen overflow-hidden",children:[e.jsx("nav",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Segment Dashboard"}),e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{})})]})}),e.jsxs("div",{className:"flex flex-col p-6 gap-6 overflow-auto",children:[e.jsx(xm,{}),e.jsx(fm,{})]})]}):(console.error("Brand ID is not defined"),e.jsx("div",{children:"Error: Brand ID is missing"}))}const bm=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(pm,{})})]}),Vo=()=>{const s=Me(),a=V(l=>l.user.user);return{refreshBrands:r.useCallback(async()=>{try{if(!(a!=null&&a.brands)||a.brands.length===0){console.warn("No brand IDs found in user context.");return}const l=await ne.post(`${be}/api/brands/filter`,{brandIds:a.brands},{withCredentials:!0});s(va(l.data))}catch(l){console.error("Error refreshing brands:",l)}},[a==null?void 0:a.brands,s])}},jm=()=>{const s=Xe(),{toast:a}=mt(),t=Me(),{refreshBrands:l}=Vo(),o="https://parallels.messold.com",i=V(c=>c.brand.selectedBrandId);return r.useEffect(()=>{(async()=>{try{const d=new URLSearchParams(window.location.search),u=d.get("token"),m=d.get("fbToken"),h=d.get("googleadRefreshToken"),v=d.get("googleanalyticsRefreshToken"),y=d.get("zohoToken"),S=d.get("userId"),x=d.get("shopify_token"),p=async(N,j,w)=>{var P,g;try{if((await ne.put(`${o}${N}/${w}?brandId=${i}`,{},{params:{[w]:j},withCredentials:!0})).data.success){if(console.log(`${w} token updated successfully`),t(Eo()),w==="zohoToken")console.log("Zoho token updated, redirecting to /profile"),s("/profile");else{const F=d.get("source")||"/dashboard";let A="";switch(w){case"googleadRefreshToken":A="googleAds";break;case"googleanalyticsRefreshToken":A="googleAnalytics";break;case"fbToken":A="facebook";break}return a({title:"Success",description:`${w} token updated successfully.`,variant:"default"}),s(A?`${F}?openModal=${A}`:F),!0}return!0}else return console.error(`Failed to update ${w} token`),a({title:"Update Failed",description:`Unable to update ${w} token.`,variant:"destructive"}),s("/dashboard"),!1}catch($){return console.error(`Error updating ${w} token:`,$),a({title:"Update Failed",description:((g=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:g.message)||`Unable to update ${w} token.`,variant:"destructive"}),s("/"),!1}};if(u){console.log("Token found, proceeding with login");const N=await ne.post(`${o}/api/auth/login/oauth?auth_token=${u}`,{email:null,password:null});if(N.data.success){console.log("Login successful");const j=N.data.user;t(Bt(j)),!j.brands||j.brands.length===0?(console.log("No brands found, redirecting to brand setup"),s("/brand-setup")):(console.log("Brands found, redirecting to dashboard"),s("/dashboard"));return}else{console.log("Login failed, redirecting to /"),a({title:"Login Failed",description:"Unable to authenticate with Google.",variant:"destructive"}),s("/");return}}if(m){await p("/api/auth/updateTokens",m,"fbToken");return}if(h){await p("/api/auth/updateTokens",h,"googleadRefreshToken");return}if(v){await p("/api/auth/updateTokens",v,"googleanalyticsRefreshToken");return}if(y){await p("/api/auth/updateTokens/zoho",y,"zohoToken");return}if(S&&x){console.log("Token found, proceeding with user saving");const N=await ne.get(`${o}/api/users/getuser/${S}?token=${x}`);if(N.data.success){const j=N.data.user,w=N.data.brands;t(Bt(j)),t(va(w)),t(yt(w[0]._id)),await l(),!j.brands||j.brands.length===0?(console.log("No brands found, redirecting to brand setup"),s("/brand-setup")):(console.log("Brands found, redirecting to dashboard"),s("/dashboard"));return}else{console.log("Login failed, redirecting to /login"),a({title:"Login Failed",description:"Unable to authenticate with Google.",variant:"destructive"}),s("/login");return}}console.log("No token present, redirecting to /login"),s("/login")}catch(d){console.error("Error during OAuth callback:",d),a({title:"Error",description:"An error occurred while handling the login callback.",variant:"destructive"}),s("/login")}})()},[s,Bt,a,o,i]),null},Zt=[{key:"day",header:"Day",width:140,minWidth:120},{key:"month",header:"Month",width:140,minWidth:120},{key:"date",header:"Date",width:140,minWidth:120},{key:"sessions",header:"Sessions",width:120,minWidth:110,align:"right"},{key:"addToCart",header:"Add To Cart",width:140,minWidth:120,align:"right"},{key:"addToCartRate",header:"Add To Cart Rate",width:160,minWidth:140,align:"right"},{key:"checkouts",header:"Checkouts",width:130,minWidth:110,align:"right"},{key:"checkoutRate",header:"Checkout Rate",width:150,minWidth:130,align:"right"},{key:"purchases",header:"Purchases",width:130,minWidth:110,align:"right"},{key:"purchaseRate",header:"Purchase Rate",width:150,minWidth:130,align:"right"},{key:"atcToCheckoutRate",header:"ATC To Checkout Rate",width:150,minWidth:130,align:"right"},{key:"checkoutToPurchaseRate",header:"Checkout To Purchase Rate",width:150,minWidth:130,align:"right"},{key:"aov",header:"AOV",width:120,minWidth:110,align:"right"},{key:"averageItemsPerOrder",header:"Avg Items/Order",width:150,minWidth:130,align:"right"},{key:"codOrderCount",header:"COD Orders",width:130,minWidth:110,align:"right"},{key:"prepaidOrderCount",header:"Prepaid Orders",width:150,minWidth:130,align:"right"},{key:"productsLaunched",header:"Products Launched",width:150,minWidth:130,align:"right"},{key:"returningCustomerPercentage",header:"Returned Customers",width:150,minWidth:130,align:"right"}];function Or(s,a,t){return t!=null?Math.min(Math.max(s,a),t):Math.max(s,a)}function ym(s){return s==="aov"||s==="averageItemsPerOrder"||s==="codOrderCount"||s==="prepaidOrderCount"||s==="productsLaunched"||s==="returningCustomerPercentage"?e.jsx(vt,{width:"1rem",height:"1rem"}):s!=="month"&&s!=="day"&&s!=="date"?e.jsx(vs,{width:"1rem",height:"1rem"}):null}function dr({rows:s,initialPageSize:a="50",visibleColumns:t,columnOrder:l}){const o=r.useMemo(()=>{if(!t||!l)return console.log("No column management props, using all columns"),Zt;console.log("Column management props:",{visibleColumns:t,columnOrder:l});const E={Day:"day",Month:"month",Date:"date",Sessions:"sessions","Add To Cart":"addToCart","Add To Cart Rate":"addToCartRate",Checkouts:"checkouts","Checkout Rate":"checkoutRate",Purchases:"purchases","Purchase Rate":"purchaseRate","ATC To Checkout Rate":"atcToCheckoutRate","Checkout To Purchase Rate":"checkoutToPurchaseRate",AOV:"aov","Avg Items/Order":"averageItemsPerOrder","COD Orders":"codOrderCount","Prepaid Orders":"prepaidOrderCount","Products Launched":"productsLaunched","Returned Customers":"returningCustomerPercentage"},M=l.filter(L=>t.includes(L)).map(L=>{const k=E[L],f=Zt.find(n=>n.key===k);return console.log(`Mapping column "${L}" to key "${k}", found:`,f),f}).filter(L=>L!==void 0),R=M.length>0?M:Zt;return R.some(L=>!L||!L.key)?(console.error("Invalid columns detected, falling back to all columns:",R),Zt):R},[t,l]),[i,c]=r.useState([]),d=r.useRef(null),[u,m]=r.useState(0),h=r.useRef(""),v=r.useRef(!1);r.useEffect(()=>{const E=()=>{d.current&&m(d.current.clientWidth)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),r.useEffect(()=>{if(o.length===0||u===0)return;const E=o.map(f=>f.key).join(",");E!==h.current&&(h.current=E,v.current=!1);const M=o.map(f=>f.width),R=o.map(f=>f.minWidth||80),L=M.reduce((f,n)=>f+n,0),k=R.reduce((f,n)=>f+n,0);if(L>0)if(k>u){const f=u/k,n=R.map(b=>b*f);c(n)}else{const f=u/L;let n=M.map((U,D)=>{const W=U*f,K=R[D];return Math.max(W,K)}),b=n.reduce((U,D)=>U+D,0);if(b>u){const U=b-u,D=[];let W=0;for(let K=0;K<n.length;K++){const q=n[K];q>R[K]&&(D.push(K),W+=q)}W>0&&D.length>0&&(n=n.map((K,q)=>D.includes(q)?K-U*(K/W):K))}else if(b<u){const U=u-b,D=[];let W=0;for(let K=0;K<n.length;K++){const q=n[K];q>R[K]&&(D.push(K),W+=q)}if(D.length===0){const K=U/n.length;n=n.map(q=>q+K)}else W>0&&(n=n.map((K,q)=>D.includes(q)?K+U*(K/W):K))}const T=n.reduce((U,D)=>U+D,0);if(Math.abs(T-u)>.1){const U=(u-T)/n.length;n=n.map(D=>D+U)}c(n)}else c(M);v.current=!0},[o,u]);const y=r.useMemo(()=>o.map((E,M)=>i[M]||E.width),[o,i]),S=r.useMemo(()=>y.reduce((E,M)=>E+M,0),[y]),x=r.useRef(null),[p,N]=r.useState(null),[j,w]=r.useState(a),[P,g]=r.useState(1),$=s.length,F=j==="all"?$:Number(j),A=Math.max(1,Math.ceil(($||1)/(F||1)));r.useEffect(()=>{g(E=>Or(E,1,A))},[A]);const C=j==="all"?0:(P-1)*F,_=j==="all"?$:Math.min(C+F,$),I=s.slice(C,_);r.useEffect(()=>{const E=R=>{const L=x.current;if(!L)return;const k=R.clientX-L.startX,f=o[L.index];c(n=>{const b=[...n];return b[L.index]=Or(L.startWidth+k,f.minWidth??80,f.maxWidth),b})},M=()=>{x.current=null,N(null),document.body.style.cursor="",document.body.classList.remove("select-none")};return window.addEventListener("pointermove",E),window.addEventListener("pointerup",M),()=>{window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",M)}},[]);const B=(E,M)=>{x.current={index:M,startX:E.clientX,startWidth:i[M]},N(M),document.body.style.cursor="col-resize",document.body.classList.add("select-none"),E.currentTarget.setPointerCapture(E.pointerId)},O=(E,M)=>{if(M==="returningCustomerPercentage"){const L=E.returningCustomerPercentage;return L==null?"-":`${L.toFixed(1)}%`}if(M==="codOrderCount"||M==="prepaidOrderCount"){const L=E.codOrderCount??0,k=E.prepaidOrderCount??0,f=L+k;if(E.codOrderCount===void 0&&E.prepaidOrderCount===void 0)return"-";if(f===0)return"0%";let n,b,T;return M==="codOrderCount"?(n=L/f*100,b=L,T="COD Orders"):(n=k/f*100,b=k,T="Prepaid Orders"),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs("span",{className:"cursor-default",children:[n.toFixed(1),"%"]})}),e.jsx(ns,{children:e.jsxs("p",{children:[T,": ",b.toLocaleString()]})})]})}const R=E[M];return R===void 0?"-":typeof R=="number"?R.toLocaleString():R};return!o||o.length===0?(console.error("No valid columns available, rendering empty table"),e.jsx("div",{children:"No columns available"})):e.jsx(_t,{children:e.jsx("div",{className:"w-full space-y-2",children:e.jsx("div",{className:"w-full rounded-lg border border-gray-200 bg-white overflow-hidden",children:e.jsxs("div",{ref:d,className:"overflow-x-auto overflow-y-auto",style:{height:"90vh",width:"100%"},children:[e.jsxs("table",{className:"table-fixed border-collapse text-sm w-full",style:{minWidth:`${S}px`},children:[e.jsx("colgroup",{children:y.map((E,M)=>{var R;return e.jsx("col",{style:{width:E}},String(((R=o[M])==null?void 0:R.key)||`col-${M}`))})}),e.jsx("thead",{className:"bg-gray-100 sticky top-0 z-50",children:e.jsx("tr",{className:"text-gray-600",children:o.map((E,M)=>{if(!E||!E.key)return console.error("Invalid column at index",M,E),null;const R=M===0,L=p===M,k=ym(E.key);return e.jsxs("th",{scope:"col",className:Q("relative h-11 align-middle border-b border-l last:border-r",L?"border-blue-500":"border-gray-200","px-3 text-left font-medium bg-gray-100",E.align==="right"&&"text-right",R&&"sticky left-0 z-50 bg-gray-100 shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsx("span",{className:"flex-shrink-0",children:k}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("span",{className:"truncate cursor-help",children:E.header})}),e.jsx(ns,{side:"bottom",children:e.jsx("p",{children:E.header})})]})]}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${E.header} column`,onPointerDown:f=>B(f,M),className:Q("absolute inset-y-0 right-0 w-3 cursor-col-resize",L?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"),children:e.jsx("div",{className:Q("absolute right-0 top-0 h-full w-px",L?"bg-blue-500":"bg-gray-200")})})]},String(E.key))})})}),e.jsx("tbody",{className:"text-gray-700",children:I.map((E,M)=>e.jsx("tr",{className:Q(M%2===1&&"bg-gray-50/60","hover:bg-blue-50 transition-colors duration-150"),children:o.map((R,L)=>{if(!R||!R.key)return console.error("Invalid column at index",L,R),null;const k=L===0,f=R.align==="right"?"text-right":R.align==="center"?"text-center":"text-left";return e.jsx("td",{className:Q("px-3 py-2 truncate tabular-nums","border-b border-l last:border-r","align-middle","border-gray-200",f,k&&"sticky left-0 z-40 bg-transparent shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]"),title:typeof E[R.key]=="string"?E[R.key]:void 0,children:O(E,R.key)},String(R.key))})},E.id))})]}),e.jsxs("div",{className:"flex flex-col items-start justify-between gap-3 border-t border-gray-200 bg-gray-50 p-3 text-sm md:flex-row md:items-center mt-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"Rows per page:"}),e.jsxs(We,{value:j,onValueChange:E=>{w(E),g(1)},children:[e.jsx(Be,{className:"h-8 w-[100px]",children:e.jsx(He,{})}),e.jsxs(Ge,{align:"start",className:"w-[140px]",children:[e.jsx(ie,{value:"50",children:"50"}),e.jsx(ie,{value:"100",children:"100"}),e.jsx(ie,{value:"200",children:"200"}),e.jsx(ie,{value:"all",children:"All"})]})]})]}),e.jsxs("div",{className:"flex flex-1 items-center justify-end gap-3",children:[e.jsx("div",{className:"text-gray-600",children:$===0?"0 of 0":e.jsxs(e.Fragment,{children:[C+1,"",_," of ",$]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>g(E=>Math.max(1,E-1)),disabled:P<=1||j==="all","aria-label":"Previous page",children:e.jsx(us,{className:"h-4 w-4"})}),e.jsx("span",{className:"min-w-[4rem] text-center text-gray-700",children:j==="all"?"1 / 1":`${P} / ${A}`}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>g(E=>Math.min(A,E+1)),disabled:P>=A||j==="all","aria-label":"Next page",children:e.jsx(Je,{className:"h-4 w-4"})})]})]})]})]})})})})}const vm=({dateRange:s,visibleColumns:a,columnOrder:t,refreshTrigger:l})=>{const o=V(A=>A.date.from),i=V(A=>A.date.to),c=V(A=>A.date.compareFrom),d=V(A=>A.date.compareTo),[u,m]=r.useState([]),[h,v]=r.useState(!1),{brandId:y}=ge(),S=r.useMemo(()=>({from:o,to:i}),[o,i]),x=r.useMemo(()=>({from:c,to:d}),[c,d]),p=S!=null&&S.from?Y(new Date(S.from),"yyyy-MM-dd"):"",N=S!=null&&S.to?Y(new Date(S.to),"yyyy-MM-dd"):"",j=x!=null&&x.from?Y(new Date(x.from),"yyyy-MM-dd"):"",w=x!=null&&x.to?Y(new Date(x.to),"yyyy-MM-dd"):"",P=Me(),g=Ce(),$=r.useMemo(()=>u.map((A,C)=>({id:`row-${C}`,date:A.Date,sessions:parseInt(A.Sessions)||0,addToCart:parseInt(A["Add To Cart"])||0,addToCartRate:A["Add To Cart Rate"]||"0%",checkouts:parseInt(A.Checkouts)||0,checkoutRate:A["Checkout Rate"]||"0%",purchases:parseInt(A.Purchases)||0,purchaseRate:A["Purchase Rate"]||"0%",atcToCheckoutRate:A["ATC To Checkout Rate"]||"0%",checkoutToPurchaseRate:A["Checkout To Purchase Rate"]||"0%"})),[u]);r.useEffect(()=>{s&&P(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,P]);const F=r.useCallback(async()=>{var A;v(!0);try{const C=[];if(p&&N&&C.push({startDate:p,endDate:N}),j&&w&&C.push({startDate:j,endDate:w}),C.length>0){const I=(await g.post(`/api/analytics/atcreport/${y}`,{dateRanges:C},{withCredentials:!0})).data.ranges||[];if(I.length>0){const B=I[0].Date;m(B?I:((A=I[0])==null?void 0:A.data)||[])}}}catch(C){console.error("Error fetching e-commerce metrics data:",C)}finally{v(!1)}},[p,N,j,w,y]);return r.useEffect(()=>{p&&N&&F()},[p,N,y]),r.useEffect(()=>{if(!p||!N)return;const A=setInterval(()=>{F()},15*60*1e3);return()=>clearInterval(A)},[p,N,y]),r.useEffect(()=>{l>0&&p&&N&&F()},[l,p,N,y]),h?e.jsx(Ae,{isLoading:h}):e.jsx(dr,{rows:$,initialPageSize:"50",visibleColumns:a,columnOrder:t})},Nm={"google analytics":{title:"Google analytics",description:"Unlock powerful insights for your store",icon:e.jsx(Xn,{className:"h-16 w-16 text-blue-500 animate-bounce"}),benefits:[{icon:e.jsx(ys,{className:"h-8 w-8 text-primary"}),title:"Real-time Analytics",description:"Track visitor behavior as it happens"},{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Performance Metrics",description:"Monitor your store's key metrics"},{icon:e.jsx(Qe,{className:"h-8 w-8 text-primary"}),title:"Growth Insights",description:"Make data-driven decisions"}],buttonText:"Connect GA4 Now",guideText:"Need help setting up GA4?"},"google ads":{title:"Google Ads",description:"Supercharge your advertising performance",icon:e.jsx(ao,{className:"h-16 w-16 text-red-500 animate-bounce"}),benefits:[{icon:e.jsx(ys,{className:"h-8 w-8 text-primary"}),title:"Campaign Tracking",description:"Monitor ad performance in real-time"},{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Conversion Analytics",description:"Track ROI and conversions"},{icon:e.jsx(Qe,{className:"h-8 w-8 text-primary"}),title:"Budget Optimization",description:"Optimize spending across campaigns"}],buttonText:"Connect Google Ads",guideText:"New to Google Ads?"},facebook:{title:"Facebook Ads",description:"Scale your social media advertising",icon:e.jsx(ro,{className:"h-16 w-16 text-blue-600 animate-bounce"}),benefits:[{icon:e.jsx(ys,{className:"h-8 w-8 text-primary"}),title:"Audience Insights",description:"Understand your target audience"},{icon:e.jsx(Vs,{className:"h-8 w-8 text-primary"}),title:"Ad Performance",description:"Track engagement and reach"},{icon:e.jsx(Qe,{className:"h-8 w-8 text-primary"}),title:"ROAS Tracking",description:"Measure advertising return"}],buttonText:"Connect Facebook Ads",guideText:"First time with Facebook Ads?"}},Pt=({platform:s="google analytics",brandId:a,onSuccess:t})=>{const[l,o]=r.useState(!1),i=Nm[s],c=()=>{o(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-secondary/20 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto w-full space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:i.icon}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tight",children:["Connect ",i.title]}),e.jsx("p",{className:"text-xl text-muted-foreground",children:i.description})]}),e.jsx(ue,{className:"p-6 bg-card/50 backdrop-blur-sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-lg text-center",children:["You haven't connected ",i.title," yet. You're missing out on valuable insights about your store's performance!"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4 my-8",children:i.benefits.map((d,u)=>e.jsxs("div",{className:"flex flex-col items-center text-center p-4 space-y-2",children:[d.icon,e.jsx("h3",{className:"font-semibold",children:d.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:d.description})]},u))}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(z,{size:"lg",className:"group",onClick:c,children:[i.buttonText,e.jsx(Ss,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]})}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[i.guideText," ",e.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Check out our guide"})]})]})}),e.jsx(Ht,{platform:s,open:l,onOpenChange:o,brandId:a,onSuccess:t})]})},wm=({dateRange:s,visibleColumns:a,columnOrder:t,refreshTrigger:l})=>{const o=V(w=>w.date.from),i=V(w=>w.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),[d,u]=r.useState([]),[m,h]=r.useState(!1),{brandId:v}=ge(),y=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",S=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"",x=Me(),p=Ce(),N=r.useMemo(()=>d.map((P,g)=>({id:`row-${g}`,day:P.Day,sessions:parseInt(P.Sessions)||0,addToCart:parseInt(P["Add To Cart"])||0,addToCartRate:P["Add To Cart Rate"]||"0%",checkouts:parseInt(P.Checkouts)||0,checkoutRate:P["Checkout Rate"]||"0%",purchases:parseInt(P.Purchases)||0,purchaseRate:P["Purchase Rate"]||"0%",atcToCheckoutRate:P["ATC To Checkout Rate"]||"0%",checkoutToPurchaseRate:P["Checkout To Purchase Rate"]||"0%"})),[d]);r.useEffect(()=>{s&&x(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,x]);const j=r.useCallback(async()=>{h(!0);try{const w=await p.post(`/api/analytics/dayAtcReport/${v}`,{startDate:y,endDate:S},{withCredentials:!0});if(w.data&&w.data.data){const P=w.data.data||[];u(P)}}catch(w){console.error("Error fetching daywise metrics data:",w)}finally{h(!1)}},[y,S,v]);return r.useEffect(()=>{y&&S&&j()},[y,S,v]),r.useEffect(()=>{if(!y||!S)return;const w=setInterval(()=>{j()},15*60*1e3);return()=>clearInterval(w)},[y,S,v]),r.useEffect(()=>{l>0&&y&&S&&j()},[l,y,S,v]),m?e.jsx(Ae,{isLoading:m}):e.jsx(dr,{rows:N,initialPageSize:"50",visibleColumns:a,columnOrder:t})};function Zs(){return e.jsx("div",{className:"min-h-screen bg-slate-50 p-6 overflow-hidden relative  flex justify-center items-center",children:e.jsxs("div",{className:"max-w-3xl mx-auto relative",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-4 bg-amber-100 px-4 py-2 rounded-full",children:[e.jsx(ao,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"text-amber-700 font-semibold text-sm",children:"Action Required"})]}),e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-slate-800 mb-3",children:["Date Range ",e.jsx("span",{className:"text-amber-500",children:"Missing"})]}),e.jsx("p",{className:"text-slate-600 max-w-xl mx-auto",children:"Please select a date range to continue. We need this information to display your data correctly."})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md border-l-4 border-amber-400 overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-5 w-5 text-slate-500"}),e.jsx("h3",{className:"font-medium text-slate-700",children:"Select Dates"})]}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(fa,{className:"h-3 w-3"}),e.jsx("span",{children:"Last 24 months available"})]})]}),e.jsx(Le,{})]})})})})]})})}function ht({platform:s,message:a,icon:t=e.jsx(no,{className:"w-8 h-8 text-red-600"}),loginOptions:l}){const o=V(d=>d.user.user),i="https://parallels.messold.com",c=async(d,u)=>{try{let m;if(d==="google"){m=await ne.get(`${i}/api/auth/google${u?`?context=${u}`:""}&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});const{authUrl:h}=m.data;window.location.href=h}else d==="facebook"&&(m=await ne.get(`${i}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),m.data.success&&(window.location.href=m.data.authURL))}catch(m){console.error(`Error getting ${d} Auth URL:`,m)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:t}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Hey there!"}),e.jsx("p",{className:"text-gray-600",children:a})]}),(o==null?void 0:o.email)&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(js,{className:"w-5 h-5 text-amber-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Currently signed in as:"}),e.jsx("p",{className:"font-medium text-gray-900",children:o.email})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Just a quick update to your ",s," token is needed to continue."]}),l.map((d,u)=>e.jsxs("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 group",onClick:()=>c(d.provider,d.context),children:[d.label,e.jsx(Ss,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]},u))]})]})})}const Wo=un,Ho=hn,Cm=xn,qo=r.forwardRef(({className:s,...a},t)=>e.jsx(ma,{className:Q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));qo.displayName=ma.displayName;const Sm=$t("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),mr=r.forwardRef(({side:s="right",className:a,children:t,...l},o)=>e.jsxs(Cm,{children:[e.jsx(qo,{}),e.jsxs(ua,{ref:o,className:Q(Sm({side:s}),a),...l,children:[e.jsxs(Ha,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}));mr.displayName=ua.displayName;const ur=({className:s,...a})=>e.jsx("div",{className:Q("flex flex-col space-y-2 text-center sm:text-left",s),...a});ur.displayName="SheetHeader";const hr=r.forwardRef(({className:s,...a},t)=>e.jsx(ha,{ref:t,className:Q("text-lg font-semibold text-foreground",s),...a}));hr.displayName=ha.displayName;const xr=r.forwardRef(({className:s,...a},t)=>e.jsx(xa,{ref:t,className:Q("text-sm text-muted-foreground",s),...a}));xr.displayName=xa.displayName;const gr=({visibleColumns:s,columnOrder:a,availableColumns:t,frozenColumns:l=[],onVisibilityChange:o,onOrderChange:i,onFrozenChange:c,viewPresets:d=[],showViewPresets:u=!1,activeViewPreset:m=null})=>{const[h,v]=r.useState(""),[y,S]=r.useState(null),[x,p]=r.useState(null),j=(t?a.filter(A=>t.includes(A)):a).filter(A=>A.toLowerCase().includes(h.toLowerCase())),w=A=>{S(A)},P=(A,C)=>{A.preventDefault(),C!==y&&p(C)},g=A=>{if(!y||y===A)return;console.log("Drop event:",{draggedColumn:y,targetColumn:A}),console.log("Current columnOrder:",a);const C=[...a],_=C.indexOf(y),I=C.indexOf(A);if(console.log("Indices:",{draggedIdx:_,targetIdx:I}),_===-1||I===-1){console.log("Invalid indices found");return}C.splice(_,1),C.splice(I,0,y),console.log("New order:",C),i(C),S(null),p(null)},$=A=>{const C=s.includes(A)?s.filter(_=>_!==A):[...s,A];o(C)},F=A=>{if(!c||A==="Campaign")return;const C=l.includes(A)?l.filter(_=>_!==A):[...l,A];c(C)};return e.jsxs(Wo,{children:[e.jsx(Ho,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"icon",className:"ml-2",children:e.jsx(gi,{className:"w-4 h-4"})})}),e.jsxs(mr,{className:"w-[400px] sm:w-[540px]",children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Column Management"}),e.jsx(xr,{children:"Select columns to display, drag to reorder, and pin columns to freeze them"})]}),u&&d.length>0&&e.jsxs("div",{className:"space-y-4 my-4",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Quick Views"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((A,C)=>e.jsx(z,{variant:"outline",size:"sm",onClick:()=>o(A.columns),className:`text-xs ${m===A.label?"bg-blue-50 border-blue-600 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:A.label},C))})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-1",children:[e.jsx(Cs,{className:"w-4 h-4 text-slate-400"}),e.jsx(ve,{placeholder:"Search columns...",value:h,onChange:A=>v(A.target.value),className:"h-8"})]}),e.jsx("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:j.map(A=>e.jsxs("div",{draggable:!0,onDragStart:()=>w(A),onDragOver:C=>P(C,A),onDrop:()=>g(A),onDragEnd:()=>{S(null),p(null)},className:`flex items-center space-x-3 p-3 border-b border-slate-200 hover:bg-slate-50 cursor-move transition-colors
                  ${y===A?"opacity-50":""}
                  ${x===A?"bg-blue-50 border-blue-200":""}`,children:[e.jsx(fi,{className:"w-4 h-4 text-slate-400"}),e.jsx(rt,{id:`col-${A}`,checked:s.includes(A),onCheckedChange:()=>$(A)}),e.jsx("label",{htmlFor:`col-${A}`,className:"flex-1 text-sm font-medium leading-none cursor-pointer",children:A}),c&&e.jsx(z,{variant:"ghost",size:"sm",className:`px-2 ${A==="Campaign"?"opacity-50 cursor-not-allowed":""}`,onClick:()=>F(A),disabled:A==="Campaign",children:l.includes(A)||A==="Campaign"?e.jsx(pi,{className:"w-4 h-4 text-blue-500"}):e.jsx(bi,{className:"w-4 h-4"})})]},A))})]})]})]})},km=({dateRange:s,visibleColumns:a,columnOrder:t,refreshTrigger:l})=>{const o=V(k=>k.date.from),i=V(k=>k.date.to),c=V(k=>k.date.compareFrom),d=V(k=>k.date.compareTo),[u,m]=r.useState([]),[h,v]=r.useState([]),[y,S]=r.useState([]),[x,p]=r.useState([]),[N,j]=r.useState([]),[w,P]=r.useState(!1),[g,$]=r.useState({ecommerce:!1,aov:!1,paymentOrders:!1,productsLaunched:!1,returningCustomerPercentage:!1}),{brandId:F}=ge(),A=r.useMemo(()=>({from:o,to:i}),[o,i]),C=r.useMemo(()=>({from:c,to:d}),[c,d]),_=A!=null&&A.from?Y(new Date(A.from),"yyyy-MM-dd"):"",I=A!=null&&A.to?Y(new Date(A.to),"yyyy-MM-dd"):"",B=C!=null&&C.from?Y(new Date(C.from),"yyyy-MM-dd"):"",O=C!=null&&C.to?Y(new Date(C.to),"yyyy-MM-dd"):"",E=Me(),M=Ce(),R=r.useMemo(()=>{if(g.ecommerce&&u.length===0)return[];const k=new Map,f=new Map;console.log("AOV Data for mapping:",h),h.forEach(D=>{let W="";if(D.monthName&&(W=D.monthName,k.set(W,D.aov||0),f.set(W,D.averageItemsPerOrder||0),console.log(`Mapped AOV: ${D.monthName} = ${D.aov}, Avg Items = ${D.averageItemsPerOrder}`)),D.month){const q=new Date(D.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-");W=q,k.set(W,D.aov||0),f.set(W,D.averageItemsPerOrder||0),console.log(`Mapped AOV from month: ${D.month} -> ${q} = ${D.aov}, Avg Items = ${D.averageItemsPerOrder}`)}});const n=new Map,b=new Map;console.log("Payment Orders Data for mapping:",y),y.forEach(D=>{let W="";if(D.monthName&&(W=D.monthName,n.set(W,D.codOrderCount||0),b.set(W,D.prepaidOrderCount||0),console.log(`Mapped Payment Orders: ${D.monthName} = COD: ${D.codOrderCount}, Prepaid: ${D.prepaidOrderCount}`)),D.month){const q=new Date(D.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-");W=q,n.set(W,D.codOrderCount||0),b.set(W,D.prepaidOrderCount||0),console.log(`Mapped Payment Orders from month: ${D.month} -> ${q} = COD: ${D.codOrderCount}, Prepaid: ${D.prepaidOrderCount}`)}});const T=new Map;console.log("Products Launched Data for mapping:",x),x.forEach(D=>{let W="";if(D.monthName&&(W=D.monthName,T.set(W,D.productsLaunched||0),console.log(`Mapped Products Launched: ${D.monthName} = ${D.productsLaunched}`)),D.month){const q=new Date(D.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-");W=q,T.set(W,D.productsLaunched||0),console.log(`Mapped Products Launched from month: ${D.month} -> ${q} = ${D.productsLaunched}`)}});const U=new Map;return console.log("Returned Customers Data for mapping:",N),N.forEach(D=>{let W="";if(D.monthName&&(W=D.monthName,U.set(W,D.returningCustomerPercentage||0),console.log(`Mapped Returned Customers: ${D.monthName} = ${D.returningCustomerPercentage}`)),D.month){const q=new Date(D.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-");W=q,U.set(W,D.returningCustomerPercentage||0),console.log(`Mapped Returned Customers from month: ${D.month} -> ${q} = ${D.returningCustomerPercentage}`)}}),console.log("Ecommerce Data months:",u.map(D=>D.Month)),console.log("AOV Map keys:",Array.from(k.keys())),console.log("Payment Orders Map keys:",Array.from(n.keys())),u.map((D,W)=>{const K=D.Month,q=g.aov?void 0:k.get(K)??0,ee=g.aov?void 0:f.get(K)??0,J=g.paymentOrders?void 0:n.get(K)??0,ae=g.paymentOrders?void 0:b.get(K)??0,pe=g.productsLaunched?void 0:T.get(K)??0,G=g.returningCustomerPercentage?void 0:U.get(K)??0;return typeof q=="number"&&q>0&&console.log(`Matched AOV for ${K}: ${q}, Avg Items: ${ee}`),(typeof J=="number"&&J>0||typeof ae=="number"&&ae>0)&&console.log(`Matched Payment Orders for ${K}: COD: ${J}, Prepaid: ${ae}`),typeof pe=="number"&&pe>0&&console.log(`Matched Products Launched for ${K}: ${pe}`),typeof G=="number"&&G>0&&console.log(`Matched Returned Customers for ${K}: ${G}`),{id:`row-${W}`,month:D.Month,sessions:parseInt(D.Sessions)||0,addToCart:parseInt(D["Add To Cart"])||0,addToCartRate:D["Add To Cart Rate"]||"0%",checkouts:parseInt(D.Checkouts)||0,checkoutRate:D["Checkout Rate"]||"0%",purchases:parseInt(D.Purchases)||0,purchaseRate:D["Purchase Rate"]||"0%",aov:q,averageItemsPerOrder:ee,codOrderCount:J,prepaidOrderCount:ae,productsLaunched:pe,returningCustomerPercentage:G,atcToCheckoutRate:D["ATC To Checkout Rate"]||"0%",checkoutToPurchaseRate:D["Checkout To Purchase Rate"]||"0%"}})},[u,h,y,g]);r.useEffect(()=>{s&&E(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,E]);const L=r.useCallback(async()=>{var k;P(!0);try{const f=[];_&&I&&f.push({startDate:_,endDate:I}),B&&O&&f.push({startDate:B,endDate:O});const n=[];f.length>0&&n.push(M.post(`/api/analytics/monthAtcReport/${F}`,{dateRanges:f},{withCredentials:!0})),_&&I&&n.push(M.post(`/api/shopify/aov/${F}`,{startDate:_,endDate:I},{withCredentials:!0})),_&&I&&n.push(M.post(`/api/shopify/payment-orders/${F}`,{startDate:_,endDate:I},{withCredentials:!0})),_&&I&&n.push(M.post(`/api/product/monthly-launched-products/${F}`,{startDate:_,endDate:I},{withCredentials:!0})),_&&I&&n.push(M.post(`/api/shopify/monthly-returned-customers/${F}`,{startDate:_,endDate:I},{withCredentials:!0}));const b=await Promise.allSettled(n);if(console.log("Returning Customer ------->:",b[4]),$({ecommerce:!1,aov:!1,paymentOrders:!1,productsLaunched:!1,returningCustomerPercentage:!1}),b[0])if(b[0].status==="fulfilled"){const U=b[0].value.data.ranges||[];if(U.length>0){const D=U[0].Date;m(D?U:((k=U[0])==null?void 0:k.data)||[])}else m([])}else console.error("Ecommerce metrics API failed:",b[0].reason),$(T=>({...T,ecommerce:!0})),m([]);if(b[1])if(b[1].status==="fulfilled"){const T=b[1].value;console.log("AOV API Response:",T.data),T.data.success&&T.data.data?(console.log("AOV Data:",T.data.data),v(T.data.data)):(console.warn("AOV data not in expected format:",T.data),v([]))}else console.error("AOV API failed:",b[1].reason),$(T=>({...T,aov:!0})),v([]);if(b[2])if(b[2].status==="fulfilled"){const T=b[2].value;console.log("Payment Orders API Response:",T.data),T.data.success&&T.data.data?(console.log("Payment Orders Data:",T.data.data),S(T.data.data)):(console.warn("Payment orders data not in expected format:",T.data),S([]))}else console.error("Payment Orders API failed:",b[2].reason),$(T=>({...T,paymentOrders:!0})),S([]);if(b[3])if(b[3].status==="fulfilled"){const T=b[3].value;console.log("Products Launched API Response:",T.data),T.data.success&&T.data.data&&(console.log("Products Launched Data:",T.data.data),p(T.data.data))}else console.error("Products Launched API failed:",b[3].reason),$(T=>({...T,productsLaunched:!0})),p([]);if(b[4])if(b[4].status==="fulfilled"){const T=b[4].value;console.log("Returned Customers API Response:",T.data),T.data.success&&T.data.data&&(console.log("Returned Customers Data:",T.data.data),j(T.data.data))}else console.error("Returned Customers API failed:",b[4].reason),$(T=>({...T,returnedCustomers:!0})),j([])}catch(f){console.error("Error in fetchMetrics:",f),$({ecommerce:!0,aov:!0,paymentOrders:!0,productsLaunched:!0,returningCustomerPercentage:!0})}finally{P(!1)}},[_,I,B,O,F]);return r.useEffect(()=>{_&&I&&L()},[_,I,F]),r.useEffect(()=>{if(!_||!I)return;const k=setInterval(()=>{L()},15*60*1e3);return()=>clearInterval(k)},[_,I,F]),r.useEffect(()=>{l>0&&_&&I&&L()},[l,_,I,F]),w?e.jsx(Ae,{isLoading:w}):e.jsx(dr,{rows:R,initialPageSize:"50",visibleColumns:a,columnOrder:t})},Am=()=>{const{brandId:a}=ge(),l=V(f=>f.brand.brands).find(f=>f._id===a),o=(l==null?void 0:l.ga4Account)??!1,i=V(f=>f.date.from),c=V(f=>f.date.to),d=V(Td),u=r.useMemo(()=>({from:i,to:c}),[i,c]),m=r.useMemo(()=>({from:u.from?new Date(u.from):void 0,to:u.to?new Date(u.to):void 0}),[u.from,u.to]),[h,v]=r.useState("month wise"),[y,S]=r.useState(!1),x=r.useMemo(()=>m,[m.from,m.to]),p=["Sessions","Add To Cart","Add To Cart Rate","Checkouts","Checkout Rate","Purchases","Purchase Rate","ATC To Checkout Rate","Checkout To Purchase Rate"],N=r.useCallback(f=>f==="month wise"?[...p,"AOV","Avg Items/Order","COD Orders","Prepaid Orders","Products Launched","Returned Customers"]:p,[]),j=r.useMemo(()=>["Date","Month","Day",...N(h)],[h,N]),[w,P]=r.useState(["Date",...p]),[g,$]=r.useState(["Date",...p]),[F,A]=r.useState(null),C=f=>{const n=f==="month wise"?"Month":f==="day wise"?"Day":"Date";return[{label:"Counts View",columns:[n,"Sessions","Add To Cart","Checkouts","Purchases"]},{label:"Rates View",columns:[n,"Sessions","Add To Cart Rate","Checkout Rate","Purchase Rate","ATC To Checkout Rate","Checkout To Purchase Rate"]}]};r.useEffect(()=>{const f=h==="month wise"?"Month":h==="day wise"?"Day":"Date",n=N(h),b=[f,...n],T=[f,...n],U=JSON.stringify(w),D=JSON.stringify(b);U!==D&&(P(b),$(T))},[h,N]);const[_,I]=r.useState(0),B=[{label:"Monthly Metrics",value:"month wise"},{label:"Daily Metrics",value:"daily"},{label:"Day wise Metrics",value:"day wise"}],O=f=>{v(f)},E=()=>{S(!y)},M=()=>{I(f=>f+1)},R=f=>{P(f);const b=C(h).find(T=>JSON.stringify(T.columns)===JSON.stringify(f));A(b?b.label:null)},L=f=>{$(f)},k=Me();return r.useEffect(()=>{o&&d&&k(Eo())},[o]),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:d?e.jsx(ht,{platform:"Google Analytics",message:"We need access to your Google Analytics account to show you amazing insights about your website performance.",icon:e.jsx(Ja,{className:"w-8 h-8 text-blue-600"}),loginOptions:[{label:"Connect Google Analytics",context:"googleAnalyticsSetup",provider:"google"}]}):o?!m.from||!m.to?e.jsx(Zs,{}):e.jsx("div",{className:"p-3",children:e.jsx(ue,{className:`${y?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(he,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("div",{className:"flex items-start gap-6",children:e.jsx("div",{className:"flex flex-row bg-gray-100 p-1.5 rounded-2xl",children:B.map(f=>e.jsx("button",{onClick:()=>O(f.value),className:`px-6 py-1 rounded-2xl text-sm font-medium transition-all duration-200 last:mb-0 ${h===f.value?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:f.label},f.value))})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(Le,{}),e.jsx(z,{onClick:M,disabled:!1,size:"icon",variant:"outline",children:e.jsx($e,{className:"h-4 w-4 "})}),e.jsx(gr,{visibleColumns:w,columnOrder:g,availableColumns:j,onVisibilityChange:R,onOrderChange:L,viewPresets:C(h),showViewPresets:!0,activeViewPreset:F}),e.jsx(z,{onClick:E,size:"icon",variant:"outline",children:y?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]}),e.jsxs("section",{className:"w-full",children:[h==="daily"&&e.jsx(vm,{dateRange:x,visibleColumns:w,columnOrder:g,refreshTrigger:_},"daily-metrics"),h==="day wise"&&e.jsx(wm,{dateRange:x,visibleColumns:w,columnOrder:g,refreshTrigger:_},"daywise-metrics"),h==="month wise"&&e.jsx(km,{dateRange:x,visibleColumns:w,columnOrder:g,refreshTrigger:_},"monthly-metrics")]})]})})})}):e.jsx(e.Fragment,{children:e.jsx(Pt,{platform:"google analytics",brandId:a??"",onSuccess:(f,n,b)=>{console.log(`Successfully connected ${f} account: ${n} (${b})`)}})})}),e.jsx(Ps,{})]})},Yo=r.createContext({tokenError:!1,setTokenError:()=>{}}),Mm=({children:s})=>{const[a,t]=r.useState(!1);return e.jsx(Yo.Provider,{value:{tokenError:a,setTokenError:t},children:s})},Ko=()=>r.useContext(Yo);function Tm(s,a,t){return t!=null?Math.min(Math.max(s,a),t):Math.max(s,a)}function qe({data:s,primaryColumn:a,secondaryColumns:t,monthlyDataKey:l,isFullScreen:o,locale:i,filter:c}){const[d,u]=r.useState(1),[m,h]=r.useState(50),[v,y]=r.useState([]),S=r.useRef(null),[x,p]=r.useState(null),N=()=>{if(!Array.isArray(s))return[];const k=n=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Number.parseInt(n)-1],f=new Set;return s.forEach(n=>{const b=n[l];Array.isArray(b)&&b.forEach(T=>{if(T!=null&&T.Month){const U=T.Month.slice(0,4),D=T.Month.slice(4);f.add(`${k(D)}-${U}`)}})}),Array.from(f).sort((n,b)=>{const[T,U]=n.split("-"),[D,W]=b.split("-"),K=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],q=K.indexOf(T),ee=K.indexOf(D);return U!==W?parseInt(W)-parseInt(U):ee-q})},j=r.useMemo(()=>{const k=[{key:a,header:a,width:130,minWidth:100,maxWidth:300,align:"left"}];return t&&t.forEach(n=>{k.push({key:n,header:n,width:130,minWidth:100,maxWidth:200,align:"right"})}),N().forEach(n=>{k.push({key:n,header:n,width:120,minWidth:100,maxWidth:150,align:"right"})}),k},[a,t,l,s]);r.useEffect(()=>{y(j.map(k=>k.width))},[j]);const w=r.useMemo(()=>j.map((k,f)=>v[f]||k.width),[j,v]);r.useEffect(()=>{const k=n=>{const b=S.current;if(!b)return;const T=n.clientX-b.startX,U=j[b.index];y(D=>{const W=[...D];return W[b.index]=Tm(b.startWidth+T,U.minWidth??80,U.maxWidth),W})},f=()=>{S.current=null,p(null),document.body.style.cursor="",document.body.classList.remove("select-none")};return window.addEventListener("pointermove",k),window.addEventListener("pointerup",f),()=>{window.removeEventListener("pointermove",k),window.removeEventListener("pointerup",f)}},[j]);const P=(k,f)=>{S.current={index:f,startX:k.clientX,startWidth:v[f]},p(f),document.body.style.cursor="col-resize",document.body.classList.add("select-none"),k.currentTarget.setPointerCapture(k.pointerId)},g=r.useMemo(()=>c===void 0?s:c.length===0?[]:s.filter(k=>{const f=String(k[a]);return c.includes(f)}),[s,c,a]),$=r.useMemo(()=>N(),[s,l]),F=r.useMemo(()=>{let k=0,f=0,n=0,b=0,T=0;return s.forEach(U=>{const D=U[l];Array.isArray(D)&&D.forEach(W=>{typeof W.Sessions=="number"&&typeof W["Conv. Rate"]=="number"&&(k+=Number(W.Sessions),f+=Number(W["Conv. Rate"]),n++),typeof W.Cost=="number"&&typeof W["Conv. Value/ Cost"]=="number"&&(b+=Number(W.Cost),T+=Number(W["Conv. Value/ Cost"]),n++)})}),{avgSessions:n>0?k/n:0,avgConvRate:n>0?f/n:0,totalCostG:n>0?b/n:0,totalConvValueCostG:n>0?T/n:0}},[s,l]);r.useEffect(()=>{u(1)},[c]),r.useEffect(()=>{u(1)},[m]);const A=k=>{const f=k==="all"?g.length:parseInt(k);h(f)},C=(k,f)=>{if(typeof k=="number")switch(f){case"spend":return Math.round(k).toLocaleString(i);case"percentage":return`${Number.parseFloat(k.toLocaleString(i)).toFixed(2)}%`;case"sessions":return Math.round(k).toLocaleString(i);default:return k.toLocaleString(i,{minimumFractionDigits:2,maximumFractionDigits:2})}return k},_=k=>{if(!k)return e.jsxs("td",{className:"text-right whitespace-nowrap p-3 text-sm border-r border-b border-gray-200 bg-transparent",children:[e.jsx("div",{className:"truncate",children:""}),e.jsx("div",{className:"truncate",children:""})]});const f=k.Sessions,n=k["Conv. Rate"],b=k.Cost,T=k.Clicks,U=k["Conv. Value/ Cost"],D=k["Bounce Rate"],W=k["Engagement Rate"];return e.jsx("td",{className:"text-right whitespace-nowrap p-3 text-sm border-r border-b border-gray-200 bg-transparent",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",children:C(f,"sessions")}),b!==void 0&&e.jsx("div",{className:"text-xs truncate",children:Math.round(+b)}),T!==void 0&&e.jsxs("div",{className:"text-xs truncate",children:["Clicks: ",T]}),U!==void 0&&e.jsxs("div",{className:"text-xs truncate",children:["Conv.rate: ",U.toLocaleString(i)]}),U!==void 0&&e.jsxs("div",{className:"text-xs truncate",children:[" ",C(n,"percentage")]}),e.jsx("div",{className:"text-xs truncate",children:C(n,"percentage")}),e.jsxs("div",{className:"text-xs truncate",children:["Bounce Rate: ",C(D,"percentage")]}),W!==void 0&&e.jsxs("div",{className:"text-xs truncate",children:["Engagement Rate: ",W.toLocaleString(i)]})]})})},I=(k,f,n)=>{console.log("column====> =",f,k[f]);const b=k[f],T=W=>W===0?0:W===1?w[0]:W===2?w[0]+w[1]:0;if(typeof b!="number")return e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"}`,style:n<3?{left:`${T(n)}px`}:{},children:""});const U=typeof k["Total Purchases"]=="number"?k["Total Purchases"].toLocaleString(i):null,D=typeof k["Total Conv. Value"]=="number"?k["Total Conv. Value"].toLocaleString(i):null;return f.includes("Sessions")?e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium truncate",children:C(b,"sessions")})})}):f.includes("Rate")||f.includes("Value")?e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium truncate",children:C(b,"percentage")}),U&&e.jsxs("div",{className:"text-xs mt-1 truncate",children:["Total Purchases: ",U]}),D&&e.jsxs("div",{className:"text-xs mt-1 truncate",children:["Total Conv Value: ",D]})]})}):e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsx("div",{className:"text-right font-medium truncate",children:C(b)})})},B=(k,f)=>e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-150 group",children:[e.jsx("td",{className:"sticky left-0 min-w-[130px] max-w-[200px] p-3 text-sm font-medium z-10 bg-white group-hover:bg-blue-50 border-r border-b border-gray-200",children:e.jsx("div",{className:"truncate",children:typeof k[a]=="string"||typeof k[a]=="number"?C(k[a]):""})}),t==null?void 0:t.map((n,b)=>{const T=b+1;return e.jsx(Se.Fragment,{children:I(k,n,T)},n)}),$.map(n=>{const b=q=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(q)+1,[T,U]=n.split("-"),D=b(T),W=`${U}${D.toString().padStart(2,"0")}`,K=k[l].find(q=>q.Month===W);return e.jsx(Se.Fragment,{children:_(K)},n)})]},`${k[a]}-${f}`),O=r.useMemo(()=>o?g:g.slice((d-1)*m,d*m),[o,g,d,m]),E=g.length,M=Math.ceil(E/m),R=k=>{const f=Math.max(1,Math.min(k,M));u(f)},L=(k,f)=>{let n="";k==="Total Sessions"?n=`(avg: ${Math.round(F.avgSessions).toLocaleString()})`:k==="Avg Conv. Rate"?n=`(avg: ${F.avgConvRate.toFixed(2)}%)`:k==="Total Cost"?n=`(avg: ${Math.round(F.totalCostG).toLocaleString()})`:k==="Conv. Value / Cost"&&(n=`(avg: ${F.totalConvValueCostG.toFixed(2)})`);const b=f<3,T=x===f,U=D=>D===0?0:D===1?w[0]:D===2?w[0]+w[1]:0;return e.jsxs("th",{className:`sticky top-0 z-10 px-3 py-3 text-right text-sm font-medium bg-gray-100 border-r border-b border-gray-200 ${b?`z-20 ${f===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`:""} ${T?"border-blue-500":""}`,style:b?{left:`${U(f)}px`}:{},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"truncate",children:k}),n&&e.jsx("span",{className:"text-xs font-normal mt-0.5 truncate",children:n})]}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${k} column`,onPointerDown:D=>P(D,f),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${T?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${T?"bg-blue-500":"bg-gray-200"}`})})]},k)};return e.jsxs("div",{className:"w-full overflow-hidden flex flex-col",children:[e.jsx("div",{className:`relative overflow-x-auto ${o?"max-h-[calc(100vh-80px)]":""} max-h-[100vh]`,children:e.jsxs("table",{className:"w-full table-fixed border border-gray-200",children:[e.jsx("colgroup",{children:w.map((k,f)=>{var n;return e.jsx("col",{style:{width:k}},String(((n=j[f])==null?void 0:n.key)||`col-${f}`))})}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sticky left-0 top-0 min-w-[130px] z-30 px-3 py-3 text-left text-sm font-medium bg-gray-100 border-r border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:a}),c&&c.length>0&&e.jsx("span",{className:"text-xs px-2 py-1 rounded",children:"Filtered"})]}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${a} column`,onPointerDown:k=>P(k,0),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${x===0?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${x===0?"bg-blue-500":"bg-gray-200"}`})})]}),t==null?void 0:t.map((k,f)=>{const n=f+1;return L(k,n)}),$.map((k,f)=>{const n=1+((t==null?void 0:t.length)||0)+f,b=x===n;return e.jsxs("th",{className:`sticky top-0 min-w-[120px] z-10 px-3 py-3 text-right text-sm font-medium whitespace-nowrap bg-gray-100 border-r border-b border-gray-200 ${b?"border-blue-500":""}`,children:[e.jsx("div",{className:"truncate",children:k}),e.jsx("div",{className:"text-xs mt-1 truncate",children:a==="All Page"?"Bounce Rate":"Sessions / (Conv, Bounce) Rate"}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${k} column`,onPointerDown:T=>P(T,n),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${b?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${b?"bg-blue-500":"bg-gray-200"}`})})]},k)})]})}),e.jsx("tbody",{children:O.length>0?O.map((k,f)=>B(k,f)):e.jsx("tr",{children:e.jsx("td",{colSpan:1+((t==null?void 0:t.length)||0)+$.length,className:"p-4 text-center border-b border-gray-200",children:c!==void 0&&g.length===0?e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsx("span",{className:"text-lg font-medium text-gray-700",children:"Oops! No data available for this category"})}):"No data to display"})})})]})}),!o&&e.jsxs("div",{className:"px-3 py-2.5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-sm",children:E>0?e.jsxs(e.Fragment,{children:["Showing ",(d-1)*m+1,"-",Math.min(d*m,E)," of"," ",E," rows",c!==void 0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filtered from ",s.length," total rows)"]}):null]}):e.jsxs(e.Fragment,{children:["No rows to display",c!==void 0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filter: ",(c==null?void 0:c.join(", "))||"Unknown",") | Total rows: ",s.length]}):null]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Rows per page:"}),e.jsxs(We,{value:m===g.length?"all":m.toString(),onValueChange:A,children:[e.jsx(Be,{className:"w-20 h-8",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"50",children:"50"}),e.jsx(ie,{value:"100",children:"100"}),e.jsx(ie,{value:"200",children:"200"}),e.jsx(ie,{value:"all",children:"All"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex bg-transparent",onClick:()=>R(1),disabled:d===1,children:e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0 bg-transparent",onClick:()=>R(d-1),disabled:d===1,children:e.jsx(us,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium px-2",children:["Page ",d," of ",M]}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0 bg-transparent",onClick:()=>R(d+1),disabled:d===M,children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex bg-transparent",onClick:()=>R(M),disabled:d===M,children:e.jsx(Xa,{className:"h-4 w-4"})})]})]})]})}const $m=({dateRange:s,refreshTrigger:a,onDataUpdate:t,currentFilter:l,isFullScreen:o})=>{const i=V(I=>I.date.from),c=V(I=>I.date.to),d=r.useMemo(()=>({from:i,to:c}),[i,c]),u=Me(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=V(I=>I.locale.locale),x=V(I=>I.user.user,St),{brandId:p}=ge(),N=d!=null&&d.from?Y(d.from,"yyyy-MM-dd"):"",j=d!=null&&d.to?Y(d.to,"yyyy-MM-dd"):"",w=Ce(),P="google-ads-search-term",g=V(I=>I.conversionFilters[P]||{},St),$=r.useMemo(()=>Object.entries(g).reduce((I,[B,O])=>{if(O){const E={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[B]||B;I[E]=O}return I},{}),[g]),F=r.useCallback(async()=>{var I;y(!0);try{const B=await w.post(`/api/google/searchTerm/${p}`,{userId:x==null?void 0:x.id,startDate:N,endDate:j,...$});h({reportType:"Search Term",data:((I=B.data)==null?void 0:I.data)||[]})}catch(B){console.error("Error fetching data:",B)}finally{y(!1)}},[p,N,j,x==null?void 0:x.id,$]);r.useEffect(()=>{F();const I=setInterval(F,15*60*1e3);return()=>clearInterval(I)},[F,a]),r.useEffect(()=>{s&&u(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,u]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"searchTerm")},[m==null?void 0:m.data,t]);const A="Search Term",C=["Total Cost","Conv. Value / Cost"],_="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):(console.log("apiResponse",m==null?void 0:m.data),e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:o,locale:S,filter:l})})}))},Fm=({dateRange:s,refreshTrigger:a,currentFilter:t,onDataUpdate:l,isFullScreen:o})=>{var B,O;const i=V(E=>E.date.from),c=V(E=>E.date.to),d=r.useMemo(()=>({from:i,to:c}),[i,c]),[u,m]=r.useState(null),[h,v]=r.useState(!0),y=V(E=>E.locale.locale),S=Me(),x=V(Ca);console.log(x);const p=V(E=>E.user.user,St),{brandId:N}=ge(),j=d!=null&&d.from?Y(d.from,"yyyy-MM-dd"):"",w=d!=null&&d.to?Y(d.to,"yyyy-MM-dd"):"",P=Ce(),g="google-ads-age",$=V(E=>E.conversionFilters[g]||{},St),F=r.useMemo(()=>Object.entries($).reduce((E,[M,R])=>{if(R){const L={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[M]||M;E[L]=R}return E},{}),[$]),A=r.useCallback(async()=>{var E;v(!0);try{const M=await P.post(`/api/google/age/${N}`,{userId:p==null?void 0:p.id,startDate:j,endDate:w,...F},{withCredentials:!0});m({reportType:"Age",data:((E=M.data)==null?void 0:E.data)||[]})}catch(M){console.error("Error fetching data:",M)}finally{v(!1)}},[N,j,w,F,p==null?void 0:p.id]);r.useEffect(()=>{A();const E=setInterval(A,15*60*1e3);return()=>clearInterval(E)},[A,a]),r.useEffect(()=>{s&&S(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),r.useEffect(()=>{var E;u!=null&&u.data&&l&&l((E=u.data[0])==null?void 0:E.ageRanges,"age")},[u==null?void 0:u.data,l]);const C="Age Range",_="MonthlyData",I=["Total Cost","Conv. Value / Cost"];return console.log("apiResponse",(B=u==null?void 0:u.data[0])==null?void 0:B.ageRanges),h?e.jsx(Ae,{isLoading:h}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:((O=u==null?void 0:u.data[0])==null?void 0:O.ageRanges)||[],primaryColumn:C,secondaryColumns:I,monthlyDataKey:_,isFullScreen:o,locale:y,filter:t})})})},_m=({dateRange:s,isFullScreen:a})=>{const t=V(C=>C.date.from),l=V(C=>C.date.to),o=r.useMemo(()=>({from:t,to:l}),[t,l]),[i,c]=r.useState(null),[d,u]=r.useState(!0),m=Me(),h=V(C=>C.user.user),{brandId:v}=ge(),y=o!=null&&o.from?Y(o.from,"yyyy-MM-dd"):"",S=o!=null&&o.to?Y(o.to,"yyyy-MM-dd"):"",x=Ce(),p="google-ads-gender",N=V(C=>C.conversionFilters[p]||{},St),j=r.useMemo(()=>Object.entries(N).reduce((C,[_,I])=>{if(I){const B={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[_]||_;C[B]=I}return C},{}),[N]),w=r.useCallback(async()=>{u(!0);try{const C=await x.post(`/api/google/gender/${v}`,{userId:h==null?void 0:h.id,startDate:y,endDate:S,...j},{withCredentials:!0});console.log("---->",C.data);const _=C.data||[];c(_)}catch(C){console.error("Error fetching data:",C)}finally{u(!1)}},[v,y,S,j,h==null?void 0:h.id]);r.useEffect(()=>{w();const C=setInterval(w,15*60*1e3);return()=>clearInterval(C)},[w]),r.useEffect(()=>{s&&m(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),r.useEffect(()=>{a||s&&m(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[a,s]);const P="Gender",g="MonthlyData",$=["Total Cost","Conv. Value / Cost"],F=V(C=>C.locale.locale),A=V(Ca);return console.log(A),e.jsxs(e.Fragment,{children:[A?e.jsx(ht,{platform:"Google Ads",message:"Looks like we need to refresh your Google Ads connection to optimize your campaigns.",icon:e.jsx(Is,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Google Ads",context:"googleAdSetup",provider:"google"}]}):d?e.jsx(Ae,{isLoading:d}):(i==null?void 0:i.data)&&i.data.map((C,_)=>e.jsx("div",{className:`${a?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(ue,{className:"mb-4",children:e.jsx(he,{children:C.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",C.error]}):C.genders.length===0?e.jsx("p",{className:"text-gray-500",children:"No gender data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:C.genders,primaryColumn:P,secondaryColumns:$,monthlyDataKey:g,isFullScreen:a,locale:F})})})},C.accountId)})),(i==null?void 0:i.data)&&i.data.length===0&&!d&&e.jsx(ue,{children:e.jsx(he,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No gender data available"})})})]})},Im=({dateRange:s,refreshTrigger:a,currentFilter:t,onDataUpdate:l,isFullScreen:o})=>{var B;const i=V(O=>O.date.from),c=V(O=>O.date.to),d=r.useMemo(()=>({from:i,to:c}),[i,c]),[u,m]=r.useState(null),[h,v]=r.useState(!0),y=Me(),S=V(O=>O.user.user),{brandId:x}=ge(),p=d!=null&&d.from?Y(d.from,"yyyy-MM-dd"):"",N=d!=null&&d.to?Y(d.to,"yyyy-MM-dd"):"",j=Ce(),w="google-ads-keyword",P=V(O=>O.conversionFilters[w]||{},St);r.useEffect(()=>{var O;u!=null&&u.data&&l&&l((O=u.data[0])==null?void 0:O.keywords,"keyword")},[u==null?void 0:u.data,l]);const g=r.useMemo(()=>Object.entries(P).reduce((O,[E,M])=>{if(M){const R={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[E]||E;O[R]=M}return O},{}),[P]),$=r.useCallback(async()=>{v(!0);try{const E=(await j.post(`/api/google/keyword/${x}`,{userId:S==null?void 0:S.id,startDate:p,endDate:N,...g},{withCredentials:!0})).data||[];m(E)}catch(O){console.error("Error fetching data:",O)}finally{v(!1)}},[x,p,N,g,S==null?void 0:S.id]);r.useEffect(()=>{$();const O=setInterval($,15*60*1e3);return()=>clearInterval(O)},[$,a]),r.useEffect(()=>{s&&y(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),r.useEffect(()=>{o||s&&y(es({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[o,s]);const F="Keyword",A="MonthlyData",C=["Total Cost","Conv. Value / Cost"],_=V(O=>O.locale.locale),I=V(Ca);return console.log(I),h?e.jsx(Ae,{isLoading:h}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:((B=u==null?void 0:u.data[0])==null?void 0:B.keywords)||[],primaryColumn:F,secondaryColumns:C,monthlyDataKey:A,isFullScreen:o,locale:_,filter:t})})})},Pm=({dateRange:s,refreshTrigger:a,currentFilter:t,onDataUpdate:l,isFullScreen:o})=>{var F,A;const[i,c]=r.useState(s),[d,u]=r.useState(null),[m,h]=r.useState(!0),v=V(C=>C.user.user),{brandId:y}=ge(),S=i!=null&&i.from?Y(i.from,"yyyy-MM-dd"):"",x=i!=null&&i.to?Y(i.to,"yyyy-MM-dd"):"",p=Ce(),N=r.useCallback(async()=>{h(!0);try{const _=(await p.post(`/api/google/product/${y}`,{userId:v==null?void 0:v.id,startDate:S,endDate:x},{withCredentials:!0})).data||[];u(_)}catch(C){console.error("Error fetching data:",C)}finally{h(!1)}},[y,S,x]);r.useEffect(()=>{N();const C=setInterval(N,15*60*1e3);return()=>clearInterval(C)},[N,a]),r.useEffect(()=>{c(s)},[s]),r.useEffect(()=>{var C;d!=null&&d.data&&l&&l((C=d.data[0])==null?void 0:C.products,"product")},[d==null?void 0:d.data,l]);const j="Product",w="MonthlyData",P=["Total Cost","Conv. Value / Cost"],g=V(C=>C.locale.locale),$=V(Ca);return console.log($),m?e.jsx(Ae,{isLoading:m}):(console.log("apiResponse",(F=d==null?void 0:d.data[0])==null?void 0:F.products),e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:((A=d==null?void 0:d.data[0])==null?void 0:A.products)||[],primaryColumn:j,secondaryColumns:P,monthlyDataKey:w,isFullScreen:o,locale:g,filter:t})})}))};function qt({tabs:s,activeTab:a,onTabChange:t,className:l,collapsible:o=!0,mobileBreakpoint:i=768}){const[c,d]=r.useState(!1),[u,m]=r.useState(!1),[h,v]=r.useState(!1);r.useEffect(()=>{const p=()=>{m(window.innerWidth<i),window.innerWidth<i&&d(!1)};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[i]);const y=()=>{d(!c)},S=()=>{v(!h)},x=p=>{t(p),u&&v(!1)};return u?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:S,className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-blue-600 text-white rounded-md shadow-lg hover:bg-blue-700 transition-colors",children:e.jsx(ys,{className:"w-5 h-5"})}),h&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:S}),e.jsxs("div",{className:Q("lg:hidden fixed left-0 top-0 h-full bg-white shadow-lg z-50 transition-transform duration-300 ease-in-out",h?"translate-x-0":"-translate-x-full"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reports"}),e.jsx("button",{onClick:S,className:"p-1 rounded-md hover:bg-gray-200 transition-colors",children:e.jsx(hs,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto w-64",children:s.map(p=>e.jsxs("button",{onClick:()=>x(p.value),className:Q("w-full flex items-center gap-3 px-4 py-3 text-left text-sm transition-all duration-200 border-l-4 hover:bg-gray-50",p.value===a?"bg-blue-50 border-blue-500 text-blue-700 font-medium shadow-sm":"border-transparent text-gray-700 hover:text-gray-900"),children:[p.icon&&e.jsx("span",{className:Q("flex-shrink-0",p.value===a?"text-blue-600":"text-gray-500"),children:p.icon}),e.jsx("span",{className:"truncate",children:p.label})]},p.value))})]})]}):e.jsxs("div",{className:Q("hidden lg:flex flex-col bg-white border-r border-gray-200 shadow-sm transition-all duration-300 ease-in-out",c?"w-16":"w-48",l),children:[e.jsxs("div",{className:Q("p-4 border-b border-gray-200 flex items-center justify-between bg-gray-50",c&&"justify-center"),children:[!c&&e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Reports"}),o&&e.jsx("button",{onClick:y,className:"p-1 rounded-md hover:bg-gray-200 transition-colors",title:c?"Expand sidebar":"Collapse sidebar",children:c?e.jsx(Je,{className:"w-4 h-4 text-gray-600"}):e.jsx(us,{className:"w-4 h-4 text-gray-600"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:s.map(p=>e.jsxs("button",{onClick:()=>x(p.value),className:Q("w-full flex items-center gap-3 px-4 py-3 text-left text-sm transition-all duration-200 border-l-4 hover:bg-gray-50 group",p.value===a?"bg-blue-50 border-blue-500 text-blue-700 font-medium shadow-sm":"border-transparent text-gray-700 hover:text-gray-900"),title:c?p.label:void 0,children:[p.icon&&e.jsx("span",{className:Q("flex-shrink-0 transition-colors duration-200",c&&"mx-auto",p.value===a?"text-blue-600":"text-gray-500 group-hover:text-gray-700"),children:p.icon}),!c&&e.jsx("span",{className:"truncate",children:p.label})]},p.value))})]})}const is=({data:s,primaryColumn:a,metricConfig:t,onCategoryFilter:l})=>{const[o,i]=r.useState(null),c=r.useMemo(()=>{const h={[t.primary.key]:0,[t.secondary.key]:0};let v=0;return s.forEach(y=>{const S=y.MonthlyData;Array.isArray(S)&&S.forEach(x=>{const p=t.primary.key==="Total Sessions"?"Sessions":t.primary.key==="Total Spend"?"Spend":t.primary.key==="Total Cost"?"Cost":t.primary.key,N=t.secondary.key==="Avg Conv. Rate"?"Conv. Rate":t.secondary.key==="Total Purchase ROAS"?"Purchase ROAS":t.secondary.key==="Conv. Value / Cost"?"Conv. Value/ Cost":t.secondary.key,j=x[p],w=x[N];typeof j=="number"&&typeof w=="number"&&(h[t.primary.key]+=Number(j),h[t.secondary.key]+=Number(w),v++)})}),{[t.primary.key]:v>0?h[t.primary.key]/v:0,[t.secondary.key]:v>0?h[t.secondary.key]/v:0}},[s,t]),d=r.useMemo(()=>{const h={"Top Performers":[],[`High ${t.primary.name}`]:[],[`High ${t.secondary.name}`]:[],"Under Performers":[]};return s.forEach(v=>{const y=Number(v[t.primary.key]),S=Number(v[t.secondary.key]),x=String(v[a]),p=y>=c[t.primary.key],N=S>=c[t.secondary.key];p&&N?h["Top Performers"].push(x):p&&!N?h[`High ${t.primary.name}`].push(x):!p&&N?h[`High ${t.secondary.name}`].push(x):h["Under Performers"].push(x)}),[{name:"Top Performers",color:"text-blue-500",bgColor:"bg-white",count:h["Top Performers"].length,items:h["Top Performers"],description:`Above average in both ${t.primary.name} (>${c[t.primary.key].toFixed(2)}) and ${t.secondary.name} (>${c[t.secondary.key].toFixed(2)})`},{name:`High ${t.primary.name}`,color:"text-gray-700",bgColor:"bg-white",count:h[`High ${t.primary.name}`].length,items:h[`High ${t.primary.name}`],description:`High ${t.primary.name} (>${c[t.primary.key].toFixed(2)}) but below average ${t.secondary.name} (<${c[t.secondary.key].toFixed(2)})`},{name:`High ${t.secondary.name}`,color:"text-gray-700",bgColor:"bg-white",count:h[`High ${t.secondary.name}`].length,items:h[`High ${t.secondary.name}`],description:`High ${t.secondary.name} (>${c[t.secondary.key].toFixed(2)}) but below average ${t.primary.name} (<${c[t.primary.key].toFixed(2)})`},{name:"Under Performers",color:"text-gray-700",bgColor:"bg-white",count:h["Under Performers"].length,items:h["Under Performers"],description:`Below average in both ${t.primary.name} (<${c[t.primary.key].toFixed(2)}) and ${t.secondary.name} (<${c[t.secondary.key].toFixed(2)})`}]},[s,c,a,t]),u=h=>{const v=d.find(y=>y.name===h);o!==h&&(i(h),l==null||l((v==null?void 0:v.items)||[]))},m=()=>{i(null),l==null||l(void 0)};return e.jsx(_t,{children:e.jsx("div",{id:"age-report-performance",className:"flex items-center gap-1",children:d.map(h=>e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("div",{className:`relative cursor-pointer transition-all duration-300 ease-in-out hover:opacity-90 rounded-full p-2 min-w-[60px] ${o===h.name?"bg-blue-50 border border-blue-500":"bg-white border border-gray-300"}`,onClick:()=>u(h.name),children:e.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[e.jsxs("span",{className:`text-xs font-medium ${o===h.name?"text-blue-700 font-semibold":"text-gray-700"}`,children:[h.name," (",h.count,")"]}),o===h.name&&e.jsx("button",{onClick:v=>{v.stopPropagation(),m()},className:"ml-0.5 p-0.5 hover:bg-blue-200 rounded-full transition-colors",children:e.jsx(hs,{className:"w-3 h-3 text-blue-700"})})]})})}),e.jsx(ns,{className:"max-w-xs p-4 bg-gray-900 text-white border-0 shadow-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center ${o===h.name?"bg-blue-50":"bg-white"}`,children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-400"})}),e.jsx("p",{className:"font-medium text-lg text-white",children:h.name})]}),e.jsx("p",{className:"text-sm text-gray-200",children:h.description})]})})]},h.name))})})},ss=({size:s="icon",variant:a="outline",iconSize:t="h-4 w-4",className:l=""})=>{const o=Me(),i=V(c=>c.locale.locale);return e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(z,{variant:a,size:s,className:l,children:e.jsx(ga,{className:t})})}),e.jsx(Ys,{className:"w-56",children:e.jsxs("div",{className:"grid gap-3",children:[e.jsx("h3",{className:"font-medium text-sm",children:"Number Format Preferences"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-IN",checked:i==="en-IN",onChange:()=>o(ia("en-IN")),className:"form-radio"}),e.jsx("span",{children:"Indian"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-US",checked:i==="en-US",onChange:()=>o(ia("en-US")),className:"form-radio"}),e.jsx("span",{children:"International"})]})]})]})})]})},Em={green:{patternType:"solid",fgColor:{rgb:"DCFCE7"}},blue:{patternType:"solid",fgColor:{rgb:"DBEAFE"}},yellow:{patternType:"solid",fgColor:{rgb:"FEF9C3"}},red:{patternType:"solid",fgColor:{rgb:"FEF2F2"}},header:{patternType:"solid",fgColor:{rgb:"F1F5F9"}}},Lm=s=>{let a=0,t=0,l=0;return s.forEach(o=>{typeof o["Total Sessions"]=="number"&&typeof o["Avg Conv. Rate"]=="number"&&(a+=Number(o["Total Sessions"]),t+=Number(o["Avg Conv. Rate"]),l++)}),{avgSessions:a/l,avgConvRate:t/l}},Dm=(s,a,t,l,o)=>{if((s==="Sessions"||s==="Conv. Rate")&&typeof a=="number"&&typeof t=="number"){const i=a>=l.avgSessions,c=t>=l.avgConvRate;return i&&c?o.green:i&&!c?o.blue:!i&&c?o.yellow:o.red}},Rm=(s,a,t,l,o,i,c,d)=>{const u=at.utils.decode_range(s["!ref"]||"A1");for(let m=u.s.c;m<=u.e.c;m++){const h=at.utils.encode_cell({r:0,c:m});s[h]||(s[h]={v:""}),s[h].s={fill:c.header,font:{bold:!0,color:{rgb:"64748B"}},alignment:{horizontal:"left"}}}a.forEach((m,h)=>{i.forEach((v,y)=>{const S=h*i.length+y+2,x=2,p=t.length+l.length+1;for(let N=x;N<=p;N++){const j=at.utils.encode_cell({r:S-1,c:N});s[j]||(s[j]={v:""});let w={font:{color:{rgb:"000000"}},alignment:{horizontal:"right"},format:v==="Conv. Rate"?"0.00%":"#,##0"},P,g;if(N<x+l.length)P=m["Total Sessions"],g=m["Avg Conv. Rate"];else{const F=N-(x+l.length),A=t[F],C=m[o].find(_=>`${_.Month.slice(0,4)}-${_.Month.slice(4)}`===A);C&&(P=C.Sessions,g=C["Conv. Rate"])}const $=Dm(v,P,g,d,c);$&&(w.fill=$),s[j].s=w}})})},Qo=({data:s,fileName:a,primaryColumn:t,secondaryColumns:l,monthlyDataKey:o,monthlyMetrics:i,buttonClassName:c="",disabled:d=!1})=>{const u=()=>{const m=at.utils.book_new(),h=[],v=Lm(s),y=Array.from(new Set(s.flatMap(N=>N[o].map(j=>`${j.Month.slice(0,4)}-${j.Month.slice(4)}`)))).sort().reverse(),S=[t,"Metric",...l,...y];h.push(S),s.forEach(N=>{i.forEach(j=>{const w=[];w.push(j===i[0]?N[t]:""),w.push(j),l.forEach(P=>{const g=N[P];w.push(typeof g=="number"?Number(g.toFixed(2)):null)}),y.forEach(P=>{const g=N[o].find(F=>`${F.Month.slice(0,4)}-${F.Month.slice(4)}`===P),$=g?g[j]:null;w.push(typeof $=="number"?Number($.toFixed(2)):null)}),h.push(w)})});const x=at.utils.aoa_to_sheet(h);Rm(x,s,y,l,o,i,Em,v);const p=[{wch:20},{wch:12},...l.map(()=>({wch:15})),...y.map(()=>({wch:12}))];x["!cols"]=p,at.utils.book_append_sheet(m,x,"Conversion Data"),at.writeFile(m,`${a}.xlsx`)};return e.jsx(z,{id:"download-button",onClick:u,size:"icon",variant:"outline",className:c,disabled:d,children:e.jsx(ji,{className:"h-4 w-4"})})},Om=()=>{const s=V(F=>F.date.from),a=V(F=>F.date.to),[t,l]=r.useState(!1),[o,i]=r.useState([]),[c,d]=r.useState(void 0),[u,m]=r.useState(0),h=()=>{l(!t)},v=(F,A)=>{A===S&&i(F)},y=r.useMemo(()=>({from:s,to:a}),[s,a]),[S,x]=r.useState("searchTerm"),p=[{label:"Search Term",value:"searchTerm",icon:e.jsx(Cs,{className:"w-4 h-4"})},{label:"Keyword",value:"keyword",icon:e.jsx(yi,{className:"w-4 h-4"})},{label:"Age",value:"age",icon:e.jsx(Ft,{className:"w-4 h-4"})},{label:"Gender",value:"gender",icon:e.jsx(er,{className:"w-4 h-4"})},{label:"Product",value:"product",icon:e.jsx(kt,{className:"w-4 h-4"})}],N=F=>({searchTerm:"Search Term",keyword:"Keyword",age:"Age Range",gender:"Gender",product:"Product"})[F]||"Unknown",j=F=>{d(F===void 0?void 0:F.map(A=>String(A)))},w=r.useCallback(()=>{m(F=>F+1)},[]),P=F=>{x(F),i([]),d(void 0)},g=F=>({searchTerm:"SearchTerm_Conversion_Report",keyword:"Keyword_Conversion_Report",age:"Age_Conversion_Report",gender:"Gender_Conversion_Report",product:"Product_Conversion_Report"})[F]||"Conversion_Report",$=F=>({searchTerm:["Metric","Total Cost","Conv. Value / Cost"],keyword:["Metric","Total Cost","Conv. Value / Cost"],age:["Metric","Total Cost","Conv. Value / Cost"],gender:["Metric","Total Cost","Conv. Value / Cost"],product:["Metric","Total Cost","Conv. Value / Cost"]})[F]||[];return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx(qt,{tabs:p,activeTab:S,onTabChange:P}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:!y.from||!y.to?e.jsx(Zs,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-none"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"p-2 space-y-6",children:e.jsx(ue,{id:`${S}-report`,className:`${t?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(he,{className:"p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex-grow items-center gap-3",children:e.jsx(is,{data:o,primaryColumn:N(S),metricConfig:ls.googleAds||{},onCategoryFilter:j})}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5 ",children:[e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(ss,{}),e.jsx(z,{id:"refresh",onClick:w,size:"icon",variant:"outline",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(Qo,{data:o,fileName:g(S),primaryColumn:N(S),secondaryColumns:$(S),monthlyDataKey:"MonthlyData",monthlyMetrics:["Sessions","Conv. Rate"],disabled:o.length===0}),e.jsx(z,{id:"expand-button",onClick:h,size:"icon",variant:"outline",children:t?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{id:S,children:[S==="searchTerm"&&e.jsx($m,{dateRange:{from:y.from?new Date(y.from):void 0,to:y.to?new Date(y.to):void 0},refreshTrigger:u,currentFilter:c,onDataUpdate:v,isFullScreen:t}),S==="keyword"&&e.jsx(Im,{dateRange:{from:y.from?new Date(y.from):void 0,to:y.to?new Date(y.to):void 0},refreshTrigger:u,currentFilter:c,onDataUpdate:v,isFullScreen:t}),S==="age"&&e.jsx(Fm,{dateRange:{from:y.from?new Date(y.from):void 0,to:y.to?new Date(y.to):void 0},refreshTrigger:u,currentFilter:c,onDataUpdate:v,isFullScreen:t}),S==="gender"&&e.jsx(_m,{dateRange:{from:y.from?new Date(y.from):void 0,to:y.to?new Date(y.to):void 0},refreshTrigger:u,currentFilter:c,onDataUpdate:v,isFullScreen:t}),S==="product"&&e.jsx(Pm,{dateRange:{from:y.from?new Date(y.from):void 0,to:y.to?new Date(y.to):void 0},refreshTrigger:u,currentFilter:c,onDataUpdate:v,isFullScreen:t})]})})]})})})})]})}),e.jsx(Ps,{})]})},$s=zl,Fs=Bl,zm=r.forwardRef(({className:s,inset:a,children:t,...l},o)=>e.jsxs($n,{ref:o,className:Q("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...l,children:[t,e.jsx(gn,{className:"ml-auto"})]}));zm.displayName=$n.displayName;const Bm=r.forwardRef(({className:s,...a},t)=>e.jsx(Fn,{ref:t,className:Q("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Bm.displayName=Fn.displayName;const As=r.forwardRef(({className:s,sideOffset:a=4,...t},l)=>e.jsx(Rl,{children:e.jsx(_n,{ref:l,sideOffset:a,className:Q("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));As.displayName=_n.displayName;const ze=r.forwardRef(({className:s,inset:a,...t},l)=>e.jsx(In,{ref:l,className:Q("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",a&&"pl-8",s),...t}));ze.displayName=In.displayName;const Gm=r.forwardRef(({className:s,children:a,checked:t,...l},o)=>e.jsxs(Pn,{ref:o,className:Q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:t,...l,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(En,{children:e.jsx(qa,{className:"h-4 w-4"})})}),a]}));Gm.displayName=Pn.displayName;const Um=r.forwardRef(({className:s,children:a,...t},l)=>e.jsxs(Ln,{ref:l,className:Q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(En,{children:e.jsx(Ol,{className:"h-2 w-2 fill-current"})})}),a]}));Um.displayName=Ln.displayName;const Vm=r.forwardRef(({className:s,inset:a,...t},l)=>e.jsx(Dn,{ref:l,className:Q("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...t}));Vm.displayName=Dn.displayName;const ra=r.forwardRef(({className:s,...a},t)=>e.jsx(Rn,{ref:t,className:Q("-mx-1 my-1 h-px bg-muted",s),...a}));ra.displayName=Rn.displayName;function Wm(s,a,t){return t!=null?Math.min(Math.max(s,a),t):Math.max(s,a)}function xs({data:s,primaryColumn:a,secondaryColumns:t,monthlyDataKey:l,isFullScreen:o,locale:i,filter:c}){const[d,u]=r.useState(1),[m,h]=r.useState(50),[v,y]=r.useState([]),S=r.useRef(null),[x,p]=r.useState(null),N=()=>{if(!Array.isArray(s))return[];const k=n=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Number.parseInt(n)-1],f=new Set;return s.forEach(n=>{const b=n[l];Array.isArray(b)&&b.forEach(T=>{if(T!=null&&T.Month){const U=T.Month.slice(0,4),D=T.Month.slice(4);f.add(`${k(D)}-${U}`)}})}),Array.from(f).sort((n,b)=>{const[T,U]=n.split("-"),[D,W]=b.split("-"),K=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],q=K.indexOf(T),ee=K.indexOf(D);return U!==W?parseInt(W)-parseInt(U):ee-q})},j=r.useMemo(()=>{const k=[{key:a,header:a,width:130,minWidth:100,maxWidth:300,align:"left"}];return t&&t.forEach(n=>{k.push({key:n,header:n,width:130,minWidth:100,maxWidth:200,align:"right"})}),N().forEach(n=>{k.push({key:n,header:n,width:120,minWidth:100,maxWidth:150,align:"right"})}),k},[a,t,l,s]);r.useEffect(()=>{y(j.map(k=>k.width))},[j]);const w=r.useMemo(()=>j.map((k,f)=>v[f]||k.width),[j,v]);r.useEffect(()=>{const k=n=>{const b=S.current;if(!b)return;const T=n.clientX-b.startX,U=j[b.index];y(D=>{const W=[...D];return W[b.index]=Wm(b.startWidth+T,U.minWidth??80,U.maxWidth),W})},f=()=>{S.current=null,p(null),document.body.style.cursor="",document.body.classList.remove("select-none")};return window.addEventListener("pointermove",k),window.addEventListener("pointerup",f),()=>{window.removeEventListener("pointermove",k),window.removeEventListener("pointerup",f)}},[j]);const P=(k,f)=>{S.current={index:f,startX:k.clientX,startWidth:v[f]},p(f),document.body.style.cursor="col-resize",document.body.classList.add("select-none"),k.currentTarget.setPointerCapture(k.pointerId)},g=r.useMemo(()=>c===void 0?s:c.length===0?[]:s.filter(k=>{const f=String(k[a]);return c.includes(f)}),[s,c,a]),$=r.useMemo(()=>N(),[s,l]),F=r.useMemo(()=>{let k=0,f=0,n=0;return s.forEach(b=>{const T=b[l];Array.isArray(T)&&T.forEach(U=>{typeof U.Spend=="number"&&typeof U["Purchase ROAS"]=="number"&&(k+=Number(U.Spend),f+=Number(U["Purchase ROAS"]),n++)})}),{avgSpend:n>0?k/n:0,avgPurchaseROAS:n>0?f/n:0}},[s,l]);r.useEffect(()=>{u(1)},[c]),r.useEffect(()=>{u(1)},[m]);const A=k=>{const f=k==="all"?g.length:parseInt(k);h(f)},C=(k,f)=>{if(typeof k=="number")switch(f){case"spend":return Math.round(k).toLocaleString(i);case"percentage":return`${Number.parseFloat(k.toLocaleString(i)).toFixed(2)}%`;case"sessions":return Math.round(k).toLocaleString(i);default:return Number.parseFloat(k.toLocaleString(i)).toFixed(2)}return k},_=k=>{if(!k)return e.jsxs("td",{className:"text-right whitespace-nowrap p-3 text-sm border-r border-b border-gray-200 bg-transparent",children:[e.jsx("div",{className:"truncate",children:""}),e.jsx("div",{className:"truncate",children:""})]});const f=k.Spend,n=k["Purchase ROAS"],b=k["Purchase Conversion Value"];return e.jsx("td",{className:"text-right whitespace-nowrap p-3 text-sm border-r border-b border-gray-200 bg-transparent",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",children:C(f,"spend")}),e.jsx("div",{className:"text-xs truncate",children:C(n,"percentage")}),b!==void 0&&e.jsxs("div",{className:"text-xs truncate",children:["PCV: ",b.toLocaleString(i)]})]})})},I=(k,f,n)=>{const b=k[f],T=D=>D===0?0:D===1?w[0]:D===2?w[0]+w[1]:0;if(typeof b!="number")return e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"}`,style:n<3?{left:`${T(n)}px`}:{},children:""});const U=typeof k["Total PCV"]=="number"?k["Total PCV"].toLocaleString(i):null;return f.includes("Spend")?e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium truncate",children:C(b,"spend")})})}):f.includes("Purchase ROAS")?e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium truncate",children:C(b,"percentage")}),U!==null&&e.jsxs("div",{className:"text-xs mt-1 truncate",children:["Total PCV: ",U]})]})}):e.jsx("td",{className:`p-3 text-sm border-r border-b border-gray-200 ${n<3?"sticky z-10 bg-white group-hover:bg-blue-50":"bg-transparent"} ${n===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`,style:n<3?{left:`${T(n)}px`}:{},children:e.jsx("div",{className:"text-right font-medium truncate",children:C(b)})})},B=(k,f)=>e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-150 group",children:[e.jsx("td",{className:"sticky left-0 min-w-[130px] max-w-[200px] p-3 text-sm font-medium z-10 bg-white group-hover:bg-blue-50 border-r border-b border-gray-200",children:e.jsx("div",{className:"truncate",children:typeof k[a]=="string"||typeof k[a]=="number"?C(k[a]):""})}),t==null?void 0:t.map((n,b)=>{const T=b+1;return e.jsx(Se.Fragment,{children:I(k,n,T)},n)}),$.map(n=>{const b=q=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(q)+1,[T,U]=n.split("-"),D=b(T),W=`${U}${D.toString().padStart(2,"0")}`,K=k[l].find(q=>q.Month===W);return e.jsx(Se.Fragment,{children:_(K)},n)})]},`${k[a]}-${f}`),O=r.useMemo(()=>o?g:g.slice((d-1)*m,d*m),[o,g,d,m]),E=g.length,M=Math.ceil(E/m),R=k=>{const f=Math.max(1,Math.min(k,M));u(f)},L=(k,f)=>{let n="";k==="Total Spend"?n=`(avg: ${Math.round(F.avgSpend).toLocaleString()})`:k==="Total Purchase ROAS"&&(n=`(avg: ${F.avgPurchaseROAS.toFixed(2)}%)`);const b=f<3,T=x===f,U=D=>D===0?0:D===1?w[0]:D===2?w[0]+w[1]:0;return console.log("filter",c,g),e.jsxs("th",{className:`sticky top-0 z-10 px-3 py-3 text-right text-sm font-medium bg-gray-100 border-r border-b border-gray-200 ${b?`z-20 ${f===2?"shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]":""}`:""} ${T?"border-blue-500":""}`,style:b?{left:`${U(f)}px`}:{},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"truncate",children:k}),n&&e.jsx("span",{className:"text-xs font-normal mt-0.5 truncate",children:n})]}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${k} column`,onPointerDown:D=>P(D,f),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${T?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${T?"bg-blue-500":"bg-gray-200"}`})})]},k)};return e.jsxs("div",{className:"w-full overflow-hidden flex flex-col mt-4",children:[e.jsx("div",{className:`relative overflow-x-auto ${o?"max-h-[calc(100vh-80px)]":""} max-h-[100vh]`,children:e.jsxs("table",{className:"w-full table-fixed border border-gray-200",children:[e.jsx("colgroup",{children:w.map((k,f)=>{var n;return e.jsx("col",{style:{width:k}},String(((n=j[f])==null?void 0:n.key)||`col-${f}`))})}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"sticky left-0 top-0 min-w-[130px] z-30 px-3 py-3 text-left text-sm font-medium bg-gray-100 border-r border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:a}),c&&c.length>0&&e.jsx("span",{className:"text-xs px-2 py-1 rounded",children:"Filtered"})]}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${a} column`,onPointerDown:k=>P(k,0),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${x===0?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${x===0?"bg-blue-500":"bg-gray-200"}`})})]}),t==null?void 0:t.map((k,f)=>{const n=f+1;return L(k,n)}),$.map((k,f)=>{const n=1+((t==null?void 0:t.length)||0)+f,b=x===n;return e.jsxs("th",{className:`sticky top-0 min-w-[120px] z-10 px-3 py-3 text-right text-sm font-medium whitespace-nowrap bg-gray-100 border-r border-b border-gray-200 ${b?"border-blue-500":""}`,children:[e.jsx("div",{className:"truncate",children:k}),e.jsx("div",{className:"text-xs mt-1 truncate",children:"Sessions / Conv Rate"}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-label":`Resize ${k} column`,onPointerDown:T=>P(T,n),className:`absolute inset-y-0 right-0 w-3 cursor-col-resize ${b?"bg-blue-500/15":"hover:bg-gray-200/30 active:bg-gray-200/50"}`,children:e.jsx("div",{className:`absolute right-0 top-0 h-full w-px ${b?"bg-blue-500":"bg-gray-200"}`})})]},k)})]})}),e.jsx("tbody",{children:O.length>0?O.map((k,f)=>B(k,f)):e.jsx("tr",{children:e.jsx("td",{colSpan:1+((t==null?void 0:t.length)||0)+$.length,className:"p-4 text-center border-b border-gray-200",children:c!==void 0&&g.length===0?e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsx("span",{className:"text-lg font-medium text-gray-700",children:"Oops! No data available for this category"})}):"No data to display"})})})]})}),!o&&e.jsxs("div",{className:"px-3 py-2.5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-sm",children:E>0?e.jsxs(e.Fragment,{children:["Showing ",(d-1)*m+1,"-",Math.min(d*m,E)," of"," ",E," rows",c!==void 0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filtered from ",s.length," total rows)"]}):null]}):e.jsxs(e.Fragment,{children:["No rows to display",c!==void 0?e.jsxs("span",{className:"ml-2 text-xs",children:["(Filter: ",(c==null?void 0:c.join(", "))||"Unknown",") | Total rows: ",s.length]}):null]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Rows per page:"}),e.jsxs(We,{value:m===g.length?"all":m.toString(),onValueChange:A,children:[e.jsx(Be,{className:"w-20 h-8",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"50",children:"50"}),e.jsx(ie,{value:"100",children:"100"}),e.jsx(ie,{value:"200",children:"200"}),e.jsx(ie,{value:"all",children:"All"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex bg-transparent",onClick:()=>R(1),disabled:d===1,children:e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0 bg-transparent",onClick:()=>R(d-1),disabled:d===1,children:e.jsx(us,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium px-2",children:["Page ",d," of ",M]}),e.jsx(z,{variant:"outline",className:"h-8 w-8 p-0 bg-transparent",onClick:()=>R(d+1),disabled:d===M,children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex bg-transparent",onClick:()=>R(M),disabled:d===M,children:e.jsx(Xa,{className:"h-4 w-4"})})]})]})]})}const Hm=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),[o,i]=r.useState(null),[c,d]=r.useState(!0),[u,m]=r.useState(""),[h,v]=r.useState([]),[y,S]=r.useState({}),[x,p]=r.useState(""),N=Me(),j=V(n=>n.locale.locale),{brandId:w}=ge(),P=n=>{m(u===n?"":n)},g=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",$=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",F=Ce(),A=r.useCallback(async()=>{d(!0);try{const b=(await F.post(`/api/meta/report/audience/${w}`,{startDate:g,endDate:$},{withCredentials:!0})).data||[];i(b)}catch(n){console.error("Error fetching data:",n)}finally{d(!1)}},[w,g,$]);r.useEffect(()=>{A();const n=setInterval(A,3*60*60*1e3);return()=>clearInterval(n)},[A]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&N(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,N]);const C="Audience Segments",_=["Total Spend","Total Purchase ROAS"],I="MonthlyData",B=()=>{A()},O=n=>{v(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{S(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=o==null?void 0:o.blendedAudienceData;r.useEffect(()=>{o!=null&&o.data&&!x&&(M&&M.length>0?p("blended-summary"):(o.data.length===1||o.data.length>1)&&p(o.data[0].account_name))},[o,x,M]);const R=r.useMemo(()=>{if(x==="blended-summary")return M||[];const n=o==null?void 0:o.data.find(b=>b.account_name===x);return(n==null?void 0:n.audienceData)||[]},[x,o,M]),L=r.useMemo(()=>{if(o!=null&&o.data&&o.data.length===1){const n=o.data[0],b=y[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[o==null?void 0:o.data,y]),k=r.useMemo(()=>{if(x==="blended-summary")return h.length===0?void 0:h.includes("__NO_RESULTS__")?[]:h;const n=y[x];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[x,h,y]),f=r.useMemo(()=>x==="blended-summary"?O:E(x),[x]);if(c)return e.jsx(Ae,{isLoading:c});if(!(o!=null&&o.data)||o.data.length===0)return e.jsx("div",{children:"No data available"});if(o.data.length===1&&(!M||M.length===0)){const n=o.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${u===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.audienceData||[],primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.audienceData)?n.audienceData:[n.audienceData],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===n.account_name,locale:j,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${u===x?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:x==="blended-summary"?"All Accounts":x}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>p("blended-summary"),className:x==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),o==null?void 0:o.data.map(n=>e.jsx(ze,{onClick:()=>p(n.account_name),className:x===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(x),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===x?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},x),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===x,locale:j,filter:k})]})})]})})},qm=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),o=Me(),[i,c]=r.useState(null),[d,u]=r.useState(!0),[m,h]=r.useState(""),[v,y]=r.useState([]),[S,x]=r.useState({}),[p,N]=r.useState(""),{brandId:j}=ge(),w=n=>{h(m===n?"":n)},P=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",g=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",$=Ce(),F=r.useCallback(async()=>{u(!0);try{const b=(await $.post(`/api/meta/report/placement/${j}`,{startDate:P,endDate:g},{withCredentials:!0})).data||[];c(b)}catch(n){console.error("Error fetching data:",n)}finally{u(!1)}},[j,P,g]);r.useEffect(()=>{F();const n=setInterval(F,3*60*60*1e3);return()=>clearInterval(n)},[F]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&o(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,o]);const A="Placements",C=["Total Spend","Total Purchase ROAS"],_="MonthlyData",I=V(n=>n.locale.locale),B=()=>{F()},O=n=>{y(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{x(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=i==null?void 0:i.blendedPlacementData;r.useEffect(()=>{i!=null&&i.data&&!p&&(M&&M.length>0?N("blended-summary"):(i.data.length===1||i.data.length>1)&&N(i.data[0].account_name))},[i,p,M]);const R=r.useMemo(()=>{if(p==="blended-summary")return M||[];const n=i==null?void 0:i.data.find(b=>b.account_name===p);return(n==null?void 0:n.placementData)||[]},[p,i,M]),L=r.useMemo(()=>{if(i!=null&&i.data&&i.data.length===1){const n=i.data[0],b=S[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[i==null?void 0:i.data,S]),k=r.useMemo(()=>{if(p==="blended-summary")return v.length===0?void 0:v.includes("__NO_RESULTS__")?[]:v;const n=S[p];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[p,v,S]),f=r.useMemo(()=>p==="blended-summary"?O:E(p),[p]);if(d)return e.jsx(Ae,{isLoading:d});if(!(i!=null&&i.data)||i.data.length===0)return e.jsx("div",{children:"No data available"});if(i.data.length===1&&(!M||M.length===0)){const n=i.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${m===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.placementData||[],primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.placementData)?n.placementData:[n.placementData],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===n.account_name,locale:I,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${m===p?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:p==="blended-summary"?"All Accounts":p}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>N("blended-summary"),className:p==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),i==null?void 0:i.data.map(n=>e.jsx(ze,{onClick:()=>N(n.account_name),className:p===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(p),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===p?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},p),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===p,locale:I,filter:k})]})})]})})},Ym=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),o=Me(),[i,c]=r.useState(null),[d,u]=r.useState(!0),[m,h]=r.useState(""),[v,y]=r.useState([]),[S,x]=r.useState({}),[p,N]=r.useState(""),{brandId:j}=ge(),w=n=>{h(m===n?"":n)},P=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",g=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",$=Ce(),F=r.useCallback(async()=>{u(!0);try{const b=(await $.post(`/api/meta/report/platform/${j}`,{startDate:P,endDate:g},{withCredentials:!0})).data||[];c(b)}catch(n){console.error("Error fetching data:",n)}finally{u(!1)}},[j,P,g]);r.useEffect(()=>{F();const n=setInterval(F,3*60*60*1e3);return()=>clearInterval(n)},[F]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&o(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,o]);const A="Platforms",C=["Total Spend","Total Purchase ROAS"],_="MonthlyData",I=V(n=>n.locale.locale),B=()=>{F()},O=n=>{y(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{x(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=i==null?void 0:i.blendedPlatformData;r.useEffect(()=>{i!=null&&i.data&&!p&&(M&&M.length>0?N("blended-summary"):(i.data.length===1||i.data.length>1)&&N(i.data[0].account_name))},[i,p,M]);const R=r.useMemo(()=>{if(p==="blended-summary")return M||[];const n=i==null?void 0:i.data.find(b=>b.account_name===p);return(n==null?void 0:n.platformData)||[]},[p,i,M]),L=r.useMemo(()=>{if(i!=null&&i.data&&i.data.length===1){const n=i.data[0],b=S[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[i==null?void 0:i.data,S]),k=r.useMemo(()=>{if(p==="blended-summary")return v.length===0?void 0:v.includes("__NO_RESULTS__")?[]:v;const n=S[p];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[p,v,S]),f=r.useMemo(()=>p==="blended-summary"?O:E(p),[p]);if(d)return e.jsx(Ae,{isLoading:d});if(!(i!=null&&i.data)||i.data.length===0)return e.jsx("div",{children:"No data available"});if(i.data.length===1&&(!M||M.length===0)){const n=i.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${m===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.platformData||[],primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.platformData)?n.platformData:[n.platformData],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===n.account_name,locale:I,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${m===p?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:p==="blended-summary"?"All Accounts":p}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>N("blended-summary"),className:p==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),i==null?void 0:i.data.map(n=>e.jsx(ze,{onClick:()=>N(n.account_name),className:p===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(p),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===p?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},p),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===p,locale:I,filter:k})]})})]})})},Km=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),[o,i]=r.useState(null),[c,d]=r.useState(!0),[u,m]=r.useState(""),[h,v]=r.useState([]),[y,S]=r.useState({}),[x,p]=r.useState(""),N=Me(),j=V(n=>n.locale.locale),{brandId:w}=ge(),P=n=>{m(u===n?"":n)},g=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",$=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",F=Ce(),A=r.useCallback(async()=>{d(!0);try{const b=(await F.post(`/api/meta/report/country/${w}`,{startDate:g,endDate:$},{withCredentials:!0})).data||[];i(b)}catch(n){console.error("Error fetching data:",n)}finally{d(!1)}},[w,g,$]);r.useEffect(()=>{A();const n=setInterval(A,3*60*60*1e3);return()=>clearInterval(n)},[A]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&N(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,N]);const C="Country",_=["Total Spend","Total Purchase ROAS"],I="MonthlyData",B=()=>{A()},O=n=>{v(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{S(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=o==null?void 0:o.blendedCountryData;r.useEffect(()=>{o!=null&&o.data&&!x&&(M&&M.length>0?p("blended-summary"):(o.data.length===1||o.data.length>1)&&p(o.data[0].account_name))},[o,x,M]);const R=r.useMemo(()=>{if(x==="blended-summary")return M||[];const n=o==null?void 0:o.data.find(b=>b.account_name===x);return(n==null?void 0:n.countryData)||[]},[x,o,M]),L=r.useMemo(()=>{if(o!=null&&o.data&&o.data.length===1){const n=o.data[0],b=y[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[o==null?void 0:o.data,y]),k=r.useMemo(()=>{if(x==="blended-summary")return h.length===0?void 0:h.includes("__NO_RESULTS__")?[]:h;const n=y[x];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[x,h,y]),f=r.useMemo(()=>x==="blended-summary"?O:E(x),[x]);if(c)return e.jsx(Ae,{isLoading:c});if(!(o!=null&&o.data)||o.data.length===0)return e.jsx("div",{children:"No data available"});if(o.data.length===1&&(!M||M.length===0)){const n=o.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${u===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.countryData||[],primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.countryData)?n.countryData:[n.countryData],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===n.account_name,locale:j,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${u===x?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:x==="blended-summary"?"All Accounts":x}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>p("blended-summary"),className:x==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),o==null?void 0:o.data.map(n=>e.jsx(ze,{onClick:()=>p(n.account_name),className:x===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(x),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===x?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},x),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===x,locale:j,filter:k})]})})]})})},Qm=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),o=Me(),[i,c]=r.useState(null),[d,u]=r.useState(!0),[m,h]=r.useState(""),[v,y]=r.useState([]),[S,x]=r.useState({}),[p,N]=r.useState(""),{brandId:j}=ge(),w=n=>{h(m===n?"":n)},P=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",g=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",$=Ce(),F=r.useCallback(async()=>{u(!0);try{const b=(await $.post(`/api/meta/report/device/${j}`,{startDate:P,endDate:g},{withCredentials:!0})).data||[];c(b)}catch(n){console.error("Error fetching data:",n)}finally{u(!1)}},[j,P,g]);r.useEffect(()=>{F();const n=setInterval(F,3*60*60*1e3);return()=>clearInterval(n)},[F]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&o(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,o]);const A="Device",C=["Total Spend","Total Purchase ROAS"],_="MonthlyData",I=V(n=>n.locale.locale),B=()=>{F()},O=n=>{y(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{x(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=i==null?void 0:i.blendedDeviceData;r.useEffect(()=>{i!=null&&i.data&&!p&&(M&&M.length>0?N("blended-summary"):(i.data.length===1||i.data.length>1)&&N(i.data[0].account_name))},[i,p,M]);const R=r.useMemo(()=>{if(p==="blended-summary")return M||[];const n=i==null?void 0:i.data.find(b=>b.account_name===p);return(n==null?void 0:n.deviceData)||[]},[p,i,M]),L=r.useMemo(()=>{if(i!=null&&i.data&&i.data.length===1){const n=i.data[0],b=S[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[i==null?void 0:i.data,S]),k=r.useMemo(()=>{if(p==="blended-summary")return v.length===0?void 0:v.includes("__NO_RESULTS__")?[]:v;const n=S[p];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[p,v,S]),f=r.useMemo(()=>p==="blended-summary"?O:E(p),[p]);if(d)return e.jsx(Ae,{isLoading:d});if(!(i!=null&&i.data)||i.data.length===0)return e.jsx("div",{children:"No data available"});if(i.data.length===1&&(!M||M.length===0)){const n=i.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${m===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.deviceData||[],primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.deviceData)?n.deviceData:[n.deviceData],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===n.account_name,locale:I,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${m===p?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:p==="blended-summary"?"All Accounts":p}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>N("blended-summary"),className:p==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),i==null?void 0:i.data.map(n=>e.jsx(ze,{onClick:()=>N(n.account_name),className:p===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(p),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===p?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},p),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===p,locale:I,filter:k})]})})]})})},Jm=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),o=Me(),[i,c]=r.useState(null),[d,u]=r.useState(!0),[m,h]=r.useState(""),[v,y]=r.useState([]),[S,x]=r.useState({}),[p,N]=r.useState(""),{brandId:j}=ge(),w=n=>{h(m===n?"":n)},P=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",g=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",$=Ce(),F=r.useCallback(async()=>{u(!0);try{const b=(await $.post(`/api/meta/report/gender/${j}`,{startDate:P,endDate:g},{withCredentials:!0})).data||[];c(b)}catch(n){console.error("Error fetching data:",n)}finally{u(!1)}},[j,P,g]);r.useEffect(()=>{F();const n=setInterval(F,3*60*60*1e3);return()=>clearInterval(n)},[F]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&o(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,o]);const A="Gender",C=["Total Spend","Total Purchase ROAS"],_="MonthlyData",I=V(n=>n.locale.locale),B=()=>{F()},O=n=>{y(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},E=n=>b=>{x(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},M=i==null?void 0:i.blendedGenderData;r.useEffect(()=>{i!=null&&i.data&&!p&&(M&&M.length>0?N("blended-summary"):(i.data.length===1||i.data.length>1)&&N(i.data[0].account_name))},[i,p,M]);const R=r.useMemo(()=>{if(p==="blended-summary")return M||[];const n=i==null?void 0:i.data.find(b=>b.account_name===p);return(n==null?void 0:n.genderData)||[]},[p,i,M]),L=r.useMemo(()=>{if(i!=null&&i.data&&i.data.length===1){const n=i.data[0],b=S[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[i==null?void 0:i.data,S]),k=r.useMemo(()=>{if(p==="blended-summary")return v.length===0?void 0:v.includes("__NO_RESULTS__")?[]:v;const n=S[p];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[p,v,S]),f=r.useMemo(()=>p==="blended-summary"?O:E(p),[p]);if(d)return e.jsx(Ae,{isLoading:d});if(!(i!=null&&i.data)||i.data.length===0)return e.jsx("div",{children:"No data available"});if(i.data.length===1&&(!M||M.length===0)){const n=i.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${m===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.genderData||[],primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.genderData)?n.genderData:[n.genderData],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===n.account_name,locale:I,filter:L})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${m===p?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:p==="blended-summary"?"All Accounts":p}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>N("blended-summary"),className:p==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),i==null?void 0:i.data.map(n=>e.jsx(ze,{onClick:()=>N(n.account_name),className:p===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:d,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>w(p),size:"sm",variant:"outline",className:"hover:bg-muted",children:m===p?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:A,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},p),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:A,secondaryColumns:C,monthlyDataKey:_,isFullScreen:m===p,locale:I,filter:k})]})})]})})},Zm=({dateRange:s})=>{const a=V(n=>n.date.from),t=V(n=>n.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),[o,i]=r.useState(null),[c,d]=r.useState(!0),[u,m]=r.useState(""),[h,v]=r.useState([]),[y,S]=r.useState({}),[x,p]=r.useState(""),N=Me(),j=V(n=>n.locale.locale),{brandId:w}=ge(),P=n=>{m(u===n?"":n)},g=l!=null&&l.from?Y(l.from,"yyyy-MM-dd"):"",$=l!=null&&l.to?Y(l.to,"yyyy-MM-dd"):"",F=Ce();r.useEffect(()=>{i(null)},[w]);const A=r.useCallback(async()=>{d(!0);try{const b=(await F.post(`/api/meta/report/age/${w}`,{startDate:g,endDate:$},{withCredentials:!0})).data||[];i(b)}catch(n){console.error("Error fetching data:",n)}finally{d(!1)}},[w,g,$]);r.useEffect(()=>{l.from&&l.to&&A()},[A]),r.useEffect(()=>{const n=setInterval(()=>{l.from&&l.to&&A()},108e5);return()=>clearInterval(n)},[A,l.from,l.to]),r.useEffect(()=>{s!=null&&s.from&&(s!=null&&s.to)&&N(es({from:s.from.toISOString(),to:s.to.toISOString()}))},[s,N]);const C="Age",_=["Total Spend","Total Purchase ROAS"],I="MonthlyData",B=()=>{A()},O=r.useCallback(n=>{v(n===void 0?[]:n.length===0?["__NO_RESULTS__"]:n.map(b=>String(b)))},[]),E=r.useCallback(n=>b=>{S(b===void 0?T=>({...T,[n]:[]}):T=>({...T,[n]:b.length===0?["__NO_RESULTS__"]:b.map(U=>String(U))}))},[]),M=o==null?void 0:o.blendedAgeData;r.useEffect(()=>{o!=null&&o.data&&!x&&(M&&M.length>0?p("blended-summary"):(o.data.length===1||o.data.length>1)&&p(o.data[0].account_name))},[o,x,M]);const R=r.useMemo(()=>{if(x==="blended-summary")return M||[];const n=o==null?void 0:o.data.find(b=>b.account_name===x);return(n==null?void 0:n.ageData)||[]},[x,o,M]),L=r.useMemo(()=>{if(x==="blended-summary")return h.length===0?void 0:h.includes("__NO_RESULTS__")?[]:h;const n=y[x];if(!(!n||n.length===0))return n.includes("__NO_RESULTS__")?[]:n},[x,h,y]),k=r.useMemo(()=>{if(o!=null&&o.data&&o.data.length===1){const n=o.data[0],b=y[n.account_name];return!b||b.length===0?void 0:b.includes("__NO_RESULTS__")?[]:b}},[o==null?void 0:o.data,y]),f=r.useMemo(()=>x==="blended-summary"?O:E(x),[x,O,E]);if(c)return e.jsx(Ae,{isLoading:c});if(!(o!=null&&o.data)||o.data.length===0)return e.jsx("div",{children:"No data available"});if(o.data.length===1&&(!M||M.length===0)){const n=o.data[0];return e.jsx("div",{children:e.jsxs(ue,{className:`${u===n.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(is,{data:n.ageData||[],primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:E(n.account_name)},n.account_name),e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(n.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===n.account_name?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})}),e.jsx(he,{className:"p-0",children:e.jsx("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:e.jsx(xs,{data:Array.isArray(n.ageData)?n.ageData:[n.ageData],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===n.account_name,locale:j,filter:k})})})]})})}return e.jsx("div",{children:e.jsxs(ue,{className:`${u===x?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{className:"text-sm",children:x==="blended-summary"?"All Accounts":x}),e.jsx(os,{className:"h-4 w-4"})]})}),e.jsxs(As,{align:"end",className:"w-48",children:[M&&M.length>0&&e.jsx(ze,{onClick:()=>p("blended-summary"),className:x==="blended-summary"?"bg-blue-50":"",children:"All Accounts"}),o==null?void 0:o.data.map(n=>e.jsx(ze,{onClick:()=>p(n.account_name),className:x===n.account_name?"bg-blue-50":"",children:n.account_name},n.account_name))]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(z,{onClick:B,disabled:c,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx($e,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(z,{onClick:()=>P(x),size:"sm",variant:"outline",className:"hover:bg-muted",children:u===x?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{className:"p-0 mt-3",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(is,{data:R,primaryColumn:C,metricConfig:ls.spendAndRoas||{},onCategoryFilter:f},x),e.jsx(xs,{data:Array.isArray(R)?R:[R],primaryColumn:C,secondaryColumns:_,monthlyDataKey:I,isFullScreen:u===x,locale:j,filter:L})]})})]})})},Xm=()=>{const s=Me(),a=V(x=>x.date.from),t=V(x=>x.date.to),l=r.useMemo(()=>({from:a,to:t}),[a,t]),[o,i]=r.useState("age"),{brandId:c}=ge(),u=V(x=>x.brand.brands).find(x=>x._id===c),m=!!(u!=null&&u.fbAdAccounts&&(u==null?void 0:u.fbAdAccounts.length)>0),h=V(cr),v={from:l.from?new Date(l.from):void 0,to:l.to?new Date(l.to):void 0},y=[{label:"Age",value:"age",icon:e.jsx(vi,{className:"w-4 h-4"})},{label:"Gender",value:"gender",icon:e.jsx(er,{className:"w-4 h-4"})},{label:"Country",value:"country",icon:e.jsx(Ut,{className:"w-4 h-4"})},{label:"Platform",value:"platform",icon:e.jsx(Ni,{className:"w-4 h-4"})},{label:"Placement",value:"placement",icon:e.jsx(oo,{className:"w-4 h-4"})},{label:"Impression Device",value:"impressionDevice",icon:e.jsx(lo,{className:"w-4 h-4"})},{label:"Audience Segments",value:"audienceSegments",icon:e.jsx(Ft,{className:"w-4 h-4"})}],S=x=>{i(x)};return r.useEffect(()=>{s(ca(!1))},[c]),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx(qt,{tabs:y,activeTab:o,onTabChange:S}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[h?e.jsx(ht,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(Is,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):m?!l.from||!l.to?e.jsx(Zs,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-3 space-y-6",children:[o==="audienceSegments"&&e.jsx("div",{id:"audienceSegments",children:e.jsx(Hm,{dateRange:v})}),o==="placement"&&e.jsx("div",{id:"placement",children:e.jsx(qm,{dateRange:v})}),o==="platform"&&e.jsx("div",{id:"platform",children:e.jsx(Ym,{dateRange:v})}),o==="country"&&e.jsx("div",{id:"country",children:e.jsx(Km,{dateRange:v})}),o==="impressionDevice"&&e.jsx("div",{id:"impressionDevice",children:e.jsx(Qm,{dateRange:v})}),o==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(Jm,{dateRange:v})}),o==="age"&&e.jsx("div",{id:"age",children:e.jsx(Zm,{dateRange:v})})]})})}):e.jsx(Pt,{platform:"facebook",brandId:c??"",onSuccess:(x,p,N)=>{console.log(`Successfully connected ${x} account: ${p} (${N})`)}}),e.jsx(Ps,{})]})]})},Jo=Gl,fr=r.forwardRef(({className:s,...a},t)=>e.jsx(On,{ref:t,className:Q("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a}));fr.displayName=On.displayName;const Bs=r.forwardRef(({className:s,...a},t)=>e.jsx(zn,{ref:t,className:Q("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a}));Bs.displayName=zn.displayName;const Wt=r.forwardRef(({className:s,...a},t)=>e.jsx(Bn,{ref:t,className:Q("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a}));Wt.displayName=Bn.displayName;function eu({isOpen:s,onClose:a,brandId:t,brandName:l,brandData:o,platformIcons:i}){var p,N,j;const[c,d]=r.useState("overview"),[u,m]=r.useState(!1),[h,v]=r.useState(""),y=[{key:"shopify",icon:i.shopify.icon,name:i.shopify.name,isConnected:!!o.shopifyAccount,accountNumber:"1 Store",accountName:(p=o.shopifyAccount)==null?void 0:p.shopName,data:o.shopifyAccount,allowMultipleAccounts:!1},{key:"googleAds",icon:i.googleAds.icon,name:i.googleAds.name,isConnected:o.googleAdAccount&&o.googleAdAccount.length>0,accountNumber:o.googleAdAccount?`${o.googleAdAccount.length} Account(s)`:void 0,accountName:o.googleAdAccount&&o.googleAdAccount.length>0?`${o.googleAdAccount.map(w=>w.clientId).join(", ")}`:void 0,data:o.googleAdAccount,allowMultipleAccounts:!0},{key:"googleAnalytics",icon:i.googleAnalytics.icon,name:i.googleAnalytics.name,isConnected:!!((N=o.ga4Account)!=null&&N.PropertyID),accountNumber:"1 Property",accountName:(j=o.ga4Account)!=null&&j.PropertyID?`Property ${o.ga4Account.PropertyID}`:void 0,data:o.ga4Account,allowMultipleAccounts:!1},{key:"facebook",icon:i.facebook.icon,name:i.facebook.name,isConnected:o.fbAdAccounts&&o.fbAdAccounts.length>0,accountNumber:o.fbAdAccounts?`${o.fbAdAccounts.length} Account(s)`:void 0,accountName:o.fbAdAccounts&&o.fbAdAccounts.length>0?`${o.fbAdAccounts.join(", ")}`:void 0,data:o.fbAdAccounts,allowMultipleAccounts:!0}];r.useEffect(()=>{console.log(t)},[]);const S=w=>{v(w),m(!0)},x=(w,P,g)=>{console.log(`Successfully connected ${w} account: ${P} (${g})`)};return e.jsxs(ut,{open:s,onOpenChange:a,children:[e.jsxs(Ks,{className:"sm:max-w-4xl max-h-[100vh] overflow-y-auto",children:[e.jsxs(Qs,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(sr,{className:"h-5 w-5 text-teal-600"})}),e.jsx(Js,{className:"text-xl",children:l})]}),e.jsx(It,{children:"Manage platform integrations for this brand"})]}),e.jsxs(Jo,{defaultValue:"overview",value:c,onValueChange:d,className:"mt-2",children:[e.jsxs(fr,{className:"grid grid-cols-5 mb-4",children:[e.jsx(Bs,{value:"overview",children:"Overview"}),e.jsx(Bs,{value:"shopify",children:"Shopify"}),e.jsx(Bs,{value:"googleAds",children:"Google Ads"}),e.jsx(Bs,{value:"googleAnalytics",children:"Analytics"}),e.jsx(Bs,{value:"facebook",children:"Facebook"})]}),e.jsx(Wt,{value:"overview",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(w=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(w.icon,{className:"h-4 w-4 text-slate-700"})}),e.jsx("h3",{className:"font-medium",children:w.name})]}),e.jsx(ps,{className:w.isConnected?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700",children:w.isConnected?"Connected":"Not Connected"})]}),e.jsx("div",{className:"text-sm text-slate-600 space-y-2",children:w.isConnected?e.jsxs(e.Fragment,{children:[w.accountNumber&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Account(s):"}),e.jsx("span",{className:"font-medium",children:w.accountNumber})]}),e.jsx(z,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>d(w.key),children:"View Details"})]}):e.jsxs(z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>S(w.key),children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Add ",w.key==="shopify"?"Store":"Account"]})})]},w.key))})}),y.map(w=>e.jsxs(Wt,{value:w.key,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(w.icon,{className:"h-5 w-5 text-slate-700"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-lg",children:w.name}),e.jsx("span",{className:"text-sm text-slate-500",children:w.isConnected?`Connected to ${w.accountName}`:"Not connected"})]})]}),e.jsx(ps,{className:w.isConnected?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700",children:w.isConnected?"Active":"Inactive"})]}),e.jsxs("div",{className:"border rounded-lg p-5 bg-slate-50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Connection Details"}),w.isConnected?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-slate-500",children:"Account Name"}),e.jsx("p",{className:"font-medium",children:w.accountName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-slate-500",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(At,{className:"h-4 w-4"}),e.jsx("span",{children:"Connected"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-4 justify-end",children:[w.allowMultipleAccounts&&e.jsxs(z,{size:"sm",onClick:()=>S(w.key),children:[e.jsx(Rt,{className:"h-4 w-4 mr-1"}),"Add ",w.key==="shopify"?"Store":"Account"]}),e.jsx(z,{variant:"destructive",size:"sm",className:"text-white hover:bg-red-800",children:"Disconnect"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(wi,{className:"h-5 w-5"}),e.jsx("span",{children:"Not connected"})]}),e.jsxs("div",{className:"bg-white p-4 rounded border text-sm",children:[e.jsxs("h5",{className:"font-medium mb-2",children:["Why connect ",w.name,"?"]}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-slate-600",children:[e.jsx("li",{children:"Get comprehensive analytics across all your marketing channels"}),e.jsx("li",{children:"Track performance metrics in one dashboard"}),e.jsx("li",{children:"Generate insights from combined data sources"})]})]}),e.jsxs(z,{className:"mt-2",onClick:()=>S(w.key),children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Add ",w.key==="shopify"?"Store":"Account"]})]})]})]},w.key))]})]}),h&&e.jsx(Ht,{platform:h==="googleAds"?"Google Ads":h==="googleAnalytics"?"Google Analytics":h==="facebook"?"Facebook":"Shopify",open:u,onOpenChange:m,brandId:t,onSuccess:x})]})}const su={shopify:{icon:Ci,name:"Shopify"},googleAds:{icon:ys,name:"Google Ads"},googleAnalytics:{icon:Vs,name:"Google Analytics"},facebook:{icon:ro,name:"Facebook"}};function tu({userBrands:s=[]}){const a=Xe(),[t,l]=r.useState(null),[o,i]=r.useState(null),c=V(y=>y.brand.brands),d=Me(),u=(s==null?void 0:s.map(y=>{const S=c.find(x=>x._id===y);return S?{_id:S._id,name:S.name}:{_id:y,name:"Unknown Brand"}}))||[];r.useEffect(()=>{(async()=>{if(t)try{const S=await ne.get(`${be}/api/brands/${t.id}`,{withCredentials:!0});i(S.data)}catch(S){console.error("Error fetching brand details:",S)}})()},[t]);const m=y=>{l(y)},h=()=>{l(null),i(null)},v=async y=>{try{await ne.delete(`${be}/api/brands/delete/${y}`,{withCredentials:!0}),d(Ec(y)),d(Rc(y))}catch(S){console.error("Error deleting brand:",S)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(z,{onClick:()=>a("/brand-setup"),variant:"outline",className:"text-slate-700",children:[e.jsx(qs,{className:"h-5 w-5 mr-2"}),"Add New Brand"]}),u.map(y=>e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-5 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>m({id:y._id,name:y.name}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(sr,{className:"h-5 w-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900",children:y.name}),e.jsx("span",{className:"text-sm text-slate-500",children:"Connected"})]})]}),e.jsx(z,{variant:"ghost",size:"icon",className:"text-slate-600",onClick:S=>{S.stopPropagation()},children:e.jsx(ga,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Integration Status"}),e.jsx(ps,{className:"bg-teal-100 text-teal-700",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{variant:"outline",size:"sm",className:"text-slate-700",onClick:S=>{S.stopPropagation(),m({id:y._id,name:y.name})},children:"Manage"}),e.jsx(z,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",onClick:S=>{S.stopPropagation(),v(y._id)},children:e.jsx(ja,{className:"h-4 w-4"})})]})]})]},y._id))]}),t&&o&&e.jsx(eu,{isOpen:!0,onClose:h,brandId:t.id,brandName:t.name,brandData:o,platformIcons:su})]})}function au(){const[s,a]=r.useState("brands"),t=V(o=>o.user.user);console.log(t==null?void 0:t.brands);const l=async()=>{try{const o=await ne.get(`${be}/api/auth/zoho?source=${encodeURIComponent(window.location.pathname)}`),{authUrl:i}=o.data;window.location.href=i}catch(o){console.error("Error getting Zoho Auth URL:",o)}};return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx("span",{className:"text-4xl font-bold text-slate-600",children:t==null?void 0:t.username[0]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:t==null?void 0:t.username}),(t==null?void 0:t.isAdmin)&&e.jsxs(ps,{className:"bg-teal-100 text-teal-700 px-3 py-1 rounded-full",children:[e.jsx(io,{className:"h-4 w-4 mr-1"}),"Administrator"]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(no,{className:"h-4 w-4"}),e.jsx("span",{children:t==null?void 0:t.email})]})})]})]})}),e.jsx("div",{className:"border-b border-slate-200",children:e.jsx("div",{className:"flex px-6",children:["Brands"].map(o=>e.jsxs("button",{onClick:()=>a(o.toLowerCase()),className:`px-6 py-4 font-medium text-sm transition-colors relative ${s===o.toLowerCase()?"text-teal-600":"text-slate-600 hover:text-slate-900"}`,children:[o,s===o.toLowerCase()&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-teal-600"})]},o))})}),s.toLowerCase()==="brands"&&e.jsx(tu,{userBrands:t==null?void 0:t.brands}),s.toLowerCase()==="support"&&(t==null?void 0:t.isAdmin)&&e.jsx("div",{className:"py-8 flex gap-4 items-center justify-center",children:e.jsxs(z,{onClick:l,className:"bg-teal-600 hover:bg-teal-700",children:[e.jsx(Jn,{className:"h-5 w-5 mr-2"}),"Connect Zoho Help Desk"]})})]})})})})]})}function ru({onConnect:s}){const[a,t]=r.useState(""),[l,o]=r.useState(!1),i="https://parallels.messold.com";r.useEffect(()=>{const d=new URLSearchParams(window.location.search),u=d.get("access_token"),m=d.get("shop_name"),h=d.get("shop");if(u&&m&&h){s&&s("Shopify",m,u),d.delete("access_token"),d.delete("shop_name"),d.delete("shop");const v=`${window.location.pathname}${d.toString()?`?${d.toString()}`:""}`;window.history.replaceState({},"",v)}},[s]);const c=async()=>{if(a.trim()){o(!0);try{const d=await ne.post(`${i}/api/auth/shopify`,{shop:a,flowType:"brandSetup"},{withCredentials:!0});if(d.data.success){const{authUrl:u}=d.data;console.log("Generated Shopify Auth URL:",u),window.location.href=u}else console.error("Failed to get Shopify Auth URL")}catch(d){console.error("Error getting Shopify Auth URL:",d)}finally{o(!1)}}};return e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(ve,{type:"text",placeholder:"Enter your Shopify store name (e.g., mystore)",value:a,onChange:d=>t(d.target.value),onKeyPress:d=>{d.key==="Enter"&&a.trim()&&c()}}),e.jsx(z,{className:"w-full",onClick:c,disabled:!a.trim()||l,children:l?"Connecting...":"Login to Shopify"}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Enter your store name without .myshopify.com"})]})}function nu({platform:s,onConnect:a,connectedId:t,onRemove:l,onOpenChange:o}){var _;const[i,c]=r.useState(""),[d,u]=r.useState([]),[m,h]=r.useState([]),[v,y]=r.useState([]),[S,x]=r.useState(!1),[p,N]=r.useState(!1),j="https://parallels.messold.com",w=V(I=>I.brand.selectedBrandId);r.useEffect(()=>{const I=new URLSearchParams(window.location.search),B=I.get("openModal");if(B&&o){switch(B.toLowerCase()){case"googleads":s.toLowerCase()==="google ads"&&o(!0);break;case"googleanalytics":s.toLowerCase()==="google analytics"&&o(!0);break;case"facebook":s.toLowerCase()==="facebook"&&o(!0);break}I.delete("openModal");const O=`${window.location.pathname}${I.toString()?`?${I.toString()}`:""}`;window.history.replaceState({},"",O)}},[s,o]),r.useEffect(()=>{const I=async()=>{var E;N(!0);try{const M=await ne.get(`${j}/api/setup/google-accounts/${w}`,{withCredentials:!0});M.status===200?(x(!1),u((E=M.data)==null?void 0:E.clientAccounts.filter(R=>!R.hidden))):console.log("Unexpected status code:",M.status)}catch(M){P(M)}finally{N(!1)}},B=async()=>{N(!0);try{const E=await ne.get(`${j}/api/setup/ga4-propertyIds/${w}`,{withCredentials:!0});E.status===200?(x(!1),h(E.data.propertiesList||[])):console.log("Unexpected status code:",E.status)}catch(E){P(E)}finally{N(!1)}},O=async()=>{N(!0);try{const E=await ne.get(`${j}/api/setup/fb-ad-accounts/${w}`,{withCredentials:!0});y(E.data.adAccounts||[])}catch(E){P(E)}finally{N(!1)}};s.toLowerCase()==="google ads"&&I(),s.toLowerCase()==="google analytics"&&B(),s.toLowerCase()==="facebook"&&O()},[s,w]);const P=I=>{var B,O,E,M;if(ne.isAxiosError(I)){const R=I,{response:L,request:k}=R;if(L){const{status:f,data:n,config:b}=L,T=((B=n==null?void 0:n.error)==null?void 0:B.code)||(n==null?void 0:n.code),U=(O=n==null?void 0:n.error)==null?void 0:O.error_subcode;if(s.toLowerCase()==="facebook"&&((E=n==null?void 0:n.error)==null?void 0:E.code)===190&&((M=n==null?void 0:n.error)==null?void 0:M.error_subcode)===458||f===401&&T==="OAUTH_NOT_AUTHORIZED"){console.error("Facebook OAuth Authorization Error:",{status:f,code:T,errorSubcode:U,message:n==null?void 0:n.message}),x(!0);return}if([401,403,"UNAUTHENTICATED","TOKEN_EXPIRED","INVALID_CREDENTIALS","OAUTH_NOT_AUTHORIZED"].some(K=>f===K||T===K)){console.error("Authentication Error:",{status:f,code:T,message:n==null?void 0:n.message}),x(!0);return}if(n!=null&&n.errors&&n.errors.length>0){const q=n.errors[0].message||"Google Ads API Error";if(console.error("Google Ads API Error:",q),q&&["not associated with any Ads accounts","missing required authentication credential","OAuth access token invalid"].some(ae=>q.toLowerCase().includes(ae.toLowerCase()))){x(!0);return}}console.error("Server Error:",{status:f,url:b==null?void 0:b.url,method:b==null?void 0:b.method}),x(!0)}else k?(console.error("No response received:",k),x(!0)):(console.error("Request Setup Error:",R.message),x(!0))}else console.error("Unexpected Error:",I),x(!0)},g=()=>s.toLowerCase()==="google ads"?!d||d.length===0?null:d.filter(I=>I.name.toLowerCase().includes(i.toLowerCase())):s.toLowerCase()==="google analytics"?!m||m.length===0?null:m.filter(I=>I.propertyName.toLowerCase().includes(i.toLowerCase())):s.toLowerCase()==="facebook"?!v||v.length===0?null:v.filter(I=>I.adname.toLowerCase().includes(i.toLowerCase())):[],$=I=>{let B,O,E;"clientId"in I?(B=I.clientId,E=I.managerId,O=E?`${I.name} (${B}/${E})`:`${I.name} (${B})`):"propertyId"in I?(B=I.propertyId,O=`${I.propertyName} (${B})`):"id"in I?(B=I.id,O=`${I.adname}`):(B="",O=""),a(s,O,B,E)},F=async()=>{try{const I=await ne.get(`${j}/api/auth/google?context=googleAdSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:B}=I.data;window.location.href=B}catch(I){console.error("Error getting Google Auth URL:",I)}},A=async()=>{try{const I=await ne.get(`${j}/api/auth/google?context=googleAnalyticsSetup&source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0}),{authUrl:B}=I.data;window.location.href=B}catch(I){console.error("Error getting Google Auth URL:",I)}},C=async()=>{try{const I=await ne.get(`${j}/api/auth/facebook?source=${encodeURIComponent(window.location.pathname)}`,{withCredentials:!0});I.data.success?window.location.href=I.data.authURL:console.error("Failed to get Facebook Auth URL")}catch(I){console.error("Error getting Facebook Auth URL:",I)}};return p?e.jsx("div",{children:"Loading..."}):e.jsx(e.Fragment,{children:S?e.jsxs("div",{className:"space-y-3",children:[s.toLowerCase()==="facebook"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-3",children:e.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Your Facebook authorization has expired. Please reconnect your account to continue."})}),e.jsxs(z,{size:"sm",onClick:s.toLowerCase()==="facebook"?C:s.toLowerCase()==="google ads"?F:A,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(ms,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(vs,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(_s,{height:"1rem",width:"1rem"}),"Reconnect Facebook Account"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(ve,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:i,onChange:I=>c(I.target.value)})]}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(_=g())==null?void 0:_.map(I=>{const B=s.toLowerCase()==="google ads",O=s.toLowerCase()==="facebook",E=B?I.clientId:O?I.id:I.propertyId,M=B?I.managerId:void 0,R=B?I.name:O?I.adname:I.propertyName,L=B?e.jsx(ms,{height:"1rem",width:"1rem"}):O?e.jsx(_s,{height:"1rem",width:"1rem"}):e.jsx(vs,{height:"1rem",width:"1rem"}),k=B&&M?`${R} (${E}/${M})`:O?`${R}`:`${R} (${E})`;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[L,k]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&l&&e.jsxs(z,{size:"sm",variant:"destructive",onClick:()=>l(s,E,s.toLowerCase()==="google ads"?M:void 0),className:"flex items-center",children:[e.jsx(hs,{className:"h-4 w-4 mr-1"})," Remove"]}),e.jsxs(z,{size:"sm",onClick:()=>$(I),disabled:t.includes(E),className:t.includes(E)?"bg-green-600":"bg-blue-600",children:[t.includes(E)&&e.jsx(Hs,{className:"h-4 w-4 mr-2"}),t.includes(E)?"Connected":"Connect"]})]})]},`${s}-${E}-${M||""}`)})})]})})}const ou=[{name:"Shopify",color:"bg-emerald-50",icon:vt,textColor:"text-emerald-700",ringColor:"ring-emerald-200",description:"Connect your e-commerce store"},{name:"Facebook",color:"bg-blue-50",icon:_s,textColor:"text-blue-700",ringColor:"ring-blue-200",description:"Link your ad accounts"},{name:"Google Ads",color:"bg-rose-50",icon:ms,textColor:"text-rose-700",ringColor:"ring-rose-200",description:"Import campaign data"},{name:"Google Analytics",color:"bg-yellow-50",icon:vs,textColor:"text-yellow-700",ringColor:"ring-yellow-200",description:"Track website metrics"}];function Zo(){const[s,a]=r.useState(null),t=Me(),l=Xe(),{toast:o}=mt(),i=V(f=>f.user.user),c=V(f=>f.brand.selectedBrandId),d=V(f=>f.brandForm),[u,m]=r.useState(d.brandName||""),[h,v]=r.useState(d.connectedAccounts||{}),[y,S]=r.useState(d.googleAdsConnections||[]),[x,p]=r.useState(d.ga4Id||""),[N,j]=r.useState(d.fbAdId||[]),[w,P]=r.useState(d.shop||""),[g,$]=r.useState(d.shopifyAccessToken||""),[F,A]=r.useState(!1),[C,_]=r.useState(null),{refreshBrands:I}=Vo();r.useEffect(()=>{t(yt(null))},[]),r.useEffect(()=>{const f=new URLSearchParams(window.location.search),n=f.get("access_token"),b=f.get("shop_name");n&&b&&($(n),P(b),v(T=>({...T,Shopify:[b]})))},[]),r.useEffect(()=>{t(Ld({brandName:u,connectedAccounts:h,googleAdsConnections:y,ga4Id:x,fbAdId:N,shop:w,shopifyAccessToken:g}))},[u,h,y,x,N,w,g,t]),r.useEffect(()=>{const f=new URLSearchParams(window.location.search),n=f.get("openModal");if(n){switch(n.toLowerCase()){case"googleads":a("Google Ads");break;case"googleanalytics":a("Google Analytics");break;case"facebook":a("Facebook");break}f.delete("openModal");const b=`${window.location.pathname}${f.toString()?`?${f.toString()}`:""}`;window.history.replaceState({},"",b)}},[]);const B=(f,n,b,T)=>{v(U=>({...U,[f]:[...U[f]||[],n]})),f.toLowerCase()==="google ads"?S(U=>[...U,{clientId:b,managerId:T}]):f.toLowerCase()==="google analytics"?p(b):f.toLowerCase()==="facebook"?j(U=>[...U,b]):f.toLowerCase()==="shopify"&&($(b),P(n)),o({description:`Successfully connected ${n} to ${f}`,variant:"default"})},O=f=>{var n;return(((n=h[f])==null?void 0:n.length)||0)>0},E=f=>{switch(f.toLowerCase()){case"google ads":return y.map(n=>n.clientId).join(",");case"google analytics":return x;case"facebook":return N.join(",");default:return""}},M=()=>!!u.trim(),R=()=>!!C&&Object.keys(h).length>0,L=async()=>{if(!u.trim()){o({description:"Please enter a brand name",variant:"destructive"});return}A(!0);try{const f={name:u,googleAdAccount:[],ga4Account:{},fbAdAccounts:[],shopifyAccount:{}},b=(await ne.post(`${be}/api/brands/add`,f,{withCredentials:!0})).data.brand._id;if(t(yt(b)),_(b),i){await ne.post(`${be}/api/users/add-brand`,{userId:i==null?void 0:i.id,brandId:b},{withCredentials:!0});const T={...i,brands:[...i.brands,b]};t(Bt(T))}o({description:"Brand created successfully! Now you can connect platforms.",variant:"default"})}catch(f){console.error(f),o({description:"Error creating brand. Please try again.",variant:"destructive"})}finally{A(!1)}},k=async()=>{const f=C||c;if(!f){o({description:"Please create a brand first",variant:"destructive"});return}try{const n={googleAdAccount:y.map(b=>({clientId:b.clientId,managerId:b.managerId||""})),ga4Account:{PropertyID:x||""},fbAdAccounts:N.map(b=>b),shopifyAccount:{shopName:w||"",shopifyAccessToken:g||""}};await ne.patch(`${be}/api/brands/update/${f}`,n,{withCredentials:!0}),t(Dd()),await I(),l("/dashboard"),o({description:"Brand setup completed successfully!",variant:"default"})}catch(n){console.error(n),o({description:"Error updating brand. Please try again.",variant:"destructive"})}};return e.jsx(ue,{className:"mx-auto max-w-7xl shadow-lg",children:e.jsxs(he,{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:e.jsx(sr,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Brand Setup"}),e.jsx("p",{className:"text-gray-500",children:"Enter your brand details and connect your platforms"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"brandName",className:"text-sm font-medium text-gray-700",children:"Brand Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ve,{id:"brandName",placeholder:"Enter your brand name",value:u,onChange:f=>m(f.target.value),className:"flex-1",disabled:!!C}),!C&&e.jsx(z,{onClick:L,disabled:!M()||F,className:"px-6",children:F?"Creating...":"Create Brand"})]}),C&&u&&e.jsxs("p",{className:"text-sm text-green-600 font-medium",children:[' Brand "',u,'" created successfully! You can now connect platforms.']})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ye,{className:"text-sm font-medium text-gray-700",children:"Connect Platforms"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:ou.map(f=>e.jsxs(ut,{open:s===f.name,onOpenChange:n=>a(n?f.name:null),children:[e.jsx(Co,{asChild:!0,children:e.jsx("button",{className:`relative group p-6 rounded-xl ${f.color} ring-1 ${f.ringColor} transition-all duration-200 hover:scale-[1.02] w-full text-left ${C?"":"opacity-50 cursor-not-allowed"}`,disabled:!C,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(f.icon,{width:"2rem",height:"2rem"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold ${f.textColor}`,children:f.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C?f.description:"Create a brand first to connect platforms"})]}),O(f.name)?e.jsx(Hs,{className:"h-5 w-5 text-green-500"}):e.jsx(Je,{className:"h-5 w-5 text-gray-400"})]})})}),e.jsxs(Ks,{className:"sm:max-w-[600px]",children:[e.jsxs(Qs,{children:[e.jsxs(Js,{children:["Connect to ",f.name]}),e.jsx(It,{children:f.name==="Shopify"?"Enter your Shopify store name and login to connect.":"Select an account to connect with your brand."})]}),f.name==="Shopify"?e.jsx(ru,{onConnect:B}):e.jsx(nu,{platform:f.name,onConnect:B,connectedId:E(f.name)})]})]},f.name))})]}),Object.keys(h).length>0&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Connected Platforms"}),e.jsx("div",{className:"space-y-2",children:Object.entries(h).map(([f,n])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:f}),e.jsx("span",{className:"font-medium",children:n.join(", ")})]},f))})]}),e.jsxs(z,{className:"w-full",disabled:!R(),onClick:k,children:[C?"Complete Setup":"Create Brand First",e.jsx(Ss,{className:"ml-2 h-5 w-5"})]})]})]})})}const jt=r.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...l},o)=>e.jsx(Gn,{ref:o,decorative:t,orientation:a,className:Q("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...l}));jt.displayName=Gn.displayName;function lu(){const s=V(t=>t.user.user),a=(s==null?void 0:s.username)||"user";return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-6 rounded-xl overflow-hidden shadow-lg relative",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:"/abstract-layout.jpg",alt:"Background",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/60"})]}),e.jsx("div",{className:"relative z-10 p-8 md:p-12",children:e.jsx("div",{className:"max-w-3xl",children:e.jsxs("div",{className:"text-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ms,{className:"h-5 w-5 text-yellow-300"}),e.jsx("span",{className:"font-medium",children:"Getting Started"})]}),e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-3 tracking-tight",children:["Welcome to Parallels, ",a,"!"]}),e.jsx("p",{className:"text-white/90 text-lg max-w-2xl",children:"Set up your brand to start tracking analytics across your marketing platforms. Connect your accounts to get comprehensive insights all in one place."})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Zo,{})}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(ue,{children:[e.jsxs(bs,{className:"pb-3",children:[e.jsx(Ts,{className:"text-lg font-semibold",children:"Setup Steps"}),e.jsx(ir,{children:"Complete these steps to get started"})]}),e.jsx(he,{className:"space-y-4",children:Mr.map((t,l)=>e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-gray-100 p-1.5 flex-shrink-0 text-gray-600 group-hover:bg-primary/10 group-hover:text-primary transition-colors",children:e.jsx(t.icon,{className:"h-4 w-4"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-sm",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500",children:t.description})]})]}),l<Mr.length-1&&e.jsx("div",{className:"ml-3 pl-3 border-l border-gray-200 h-4 my-1"})]},t.id))})]}),e.jsxs(ue,{children:[e.jsx(bs,{className:"pb-3",children:e.jsx(Ts,{className:"text-lg font-semibold text-blue-800",children:"Pro Tips"})}),e.jsx(he,{children:e.jsxs("ul",{className:"space-y-3 text-sm",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-1 text-blue-600 flex-shrink-0",children:e.jsx(At,{width:14,height:14})}),e.jsx("span",{className:"text-blue-700",children:"Connect multiple platforms for comprehensive analytics across all your marketing channels."})]}),e.jsx(jt,{className:"my-2 bg-blue-100"}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-1 text-blue-600 flex-shrink-0",children:e.jsx(At,{width:14,height:14})}),e.jsx("span",{className:"text-blue-700",children:"Your data will be automatically synced and updated every 3 hours."})]})]})})]})]})]})]})})]})}const pr=[{id:"business-performance",title:"Business Performance",route:"/dashboard",description:"Period wise Metrics Performance"},{id:"report-tab",title:"Report Tab",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",priority:2,relatedTutorials:["age-conversion-report"]},{id:"age-conversion-report",title:"Age Conversion Report",description:"Understanding the age conversion report",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,componentId:"age-report",priority:1},{id:"marketing-insights",title:"Marketing Insights",description:"Understanding the marketing insights iver different months",route:/^\/ad-metrics\/[a-zA-Z0-9]+$/}],iu={"business-performance":[{element:"#analytics-section",popover:{title:"Analytics Overview",description:"This section provides key business metrics such as Sessions, Cart Additions, Checkouts, and Purchases.",position:"top"}},{element:"#sessions-metric",popover:{title:"Sessions Overview",description:`This section shows the total number of sessions on your website:

            - Yesterday: Displays the total sessions for yesterday and its comparison to the previous day.

            - Last 7 Days: Aggregates data for the last 7 days and compares it with the previous 7-day period.

            - Last 30 Days: Shows trends over the last month, compared with the previous 30-day period.`,position:"bottom"}}],"report-tab":[{element:"#report-tab",popover:{title:"Report Tab",description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",position:"bottom"}}],"age-conversion-report":[{element:"#age-report",popover:{title:"Age based Report",description:"Review detailed monthly conversion numbers for each age group here.",position:"top"}},{element:"#age-report-performance",popover:{title:"Key Performers",description:"These metrics highlight your best and worst performing age segments.",position:"left"}},{element:"#age-report-table",popover:{title:"Detailed Data",description:"Analyze session counts, conversion rates, and purchase trends for different age groups over time.",position:"top"}},{element:"#refresh",popover:{title:"Refresh for Updated Values",description:"Refresh to see the latest performance metrics for different age segments",position:"bottom"}},{element:"#filters",popover:{title:"Filter Your Data",description:"Use filters to refine your data by selecting a metric, condition, and value. Click 'Add Filter' to apply.",position:"bottom"}},{element:"#download-button",popover:{title:"Download Your Excel Report",description:"Click to download the report as an Excel file for further analysis.",position:"bottom"}},{element:"#expand-button",popover:{title:"Expand the Table for a Better View",description:"Click to enlarge the table for easier data analysis and readability.",position:"bottom"}}],"marketing-insights":[{element:"#metrics-table",popover:{title:"Monthly Performance Overview",description:"This table displays key performance metrics for each month over the last two years, including ad spend, sales, and ROAS for Meta, Google, and Shopify.",position:"left"}},{element:"#expand-month",popover:{title:"Expand to View Daily Breakdown",description:"Click on a month to expand and see the daily breakdown of ad performance metrics.",position:"top"}}]},cu=s=>pr.filter(a=>typeof a.route=="string"?a.route===s:a.route.test(s)).sort((a,t)=>(t.priority||0)-(a.priority||0)),du=s=>{const a=br(s);return a!=null&&a.steps&&a.steps.length>0?a.steps:iu[s]||[]},br=s=>pr.find(a=>a.id===s),mu=s=>{const a=br(s);return(a==null?void 0:a.relatedTutorials)||[]},uu=s=>{const t=[...cu(s)].sort((c,d)=>(d.priority||0)-(c.priority||0)),l=new Map,o=c=>{if(!l.has(c.id)&&(l.set(c.id,c),c.relatedTutorials&&c.relatedTutorials.length>0))for(const d of c.relatedTutorials){const u=br(d);u&&o(u)}};for(const c of t)o(c);const i=Array.from(l.values());return console.log("Available tutorials:",i.map(c=>c.id).join(", ")),i},hu={};pr.forEach(s=>{hu[s.id]=s.route});const xu=({children:s})=>{const a=Me(),l=tr().pathname,o=V(h=>h.tutorials.isFirstTimeLogin),i=V(h=>h.user.user),c=V(h=>h.tutorials.isTutorialActive),d=V(h=>h.tutorials.tutorialQueue),u=V(h=>h.tutorials.activeTutorial),m=Se.useRef(!1);return r.useEffect(()=>{if(i&&!m.current){const h=i.loginCount===1;console.log("User login status:",{loginCount:i.loginCount,isFirstLogin:h}),a(Cd(h))}},[i,a]),r.useEffect(()=>{console.log("Tutorial queue updated:",{active:u,queueLength:d.length,queue:d})},[u,d]),r.useEffect(()=>{m.current&&u===null&&!c&&(console.log("Tutorial session ended, marking first-time login as complete"),a(kd()))},[u,c,a]),r.useEffect(()=>{if(m.current)return;const h=o&&i&&!c&&d.length===0;if(console.log("Tutorial conditions:",{isFirstTimeLogin:o,hasUser:!!i,isTutorialActive:c,queueLength:d.length,shouldQueueTutorials:h}),h){const v=setTimeout(()=>{const y=uu(l);if(console.log("Available tutorials for path:",{path:l,allTutorials:y}),y.length>0){const S=y.map(x=>x.id);console.log("Queueing tutorials:",S),a(Io(S)),m.current=!0}else console.log("No tutorials available for this path")},1500);return()=>clearTimeout(v)}},[o,i,l,c,d,a]),e.jsx(e.Fragment,{children:s})},gu=()=>{const s=Me(),a=r.useRef(null),t=V(c=>c.tutorials.activeTutorial),l=V(c=>c.tutorials.isTutorialActive),o=V(c=>c.tutorials.activeTutorialStep),i=V(c=>c.tutorials.tutorialQueue);return r.useEffect(()=>{if(t&&l){console.log(`Starting tutorial: ${t}, Queue: [${i.join(", ")}]`);const c=du(t);c&&c.length>0?(a.current&&(a.current.destroy(),a.current=null),setTimeout(()=>{let d=!0;if(c.forEach(m=>{document.querySelector(m.element)||(console.warn(`Element ${m.element} not found for tutorial ${t}`),d=!1)}),!d){console.warn(`Not all elements for tutorial ${t} exist on the page. Moving to next tutorial.`),s(La());return}const u=Nc({showProgress:!0,smoothScroll:!0,animate:!0,allowClose:!0,stagePadding:10,steps:c,onHighlightStarted:m=>{const h=c.findIndex(v=>v.element===(m==null?void 0:m.id));s(Sd(h>=0?h:0))},onDestroyed:()=>{a.current=null;const m=mu(t);m.length>0&&(console.log(`Queueing related tutorials: ${m.join(", ")}`),s(Io(m))),console.log("Moving to next tutorial"),s(La())}});o>0&&o<c.length?u.highlight(c[o]):u.drive(),a.current=u},500)):(console.error(`No steps defined for tutorial: ${t}`),s(La()))}return()=>{a.current&&(a.current.destroy(),a.current=null)}},[t,l,s]),null},Ns=(s={})=>{const{threshold:a=.1,rootMargin:t="0px",triggerOnce:l=!0}=s,o=r.useRef(null),[i,c]=r.useState(!1);return r.useEffect(()=>{const d=o.current;if(!d)return;const u=new IntersectionObserver(([m])=>{m.isIntersecting?(c(!0),l&&u.unobserve(d)):l||c(!1)},{threshold:a,rootMargin:t});return u.observe(d),()=>u.disconnect()},[a,t,l]),{ref:o,isInView:i}},zr=({className:s=""})=>e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:s,children:e.jsx("path",{d:"M12 2C6.477 2 2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.989C18.343 21.129 22 16.99 22 12c0-5.523-4.477-10-10-10z"})}),Br=({className:s=""})=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:s,children:[e.jsx("path",{d:"M22.84 2.9992v17.984c0 .5521-.4479 1-1 1h-2.9861c-.5521 0-1-.4479-1-1V2.9992c0-.552.4479-1 1-1h2.9861c.5521 0 1 .448 1 1z"}),e.jsx("path",{d:"M6.1519 21.9992c-2.2091 0-4-1.7909-4-4 0-2.2092 1.7909-4 4-4 2.2092 0 4 1.7908 4 4 0 2.2091-1.7908 4-4 4z"}),e.jsx("path",{d:"M17.8481 13.1992c-.7416 0-1.3861-.4141-1.7147-1.0229L7.3974 2.8942c-.5066-.9382.1672-2.0929 1.2306-2.1049.4189-.0047.8318.1351 1.1693.4162l8.7461 7.2863c.5282.4399.831 1.0909.831 1.7854v.922c0 1.1046-.8954 2-2 2h-.5263z"})]}),Gr=({className:s=""})=>e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:s,children:e.jsx("path",{d:"M15.337 3.415c-.022-.146-.134-.238-.268-.252-.134-.014-2.96-.219-2.96-.219s-1.97-1.964-2.188-2.179c-.217-.216-.64-.152-.805-.103-.022 0-.43.132-1.09.342C7.526.489 6.9.133 6.167.133 4.525.133 3.666 1.728 3.315 3.056c-.955.296-1.629.504-1.717.534-.534.168-.55.186-.62.69C.909 4.74 0 12.47 0 12.47l11.281 2.47 6.106-1.474s-2.028-9.903-2.05-10.051z"})}),fu=[{icon:js,title:"Inconsistent metrics across platforms",description:"Meta shows one story, GA4 another, and Shopify something entirely different."},{icon:Si,title:"Limited visibility into the full customer journey",description:"Understanding how customers move from discovery to purchase remains fragmented."},{icon:fa,title:"Time-intensive reporting processes",description:"Hours spent exporting, cleaning, and reconciling data from multiple sources."},{icon:ki,title:"Difficulty connecting marketing to sales",description:"Linking advertising spend to actual revenue outcomes is often unclear."}],pu=["Which channels are contributing most effectively to revenue?","How do marketing efforts influence customer purchasing behaviour?","Where should budgets be allocated for efficient growth?"],bu=()=>{const{ref:s,isInView:a}=Ns({threshold:.1}),{ref:t,isInView:l}=Ns({threshold:.1});return e.jsxs("section",{className:"bg-section-gradient py-24 lg:py-32 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-30",children:[e.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-1/2 bg-gradient-radial from-accent/5 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-1/3 h-1/3 bg-gradient-radial from-brand-coral/5 to-transparent"})]}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-16 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-foreground mb-6",children:["Modern ecommerce requires"," ",e.jsx("span",{className:"text-gradient",children:"aligned data."})]}),e.jsx("p",{className:"text-lg text-muted-foreground leading-relaxed",children:"Ecommerce teams rely on multiple platforms to drive growth  advertising platforms to acquire customers, analytics tools to track behaviour, and ecommerce platforms to process revenue. However, when these systems operate independently, it becomes difficult to answer key questions."})]}),e.jsx("div",{className:"max-w-6xl mx-auto mb-20",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-stretch",children:[e.jsx("div",{className:`relative ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.2s"},children:e.jsxs("div",{className:"bg-card border border-brand-coral/30 rounded-2xl p-8 relative overflow-hidden h-full group hover:border-brand-coral/50 transition-all",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-coral/5 to-transparent opacity-50"}),e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-brand-coral/10 rounded-full blur-3xl animate-pulse"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-brand-coral animate-pulse"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Without unified data"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("div",{className:"flex-1 p-4 bg-[#1877F2]/10 rounded-xl border border-[#1877F2]/20 opacity-60 group-hover:opacity-80 transition-all transform group-hover:-translate-x-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(zr,{className:"w-4 h-4 text-[#1877F2]"}),e.jsx("span",{className:"text-xs font-medium text-[#1877F2]",children:"Meta Pixel"})]}),e.jsx("div",{className:"h-8 bg-[#1877F2]/20 rounded flex items-end p-1 gap-0.5",children:[30,50,40,60,45].map((o,i)=>e.jsx("div",{className:"flex-1 bg-[#1877F2]/50 rounded-t",style:{height:`${o}%`}},i))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Shows: 2,400 conversions"})]}),e.jsxs("div",{className:"flex flex-col gap-1 opacity-30",children:[e.jsx("div",{className:"w-4 h-0.5 bg-brand-coral"}),e.jsx("div",{className:"w-4 h-0.5 bg-brand-coral animate-pulse"})]}),e.jsxs("div",{className:"flex-1 p-4 bg-[#F9AB00]/10 rounded-xl border border-[#F9AB00]/20 opacity-60 group-hover:opacity-80 transition-all transform group-hover:translate-x-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Br,{className:"w-4 h-4 text-[#F9AB00]"}),e.jsx("span",{className:"text-xs font-medium text-[#F9AB00]",children:"GA4"})]}),e.jsx("div",{className:"h-8 bg-[#F9AB00]/20 rounded flex items-end p-1 gap-0.5",children:[45,35,55,40,50].map((o,i)=>e.jsx("div",{className:"flex-1 bg-[#F9AB00]/50 rounded-t",style:{height:`${o}%`}},i))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Shows: 1,800 conversions"})]})]}),e.jsxs("div",{className:"p-4 bg-[#96BF48]/10 rounded-xl border border-[#96BF48]/20 opacity-60 group-hover:opacity-80 transition-all transform group-hover:translate-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Gr,{className:"w-4 h-4 text-[#96BF48]"}),e.jsx("span",{className:"text-xs font-medium text-[#96BF48]",children:"Shopify"})]}),e.jsx("div",{className:"h-8 bg-[#96BF48]/20 rounded flex items-end p-1 gap-0.5",children:[55,40,65,50,70].map((o,i)=>e.jsx("div",{className:"flex-1 bg-[#96BF48]/50 rounded-t",style:{height:`${o}%`}},i))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Shows: 1,234 orders"})]}),e.jsx("div",{className:"flex items-center gap-4 pt-4 border-t border-border/50",children:e.jsxs("div",{className:"flex items-center gap-2 text-brand-coral",children:[e.jsx(js,{size:16,className:"animate-pulse"}),e.jsx("span",{className:"text-xs font-medium",children:"Data mismatch detected"})]})}),e.jsxs("p",{className:"text-sm text-brand-coral font-medium flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-1 h-1 rounded-full bg-brand-coral animate-pulse"}),"Disconnected. Conflicting. Time-consuming."]})]})]})]})}),e.jsx("div",{className:"hidden lg:flex items-center justify-center absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-20",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-accent-gradient flex items-center justify-center shadow-lg animate-pulse",children:e.jsx(Ss,{size:24,className:"text-primary-foreground"})})}),e.jsx("div",{className:`relative ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.4s"},children:e.jsxs("div",{className:"bg-card border border-accent/30 rounded-2xl p-8 relative overflow-hidden glow-blue h-full group hover:border-accent/50 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-accent/15 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-brand-green/10 rounded-full blur-2xl animate-float",style:{animationDelay:"1s"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-brand-green animate-pulse"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"With Parallels"}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 px-2 py-1 bg-brand-green/10 rounded-full",children:[e.jsx(Tt,{size:12,className:"text-brand-green"}),e.jsx("span",{className:"text-xs text-brand-green font-medium",children:"Live"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 py-3 bg-accent/5 rounded-xl border border-accent/20",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#1877F2]/20 flex items-center justify-center animate-float",style:{animationDelay:"0s"},children:e.jsx(zr,{className:"w-4 h-4 text-[#1877F2]"})}),e.jsx("div",{className:"flex gap-1",children:[...Array(3)].map((o,i)=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-accent animate-pulse",style:{animationDelay:`${i*.2}s`}},i))}),e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#F9AB00]/20 flex items-center justify-center animate-float",style:{animationDelay:"0.2s"},children:e.jsx(Br,{className:"w-4 h-4 text-[#F9AB00]"})}),e.jsx("div",{className:"flex gap-1",children:[...Array(3)].map((o,i)=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-brand-green animate-pulse",style:{animationDelay:`${i*.2+.3}s`}},i))}),e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#96BF48]/20 flex items-center justify-center animate-float",style:{animationDelay:"0.4s"},children:e.jsx(Gr,{className:"w-4 h-4 text-[#96BF48]"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-accent/10 rounded-xl border border-accent/20 text-center group-hover:scale-105 transition-transform",children:[e.jsx(ys,{size:16,className:"text-accent mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:"$124K"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Revenue"})]}),e.jsxs("div",{className:"p-3 bg-brand-green/10 rounded-xl border border-brand-green/20 text-center group-hover:scale-105 transition-transform",style:{transitionDelay:"0.1s"},children:[e.jsx(Qe,{size:16,className:"text-brand-green mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:"4.2x"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ROAS"})]}),e.jsxs("div",{className:"p-3 bg-brand-amber/10 rounded-xl border border-brand-amber/20 text-center group-hover:scale-105 transition-transform",style:{transitionDelay:"0.2s"},children:[e.jsx(Qa,{size:16,className:"text-brand-amber mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:"1,234"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Orders"})]})]}),e.jsxs("div",{className:"h-20 bg-gradient-to-r from-accent/10 via-brand-green/10 to-brand-amber/10 rounded-xl p-3 relative overflow-hidden",children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"unifiedChartLine",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(217, 91%, 60%)"}),e.jsx("stop",{offset:"50%",stopColor:"hsl(160, 84%, 39%)"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(38, 92%, 50%)"})]})}),e.jsx("path",{d:"M 0 60 Q 40 50 80 45 T 160 35 T 240 25 T 320 20 T 400 15",fill:"none",stroke:"url(#unifiedChartLine)",strokeWidth:"3",strokeLinecap:"round",style:{strokeDasharray:500,strokeDashoffset:500,animation:"drawLine 2s ease-out forwards"}})]}),e.jsxs("div",{className:"absolute bottom-2 right-3 flex items-center gap-1 text-brand-green",children:[e.jsx(Qe,{size:12}),e.jsx("span",{className:"text-xs font-medium",children:"+18.2%"})]})]}),e.jsxs("p",{className:"text-sm text-brand-green font-medium flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-brand-green animate-pulse"}),"Connected. Aligned. Actionable."]})]})]})]})})]})}),e.jsx("div",{className:"max-w-3xl mx-auto mb-16",children:e.jsxs("div",{className:"bg-black rounded-2xl p-8 text-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-mesh-gradient opacity-30"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-foreground mb-6",children:"Key questions teams struggle to answer:"}),e.jsx("ul",{className:"space-y-4",children:pu.map((o,i)=>e.jsxs("li",{className:`flex items-center gap-4 text-primary-foreground/80 ${l?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${i*.1}s`},children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-accent/20 flex items-center justify-center text-sm font-bold text-accent",children:i+1}),e.jsx("span",{className:"text-left",children:o})]},i))})]})]})}),e.jsx("div",{ref:t,className:"grid md:grid-cols-2 gap-6 max-w-5xl mx-auto",children:fu.map((o,i)=>e.jsx("div",{className:`bg-card border border-border rounded-xl p-6 card-hover group ${l?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${i*.1}s`},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand-coral/10 flex items-center justify-center flex-shrink-0 group-hover:scale-110 group-hover:bg-brand-coral/20 transition-all",children:e.jsx(o.icon,{size:24,className:"text-brand-coral"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground mb-2 group-hover:text-brand-coral transition-colors",children:o.title}),e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:o.description})]})]})},i))}),e.jsx("div",{className:"max-w-2xl mx-auto text-center mt-16",children:e.jsxs("p",{className:"text-xl md:text-2xl text-foreground font-medium",children:["Parallels brings these data sources together to create"," ",e.jsx("span",{className:"text-gradient",children:"clarity and alignment."})]})})]}),e.jsx("style",{children:`
        @keyframes drawLine {
          to {
            stroke-dashoffset: 0;
          }
        }
      `})]})},Xo=r.createContext(null);function Ta(){const s=r.useContext(Xo);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const el=r.forwardRef(({orientation:s="horizontal",opts:a,setApi:t,plugins:l,className:o,children:i,...c},d)=>{const[u,m]=wc({...a,axis:s==="horizontal"?"x":"y"},l),[h,v]=r.useState(!1),[y,S]=r.useState(!1),x=r.useCallback(w=>{w&&(v(w.canScrollPrev()),S(w.canScrollNext()))},[]),p=r.useCallback(()=>{m==null||m.scrollPrev()},[m]),N=r.useCallback(()=>{m==null||m.scrollNext()},[m]),j=r.useCallback(w=>{w.key==="ArrowLeft"?(w.preventDefault(),p()):w.key==="ArrowRight"&&(w.preventDefault(),N())},[p,N]);return r.useEffect(()=>{!m||!t||t(m)},[m,t]),r.useEffect(()=>{if(m)return x(m),m.on("reInit",x),m.on("select",x),()=>{m==null||m.off("select",x)}},[m,x]),e.jsx(Xo.Provider,{value:{carouselRef:u,api:m,opts:a,orientation:s||((a==null?void 0:a.axis)==="y"?"vertical":"horizontal"),scrollPrev:p,scrollNext:N,canScrollPrev:h,canScrollNext:y},children:e.jsx("div",{ref:d,onKeyDownCapture:j,className:Q("relative",o),role:"region","aria-roledescription":"carousel",...c,children:i})})});el.displayName="Carousel";const sl=r.forwardRef(({className:s,...a},t)=>{const{carouselRef:l,orientation:o}=Ta();return e.jsx("div",{ref:l,className:"overflow-hidden",children:e.jsx("div",{ref:t,className:Q("flex",o==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...a})})});sl.displayName="CarouselContent";const tl=r.forwardRef(({className:s,...a},t)=>{const{orientation:l}=Ta();return e.jsx("div",{ref:t,role:"group","aria-roledescription":"slide",className:Q("min-w-0 shrink-0 grow-0 basis-full",l==="horizontal"?"pl-4":"pt-4",s),...a})});tl.displayName="CarouselItem";const ju=r.forwardRef(({className:s,variant:a="outline",size:t="icon",...l},o)=>{const{orientation:i,scrollPrev:c,canScrollPrev:d}=Ta();return e.jsxs(z,{ref:o,variant:a,size:t,className:Q("absolute  h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:c,...l,children:[e.jsx(Ai,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});ju.displayName="CarouselPrevious";const yu=r.forwardRef(({className:s,variant:a="outline",size:t="icon",...l},o)=>{const{orientation:i,scrollNext:c,canScrollNext:d}=Ta();return e.jsxs(z,{ref:o,variant:a,size:t,className:Q("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:c,...l,children:[e.jsx(Ss,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});yu.displayName="CarouselNext";const Ur={accent:"text-brand-blue border-brand-blue bg-brand-blue/10","brand-green":"text-brand-green border-brand-green bg-brand-green/10","brand-amber":"text-brand-amber border-brand-amber bg-brand-amber/10","brand-coral":"text-brand-coral border-brand-coral bg-brand-coral/10"},tt=[{icon:Wn,title:"Marketing Insights",bullets:["Unified view across Shopify, Meta & Google","2 years historical data","Identify top & underperforming channels"],color:"accent"},{icon:Ls,title:"Festival Calendar",bullets:["Add regional & special festivals","See sales spikes on hover","Plan campaigns around key dates"],color:"brand-amber"},{icon:Kn,title:"Speed Insights",bullets:["Analyze any URL performance","LCP, FID, CLS metrics","Find conversion bottlenecks"],color:"brand-green"},{icon:bt,title:"D2C Calculator",bullets:["Real-time EBITDA tracking","Factor all costs & revenue","True profitability insights"],color:"accent"},{icon:ya,title:"Creative Library",bullets:["Track all ad creatives","Compare spend, ROAS, engagement","Spot creative fatigue early"],color:"brand-coral"},{icon:Qn,title:"Ad Market",bullets:["Monitor competitor ads","Track their strategies over time","Stay ahead of trends"],color:"brand-amber"},{icon:ys,title:"Ad Metrics Dashboard",bullets:["Meta & Google unified view","Spend, ROAS, CTR, CPC","Daily & monthly trends"],color:"accent"},{icon:Qa,title:"E-commerce Metrics",bullets:["Full funnel: Sessions  Purchase","COD/Prepaid & returning customers","Identify funnel drop-offs"],color:"brand-green"},{icon:Mi,title:"Conversion Reports",bullets:["Segment by demographics & device","Channel & campaign analysis","Understand who converts"],color:"brand-coral"},{icon:Is,title:"Meta Ads Analytics",bullets:["Campaign-level insights","Interest & demographic breakdown","Placement performance"],color:"accent"},{icon:Cs,title:"Google Ads Analytics",bullets:["Search terms & keywords","Cost per conversion tracking","Product-level performance"],color:"brand-amber"},{icon:kt,title:"Product Analytics",bullets:["Page & product performance","Landing page analysis","Top performers identification"],color:"brand-green"},{icon:Ti,title:"Bounce Rate Analytics",bullets:["Monthly bounce trends","Collection & product segmentation","Optimize user experience"],color:"brand-coral"}],Vr=({index:s,isActive:a})=>{const t=tt[s],l=t.color==="accent"?"brand-blue":t.color==="brand-green"?"brand-green":t.color==="brand-amber"?"brand-amber":"brand-coral",o="bg-"+l,i="text-"+l;return e.jsx("div",{className:`w-full h-full flex items-center justify-center transition-all duration-500 ${a?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:`absolute inset-0 ${o}/20 rounded-3xl blur-3xl`}),e.jsxs("div",{className:"relative bg-card/80 backdrop-blur-sm rounded-2xl border border-border/50 p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl ${o}/20 flex items-center justify-center`,children:e.jsx(t.icon,{className:`w-7 h-7 ${i}`})}),e.jsx("h4",{className:"text-2xl font-bold text-foreground",children:t.title})]}),e.jsx("div",{className:"min-h-[180px]",children:e.jsx(vu,{index:s,colorClass:l,isActive:a})}),e.jsx("div",{className:"mt-6 space-y-3",children:t.bullets.map((c,d)=>e.jsxs("div",{className:"flex items-start gap-3",style:{opacity:a?1:0,transform:a?"translateX(0)":"translateX(-10px)",transition:`all 0.4s ease-out ${d*.1}s`},children:[e.jsx("div",{className:`w-2 h-2 rounded-full bg-${l} mt-2 flex-shrink-0`}),e.jsx("span",{className:"text-base text-muted-foreground",children:c})]},d))})]})]})})},vu=({index:s,isActive:a})=>{const t={0:e.jsx("div",{className:"flex items-end gap-3 h-24 px-2",children:[{label:"Meta",value:85,color:"bg-[#1877F2]"},{label:"Google",value:65,color:"bg-[#F9AB00]"},{label:"Shopify",value:95,color:"bg-[#96BF48]"}].map((l,o)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-secondary/50 rounded-t-lg overflow-hidden h-20 flex items-end",children:e.jsx("div",{className:`w-full ${l.color} rounded-t-lg transition-all duration-700`,style:{height:a?`${l.value}%`:"0%",transitionDelay:`${o*100}ms`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l.label})]},o))}),1:e.jsx("div",{className:"grid grid-cols-7 gap-1 p-2",children:[...Array(21)].map((l,o)=>{const i=[6,7,13,14,20].includes(o)?"bg-brand-amber":[5,12,19].includes(o)?"bg-brand-amber/50":"bg-secondary/50";return e.jsx("div",{className:`aspect-square rounded ${i} transition-all duration-300`,style:{opacity:a?1:0,transform:a?"scale(1)":"scale(0.5)",transitionDelay:`${o*20}ms`}},o)})}),2:e.jsx("div",{className:"flex justify-center py-2",children:e.jsxs("div",{className:"relative w-28 h-16 overflow-hidden",children:[e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 50",children:[e.jsx("path",{d:"M 10 50 A 40 40 0 0 1 90 50",fill:"none",stroke:"hsl(var(--muted))",strokeWidth:"8",strokeLinecap:"round"}),e.jsx("path",{d:"M 10 50 A 40 40 0 0 1 90 50",fill:"none",stroke:"hsl(var(--brand-green))",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:a?"100 126":"0 126",className:"transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 text-center",children:[e.jsx("span",{className:"text-lg font-bold text-brand-green",children:"92"}),e.jsx("span",{className:"text-xs text-muted-foreground block",children:"Score"})]})]})}),3:e.jsx("div",{className:"space-y-2 py-2",children:[{label:"Revenue",value:85,color:"bg-brand-green"},{label:"Costs",value:45,color:"bg-brand-coral"},{label:"EBITDA",value:40,color:"bg-accent"}].map((l,o)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground w-16",children:l.label}),e.jsx("div",{className:"flex-1 h-4 bg-secondary/50 rounded overflow-hidden",children:e.jsx("div",{className:`h-full ${l.color} rounded transition-all duration-700`,style:{width:a?`${l.value}%`:"0%",transitionDelay:`${o*100}ms`}})})]},o))}),4:e.jsx("div",{className:"grid grid-cols-3 gap-2 py-2",children:[{status:"Top",color:"bg-brand-green"},{status:"Good",color:"bg-accent"},{status:"Fatigue",color:"bg-brand-coral"}].map((l,o)=>e.jsx("div",{className:"aspect-video bg-secondary/50 rounded-lg border border-border/50 flex items-end p-1.5 transition-all duration-500",style:{opacity:a?1:0,transform:a?"translateY(0)":"translateY(10px)",transitionDelay:`${o*100}ms`},children:e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${l.color} text-primary-foreground`,children:l.status})},o))}),5:e.jsx("div",{className:"flex gap-2 py-2 overflow-hidden",children:[1,2,3].map((l,o)=>e.jsxs("div",{className:"flex-1 bg-secondary/50 rounded-lg p-2 border border-border/50 transition-all duration-500",style:{opacity:a?1:0,transform:a?"translateX(0)":"translateX(20px)",transitionDelay:`${o*100}ms`},children:[e.jsx("div",{className:"w-6 h-6 bg-brand-amber/30 rounded mb-2"}),e.jsx("div",{className:"h-1.5 bg-brand-amber/50 rounded w-full mb-1"}),e.jsx("div",{className:"h-1.5 bg-brand-amber/30 rounded w-2/3"})]},o))}),6:e.jsxs("div",{className:"h-20 relative py-2",children:[e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 200 60",preserveAspectRatio:"none",children:[e.jsx("path",{d:a?"M 0 50 Q 30 45 50 35 T 100 30 T 150 20 T 200 15":"M 0 50 L 200 50",fill:"none",stroke:"hsl(var(--accent))",strokeWidth:"2",className:"transition-all duration-1000"}),e.jsx("path",{d:a?"M 0 55 Q 40 50 60 45 T 120 40 T 180 35 T 200 30":"M 0 55 L 200 55",fill:"none",stroke:"hsl(var(--brand-green))",strokeWidth:"2",strokeDasharray:"4 2",className:"transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex gap-3 text-[10px]",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-0.5 bg-accent"})," Meta"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-0.5 bg-brand-green"})," Google"]})]})]}),7:e.jsx("div",{className:"flex flex-col items-center gap-1 py-2",children:[{label:"Sessions",width:"100%"},{label:"ATC",width:"65%"},{label:"Checkout",width:"40%"},{label:"Purchase",width:"25%"}].map((l,o)=>e.jsx("div",{className:"h-5 bg-gradient-to-r from-accent to-brand-green rounded flex items-center justify-center transition-all duration-500",style:{width:a?l.width:"0%",transitionDelay:`${o*100}ms`},children:e.jsx("span",{className:"text-[9px] text-primary-foreground font-medium truncate px-1",children:l.label})},o))}),8:e.jsx("div",{className:"grid grid-cols-2 gap-2 py-2",children:["Age 25-34","Mobile","Instagram","Female"].map((l,o)=>e.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 border border-border/50 flex items-center justify-between transition-all duration-500",style:{opacity:a?1:0,transitionDelay:`${o*80}ms`},children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:l}),e.jsxs("span",{className:"text-xs font-medium text-brand-coral",children:[(3.2+o*.5).toFixed(1),"%"]})]},o))}),9:e.jsx("div",{className:"space-y-2 py-2",children:["Prospecting","Retargeting","Lookalike"].map((l,o)=>e.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 flex items-center justify-between transition-all duration-500",style:{opacity:a?1:0,transform:a?"translateX(0)":"translateX(-10px)",transitionDelay:`${o*100}ms`},children:[e.jsx("span",{className:"text-xs text-foreground",children:l}),e.jsxs("span",{className:"text-xs font-medium text-accent-foreground/50",children:[(2.8+o*.6).toFixed(1),"x ROAS"]})]},o))}),10:e.jsx("div",{className:"space-y-2 py-2",children:["brand shoes","+running","[sneakers online]"].map((l,o)=>e.jsxs("div",{className:"flex items-center gap-2 transition-all duration-500",style:{opacity:a?1:0,transitionDelay:`${o*100}ms`},children:[e.jsx("span",{className:"text-xs bg-brand-amber/20 text-brand-amber px-2 py-1 rounded font-mono",children:l}),e.jsx("div",{className:"flex-1 h-1.5 bg-secondary/50 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-brand-amber rounded",style:{width:`${80-o*15}%`}})})]},o))}),11:e.jsx("div",{className:"flex items-end gap-2 h-20 px-2 py-2",children:["PDP 1","PDP 2","LP 1","LP 2"].map((l,o)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-secondary/50 rounded-t-lg overflow-hidden h-16 flex items-end",children:e.jsx("div",{className:"w-full bg-brand-green rounded-t-lg transition-all duration-700",style:{height:a?`${90-o*15}%`:"0%",transitionDelay:`${o*80}ms`}})}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:l})]},o))}),12:e.jsxs("div",{className:"h-20 relative py-2",children:[e.jsx("svg",{className:"w-full h-full",viewBox:"0 0 200 60",preserveAspectRatio:"none",children:e.jsx("path",{d:a?"M 0 20 Q 30 25 60 35 T 120 30 T 160 40 T 200 25":"M 0 40 L 200 40",fill:"none",stroke:"hsl(var(--brand-coral))",strokeWidth:"2",className:"transition-all duration-1000"})}),e.jsxs("div",{className:"absolute top-1 right-1 flex items-center gap-1 px-2 py-0.5 bg-brand-green/20 rounded",children:[e.jsx(Qe,{size:10,className:"text-brand-green"}),e.jsx("span",{className:"text-[10px] text-brand-green",children:"-12%"})]})]})};return t[s]||t[0]},Nu=()=>{const[s,a]=r.useState(0),{ref:t,isInView:l}=Ns({threshold:.2,triggerOnce:!0}),o=r.useRef(null),i=c=>{o.current&&o.current.scrollBy({left:c==="left"?-120:120,behavior:"smooth"})};return e.jsxs("section",{ref:t,id:"features",className:"py-16 md:py-20 relative overflow-hidden bg-section-gradient",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/2 left-1/4 w-64 h-64 bg-accent/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-48 h-48 bg-brand-green/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"container mx-auto px-4 relative",children:[e.jsxs("div",{className:`text-center mb-10 transition-all duration-700 ${l?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,children:[e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-brand-blue/10 text-brand-blue text-sm font-medium mb-4",children:[e.jsx(Ms,{size:14}),"13 Powerful Features"]}),e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-foreground mb-3",children:"Everything You Need to Scale"}),e.jsx("p",{className:"text-muted-foreground max-w-xl mx-auto",children:"Comprehensive analytics suite for modern D2C brands"})]}),e.jsxs("div",{className:"hidden lg:grid lg:grid-cols-12 lg:gap-6 lg:items-center",children:[e.jsx("div",{className:"lg:col-span-3 space-y-1",children:tt.slice(0,7).map((c,d)=>{const u=s===d,m=Ur[c.color]||Ur.accent;return e.jsxs("button",{onClick:()=>a(d),className:`w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-left transition-all duration-300 group border-l-2 ${u?m:"hover:bg-secondary/50 border-transparent text-muted-foreground"}`,children:[e.jsx("div",{className:`w-7 h-7 rounded-lg flex items-center justify-center transition-colors flex-shrink-0 ${u?"bg-current/20":"bg-secondary"}`,children:e.jsx(c.icon,{className:`w-3.5 h-3.5 ${u?"":"group-hover:text-foreground"}`})}),e.jsx("span",{className:`text-sm font-medium transition-colors truncate ${u?"text-foreground":"group-hover:text-foreground"}`,children:c.title})]},d)})}),e.jsx("div",{className:"lg:col-span-6 relative min-h-[480px] flex items-center justify-center",children:tt.map((c,d)=>e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${s===d?"z-10":"z-0 pointer-events-none"}`,children:e.jsx(Vr,{index:d,isActive:s===d})},d))}),e.jsx("div",{className:"lg:col-span-3 space-y-1",children:tt.slice(7).map((c,d)=>{const u=d+7,m=s===u,h=c.color==="accent"?"accent-foreground":c.color==="brand-green"?"brand-green":c.color==="brand-amber"?"brand-amber":"brand-coral";return e.jsxs("button",{onClick:()=>a(u),className:`w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-left transition-all duration-300 group ${m?`bg-${h}/10 border-r-2 border-${h}`:"hover:bg-secondary/50 border-r-2 border-transparent"}`,children:[e.jsx("div",{className:`w-7 h-7 rounded-lg flex items-center justify-center transition-colors flex-shrink-0 ${m?`bg-${h}/20`:"bg-secondary"}`,children:e.jsx(c.icon,{className:`w-3.5 h-3.5 transition-colors ${m?`text-${h}`:"text-muted-foreground group-hover:text-foreground"}`})}),e.jsx("span",{className:`text-sm font-medium transition-colors truncate ${m?"text-foreground":"text-muted-foreground group-hover:text-foreground"}`,children:c.title})]},u)})})]}),e.jsxs("div",{className:"lg:hidden",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("button",{onClick:()=>i("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 bg-background/90 border border-border rounded-full flex items-center justify-center shadow-lg",children:e.jsx(us,{size:16})}),e.jsx("div",{ref:o,className:"flex gap-2 overflow-x-auto scrollbar-hide px-8 py-2 snap-x snap-mandatory",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:tt.map((c,d)=>{const u=s===d,m=c.color==="accent"?"accent":c.color==="brand-green"?"brand-green":c.color==="brand-amber"?"brand-amber":"brand-coral";return e.jsxs("button",{onClick:()=>a(d),className:`flex-shrink-0 flex items-center gap-2 px-3 py-2 rounded-full transition-all duration-300 snap-center ${u?`bg-${m}/20 border border-${m}/50`:"bg-secondary/50 border border-transparent"}`,children:[e.jsx(c.icon,{className:`w-4 h-4 ${u?`text-${m}`:"text-muted-foreground"}`}),e.jsx("span",{className:`text-xs font-medium whitespace-nowrap ${u?"text-foreground":"text-muted-foreground"}`,children:c.title})]},d)})}),e.jsx("button",{onClick:()=>i("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 bg-background/90 border border-border rounded-full flex items-center justify-center shadow-lg",children:e.jsx(Je,{size:16})})]}),e.jsx(el,{opts:{align:"center",loop:!0},className:"w-full",children:e.jsx(sl,{children:tt.map((c,d)=>e.jsx(tl,{className:"basis-full",children:e.jsx("div",{onClick:()=>a(d),className:"px-4",children:e.jsx(Vr,{index:d,isActive:!0})})},d))})}),e.jsx("div",{className:"flex justify-center gap-1.5 mt-4",children:tt.map((c,d)=>e.jsx("button",{onClick:()=>a(d),className:`w-2 h-2 rounded-full transition-all ${s===d?"bg-accent w-6":"bg-muted-foreground/30"}`},d))})]})]})]})},wu=()=>{const{ref:s,isInView:a}=Ns({threshold:.2});return e.jsxs("section",{className:"relative py-24 lg:py-32 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-black to-accent/30"}),e.jsx("div",{className:"absolute inset-0 bg-mesh-gradient opacity-50"}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-accent/20 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-brand-green/20 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute inset-0 opacity-5",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"linear-gradient(hsl(var(--primary-foreground) / 0.1) 1px, transparent 1px), linear-gradient(90deg, hsl(var(--primary-foreground) / 0.1) 1px, transparent 1px)",backgroundSize:"50px 50px"}})}),e.jsx("div",{className:"container mx-auto px-6 relative z-10",children:e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary-foreground/10 border border-primary-foreground/20 mb-8",children:[e.jsx(Ms,{size:14,className:"text-accent"}),e.jsx("span",{className:"text-sm font-medium text-primary-foreground",children:"Ready to transform your analytics?"})]}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-primary-foreground mb-6 leading-tight",children:["Build growth strategies on"," ",e.jsx("span",{className:"text-gradient",children:"aligned data."})]}),e.jsx("p",{className:"text-lg md:text-xl text-primary-foreground/70 mb-10 max-w-2xl mx-auto leading-relaxed",children:"Parallels helps ecommerce teams make confident, revenue-focused decisions by connecting marketing activity with real business outcomes."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(z,{size:"lg",className:"bg-primary-foreground text-black hover:bg-primary-foreground/90 gap-2 hover:shadow-primary-foreground/25 transition-all group text-lg px-8",children:["Request a Demo",e.jsx(Ss,{size:20,className:"group-hover:translate-x-1 transition-transform"})]}),e.jsx(z,{size:"lg",className:"bg-accent-gradient text-primary-foreground hover:opacity-90 transition-all hover:shadow-accent/25 text-lg px-8",children:"Join Early Access Program"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mt-12 pt-12 border-t border-primary-foreground/10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-foreground",children:"5 min"}),e.jsx("div",{className:"text-sm text-primary-foreground/50",children:"Setup time"})]}),e.jsx("div",{className:"w-px h-10 bg-primary-foreground/10"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-foreground",children:"No code"}),e.jsx("div",{className:"text-sm text-primary-foreground/50",children:"Required"})]}),e.jsx("div",{className:"w-px h-10 bg-primary-foreground/10"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-foreground",children:"Free"}),e.jsx("div",{className:"text-sm text-primary-foreground/50",children:"Trial"})]})]})]})})]})},Cu=()=>{const s=Xe(),{ref:a,isInView:t}=Ns({threshold:.1}),[l,o]=r.useState({x:0,y:0});return r.useEffect(()=>{const i=c=>{const d=(c.clientX/window.innerWidth-.5)*2,u=(c.clientY/window.innerHeight-.5)*2;o({x:d,y:u})};return window.addEventListener("mousemove",i),()=>window.removeEventListener("mousemove",i)},[]),e.jsxs("section",{className:"relative min-h-screen flex items-center overflow-hidden bg-hero-gradient",children:[e.jsxs("div",{className:"absolute inset-0 transition-transform duration-300 ease-out",style:{transform:`translate(${l.x*-10}px, ${l.y*-10}px)`},children:[e.jsx("div",{className:"absolute top-[10%] left-[15%] w-[400px] h-[400px] bg-brand-blue/15 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[20%] right-[10%] w-[350px] h-[350px] bg-brand-green/10 rounded-full blur-[80px]"})]}),e.jsx("div",{className:"absolute inset-0 transition-transform duration-500 ease-out",style:{transform:`translate(${l.x*-20}px, ${l.y*-20}px)`},children:e.jsx("div",{className:"absolute top-[40%] right-[30%] w-[500px] h-[500px] bg-brand-blue/8 rounded-full blur-[120px]"})}),e.jsx("div",{className:"absolute top-[15%] left-[8%] transition-transform duration-700 ease-out",style:{transform:`translate(${l.x*30}px, ${l.y*30}px)`},children:e.jsx("div",{className:"glass-dark rounded-xl p-4 border border-primary-foreground/10 animate-float opacity-60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-blue/20 flex items-center justify-center",children:e.jsx(ys,{size:18,className:"text-brand-blue"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-primary-foreground/50",children:"Revenue"}),e.jsx("p",{className:"text-sm font-bold text-primary-foreground",children:"$847K"})]})]})})}),e.jsx("div",{className:"absolute top-[25%] right-[12%] transition-transform duration-700 ease-out",style:{transform:`translate(${l.x*25}px, ${l.y*25}px)`},children:e.jsx("div",{className:"glass-dark rounded-xl p-4 border border-primary-foreground/10 animate-float opacity-60",style:{animationDelay:"1s"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-green/20 flex items-center justify-center",children:e.jsx(Qe,{size:18,className:"text-brand-green"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-primary-foreground/50",children:"ROAS"}),e.jsx("p",{className:"text-sm font-bold text-primary-foreground",children:"4.2x"})]})]})})}),e.jsx("div",{className:"absolute bottom-[20%] left-[12%] transition-transform duration-700 ease-out",style:{transform:`translate(${l.x*35}px, ${l.y*35}px)`},children:e.jsx("div",{className:"glass-dark rounded-xl p-4 border border-primary-foreground/10 animate-float opacity-60",style:{animationDelay:"2s"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-amber/20 flex items-center justify-center",children:e.jsx(Is,{size:18,className:"text-brand-amber"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-primary-foreground/50",children:"CAC"}),e.jsx("p",{className:"text-sm font-bold text-primary-foreground",children:"$24.50"})]})]})})}),e.jsx("div",{className:"absolute bottom-[30%] right-[8%] transition-transform duration-700 ease-out",style:{transform:`translate(${l.x*40}px, ${l.y*40}px)`},children:e.jsx("div",{className:"glass-dark rounded-xl p-4 border border-primary-foreground/10 animate-float opacity-60",style:{animationDelay:"1.5s"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-coral/20 flex items-center justify-center",children:e.jsx(Ms,{size:18,className:"text-brand-coral"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-primary-foreground/50",children:"LTV"}),e.jsx("p",{className:"text-sm font-bold text-primary-foreground",children:"$186"})]})]})})}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none opacity-20",preserveAspectRatio:"xMidYMid slice",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"lineGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:"0"}),e.jsx("stop",{offset:"50%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(160, 84%, 39%)",stopOpacity:"0"})]})}),e.jsx("path",{d:"M 10% 20% Q 30% 35% 50% 50%",fill:"none",stroke:"url(#lineGrad)",strokeWidth:"1",className:"data-line"}),e.jsx("path",{d:"M 90% 25% Q 70% 40% 50% 50%",fill:"none",stroke:"url(#lineGrad)",strokeWidth:"1",className:"data-line",style:{animationDelay:"0.5s"}}),e.jsx("path",{d:"M 15% 75% Q 35% 60% 50% 50%",fill:"none",stroke:"url(#lineGrad)",strokeWidth:"1",className:"data-line",style:{animationDelay:"1s"}}),e.jsx("path",{d:"M 88% 70% Q 70% 60% 50% 50%",fill:"none",stroke:"url(#lineGrad)",strokeWidth:"1",className:"data-line",style:{animationDelay:"1.5s"}})]}),e.jsx("div",{ref:a,className:"container mx-auto px-6 py-32 lg:py-40 relative z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full glass-dark border border-brand-blue/20 mb-8 ${t?"animate-fade-in":"opacity-0"}`,children:[e.jsx(Tt,{size:14,className:"text-brand-blue"}),e.jsx("span",{className:"text-sm font-medium text-primary-foreground/80",children:"Ecommerce Growth Intelligence"})]}),e.jsxs("h1",{className:`text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold text-primary-foreground leading-[1.1] tracking-tight mb-6 ${t?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.1s"},children:["Understand what truly drives your"," ",e.jsx("span",{className:"text-gradient",children:"ecommerce revenue."})]}),e.jsx("p",{className:`text-lg md:text-xl text-primary-foreground/60 leading-relaxed max-w-2xl mx-auto mb-10 ${t?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.2s"},children:"Parallels unifies Meta, Google, GA4, and Shopify data to reveal the real drivers behind your revenue and profit."}),e.jsxs("div",{className:`flex flex-col sm:flex-row gap-4 justify-center mb-12 ${t?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.3s"},children:[e.jsxs(z,{onClick:()=>s("/login"),size:"lg",className:"bg-accent-gradient text-primary-foreground hover:opacity-90 transition-all gap-2 group  hover:shadow-brand-blue/20 h-11",children:["Request a Demo",e.jsx(Ss,{size:18,className:"group-hover:translate-x-0.5 transition-transform"})]}),e.jsxs(z,{onClick:()=>s("/login"),size:"lg",className:"bg-success-gradient text-primary-foreground hover:opacity-90 transition-all gap-2  hover:shadow-brand-green/20 h-11",children:[e.jsx(Tt,{size:18}),"Sign In"]})]}),e.jsxs("div",{className:`flex flex-wrap items-center justify-center gap-3 ${t?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.4s"},children:[e.jsx("span",{className:"text-sm text-primary-foreground/40",children:"Connects with:"}),["Meta Ads","Google Ads","GA4","Shopify"].map(i=>e.jsx("div",{className:"px-3 py-1.5 rounded-md glass-dark border border-primary-foreground/10 text-xs text-primary-foreground/60 hover:text-primary-foreground/90 hover:border-brand-blue/30 transition-all cursor-default",children:i},i))]}),e.jsxs("div",{className:`mt-16 relative ${t?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.5s"},children:[e.jsx("div",{className:"absolute inset-0 bg-brand-blue/20 rounded-full blur-[80px] animate-pulse-slow"}),e.jsx("div",{className:"relative glass-dark rounded-2xl p-6 border border-primary-foreground/10 max-w-3xl mx-auto overflow-hidden",children:e.jsxs("svg",{viewBox:"0 0 600 200",className:"w-full h-auto",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"areaFill",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:"0"})]}),e.jsxs("linearGradient",{id:"lineStroke",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(217, 91%, 60%)"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(160, 84%, 39%)"})]}),e.jsxs("filter",{id:"glowEffect",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"blur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"blur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),[50,100,150].map(i=>e.jsx("line",{x1:"30",y1:i,x2:"570",y2:i,stroke:"white",strokeOpacity:"0.05",strokeWidth:"1"},i)),e.jsx("path",{d:"M 30 160 Q 80 150 130 140 T 230 100 T 330 80 T 430 50 T 530 30 L 530 180 L 30 180 Z",fill:"url(#areaFill)",className:"animate-fade-in",style:{animationDelay:"0.6s"}}),e.jsx("path",{d:"M 30 160 Q 80 150 130 140 T 230 100 T 330 80 T 430 50 T 530 30",fill:"none",stroke:"url(#lineStroke)",strokeWidth:"3",strokeLinecap:"round",filter:"url(#glowEffect)",style:{strokeDasharray:800,strokeDashoffset:800,animation:"drawLine 2s ease-out 0.7s forwards"}}),[{x:130,y:140,label:"Meta",value:"+18%"},{x:330,y:80,label:"Google",value:"+24%"},{x:530,y:30,label:"Total",value:"+42%"}].map((i,c)=>e.jsxs("g",{className:"animate-fade-in",style:{animationDelay:`${1.2+c*.2}s`},children:[e.jsx("circle",{cx:i.x,cy:i.y,r:"8",fill:"hsl(160, 84%, 39%)",filter:"url(#glowEffect)"}),e.jsx("circle",{cx:i.x,cy:i.y,r:"14",fill:"none",stroke:"hsl(160, 84%, 39%)",strokeWidth:"1",strokeOpacity:"0.4"}),e.jsx("text",{x:i.x,y:i.y-25,textAnchor:"middle",fill:"white",fillOpacity:"0.5",fontSize:"10",children:i.label}),e.jsx("text",{x:i.x,y:i.y-40,textAnchor:"middle",fill:"hsl(160, 84%, 39%)",fontSize:"12",fontWeight:"bold",children:i.value})]},c))]})})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background to-transparent"}),e.jsx("style",{children:`
        @keyframes drawLine {
          to { stroke-dashoffset: 0; }
        }
      `})]})},Wr=[{icon:$i,number:"01",title:"Connect your platforms",description:"Link Shopify, Meta, and GA4 with a few clicks. No engineering required.",color:"accent"},{icon:$e,number:"02",title:"Data syncs automatically",description:"Your data is pulled and structured in real-time, always up to date.",color:"brand-green"},{icon:Fi,number:"03",title:"Parallels analyses relationships",description:"Our engine correlates marketing activity with revenue outcomes.",color:"brand-amber"},{icon:_i,number:"04",title:"Insights appear in your dashboard",description:"See performance signals, trends, and opportunities instantly.",color:"brand-coral"}],gt={accent:{bg:"bg-accent-foreground/10",border:"border-accent-foreground/30",text:"text-accent-foreground"},"brand-green":{bg:"bg-brand-green/10",border:"border-brand-green/30",text:"text-brand-green"},"brand-amber":{bg:"bg-brand-amber/10",border:"border-brand-amber/30",text:"text-brand-amber"},"brand-coral":{bg:"bg-brand-coral/10",border:"border-brand-coral/30",text:"text-brand-coral"}},Su=()=>{const{ref:s,isInView:a}=Ns({threshold:.1});return e.jsxs("section",{id:"how-it-works",className:"bg-section-gradient py-24 lg:py-32 relative overflow-hidden",children:[e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-brand-green/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-16 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-brand-blue/10 text-brand-blue text-sm font-medium mb-4",children:[e.jsx(Tt,{size:14}),"How It Works"]}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-foreground mb-6",children:["From connection to"," ",e.jsx("span",{className:"text-gradient",children:"insight."})]}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"No engineering. No setup headaches."})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"space-y-6 md:space-y-0",children:Wr.map((t,l)=>e.jsxs("div",{className:`relative flex gap-6 md:gap-10 ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${.2+l*.15}s`},children:[e.jsxs("div",{className:"relative z-10 flex-shrink-0",children:[e.jsx("div",{className:`w-16 h-16 md:w-20 md:h-20 rounded-2xl ${gt[t.color].bg} border-2 ${gt[t.color].border} flex items-center justify-center group-hover:scale-110 transition-transform`,children:e.jsx(t.icon,{size:28,className:`${gt[t.color].text}`})}),l<Wr.length-1&&e.jsx("div",{className:"mx-auto hidden md:block w-0.5 h-32 bg-gradient-to-b from-muted-foreground/20 to-muted-foreground/10 "})]}),e.jsx("div",{className:"flex-1 pb-12 md:pb-16",children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl p-6 md:p-8 card-hover",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("span",{className:`text-sm font-mono ${gt[t.color].text} ${gt[t.color].bg} px-3 py-1 rounded-full`,children:["Step ",t.number]}),e.jsx("h3",{className:`text-xl font-bold  ${gt[t.color].text}`,children:t.title})]}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:t.description})]})})]},l))})}),e.jsx("div",{className:"text-center mt-8",children:e.jsxs("div",{className:"inline-flex items-center gap-3 bg-brand-green/10 border border-brand-green/20 rounded-full px-6 py-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-green animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-brand-green",children:"Average setup time: Under 5 minutes"})]})})]})]})]})},Hr=[{icon:Ii,number:"01",title:"Data Unification",description:"Parallels automatically consolidates data from Meta Pixel, GA4, and Shopify into a single, structured, analytics-ready unified workspace",outcome:"Teams work from consistent, reliable performance metrics across all channels.",color:"accent",gradient:"from-accent to-accent/60"},{icon:Pi,number:"02",title:"Revenue Correlation",description:"Marketing activity is mapped directly to ecommerce outcomes, allowing teams to understand how campaigns influence revenue over time.",outcome:"Clear visibility into the relationship between spend, traffic quality, and sales performance.",color:"brand-green",gradient:"from-brand-green to-brand-green/60"},{icon:Ei,number:"03",title:"Actionable Intelligence",description:"Parallels transforms complex datasets into understandable insights, highlighting trends, changes, and opportunities for optimisation.",outcome:"Teams can act quickly and confidently, guided by data rather than assumptions.",color:"brand-amber",gradient:"from-brand-amber to-brand-amber/60"}],ku=()=>{const{ref:s,isInView:a}=Ns({threshold:.1});return e.jsxs("section",{className:"bg-dark-section py-24 lg:py-32 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-mesh-gradient opacity-30"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-16 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-primary-foreground mb-6",children:["A unified foundation for"," ",e.jsx("span",{className:"text-gradient",children:"informed decisions."})]}),e.jsx("p",{className:"text-lg text-primary-foreground/70",children:"How Parallels enables ecommerce growth through three core capabilities."})]}),e.jsx("div",{className:"grid lg:grid-cols-3 gap-8 max-w-6xl mx-auto",children:Hr.map((t,l)=>e.jsxs("div",{className:`group relative ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${.2+l*.15}s`},children:[l<Hr.length-1&&e.jsx("div",{className:"hidden lg:block absolute top-1/2 -right-4 w-8 h-0.5 bg-gradient-to-r from-primary-foreground/20 to-transparent z-10",children:e.jsx(Ss,{size:16,className:"absolute -right-2 -top-1.5 text-primary-foreground/20"})}),e.jsxs("div",{className:"glass-dark rounded-2xl p-8 h-full border border-primary-foreground/10 group-hover:border-accent/30 transition-all duration-300 hover-lift",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl bg-gradient-to-br ${t.gradient} flex items-center justify-center shadow-lg`,children:e.jsx(t.icon,{size:28,className:"text-primary-foreground"})}),e.jsx("span",{className:"text-5xl font-bold text-primary-foreground/10 group-hover:text-primary-foreground/20 transition-colors",children:t.number})]}),e.jsx("h3",{className:"text-xl font-bold text-primary-foreground mb-4",children:t.title}),e.jsx("p",{className:"text-primary-foreground/70 mb-6 leading-relaxed",children:t.description}),e.jsx("div",{className:`bg-${t.color}/10 rounded-xl p-4 border-l-4 border-${t.color}`,children:e.jsxs("p",{className:"text-sm text-primary-foreground",children:[e.jsx("span",{className:"text-primary-foreground/50 font-medium",children:"Outcome: "}),t.outcome]})})]})]},l))}),e.jsx("div",{className:"max-w-4xl mx-auto mt-16 pt-16 border-t border-primary-foreground/10",children:e.jsx("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 md:gap-0",children:["Raw Data","Unified View","Correlated Insights","Growth Actions"].map((t,l)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${l===3?"bg-success-gradient":"bg-primary-foreground/10"}`,children:e.jsx("span",{className:`text-sm font-bold ${l===3?"text-primary-foreground":"text-primary-foreground/70"}`,children:l+1})}),e.jsx("span",{className:"text-sm font-medium text-primary-foreground/70",children:t})]}),l<3&&e.jsx("div",{className:"hidden md:block w-12 h-0.5 bg-gradient-to-r from-primary-foreground/20 to-primary-foreground/5 mx-4"})]},t))})})]})]})},Au=({end:s,duration:a=2e3,startOnView:t=!0})=>{const[l,o]=r.useState(0),[i,c]=r.useState(!1),d=r.useRef(null);return r.useEffect(()=>{if(!t){c(!0);return}const u=d.current;if(!u)return;const m=new IntersectionObserver(([h])=>{h.isIntersecting&&!i&&c(!0)},{threshold:.3});return m.observe(u),()=>m.disconnect()},[t,i]),r.useEffect(()=>{if(!i)return;const u=Date.now(),m=0,h=()=>{const v=Date.now(),y=Math.min((v-u)/a,1),S=1-Math.pow(1-y,4),x=Math.floor(m+(s-m)*S);o(x),y<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},[i,s,a]),{count:l,ref:d}},Mu=[{icon:fa,value:5,suffix:"x",label:"Faster real-time insight discovery",description:"Find answers without manual data reconciliation",color:"accent"},{icon:Qe,value:40,suffix:"%",label:"Less time on reporting, more scaling",description:"Automated insights reduce manual workflows",color:"brand-green"},{icon:At,value:3,suffix:"x",label:"Higher confidence in scaling",description:"Data-driven decisions backed by unified metrics",color:"brand-amber"},{icon:Ft,value:90,suffix:"%",label:"Fewer attribution disputes",description:"One source of truth for all stakeholders",color:"brand-coral"}],Tu=({metric:s,index:a})=>{const{count:t,ref:l}=Au({end:s.value,duration:2e3}),o={accent:{bg:"bg-accent/20",text:"text-accent",glow:"group-hover:shadow-accent/20"},"brand-green":{bg:"bg-brand-green/20",text:"text-brand-green",glow:"group-hover:shadow-brand-green/20"},"brand-amber":{bg:"bg-brand-amber/20",text:"text-brand-amber",glow:"group-hover:shadow-brand-amber/20"},"brand-coral":{bg:"bg-brand-coral/20",text:"text-brand-coral",glow:"group-hover:shadow-brand-coral/20"}},i=o[s.color]||o.accent;return e.jsx("div",{ref:l,className:"relative group transition-all duration-500",style:{animationDelay:`${a*.15}s`,animation:"fadeInUp 0.6s ease-out forwards",opacity:0},children:e.jsxs("div",{className:`text-center p-8 rounded-2xl bg-primary-foreground/5 border border-primary-foreground/10 group-hover:border-accent/30 transition-all duration-300 hover:scale-105 ${i.glow} group-hover:shadow-lg`,children:[e.jsx("div",{className:`absolute inset-0 ${i.bg} opacity-0 group-hover:opacity-20 rounded-2xl transition-opacity blur-xl`}),e.jsx("div",{className:`w-14 h-14 rounded-xl ${i.bg} flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform relative z-10`,children:e.jsx(s.icon,{size:28,className:i.text})}),e.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-primary-foreground mb-2 relative z-10",children:[e.jsx("span",{className:"text-gradient",children:t}),e.jsx("span",{className:"text-primary-foreground/80",children:s.suffix})]}),e.jsx("div",{className:"text-lg font-semibold text-primary-foreground mb-2 relative z-10",children:s.label}),e.jsx("p",{className:"text-sm text-primary-foreground/50 relative z-10",children:s.description})]})})},$u=()=>{const{ref:s,isInView:a}=Ns({threshold:.3});return e.jsx("div",{ref:s,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-40 opacity-10 pointer-events-none",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 800 160",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"metricsChartGrad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"hsl(217, 91%, 60%)"}),e.jsx("stop",{offset:"50%",stopColor:"hsl(160, 84%, 39%)"}),e.jsx("stop",{offset:"100%",stopColor:"hsl(38, 92%, 50%)"})]})}),e.jsx("path",{d:"M 0 120 Q 100 100 200 80 T 400 60 T 600 40 T 800 20",fill:"none",stroke:"url(#metricsChartGrad)",strokeWidth:"3",strokeLinecap:"round",style:{strokeDasharray:1200,strokeDashoffset:a?0:1200,transition:"stroke-dashoffset 2s ease-out"}})]})})},Fu=()=>{const{ref:s,isInView:a}=Ns({threshold:.1});return e.jsxs("section",{className:"relative py-20 lg:py-28 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-black to-accent/20"}),e.jsx("div",{className:"absolute inset-0 bg-mesh-gradient opacity-50"}),e.jsx("div",{className:"absolute top-1/4 left-10 w-64 h-64 bg-accent/20 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-1/4 right-10 w-80 h-80 bg-brand-green/20 rounded-full blur-3xl animate-float",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/3 w-48 h-48 bg-brand-amber/10 rounded-full blur-3xl animate-float",style:{animationDelay:"2.5s"}}),e.jsx($u,{}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-12 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-accent/10 border border-accent/20 mb-6",children:[e.jsx(Tt,{size:14,className:"text-accent animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-accent",children:"Measurable Impact"})]}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-primary-foreground mb-6",children:["Driving meaningful outcomes through"," ",e.jsx("span",{className:"text-gradient",children:"clarity."})]}),e.jsx("p",{className:"text-lg text-primary-foreground/70",children:"Real results for ecommerce teams."})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto",children:Mu.map((t,l)=>e.jsx(Tu,{metric:t,index:l},l))}),e.jsx("div",{className:"flex justify-center mt-12",children:e.jsxs("div",{className:"flex items-center gap-3 px-6 py-3 bg-primary-foreground/5 rounded-full border border-primary-foreground/10",children:[e.jsx(ys,{size:18,className:"text-accent"}),e.jsx("span",{className:"text-sm text-primary-foreground/70",children:"Based on early user feedback"})]})})]}),e.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})};function jr(){const[s,a]=r.useState(!1),[t,l]=r.useState(!1),o=Xe();return r.useEffect(()=>{const i=()=>{l(window.scrollY>50)};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]),e.jsx("header",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${s||t?"bg-black/95 backdrop-blur-md":"bg-transparent"}`,children:e.jsxs("div",{className:"container mx-auto px-6 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-10 h-10 bg-accent-gradient rounded-lg flex items-center justify-center animate-pulse-glow",children:e.jsx("span",{className:"text-accent font-bold text-xl",children:"P"})})}),e.jsx("span",{className:"text-accent font-bold text-2xl tracking-tight",children:"Parallels"})]}),e.jsx("nav",{className:"hidden md:flex items-center gap-8",children:["Features","Use Cases","How It Works","Why Parallels"].map(i=>e.jsxs("a",{href:`#${i.toLowerCase().replace(/\s+/g,"-")}`,className:"text-accent/90 hover:text-accent transition-colors text-sm font-medium relative group",children:[i,e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-accent transition-all duration-300 group-hover:w-full"})]},i))}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[e.jsx(z,{onClick:()=>o("/login"),variant:"ghost",className:"text-accent/90 hover:text-accent hover:bg-accent/10 py-5",children:"Request Demo"}),e.jsx(z,{onClick:()=>o("/login"),className:"bg-accent-gradient text-accent hover:opacity-90 transition-opacity py-5",children:"Sign In"})]}),e.jsx("button",{className:"md:hidden text-primary-foreground p-2",onClick:()=>a(!s),children:s?e.jsx(hs,{size:24}):e.jsx(Li,{size:24})})]}),s&&e.jsx("div",{className:"md:hidden  mt-4 pb-4 border-t border-primary-foreground/40 animate-fade-in-up",children:e.jsxs("nav",{className:"flex flex-col gap-4 mt-4",children:[["Features","Use Cases","How It Works","Why Parallels"].map(i=>e.jsx(nt,{to:`#${i.toLowerCase().replace(/\s+/g,"-")}`,className:"text-primary-foreground/80 hover:text-primary-foreground hover:bg-accent/10 py-2  rounded-md transition-colors font-medium",onClick:()=>a(!1),children:i},i)),e.jsxs("div",{className:"flex flex-col gap-2 mt-4 pt-4 border-t border-primary-foreground/40",children:[e.jsx(z,{onClick:()=>o("/login"),variant:"ghost",className:"text-accent/90 hover:text-accent hover:bg-accent/10 md:justify-start justify-center",children:"Request Demo"}),e.jsx(z,{onClick:()=>o("/login"),className:"bg-accent-gradient text-primary-foreground",children:"Sign In"})]})]})})]})})}const _u=()=>e.jsx("footer",{className:"bg-black border-t border-primary-foreground/10 py-16",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-12 mb-12",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-accent-gradient rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-xl",children:"P"})}),e.jsx("span",{className:"text-primary-foreground font-bold text-2xl tracking-tight",children:"Parallels"})]}),e.jsx("p",{className:"text-primary-foreground/60 text-sm max-w-md leading-relaxed mb-6",children:"Ecommerce growth intelligence platform that unifies Meta, GA4, and Shopify data to help teams understand, optimise, and scale revenue with confidence."}),e.jsx("div",{className:"flex gap-4",children:["Twitter","LinkedIn"].map(s=>e.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-primary-foreground/5 border border-primary-foreground/10 flex items-center justify-center text-primary-foreground/60 hover:text-primary-foreground hover:border-accent/30 transition-colors",children:e.jsx("span",{className:"text-xs font-medium",children:s[0]})},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-primary-foreground mb-6",children:"Product"}),e.jsx("ul",{className:"space-y-3",children:["Features","Use Cases","How It Works","Pricing"].map(s=>e.jsx("li",{children:e.jsxs("a",{href:`#${s.toLowerCase().replace(/\s+/g,"-")}`,className:"text-sm text-primary-foreground/60 hover:text-primary-foreground transition-colors flex items-center gap-1 group",children:[s,e.jsx(vr,{size:12,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-primary-foreground mb-6",children:"Company"}),e.jsx("ul",{className:"space-y-3",children:["About","Blog","Careers","Contact"].map(s=>e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-sm text-primary-foreground/60 hover:text-primary-foreground transition-colors flex items-center gap-1 group",children:[s,e.jsx(vr,{size:12,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})},s))})]})]}),e.jsxs("div",{className:"border-t border-primary-foreground/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-primary-foreground/50",children:[" ",new Date().getFullYear()," Parallels. All rights reserved."]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("a",{href:"#",className:"text-sm text-primary-foreground/50 hover:text-primary-foreground transition-colors",children:"Privacy Policy"}),e.jsx("a",{href:"#",className:"text-sm text-primary-foreground/50 hover:text-primary-foreground transition-colors",children:"Terms of Service"})]}),e.jsxs("p",{className:"text-sm text-primary-foreground/50",children:["A product by ",e.jsx("span",{className:"text-accent",children:"Messold"})]})]})]})}),Iu=[{quote:"We see exactly which campaigns are driving revenue. The correlation engine is a game-changer for scaling decisions.",author:"Performance Marketing Lead",company:"DTC Fashion Brand",rating:5},{quote:"We've cut our reporting time in half. The unified dashboard gives our entire team the same view of performance.",author:"Head of Growth",company:"Shopify Plus Brand",rating:5},{quote:"Client reporting used to be a nightmare. Now we deliver insights that actually build trust and drive results.",author:"Agency Director",company:"Ecommerce Agency",rating:5}],Pu=()=>{const{ref:s,isInView:a}=Ns({threshold:.1});return e.jsxs("section",{className:"bg-section-gradient py-24 lg:py-32 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-accent/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-16 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsx("span",{className:"inline-block text-accent-foreground text-sm font-semibold tracking-wider uppercase mb-4",children:"Testimonials"}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-foreground mb-6",children:["Developed with"," ",e.jsx("span",{className:"text-gradient",children:"ecommerce teams."})]}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Built by a team with deep ecommerce and analytics experience. Currently in private beta with select brands."})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:Iu.map((t,l)=>e.jsx("div",{className:`group ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${.1+l*.1}s`},children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl p-8 h-full card-hover relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-accent/5 rounded-full blur-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-accent-foreground/10 flex items-center justify-center mb-6",children:e.jsx(Di,{size:24,className:"text-accent-foreground"})}),e.jsx("div",{className:"flex gap-1 mb-4",children:Array.from({length:t.rating}).map((o,i)=>e.jsx(Hn,{size:16,className:"text-brand-amber fill-brand-amber"},i))}),e.jsxs("p",{className:"text-foreground mb-6 leading-relaxed",children:['"',t.quote,'"']}),e.jsxs("div",{className:"border-t border-border pt-6",children:[e.jsx("p",{className:"font-semibold text-foreground",children:t.author}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.company})]})]})]})},l))}),e.jsx("div",{className:"text-center mt-12",children:e.jsxs("div",{className:"inline-flex items-center gap-3 bg-brand-blue/10 border border-brand-blue/20 rounded-full px-6 py-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-blue animate-pulse flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-brand-blue text-left",children:"Currently in private beta with select ecommerce teams"})]})})]})]})},Da=[{id:"dtc",icon:qn,title:"DTC Brand Owners",shortTitle:"Brand Owners",insight:"Know which channels actually generate profit",description:"See the full picture of revenue attribution across all your marketing spend.",highlightAreas:["revenue","profit"],color:"accent"},{id:"performance",icon:Is,title:"Performance Marketing",shortTitle:"Marketers",insight:"See which campaigns drive real revenue",description:"Move beyond vanity metrics to understand true campaign performance.",highlightAreas:["campaigns","roas"],color:"brand-green"},{id:"growth",icon:Qe,title:"Growth Leaders",shortTitle:"Growth",insight:"Allocate budget with confidence",description:"Make data-driven decisions on where to invest for maximum growth.",highlightAreas:["budget","growth"],color:"brand-amber"},{id:"agency",icon:Ft,title:"Agencies",shortTitle:"Agencies",insight:"Deliver reporting clients can trust",description:"Build credibility with transparent, revenue-focused client reports.",highlightAreas:["reporting","clients"],color:"brand-coral"}],Eu=()=>{const[s,a]=r.useState("dtc"),{ref:t,isInView:l}=Ns({threshold:.1}),o=Da.find(i=>i.id===s)||Da[0];return e.jsxs("section",{id:"use-cases",className:"bg-dark-section py-24 lg:py-32 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-hero-pattern opacity-20"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-accent/5 rounded-full blur-[150px]"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:t,className:`max-w-3xl mx-auto text-center mb-16 ${l?"animate-fade-in":"opacity-0"}`,children:[e.jsx("span",{className:"inline-block text-accent text-sm font-semibold tracking-wider uppercase mb-4",children:"One Platform, Many Perspectives"}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-primary-foreground mb-6",children:["Same data."," ",e.jsx("span",{className:"text-gradient",children:"Your view."})]}),e.jsx("p",{className:"text-lg text-primary-foreground/70",children:"Parallels adapts to how different teams think and make decisions."})]}),e.jsxs("div",{className:`max-w-5xl mx-auto ${l?"animate-fade-in":"opacity-0"}`,style:{animationDelay:"0.2s"},children:[e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-10",children:Da.map(i=>{const c=s===i.id;return e.jsxs("button",{onClick:()=>a(i.id),className:`group flex items-center gap-2 px-5 py-3 rounded-xl transition-all duration-300 ${c?`bg-${i.color}/20 border border-${i.color}/50`:"bg-primary-foreground/5 border border-primary-foreground/10 hover:bg-primary-foreground/10"}`,children:[e.jsx(i.icon,{size:18,className:`transition-colors ${c?`text-${i.color}`:"text-primary-foreground/50 group-hover:text-primary-foreground/70"}`}),e.jsxs("span",{className:`text-sm font-medium transition-colors ${c?"text-primary-foreground":"text-primary-foreground/60 group-hover:text-primary-foreground/80"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:i.title}),e.jsx("span",{className:"sm:hidden",children:i.shortTitle})]})]},i.id)})}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"glass-dark rounded-2xl border border-primary-foreground/10 p-6 md:p-8 relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-brand-green animate-pulse"}),e.jsx("span",{className:"text-sm text-primary-foreground/60",children:"Live Dashboard"})]}),e.jsx("div",{className:"text-xs text-primary-foreground/40",children:"Unified View  Real-time"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-xl transition-all duration-500 ${o.highlightAreas.includes("revenue")||o.highlightAreas.includes("profit")?"bg-accent/10 border-2 border-accent/40 scale-[1.02]":"bg-primary-foreground/5 border border-primary-foreground/10"}`,children:[e.jsx("div",{className:"text-xs text-primary-foreground/50 mb-1",children:"Total Revenue"}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-primary-foreground",children:"$847K"}),e.jsx("div",{className:"text-xs text-brand-green mt-1",children:"+23% MoM"})]}),e.jsxs("div",{className:`p-4 rounded-xl transition-all duration-500 ${o.highlightAreas.includes("roas")||o.highlightAreas.includes("campaigns")?"bg-brand-green/10 border-2 border-brand-green/40 scale-[1.02]":"bg-primary-foreground/5 border border-primary-foreground/10"}`,children:[e.jsx("div",{className:"text-xs text-primary-foreground/50 mb-1",children:"Blended ROAS"}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-primary-foreground",children:"4.2x"}),e.jsx("div",{className:"text-xs text-brand-green mt-1",children:"+0.8 vs target"})]}),e.jsxs("div",{className:`p-4 rounded-xl transition-all duration-500 ${o.highlightAreas.includes("budget")||o.highlightAreas.includes("growth")?"bg-brand-amber/10 border-2 border-brand-amber/40 scale-[1.02]":"bg-primary-foreground/5 border border-primary-foreground/10"}`,children:[e.jsx("div",{className:"text-xs text-primary-foreground/50 mb-1",children:"Ad Spend"}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-primary-foreground",children:"$201K"}),e.jsx("div",{className:"text-xs text-primary-foreground/40 mt-1",children:"Optimal allocation"})]}),e.jsxs("div",{className:`p-4 rounded-xl transition-all duration-500 ${o.highlightAreas.includes("reporting")||o.highlightAreas.includes("clients")?"bg-brand-coral/10 border-2 border-brand-coral/40 scale-[1.02]":"bg-primary-foreground/5 border border-primary-foreground/10"}`,children:[e.jsx("div",{className:"text-xs text-primary-foreground/50 mb-1",children:"CAC Payback"}),e.jsx("div",{className:"text-xl md:text-2xl font-bold text-primary-foreground",children:"42d"}),e.jsx("div",{className:"text-xs text-brand-coral mt-1",children:"-8d improvement"})]})]}),e.jsxs("div",{className:"relative h-32 md:h-40 rounded-xl bg-primary-foreground/5 border border-primary-foreground/10 overflow-hidden",children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"chartGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:`hsl(var(--${o.color}))`,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:`hsl(var(--${o.color}))`,stopOpacity:"0"})]}),e.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:`hsl(var(--${o.color}))`,stopOpacity:"0.5"}),e.jsx("stop",{offset:"50%",stopColor:`hsl(var(--${o.color}))`,stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:`hsl(var(--${o.color}))`,stopOpacity:"0.5"})]})]}),e.jsx("path",{d:"M 0 120 Q 50 100, 100 90 T 200 70 T 300 85 T 400 60 T 500 50 T 600 65 T 700 45 T 800 40 L 800 160 L 0 160 Z",fill:"url(#chartGradient)",className:"transition-all duration-700"}),e.jsx("path",{d:"M 0 120 Q 50 100, 100 90 T 200 70 T 300 85 T 400 60 T 500 50 T 600 65 T 700 45 T 800 40",stroke:"url(#lineGradient)",strokeWidth:"2",fill:"none",className:"transition-all duration-700",style:{strokeDasharray:"1200",strokeDashoffset:"0",animation:"drawLine 2s ease-out forwards"}}),[100,200,300,400,500,600,700].map((i,c)=>e.jsx("circle",{cx:i,cy:[90,70,85,60,50,65,45][c],r:"4",fill:`hsl(var(--${o.color}))`,className:"animate-pulse",style:{animationDelay:`${c*.1}s`}},i))]}),e.jsxs("div",{className:"absolute bottom-3 left-4 right-4 flex justify-between text-xs text-primary-foreground/40",children:[e.jsx("span",{children:"Jan"}),e.jsx("span",{children:"Feb"}),e.jsx("span",{children:"Mar"}),e.jsx("span",{children:"Apr"}),e.jsx("span",{children:"May"}),e.jsx("span",{children:"Jun"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-6 pt-4 border-t border-primary-foreground/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#4285F4]"}),e.jsx("span",{className:"text-xs text-primary-foreground/50",children:"Google"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#0081FB]"}),e.jsx("span",{className:"text-xs text-primary-foreground/50",children:"Meta"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#96BF48]"}),e.jsx("span",{className:"text-xs text-primary-foreground/50",children:"Shopify"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#F9AB00]"}),e.jsx("span",{className:"text-xs text-primary-foreground/50",children:"GA4"})]})]})]}),e.jsx("div",{className:"mt-6 glass-dark rounded-xl border border-primary-foreground/10 p-6 animate-fade-in",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-${o.color}/20 flex items-center justify-center flex-shrink-0`,children:e.jsx(o.icon,{size:24,className:`text-${o.color}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-foreground mb-1",children:o.insight}),e.jsx("p",{className:"text-primary-foreground/60 text-sm",children:o.description})]})]})},s)]})]})]}),e.jsx("style",{children:`
        @keyframes drawLine {
          from {
            stroke-dashoffset: 1200;
          }
          to {
            stroke-dashoffset: 0;
          }
        }
      `})]})},qr=[{feature:"Cross-platform consistency",traditional:"Limited",parallels:"Strong",isBoolean:!1},{feature:"Revenue-centric insights",traditional:"Partial",parallels:"Comprehensive",isBoolean:!1},{feature:"Ecommerce-specific focus",traditional:"Generalised",parallels:"Purpose-built",isBoolean:!1},{feature:"Actionable intelligence",traditional:"Manual",parallels:"Automated",isBoolean:!1},{feature:"Raw data exports required",traditional:!0,parallels:!1,isBoolean:!0},{feature:"Manual reconciliation",traditional:!0,parallels:!1,isBoolean:!0}],Lu=()=>{const{ref:s,isInView:a}=Ns({threshold:.1});return e.jsxs("section",{id:"why-parallels",className:"bg-dark-section py-24 lg:py-32 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-mesh-gradient opacity-30"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{ref:s,className:`max-w-3xl mx-auto text-center mb-16 ${a?"animate-fade-in":"opacity-0"}`,children:[e.jsx("span",{className:"inline-block text-accent text-sm font-semibold tracking-wider uppercase mb-4",children:"Comparison"}),e.jsxs("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-primary-foreground mb-6",children:["Built specifically for"," ",e.jsx("span",{className:"text-gradient",children:"ecommerce growth."})]}),e.jsx("p",{className:"text-lg text-primary-foreground/70",children:"Why teams choose Parallels."})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"glass-dark rounded-2xl overflow-hidden border border-primary-foreground/10",children:[e.jsxs("div",{className:"grid grid-cols-3 bg-primary-foreground/5 border-b border-primary-foreground/10",children:[e.jsx("div",{className:"p-4 md:p-6",children:e.jsx("span",{className:"font-semibold text-primary-foreground",children:"Capability"})}),e.jsx("div",{className:"p-4 md:p-6 text-center border-x border-primary-foreground/10",children:e.jsx("span",{className:"font-semibold text-primary-foreground/50",children:"Traditional Tools"})}),e.jsx("div",{className:"p-4 md:p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ms,{size:16,className:"text-accent"}),e.jsx("span",{className:"font-semibold text-accent",children:"Parallels"})]})})]}),qr.map((t,l)=>e.jsxs("div",{className:`grid grid-cols-3 ${l!==qr.length-1?"border-b border-primary-foreground/10":""} ${a?"animate-fade-in":"opacity-0"}`,style:{animationDelay:`${.1+l*.05}s`},children:[e.jsx("div",{className:"p-4 md:p-6 flex items-center",children:e.jsx("span",{className:"text-sm md:text-base text-primary-foreground",children:t.feature})}),e.jsx("div",{className:"p-4 md:p-6 flex items-center justify-center border-x border-primary-foreground/10",children:t.isBoolean?t.traditional?e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-coral/20 flex items-center justify-center",children:e.jsx(hs,{size:16,className:"text-brand-coral"})}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-green/20 flex items-center justify-center",children:e.jsx(Hs,{size:16,className:"text-brand-green"})}):e.jsx("span",{className:"text-sm md:text-base text-primary-foreground/50",children:t.traditional})}),e.jsx("div",{className:"p-4 md:p-6 flex items-center justify-center bg-accent/5",children:t.isBoolean?t.parallels?e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-coral/20 flex items-center justify-center",children:e.jsx(hs,{size:16,className:"text-brand-coral"})}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-green/20 flex items-center justify-center",children:e.jsx(Hs,{size:16,className:"text-brand-green"})}):e.jsx("span",{className:"text-sm md:text-base font-medium text-accent",children:t.parallels})})]},l))]})})]})]})};function Du(){const s=V(l=>l.user.user),a=!!(s!=null&&s.id),t=Xe();return r.useEffect(()=>{a&&t("/dashboard")},[a]),e.jsxs("div",{className:"landing-page landing-page-container text-accent flex min-h-screen flex-col gradient-bg",children:[e.jsx(jr,{}),e.jsxs("main",{className:"flex-1",children:[e.jsx(Cu,{}),e.jsx(bu,{}),e.jsx(Fu,{}),e.jsx(Nu,{}),e.jsx(Eu,{}),e.jsx(Su,{}),e.jsx(ku,{}),e.jsx(Lu,{}),e.jsx(Pu,{}),e.jsx(wu,{}),e.jsx(_u,{})]})]})}function yr(){return e.jsx("footer",{className:"w-full border-t bg-slate-900 text-white",children:e.jsx("div",{className:"container px-6 py-8 flex justify-center items-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-2xl tracking-tight",children:[e.jsx("img",{src:nr,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{className:"text-slate-100",children:"Parallels"})]}),e.jsx("p",{className:"text-sm text-slate-400 text-center max-w-sm",children:"The all-in-one marketing platform for growing businesses."}),e.jsxs("nav",{className:"flex space-x-4 text-sm font-medium",children:[e.jsx(nt,{to:"/privacy-policy",className:"text-slate-400 transition hover:text-blue-400",children:"Privacy Policy"}),e.jsx("span",{className:"text-slate-500",children:"|"}),e.jsx(nt,{to:"/terms-and-conditions",className:"text-slate-400 transition hover:text-blue-400",children:"Terms of Service"})]})]})})})}function Ru(){return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 text-slate-800",children:[e.jsx(jr,{}),e.jsx("div",{className:"max-w-4xl mx-auto p-6 my-5",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-center text-gray-900 mb-6",children:"Privacy Policy"}),Gc.map(s=>e.jsxs("section",{className:"mb-6 border-b pb-4 last:border-none",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:s.title}),s.content.map(a=>{var t;return typeof a=="string"?e.jsx("p",{className:"text-gray-700 mb-2",children:a},`${s.title}-${a.slice(0,20)}`):e.jsx("ul",{className:"list-disc pl-5 text-gray-700",children:a.map(l=>e.jsx("li",{children:l},`${s.title}-item-${l.slice(0,20)}`))},`${s.title}-list-${(t=a[0])==null?void 0:t.slice(0,20)}`)})]},s.title))]})}),e.jsx(yr,{})]})}function Ou(){return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 text-slate-800",children:[e.jsx(jr,{}),e.jsx("div",{className:"max-w-4xl mx-auto p-6 my-5",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-center text-gray-900 mb-6",children:"Terms and Conditions"}),Uc.map(s=>e.jsxs("section",{className:"mb-6 border-b pb-4 last:border-none",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:s.title}),s.content.map(a=>{var t;return typeof a=="string"?e.jsx("p",{className:"text-gray-700 mb-2",children:a},`${s.title}-${a.slice(0,20)}`):e.jsx("ul",{className:"list-disc pl-5 text-gray-700",children:a.map(l=>e.jsx("li",{children:l},`${s.title}-item-${l.slice(0,20)}`))},`${s.title}-list-${(t=a[0])==null?void 0:t.slice(0,20)}`)})]},s.title))]})}),e.jsx(yr,{})]})}const zu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/deviceTypeConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"device")},[m==null?void 0:m.data,t]);const j="Device",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Bu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/genderConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"gender")},[m==null?void 0:m.data,t]);const j="Gender",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Gu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/ageConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g),h(null)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"age")},[m==null?void 0:m.data,t]);const j="Age",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):(console.log(m==null?void 0:m.data),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})}))},Uu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/interestConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"interest")},[m==null?void 0:m.data,t]);const j="Interest",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Vu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/operatingSystemConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"operatingSystem")},[m==null?void 0:m.data,t]);const j="Operating System",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Wu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/browserConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"browser")},[m==null?void 0:m.data,t]);const j="Browser",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Hu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/sourceConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"source")},[m==null?void 0:m.data,t]);const j="Source",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},qu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/regionConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"region")},[m==null?void 0:m.data,t]);const j="Region",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Yu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/cityConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"city")},[m==null?void 0:m.data,t]);const j="City",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Ku=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/countryConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"country")},[m==null?void 0:m.data,t]);const j="Country",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Qu=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/campaignConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"campaign")},[m==null?void 0:m.data,t]);const j="Campaign",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Ju=({isFullScreen:s,currentFilter:a,onDataUpdate:t,refreshTrigger:l})=>{const o=V(g=>g.date.from),i=V(g=>g.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=V(g=>g.locale.locale),{brandId:u}=ge(),[m,h]=r.useState(null),[v,y]=r.useState(!0),S=Ce(),x=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",p=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";r.useEffect(()=>{h(null)},[u]);const N=r.useCallback(async()=>{y(!0);try{const $=(await S.post(`/api/analytics/channelConversionReport/${u}`,{startDate:x,endDate:p},{withCredentials:!0})).data||[];h($)}catch(g){console.error("Error fetching data:",g)}finally{y(!1)}},[u,x,p]);r.useEffect(()=>{c.from&&c.to&&N()},[N,l]),r.useEffect(()=>{m!=null&&m.data&&t&&t(m.data,"channel")},[m==null?void 0:m.data,t]);const j="Channel",w=["Total Sessions","Avg Conv. Rate"],P="MonthlyData";return v?e.jsx(Ae,{isLoading:v}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:(m==null?void 0:m.data)||[],primaryColumn:j,secondaryColumns:w,monthlyDataKey:P,isFullScreen:s,locale:d,filter:a})})},Zu=()=>{const s=V(B=>B.date.from),a=V(B=>B.date.to),t=r.useMemo(()=>({from:s,to:a}),[s,a]),{brandId:l}=ge(),i=V(B=>B.brand.brands).find(B=>B._id===l),c=(i==null?void 0:i.ga4Account)??!1,{tokenError:d}=Ko(),[u,m]=r.useState("age"),[h,v]=r.useState(!1),[y,S]=r.useState(void 0),[x,p]=r.useState([]),[N,j]=r.useState(0),w=()=>{v(!h)},P=r.useCallback(()=>{j(B=>B+1)},[]),g=B=>{S(B===void 0?void 0:B.map(O=>String(O)))},$=(B,O)=>{O===u&&p(B)},F=B=>({age:"Age",gender:"Gender",interest:"Interest",device:"Device Type",operatingSystem:"Operating System",browser:"Browser",source:"Source",channel:"Channel",campaign:"Campaign",country:"Country",city:"City",region:"Region"})[B]||"Unknown",A=B=>({age:["Total Sessions","Avg Conv. Rate"],gender:["Total Sessions","Avg Conv. Rate"],interest:["Total Sessions","Avg Conv. Rate"],device:["Total Sessions","Avg Conv. Rate"],operatingSystem:["Total Sessions","Avg Conv. Rate"],browser:["Total Sessions","Avg Conv. Rate"],source:["Total Sessions","Avg Conv. Rate"],channel:["Total Sessions","Avg Conv. Rate"],campaign:["Total Sessions","Avg Conv. Rate"],country:["Total Sessions","Avg Conv. Rate"],city:["Total Sessions","Avg Conv. Rate"],region:["Total Sessions","Avg Conv. Rate"]})[B]||[],C=B=>({age:"Age_Conversion_Report",gender:"Gender_Conversion_Report",interest:"Interest_Conversion_Report",device:"Device_Conversion_Report",operatingSystem:"OperatingSystem_Conversion_Report",browser:"Browser_Conversion_Report",source:"Source_Conversion_Report",channel:"Channel_Conversion_Report",campaign:"Campaign_Conversion_Report",country:"Country_Conversion_Report",city:"City_Conversion_Report",region:"Region_Conversion_Report"})[B]||"Conversion_Report",_=[{label:"Age",value:"age",icon:e.jsx(Ft,{className:"w-4 h-4"})},{label:"Gender",value:"gender",icon:e.jsx(er,{className:"w-4 h-4"})},{label:"Interest",value:"interest",icon:e.jsx(Is,{className:"w-4 h-4"})},{label:"Device",value:"device",icon:e.jsx(lo,{className:"w-4 h-4"})},{label:"Operating System",value:"operatingSystem",icon:e.jsx(oo,{className:"w-4 h-4"})},{label:"Browser",value:"browser",icon:e.jsx(Ri,{className:"w-4 h-4"})},{label:"Source",value:"source",icon:e.jsx(so,{className:"w-4 h-4"})},{label:"Channel",value:"channel",icon:e.jsx(ys,{className:"w-4 h-4"})},{label:"Campaign",value:"campaign",icon:e.jsx(Qe,{className:"w-4 h-4"})},{label:"Country",value:"country",icon:e.jsx(Ut,{className:"w-4 h-4"})},{label:"City",value:"city",icon:e.jsx(Zn,{className:"w-4 h-4"})},{label:"Region",value:"region",icon:e.jsx(Ut,{className:"w-4 h-4"})}],I=B=>{m(B),p([]),S(void 0)};return d?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:e.jsx(ht,{platform:"Google Analytics",message:"We need access to your Google Analytics account to show you amazing insights about your website performance.",icon:e.jsx(Ja,{className:"w-8 h-8 text-blue-600"}),loginOptions:[{label:"Connect Google Analytics",context:"googleAnalyticsSetup",provider:"google"}]})})]}):c?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx(qt,{tabs:_,activeTab:u,onTabChange:I}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:!t.from||!t.to?e.jsx(Zs,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-none"}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"p-2 space-y-6",children:e.jsx(ue,{id:`${u}-report`,className:`${h?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(he,{className:"p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex-grow items-center gap-3",children:e.jsx(is,{data:x,primaryColumn:F(u),metricConfig:ls.sessionsAndConversion||{},onCategoryFilter:g})}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5 ",children:[e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(ss,{}),e.jsx(z,{id:"refresh",onClick:P,size:"icon",variant:"outline",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(Qo,{data:x,fileName:C(u),primaryColumn:F(u),secondaryColumns:A(u),monthlyDataKey:"MonthlyData",monthlyMetrics:["Sessions","Conv. Rate"],disabled:x.length===0}),e.jsx(z,{id:"expand-button",onClick:w,size:"icon",variant:"outline",children:h?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{id:u,children:[u==="age"&&e.jsx(Gu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="gender"&&e.jsx(Bu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="interest"&&e.jsx(Uu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="device"&&e.jsx(zu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="operatingSystem"&&e.jsx(Vu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="browser"&&e.jsx(Wu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="source"&&e.jsx(Hu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="channel"&&e.jsx(Ju,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="campaign"&&e.jsx(Qu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="country"&&e.jsx(Ku,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="city"&&e.jsx(Yu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N}),u==="region"&&e.jsx(qu,{isFullScreen:h,currentFilter:y,onDataUpdate:$,refreshTrigger:N})]})})]})})}),e.jsx(Ps,{})]})]})})]}):e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:e.jsx(Pt,{platform:"google analytics",brandId:l??"",onSuccess:(B,O,E)=>{console.log(`Successfully connected ${B} account: ${O} (${E})`)}})})]})},Yr=["bg-red-100 text-red-800 border border-red-200 hover:bg-red-200","bg-blue-100 text-blue-800 border border-blue-200 hover:bg-blue-200","bg-green-100 text-green-800 border border-green-200 hover:bg-green-200","bg-yellow-100 text-yellow-800 border border-yellow-200 hover:bg-yellow-200","bg-purple-100 text-purple-800 border border-purple-200 hover:bg-purple-200","bg-pink-100 text-pink-800 border border-pink-200 hover:bg-pink-200","bg-indigo-100 text-indigo-800 border border-indigo-200 hover:bg-indigo-200","bg-orange-100 text-orange-800 border border-orange-200 hover:bg-orange-200"],Kr="85px",Xu=({data:s,blendedSummary:a})=>{const t=Me(),[l,o]=r.useState(null),[i,c]=r.useState(null),[d,u]=r.useState(!1),[m,h]=r.useState(null),[v,y]=r.useState(null),[S,x]=r.useState(null),[p,N]=r.useState(""),[j,w]=r.useState(!1),[P,g]=r.useState(""),[$,F]=r.useState([]),[A,C]=r.useState([]),[_,I]=r.useState(["Campaign","Labels"]),[B,O]=r.useState(0),E=r.useRef(null);r.useEffect(()=>{I(H=>["Campaign","Labels",...H.filter(X=>X!=="Campaign"&&X!=="Labels")])},[]),r.useEffect(()=>{s.length>0&&!P&&(a&&a.length>0?g("all"):g(s[0].account_id))},[s,P,a]);const[M,R]=r.useState(!0),[L,k]=r.useState([]),[f,n]=r.useState([]),[b,T]=r.useState("all"),U=r.useRef(null),D=r.useRef({}),W=r.useRef(null),{labels:K}=V(H=>H.campaignLabels),q=r.useMemo(()=>P==="all"&&a?{account_name:"All Accounts",account_id:"all",campaigns:a}:s.find(H=>H.account_id===P)||s[0],[s,P,a]),ee=r.useMemo(()=>q!=null&&q.account_id?K[q.account_id]||{}:{},[K,q==null?void 0:q.account_id]),J=["TOFU","MOFU","BOFU","TOFU+MOFU"],ae=r.useMemo(()=>{const H=new Set;return Object.values(ee).forEach(de=>{de==null||de.forEach(X=>{H.add(X)})}),Array.from(H)},[ee]),pe=r.useMemo(()=>ae.length>0,[ae]),G=H=>b==="all"?H:H.filter(de=>{const X=de.status||de.Status||"",fe=String(X).toLowerCase();return b==="active"?fe==="active":fe==="paused"}),se=r.useMemo(()=>G((q==null?void 0:q.campaigns)||[]),[q==null?void 0:q.campaigns,b]);r.useEffect(()=>{if(s.length>0&&A.length===0){const H=s[0];if((H==null?void 0:H.campaigns.length)>0){const X=Object.keys(H.campaigns[0]).filter(xe=>xe!=="Labels"&&xe!=="campaignId"&&xe!=="accountId"&&xe!=="accountName"),fe=[...X,"Labels"];F(fe);const ce=["Campaign","Labels",...[...X].filter(xe=>xe!=="Campaign"&&xe!=="campaignName"&&xe!=="Labels")];C(ce)}}},[s,A.length]),r.useEffect(()=>{if(M&&pe){const H={};ae.forEach(fe=>{H[fe]=[]});const de=[];se.forEach(fe=>{const re=ee[fe.campaignId]||[];re.length>0?re.forEach(ce=>{H[ce].push(fe)}):de.push(fe)});const X=Object.entries(H).filter(([,fe])=>fe.length>0).map(([fe,re])=>({label:fe,campaigns:re,isExpanded:!0}));k(X),n(de)}else k([]),n(se)},[se,ee,M,pe,ae]);const te=Se.useMemo(()=>{const H=new Map;let de=0;return ae.forEach(X=>{H.set(X,Yr[de%Yr.length]),de++}),H},[ae]),me=H=>{const de=A.filter(re=>$.includes(re)),X=de[H];if(!_.includes(X))return 0;let fe=0;for(let re=0;re<H;re++){const ce=de[re];_.includes(ce)&&(ce==="Campaign"?fe+=250:ce==="Labels"?fe+=150:fe+=85)}return fe},je=H=>{if(B<=0)return!1;const X=A.filter(re=>$.includes(re)).filter(re=>_.includes(re));if(X.length===0)return!1;const fe=X[X.length-1];return H===fe},Ne=H=>je(H)?"relative after:content-[''] after:absolute after:right-0 after:top-0 after:bottom-0 after:w-[3px] after:bg-gradient-to-r after:from-slate-400 after:to-transparent after:shadow-lg before:content-[''] before:absolute before:right-0 before:top-0 before:bottom-0 before:w-[1px] before:bg-slate-300":"",Te=(H,de)=>{de&&q&&t(yd({accountId:q.account_id,campaignId:H,label:de}))},Fe=(H,de)=>{q&&t(vd({accountId:q.account_id,campaignId:H,label:de}))},Z=H=>{p&&(Te(H,p),N(""),x(null))},le=H=>H==="Campaign"?{width:"auto",minWidth:"250px"}:H==="Labels"?{width:"auto",minWidth:"150px"}:{width:Kr,minWidth:Kr},oe=H=>{o(H)},_e=(H,de)=>{H.preventDefault(),de!==l&&c(de)},Pe=H=>{!l||l===H||(o(null),c(null))},Ze=()=>{o(null),c(null)},ts=H=>{h(H)},gs=(H,de)=>{H.preventDefault(),de!==m&&y(de)},Et=H=>{if(!m||m===H)return;const de=A.indexOf(m),X=A.indexOf(H);if(de!==-1&&X!==-1){const fe=[...A];fe.splice(de,1),fe.splice(X,0,m),C(fe)}h(null),y(null)},Rs=()=>{h(null),y(null)},Os=()=>{u(!d)},Yt=H=>{const de=[...L];de[H].isExpanded=!de[H].isExpanded,k(de)},Kt=H=>{const de={},X=A.filter(re=>$.includes(re)&&re!=="Campaign"&&re!=="Labels"),fe={"Conversion Rate":(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe["Link Click"]||0),0),Ie=ce.reduce((we,Oe)=>we+Number(Oe.Purchases||0),0);return xe===0?0:Ie/xe*100},"CPM (Reach Based)":(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe.Reach||0),0);return ce.reduce((we,Oe)=>we+Number(Oe["Amount spend"]||0),0)/(xe/1e3)},"Audience Saturation Score":(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe["Outbound CTR"]||0),0),Ie=ce.reduce((we,Oe)=>we+Number(Oe.Frequency||0),0);return xe===0?0:Ie/xe*100},"Reach v/s Unique Click":(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe["Unique Link Click"]||0),0),Ie=ce.reduce((we,Oe)=>we+Number(Oe.Reach||0),0);return xe===0?0:Ie/xe},"High-Intent Click Rate":(re,ce)=>{const xe=ce.reduce((Xs,et)=>Xs+Number(et["Add To Cart (ATC)"]||0),0),Ie=ce.reduce((Xs,et)=>Xs+Number(et["Checkout Initiate (CI)"]||0),0),Ye=ce.reduce((Xs,et)=>Xs+Number(et["Landing Page View"]||0),0),we=ce.reduce((Xs,et)=>Xs+Number(et["Link Click"]||0),0);return we===0?0:(xe+Ie+Ye)/we*100},HookRate:(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe["Three Seconds View"]||0),0),Ie=ce.reduce((we,Oe)=>we+Number(Oe.Impressions||0),0);return Ie===0?0:xe/Ie*100},ROAS:(re,ce)=>{const xe=ce.reduce((we,Oe)=>we+Number(Oe["Amount spend"]||0),0),Ie=ce.reduce((we,Oe)=>we+Number(Oe.Revenue||0),0);return xe>0?Ie/xe:0},Frequency:(re,ce)=>{const xe=ce.reduce((Ie,Ye)=>Ie+Number(Ye.Frequency||0),0);return ce.length?xe/ce.length:0},"Add To Cart (ATC)":(re,ce)=>{const xe=ce.reduce((Ie,Ye)=>Ie+Number(Ye["Add To Cart (ATC)"]||0),0);return ce.length?xe/ce.length:0},"Checkout Initiate (CI)":(re,ce)=>{const xe=ce.reduce((Ie,Ye)=>Ie+Number(Ye["Checkout Initiate (CI)"]||0),0);return ce.length?xe/ce.length:0},DEFAULT:(re,ce)=>re.reduce((xe,Ie)=>xe+Ie,0)};return X.forEach(re=>{const ce=H.map(Ie=>Number(Ie[re]||0)).filter(Ie=>!isNaN(Ie)),xe=fe[re]||fe.DEFAULT;de[re]=xe(ce,H).toFixed(2)}),de},$a=()=>"h-[calc(100vh-120px)]",Qt=H=>{const de=ee[H.campaignId]||[];return e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:"h-7 w-full justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 overflow-hidden",children:[e.jsx(eo,{className:"h-3.5 w-3.5 text-slate-500 shrink-0"}),e.jsx("span",{className:"truncate",children:de.length>0?`${de.length} label${de.length>1?"s":""}`:"Add label"})]}),e.jsx(os,{className:"h-3.5 w-3.5 opacity-70"})]})}),e.jsx(As,{align:"start",className:"w-56",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-2",children:"Predefined labels"}),J.map(X=>{const fe=de.includes(X);return e.jsx(ze,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{fe?Fe(H.campaignId,X):Te(H.campaignId,X)},children:e.jsx(ps,{className:"bg-slate-100 text-slate-800 border border-slate-200 hover:bg-slate-200 text-xs py-0.5 px-2 w-full",children:X})},X)}),ae.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ra,{}),e.jsx("div",{className:"text-xs font-medium text-slate-500 my-2",children:"Custom labels"}),ae.filter(X=>!J.includes(X)).map(X=>{const fe=de.includes(X);return e.jsx(ze,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{fe?Fe(H.campaignId,X):Te(H.campaignId,X)},children:e.jsx(ps,{className:`${te.get(X)} text-xs py-0.5 px-2`,children:X})},X)})]}),e.jsx(ra,{}),S===H.campaignId?e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1",children:[e.jsx(ve,{ref:W,value:p,onChange:X=>N(X.target.value),placeholder:"New label name",className:"h-7 text-xs",autoFocus:!0,onKeyDown:X=>{X.key==="Enter"?Z(H.campaignId):X.key==="Escape"&&(x(null),N(""))}}),e.jsx(z,{size:"sm",className:"h-7 px-2",onClick:()=>Z(H.campaignId),children:e.jsx(Hs,{className:"h-3.5 w-3.5"})})]}):e.jsxs(ze,{className:"flex items-center gap-2 cursor-pointer",onClick:X=>{X.preventDefault(),x(H.campaignId),N(""),setTimeout(()=>{var fe;(fe=W.current)==null||fe.focus()},0)},children:[e.jsx(qs,{className:"h-3.5 w-3.5 text-slate-500"}),e.jsx("span",{className:"text-sm",children:"Create new label"})]})]})})]})};return r.useEffect(()=>()=>{E.current&&clearTimeout(E.current)},[]),e.jsx(_t,{children:e.jsxs(ue,{className:`overflow-hidden ${d?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 p-2 rounded-2xl",children:[a&&a.length>0&&e.jsx("button",{onClick:()=>g("all"),className:`px-6 py-1 rounded-2xl text-sm font-medium transition-all duration-200 ${P==="all"?"bg-white text-blue-700 shadow-sm":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:"All"},"all"),s.map(H=>e.jsx("button",{onClick:()=>g(H.account_id),className:`px-6 py-1 rounded-2xl text-sm font-medium transition-all duration-200 ${P===H.account_id?"bg-white text-blue-700 shadow-sm":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:H.account_name},H.account_id))]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{}),e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",className:`gap-1 font-medium ${b!=="all"?"bg-blue-50 text-blue-600 border-blue-200":""}`,children:[e.jsx(Mt,{className:`h-4 w-4 ${b!=="all"?"text-blue-600":"text-slate-500"}`}),b==="all"?"All Status":b==="active"?"Active":"Paused"]})}),e.jsxs(As,{align:"end",className:"w-32",children:[e.jsx(ze,{onClick:()=>T("all"),className:b==="all"?"bg-blue-50":"",children:"All Status"}),e.jsx(ze,{onClick:()=>T("active"),className:b==="active"?"bg-blue-50":"",children:"Active"}),e.jsx(ze,{onClick:()=>T("paused"),className:b==="paused"?"bg-blue-50":"",children:"Paused"})]})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(z,{variant:"outline",onClick:()=>w(!j),size:"sm",className:`gap-1 font-medium ${j?"bg-blue-50 text-blue-600 border-blue-200":""}`,disabled:!M,children:e.jsx(Oi,{className:`h-4 w-4 ${j?"text-blue-600":"text-slate-500"}`})})}),e.jsx(ns,{children:j?"Exit Edit Mode":"Edit Labels"})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(z,{variant:"outline",onClick:()=>R(!M),size:"sm",className:"gap-1 font-medium",children:M?e.jsx(e.Fragment,{children:e.jsx(Nr,{className:"h-4 w-4 text-blue-600"})}):e.jsx(e.Fragment,{children:e.jsx(Nr,{className:"h-4 w-4 text-slate-500"})})})}),e.jsx(ns,{children:M?"Disable Grouping":"Enable Grouping"})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("div",{children:e.jsx(gr,{visibleColumns:$,columnOrder:A,frozenColumns:_,onVisibilityChange:F,onOrderChange:C,onFrozenChange:I})})}),e.jsx(ns,{children:"Manage Columns"})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",onClick:Os,className:"font-medium",children:d?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(ns,{children:d?"Exit Fullscreen":"Enter Fullscreen"})]})]})]}),e.jsx("div",{className:"p-3",children:s.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No campaign data available"}):e.jsx("div",{className:"block",children:e.jsx("div",{ref:U,className:`overflow-auto ${$a()} bg-white rounded-lg border border-slate-200 shadow-sm`,onScroll:H=>{const X=H.target.scrollLeft;O(X),E.current&&clearTimeout(E.current)},children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:A.filter(H=>$.includes(H)).filter(H=>!M||H!=="campaignName").map((H,de)=>{const X=_.includes(H),fe=X?`${me(de)}px`:void 0,re=le(H);return e.jsx("th",{ref:ce=>D.current[H]=ce,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${X?"sticky z-20 bg-slate-50":""} ${v===H?"bg-blue-50":""} ${Ne(H)}`,style:{left:fe,...re},draggable:!0,onDragStart:()=>ts(H),onDragOver:ce=>gs(ce,H),onDrop:()=>Et(H),onDragEnd:Rs,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:H}),e.jsx(co,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},H)})})}),e.jsxs("tbody",{children:[M&&L.map((H,de)=>e.jsxs(Se.Fragment,{children:[e.jsx("tr",{className:"bg-gradient-to-r from-slate-100 to-slate-50 font-medium hover:bg-slate-100 transition-colors",children:A.filter(X=>$.includes(X)).filter(X=>!M||X!=="campaignName").map((X,fe)=>{const re=_.includes(X),ce=re?`${me(fe)}px`:void 0,xe=le(X),Ie=Kt(H.campaigns);return X==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50 ${Ne(X)}`,style:{left:ce,...xe},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>Yt(de),className:"mr-2 focus:outline-none rounded-full p-0.5 hover:bg-slate-200 transition-colors",children:H.isExpanded?e.jsx(os,{className:"h-4 w-4 text-slate-600"}):e.jsx(Je,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("span",{className:"font-medium text-slate-700",children:["Group: ",H.campaigns.length," campaigns"]})]})},X):X==="Labels"?e.jsx("td",{className:`p-2 border-r ${re?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"} ${Ne(X)}`,style:{left:ce,...xe},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ps,{className:`${te.get(H.label)} w-fit flex items-center gap-1 cursor-default text-xs py-0.5 px-2 rounded-md`,children:H.label}),j&&e.jsx(z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-red-50",onClick:()=>{H.campaigns.forEach(Ye=>{Fe(Ye.campaignId,H.label)})},children:e.jsx(hs,{className:"h-3.5 w-3.5 text-red-500"})})]})},X):e.jsx("td",{className:`p-2 border-r ${re?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"} font-semibold`,style:{left:ce,...xe},children:e.jsx("div",{children:Ie[X]})},X)})}),H.isExpanded&&H.campaigns.map((X,fe)=>e.jsx("tr",{className:`group border-b border-2 hover:bg-slate-50 transition-colors ${i===X.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>oe(X.campaignName),onDragOver:re=>_e(re,X.campaignName),onDrop:()=>Pe(X.campaignName),onDragEnd:Ze,children:A.filter(re=>$.includes(re)).filter(re=>!M||re!=="campaignName").map((re,ce)=>{const xe=_.includes(re),Ie=xe?`${me(ce)}px`:void 0,Ye=le(re);return re==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky bg-white z-10 group-hover:bg-slate-50 transition-colors ${Ne(re)}`,style:{left:Ie,paddingLeft:"30px",...Ye},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium",children:X.campaignName}),X.accountName&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded whitespace-nowrap",children:X.accountName})]})},re):re==="Labels"?e.jsx("td",{className:`p-2 border-r ${xe?"sticky z-10 bg-white group-hover:bg-slate-50 transition-colors":""} ${Ne(re)}`,style:{left:Ie,...Ye},children:j&&M?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ps,{className:`${te.get(H.label)} w-fit flex items-center gap-1 text-xs py-0.5 px-2 rounded-md`,children:H.label}),e.jsx(z,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 rounded-full hover:bg-red-50",onClick:()=>Fe(X.campaignId,H.label),children:e.jsx(hs,{className:"h-3.5 w-3.5 text-red-500"})}),e.jsxs($s,{children:[e.jsx(Fs,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",className:"h-7",children:"Change"})}),e.jsx(As,{align:"start",className:"w-56",children:e.jsxs("div",{className:"p-2",children:[ae.filter(we=>we!==H.label).map(we=>e.jsx(ze,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{Fe(X.campaignId,H.label),Te(X.campaignId,we)},children:e.jsx(ps,{className:`${te.get(we)} text-xs py-0.5 px-2`,children:we})},we)),e.jsx(ra,{}),e.jsxs(ze,{className:"flex items-center gap-2 cursor-pointer",onClick:we=>{we.preventDefault(),x(X.campaignId),N(""),setTimeout(()=>{var Oe;(Oe=W.current)==null||Oe.focus()},0)},children:[e.jsx(qs,{className:"h-3.5 w-3.5 text-slate-500"}),e.jsx("span",{className:"text-sm",children:"Create new label"})]}),S===X.campaignName&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 mt-2",children:[e.jsx(ve,{ref:W,value:p,onChange:we=>N(we.target.value),placeholder:"New label name",className:"h-7 text-xs",autoFocus:!0,onKeyDown:we=>{we.key==="Enter"?(Z(X.campaignId),Fe(X.campaignId,H.label)):we.key==="Escape"&&(x(null),N(""))}}),e.jsx(z,{size:"sm",className:"h-7 px-2",onClick:()=>{Z(X.campaignId),Fe(X.campaignId,H.label)},children:e.jsx(Hs,{className:"h-3.5 w-3.5"})})]})]})})]})]}):Qt(X)},re):e.jsx("td",{className:`p-2 border-r ${xe?"sticky z-10 bg-white group-hover:bg-slate-50 transition-colors":""} ${Ne(re)}`,style:{left:Ie,...Ye},children:e.jsx("div",{children:X[re]})},re)})},`group-${H.label}-campaign-${X.campaignId}-${fe}`))]},`group-${H.label}`)),M&&f.length>0&&e.jsx("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-50 font-medium hover:bg-gray-100 transition-colors",children:A.filter(H=>$.includes(H)).filter(H=>!M||H!=="campaignName").map((H,de)=>{const X=_.includes(H),fe=X?`${me(de)}px`:void 0,re=le(H);if(H==="Campaign")return e.jsx("td",{className:`p-2 border-r sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50 ${Ne(H)}`,style:{left:fe,...re},children:e.jsxs("div",{className:"font-medium text-slate-700 flex items-center",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2 text-slate-500"}),"Unlabeled: ",f.length," campaigns"]})},H);if(H==="Labels")return e.jsx("td",{className:`p-2 border-r ${X?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":""} ${Ne(H)}`,style:{left:fe,...re},children:"-"},H);const ce=Kt(f);return e.jsx("td",{className:`p-2 border-r ${X?"sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50":"bg-gradient-to-r from-gray-100 to-gray-50"} font-semibold`,style:{left:fe,...re},children:e.jsx("div",{children:ce[H]})},H)})}),(M?f:se).map((H,de)=>e.jsx("tr",{className:`group border-b border-2 hover:bg-slate-50 transition-colors ${i===H.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>oe(H.campaignName),onDragOver:X=>_e(X,H.campaignName),onDrop:()=>Pe(H.campaignName),onDragEnd:Ze,children:A.filter(X=>$.includes(X)).filter(X=>!M||X!=="campaignName").map((X,fe)=>{const re=_.includes(X),ce=re?`${me(fe)}px`:void 0,xe=le(X);return X==="Campaign"?e.jsx("td",{className:`p-2 border-r sticky z-10 bg-white group-hover:bg-slate-50 transition-colors ${Ne(X)}`,style:{left:ce,...xe},children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium",children:H.campaignName}),H.accountName&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded whitespace-nowrap",children:H.accountName})]})},X):X==="Labels"?e.jsx("td",{className:`p-2 border-r ${re?"sticky z-10 bg-white group-hover:bg-slate-50 transition-colors":""} ${Ne(X)}`,style:{left:ce,...xe},children:Qt(H)},X):e.jsx("td",{className:`p-2 border-r ${re?"sticky z-10 bg-white group-hover:bg-slate-50 transition-colors":""} ${Ne(X)}`,style:{left:ce,...xe},children:e.jsx("div",{children:H[X]})},X)})},`${M?"ungrouped":"all"}-${H.campaignName}-${de}`))]})]})})},q==null?void 0:q.account_id)})]})})};function eh(){var N;const[s,a]=r.useState(!1),[t,l]=r.useState(),o=V(j=>j.date.from),i=V(j=>j.date.to),c=r.useMemo(()=>({from:o,to:i}),[o,i]),d=Ce(),{brandId:u}=ge(),h=V(j=>j.brand.brands).find(j=>j._id===u),v=!!(h!=null&&h.fbAdAccounts&&(h==null?void 0:h.fbAdAccounts.length)>0),y=V(cr),S=Xe(),x=r.useCallback(async()=>{var j;a(!0);try{const w=c!=null&&c.from?Y(c.from,"yyyy-MM-dd"):"",P=c!=null&&c.to?Y(c.to,"yyyy-MM-dd"):"";try{const $=(await d.post(`/api/meta/campaign/${u}`,{startDate:w,endDate:P},{withCredentials:!0})).data;l($)}catch(g){console.error("Error fetching Facebook ad data:",g)}}catch(w){console.error("Error fetching ad data:",w),ne.isAxiosError(w)&&((j=w.response)==null?void 0:j.status)===401&&(alert("Your session has expired. Please log in again."),S("/"))}finally{a(!1)}},[S,c,u]);r.useEffect(()=>{x()},[x]),r.useEffect(()=>{x();const j=setInterval(x,6*60*60*1e3);return()=>clearInterval(j)},[x]);const p=t==null?void 0:t.accountData;return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[y?e.jsx(ht,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(Is,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):v?!c.from||!c.to?e.jsx(Zs,{}):s?e.jsx(Ae,{isLoading:s}):e.jsx(e.Fragment,{children:e.jsx("main",{className:"p-3 overflow-auto",children:e.jsx("div",{className:"grid grid-cols-1 gap-6",children:p&&e.jsx(Xu,{data:p.map(j=>({account_name:j.account_name,account_id:j.account_id,campaigns:j.campaigns.map(w=>({...w,Campaign:w.campaignName}))})),blendedSummary:(N=t==null?void 0:t.blendedSummary)==null?void 0:N.map(j=>({...j,Campaign:j.campaignName}))})})})}):e.jsx(e.Fragment,{children:e.jsx(Pt,{platform:"facebook",brandId:u??"",onSuccess:(j,w,P)=>{console.log(`Successfully connected ${j} account: ${w} (${P})`)}})}),e.jsx(Ps,{})]})]})}const sh=({columns:s,tableId:a})=>{const t=Me(),l=V(v=>v.interestFilter.filters[a]||[]),[o,i]=r.useState(!1),[c,d]=r.useState({column:s[0],operator:">",value:""}),u=()=>{c.value&&(t(_d({tableId:a,filter:{...c,value:c.column==="Interest"?c.value:Number(c.value)}})),d({...c,value:""}),i(!1))},m=v=>{t(Id({tableId:a,index:v}))},h=()=>{t(Pd({tableId:a}))};return e.jsxs(ct,{open:o,onOpenChange:i,children:[e.jsx(dt,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(Mt,{className:"h-4 w-4"}),l.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:l.length})]})}),e.jsx(Ys,{className:"w-80",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(We,{value:c.column,onValueChange:v=>d({...c,column:v}),children:[e.jsx(Be,{children:e.jsx(He,{placeholder:"Select column"})}),e.jsx(Ge,{children:s.map(v=>e.jsx(ie,{value:v,children:v},v))})]}),e.jsxs(We,{value:c.operator,onValueChange:v=>d({...c,operator:v}),children:[e.jsx(Be,{children:e.jsx(He,{placeholder:"Operator"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:">",children:">"}),e.jsx(ie,{value:"<",children:"<"}),e.jsx(ie,{value:"=",children:"="}),e.jsx(ie,{value:">=",children:">="}),e.jsx(ie,{value:"<=",children:"<="})]})]}),e.jsx(ve,{type:c.column==="Interest"?"text":"number",value:c.value,onChange:v=>d({...c,value:v.target.value}),placeholder:"Enter value"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{onClick:u,className:"flex-1",children:"Add Filter"}),e.jsx(z,{variant:"outline",onClick:h,className:"flex-1",children:"Clear All"})]}),l.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Active Filters"}),l.map((v,y)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 rounded-md",children:[e.jsxs("div",{className:"flex-1 text-sm",children:[v.column," ",v.operator," ",v.value]}),e.jsx(z,{variant:"ghost",size:"icon",onClick:()=>m(y),className:"h-6 w-6",children:e.jsx(hs,{className:"h-3 w-3"})})]},y))]})]})})]})},Qr="100px",Jr=({data:s,height:a="max-h-96",accountName:t,showAccounts:l=!1})=>{var ee;const[o,i]=r.useState(null),[c,d]=r.useState(null),[u,m]=r.useState(!1),[h,v]=r.useState(null),[y,S]=r.useState(null),x=V(J=>J.interestFilter.filters[t||"blended"]||[]),[p,N]=r.useState(l?["Interest","Spend","Revenue","Roas","accounts"]:["Interest","Spend","Revenue","Roas"]),[j,w]=r.useState(l?["Interest","Spend","Revenue","Roas","accounts"]:["Interest","Spend","Revenue","Roas"]),[P,g]=r.useState(["Interest"]),$=r.useRef(null),F=r.useRef({}),A=J=>J.filter(ae=>x.every(pe=>{const G=ae[pe.column],se=pe.value;switch(pe.operator){case">":return Number(G)>Number(se);case"<":return Number(G)<Number(se);case"=":return String(G).toLowerCase()===String(se).toLowerCase();case">=":return Number(G)>=Number(se);case"<=":return Number(G)<=Number(se);default:return!0}})),C=t?((ee=s.resultsByAccount[t])==null?void 0:ee.interestMetrics)||[]:s.blendedSummary||[],_=A(C),I=t||"All Accounts",B=J=>{let ae=0;const pe=j.filter(G=>p.includes(G));for(let G=0;G<J;G++){const se=pe[G];if(P.includes(se)){const te=F.current[se];te&&(ae+=te.offsetWidth)}}return ae},O=J=>J==="Interest"?{width:"auto",minWidth:"200px"}:J==="accounts"?{width:"auto",minWidth:"120px"}:{width:Qr,minWidth:Qr},E=J=>{i(J)},M=(J,ae)=>{J.preventDefault(),ae!==o&&d(ae)},R=J=>{!o||o===J||(i(null),d(null),console.log(`Dragged ${o} and dropped on ${J}`))},L=()=>{i(null),d(null)},k=J=>{v(J)},f=(J,ae)=>{J.preventDefault(),ae!==h&&S(ae)},n=J=>{if(!h||h===J)return;const ae=j.indexOf(h),pe=j.indexOf(J);if(ae!==-1&&pe!==-1){const G=[...j];G.splice(ae,1),G.splice(pe,0,h),w(G)}v(null),S(null)},b=()=>{v(null),S(null)},T=()=>{m(!u)},U=()=>u?"max-h-screen":a,D=J=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(J),W=J=>J.toFixed(2)+"x",K=J=>!J||J.length===0?"-":J.length<=2?J.join(", "):`${J[0]}, ${J[1]} +${J.length-2} more`,q=(J,ae)=>{switch(ae){case"Interest":return J.Interest;case"Spend":return D(J.Spend);case"Revenue":return D(J.Revenue);case"Roas":return W(J.Roas);case"accounts":return K(J.accounts);default:return J[ae]||"-"}};return!C||C.length===0?e.jsx(ue,{className:"p-4",children:e.jsx("div",{className:"text-center text-slate-500",children:"No interest data available"})}):e.jsx(_t,{children:e.jsxs(ue,{className:`overflow-hidden ${u?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{height:"1rem",width:"1rem"}),e.jsxs("div",{className:"text-base font-semibold text-slate-800",children:["Interest Performance ",e.jsxs("span",{children:["(",I,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(sh,{columns:p,tableId:t||"blended"})}),e.jsx(ns,{children:"Apply Filter"})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(z,{variant:"outline",size:"sm",onClick:T,className:"font-medium",children:u?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(ns,{children:u?"Exit Fullscreen":"Enter Fullscreen"})]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("div",{children:e.jsx(gr,{visibleColumns:p,columnOrder:j,frozenColumns:P,onVisibilityChange:N,onOrderChange:w,onFrozenChange:g})})}),e.jsx(ns,{children:"Manage Columns"})]})]})]}),e.jsx("div",{className:"p-3",children:e.jsx("div",{ref:$,className:`overflow-auto ${U()} bg-white rounded-lg border border-slate-200 shadow-sm `,children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:j.filter(J=>p.includes(J)).map((J,ae)=>{const pe=P.includes(J),G=pe?`${B(ae)}px`:void 0,se=O(J);return e.jsx("th",{ref:te=>F.current[J]=te,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${pe?"sticky z-20 bg-slate-50":""} ${y===J?"bg-blue-50":""}`,style:{left:G,...se},draggable:!0,onDragStart:()=>k(J),onDragOver:te=>f(te,J),onDrop:()=>n(J),onDragEnd:b,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:J}),e.jsx(co,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},J)})})}),e.jsx("tbody",{children:_.map(J=>e.jsx("tr",{className:`border-b hover:bg-slate-50 transition-colors ${c===J.InterestId?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>E(J.InterestId),onDragOver:ae=>M(ae,J.InterestId),onDrop:()=>R(J.InterestId),onDragEnd:L,children:j.filter(ae=>p.includes(ae)).map((ae,pe)=>{const G=P.includes(ae),se=G?`${B(pe)}px`:void 0,te=O(ae);return e.jsx("td",{className:`p-2 border-b border-r text-slate-700 ${G?"sticky z-10 bg-inherit":""}`,style:{left:se,...te},children:q(J,ae)},`${J.InterestId}-${ae}`)})},J.InterestId))})]})})})]})})};function th(){var A;const[s,a]=r.useState(!1),[t,l]=r.useState(null),[o,i]=r.useState(null),c=Me(),d=V(C=>C.brand.brands),{brandId:u}=ge(),m=d.find(C=>C._id===u),h=!!(m!=null&&m.fbAdAccounts&&(m==null?void 0:m.fbAdAccounts.length)>0),v=V(cr),y=V(C=>C.date.from),S=V(C=>C.date.to),x=r.useMemo(()=>({from:y,to:S}),[y,S]);r.useEffect(()=>{c(ca(!1))},[u]);const p=Ce(),N=Xe(),j=r.useCallback(async()=>{var C,_,I;if(!(!x.from||!x.to)){a(!0),i(null);try{const B=Y(x.from,"yyyy-MM-dd"),O=Y(x.to,"yyyy-MM-dd"),E=await p.post(`/api/meta/interest/${u}`,{startDate:B,endDate:O},{withCredentials:!0});console.log("API Response:",E.data),E.data&&E.data.data?l(E.data.data):(console.error("Invalid data structure:",E.data),i("Invalid data structure received from API"))}catch(B){console.error("Error fetching interest data:",B),ne.isAxiosError(B)?((C=B.response)==null?void 0:C.status)===401?(alert("Your session has expired. Please log in again."),N("/")):i(`API Error: ${((I=(_=B.response)==null?void 0:_.data)==null?void 0:I.message)||B.message}`):i("An unexpected error occurred")}finally{a(!1)}}},[N,x,u]);r.useEffect(()=>{x.from&&x.to&&j()},[j,x]),r.useEffect(()=>{const C=setInterval(()=>{x.from&&x.to&&j()},108e5);return()=>clearInterval(C)},[j,x]);const w=r.useMemo(()=>{if(!(t!=null&&t.resultsByAccount))return console.log("No resultsByAccount found in metaInterest:",t),[];const C=Object.keys(t.resultsByAccount);return console.log("Found accounts:",C),C.filter(_=>{var B,O;const I=((O=(B=t.resultsByAccount[_])==null?void 0:B.interestMetrics)==null?void 0:O.length)>0;return console.log(`Account ${_} has interests: ${I}`),I})},[t]),P=r.useMemo(()=>{const C="max-h-[calc(100vh-210px)]";return!(t!=null&&t.resultsByAccount)||Object.keys(t.resultsByAccount).length<=1?C:"max-h-[calc(100vh-400px)]"},[t]),g=(t==null?void 0:t.blendedSummary)&&t.blendedSummary.length>0;console.log("Has blended data:",g,(A=t==null?void 0:t.blendedSummary)==null?void 0:A.length);const $=w.length>0;console.log("Has account data:",$,w.length);const F=g||$;return console.log("Has any data:",F),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(Sa,{title:"Meta Interest Analysis",Icon:uo,showDatePicker:!0}),v?e.jsx(ht,{platform:"Facebook Ads",message:"Looks like we need to refresh your Facebook Ads connection to optimize your campaigns.",icon:e.jsx(Is,{className:"w-8 h-8 text-red-500"}),loginOptions:[{label:"Connect Facebook Ads",provider:"facebook"}]}):h?!x.from||!x.to?e.jsx(Zs,{}):s?e.jsx(Ae,{isLoading:s}):e.jsx("main",{className:"p-4 md:p-6 lg:px-8 overflow-auto",children:o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500",children:o}),e.jsx("button",{onClick:j,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]}):t?e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[g&&e.jsx(Jr,{data:t,height:P,showAccounts:!0}),$&&w.map(C=>e.jsx(Jr,{data:{resultsByAccount:{[C]:t.resultsByAccount[C]},blendedSummary:t.resultsByAccount[C].interestMetrics},height:P,accountName:C,showAccounts:!1},C)),!F&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No interest data available. Please try adjusting your date range."})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No interest data available. Please try adjusting your date range."})})}):e.jsx(Pt,{platform:"facebook",brandId:u??"",onSuccess:(C,_,I)=>{console.log(`Successfully connected ${C} account: ${_} (${I})`)}}),e.jsx(yr,{}),e.jsx(Ps,{})]})]})}function ah(){const[s,a]=r.useState(!0),[t,l]=r.useState(null),o=tr();return r.useEffect(()=>{async function i(){var c,d;try{const u=new URLSearchParams(o.search),m={};for(const[v,y]of u.entries())m[v]=y;if(!m.shop){l("Shop parameter is missing"),a(!1);return}const h=await ne.post(`${be}/api/auth/shopify`,m);h.data&&h.data.success&&h.data.authUrl?window.location.href=h.data.authUrl:(l("Failed to get authorization URL"),a(!1))}catch(u){ne.isAxiosError(u)?l(((d=(c=u.response)==null?void 0:c.data)==null?void 0:d.error)||u.message||"An error occurred"):l((u==null?void 0:u.message)||"An error occurred"),a(!1)}}i()},[o]),s?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner mb-4"}),e.jsx("p",{className:"text-lg",children:"Connecting to Dashboard..."})]})}):t?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-6 max-w-md",children:[e.jsx("h2",{className:"text-red-700 text-lg font-medium mb-2",children:"Authentication Error"}),e.jsx("p",{className:"text-red-600",children:t}),e.jsx("button",{className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded",onClick:()=>window.location.href="/",children:"Return to Home"})]})}):null}const rh=()=>{const s=Xe(),[a,t]=r.useState(!0),[l,o]=r.useState(""),i="https://parallels.messold.com";return r.useEffect(()=>{(async()=>{var d,u;try{const m=new URLSearchParams(window.location.search),h=m.get("shop"),v=m.get("charge_id");if(!h||!v){console.error("Missing required parameters: shop or charge_id"),o("Missing required parameters"),t(!1),setTimeout(()=>s("/dashboard"),2e3);return}console.log(`Processing subscription for shop: ${h}, charge ID: ${v}`),await ne.get(`${i}/api/pricing/callback`,{params:{shop:h,charge_id:v}}),console.log("Subscription processed successfully"),t(!1),s("/dashboard")}catch(m){console.error("Error processing subscription:",m),o(((u=(d=m.response)==null?void 0:d.data)==null?void 0:u.error)||"An error occurred"),t(!1),setTimeout(()=>s("/dashboard"),2e3)}})()},[s,i]),a?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-lg font-medium",children:"Processing your subscription..."})]}):l?e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[e.jsxs("p",{children:["Error: ",l]}),e.jsx("p",{className:"mt-2",children:"Redirecting to dashboard..."})]})}):null};function nh(){return e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("div",{className:"w-full",children:e.jsx(Zo,{})}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fadeInUp",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2 group-hover:bg-primary/20 transition-colors",children:e.jsx(Ms,{className:"h-5 w-5 text-primary"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Connect Multiple Platforms"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Link all your marketing platforms for comprehensive analytics and insights"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-success/10 p-2 group-hover:bg-success/20 transition-colors",children:e.jsx(Ms,{className:"h-5 w-5 text-success"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Real-time Updates"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your data will be automatically synced every 3 hours for accurate reporting"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border hover:shadow-md transition-all duration-200 transform hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-full bg-warning/10 p-2 group-hover:bg-warning/20 transition-colors",children:e.jsx(Ms,{className:"h-5 w-5 text-warning"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Easy Management"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage all your brands and their performance from a single dashboard"})]})]})]})})]})}const oh=()=>{const s=Me(),a=Xe(),t=r.useRef(null),l=async()=>{try{return(await ne.get(`${be}/api/auth/check-token`,{withCredentials:!0})).data}catch(c){return console.error("Error checking token validity:",c),null}},o=async()=>{try{await ne.post(`${be}/api/auth/logout`,{},{withCredentials:!0})}catch(c){console.error("Error during logout API call:",c)}s(wa()),s(Na()),a("/login")},i=async()=>{const c=await l();if(!c){console.log("Failed to check token validity");return}if(!c.isValid){console.log("Token is invalid or expired:",c.message),o();return}};return r.useEffect(()=>(i(),t.current=setInterval(i,6e4),()=>{t.current&&clearInterval(t.current)}),[]),{checkTokenStatus:i,isTokenValid:async()=>{const c=await l();return(c==null?void 0:c.isValid)||!1}}},lh=({children:s})=>(oh(),e.jsx(e.Fragment,{children:s})),ih=({creative:s,selectedKPIs:a})=>{var g,$,F,A;const t=C=>a?a.has(C):!0,[l,o]=r.useState(!1),[i,c]=r.useState(!1),[d,u]=r.useState(0),m=Se.useRef(null),h=s.carousel_images||[],v=s.creative_type==="carousel"&&h.length>0;r.useEffect(()=>{u(0)},[s.ad_id]);const y=()=>{m.current&&(l?m.current.pause():m.current.play(),o(!l))},S=C=>{C.stopPropagation(),u(_=>(_+1)%h.length)},x=C=>{C.stopPropagation(),u(_=>(_-1+h.length)%h.length)},p=()=>{u(0),c(!0)},N=C=>C==null?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(C),j=(C,_=0)=>C==null?"-":C.toFixed(_),w=(C,_=2)=>C==null?"-":`${C.toFixed(_)}%`,P=(C,_=2)=>C==null?"-":`${C.toFixed(_)}x`;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:Q("flex flex-col border border-border rounded-lg bg-card overflow-hidden","hover:border-primary/30 hover:shadow-lg transition-all duration-200","group h-full"),children:[e.jsxs("div",{className:"relative w-full aspect-square bg-muted overflow-hidden",children:[e.jsx("div",{className:"absolute top-2 left-2 z-30",children:e.jsx("span",{className:Q("inline-block text-[10px] px-2 py-0.5 rounded-full font-medium shadow-sm",s.status==="ACTIVE"||s.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":s.status==="PAUSED"||s.status==="paused"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":s.status==="DELETED"||s.status==="deleted"||s.status==="ARCHIVED"||s.status==="archived"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:s.status||"Unknown"})}),v?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:(g=h[d])==null?void 0:g.url,alt:(($=h[d])==null?void 0:$.name)||s.ad_name,className:"w-full h-full object-cover transition-opacity duration-300"}),h.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 z-20 flex items-center justify-center w-8 h-8",children:e.jsx(z,{variant:"secondary",size:"icon",className:"!w-8 !h-8 !rounded-full bg-black/50 hover:!bg-black/70 hover:!w-8 hover:!h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity pointer-events-auto !border-0 !p-0 !m-0 !min-w-[2rem] !min-h-[2rem] !max-w-[2rem] !max-h-[2rem] flex-shrink-0",onClick:x,style:{transform:"none",width:"2rem",height:"2rem"},children:e.jsx(us,{className:"w-4 h-4 flex-shrink-0"})})}),e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 z-20 flex items-center justify-center w-8 h-8",children:e.jsx(z,{variant:"secondary",size:"icon",className:"!w-8 !h-8 !rounded-full bg-black/50 hover:!bg-black/70 hover:!w-8 hover:!h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity pointer-events-auto !border-0 !p-0 !m-0 !min-w-[2rem] !min-h-[2rem] !max-w-[2rem] !max-h-[2rem] flex-shrink-0",onClick:S,style:{transform:"none",width:"2rem",height:"2rem"},children:e.jsx(Je,{className:"w-4 h-4 flex-shrink-0"})})}),e.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1.5",children:h.map((C,_)=>e.jsx("button",{className:Q("h-1.5 rounded-full transition-all",_===d?"w-6 bg-white":"w-1.5 bg-white/50"),onClick:I=>{I.stopPropagation(),u(_)},"aria-label":`Go to slide ${_+1}`},C.url||`carousel-${_}`))})]}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center pointer-events-none z-10",children:e.jsx(z,{variant:"secondary",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity w-10 h-10 rounded-full pointer-events-auto",onClick:p,children:e.jsx(na,{className:"w-5 h-5"})})})]})}):s.creative_type==="video"&&s.creative_url?e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:m,src:s.creative_url,poster:s.thumbnail_url||void 0,className:"w-full h-full object-cover",loop:!0,playsInline:!0,onPlay:()=>o(!0),onPause:()=>o(!1)}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors flex items-center justify-center",children:e.jsx(z,{variant:"secondary",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity w-12 h-12 rounded-full",onClick:y,children:l?e.jsx(zi,{className:"w-6 h-6"}):e.jsx(Vt,{className:"w-6 h-6 ml-1"})})})]}):s.creative_url||s.thumbnail_url?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:s.creative_url||s.thumbnail_url,alt:s.ad_name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105 cursor-pointer",onClick:p}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:e.jsx(z,{variant:"secondary",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity w-10 h-10 rounded-full",onClick:p,children:e.jsx(na,{className:"w-5 h-5"})})})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:e.jsx(ya,{className:"w-16 h-16"})})]}),e.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-start gap-1",children:[e.jsx("h3",{className:"text-sm font-semibold flex-1 leading-tight",children:s.ad_name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Y(new Date(s.created_time),"dd/MM/yyyy")})]}),e.jsx("span",{className:Q("inline-block text-[10px] px-2 py-0.5 rounded-full font-medium flex-shrink-0",s.creative_type==="video"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":s.creative_type==="image"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":s.creative_type==="carousel"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),children:s.creative_type==="video"?"Video":s.creative_type==="image"?"Image":s.creative_type==="carousel"?"Carousel":"Unknown"})]})}),e.jsxs("div",{className:"space-y-1 flex-1 text-xs",children:[t("spend")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Spend"}),e.jsx("span",{className:"font-semibold",children:N(s.spend)})]}),t("revenue")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Revenue"}),e.jsx("span",{className:"font-semibold",children:N(s.revenue)})]}),t("roas")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"ROAS"}),e.jsx("span",{className:"font-semibold",children:P(s.roas)})]}),t("cpc")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"CPC"}),e.jsx("span",{className:"font-semibold",children:N(s.cpc)})]}),t("cpp")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"CPP"}),e.jsx("span",{className:"font-semibold",children:N(s.cpp)})]}),t("orders")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Orders"}),e.jsx("span",{className:"font-semibold",children:j(s.orders)})]}),t("impressions")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Impressions"}),e.jsx("span",{className:"font-semibold",children:j(s.impressions)})]}),t("clicks")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Clicks"}),e.jsx("span",{className:"font-semibold",children:j(s.clicks)})]}),t("ctr")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"CTR"}),e.jsx("span",{className:"font-semibold",children:w(s.ctr)})]}),t("frequency")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Frequency"}),e.jsx("span",{className:"font-semibold",children:j(s.frequency,2)})]}),t("hook_rate")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Hook Rate"}),e.jsx("span",{className:"font-semibold",children:w(s.hook_rate)})]}),t("engagementRate")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Engagement Rate"}),e.jsx("span",{className:"font-semibold",children:s.engagementRate!==void 0?w(s.engagementRate*100):"-"})]}),t("video_views")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"Video Views"}),e.jsx("span",{className:"font-semibold",children:j(s.video_views)})]}),t("video_p25_watched")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"25% Watched"}),e.jsx("span",{className:"font-semibold",children:j(s.video_p25_watched)})]}),t("video_p50_watched")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"50% Watched"}),e.jsx("span",{className:"font-semibold",children:j(s.video_p50_watched)})]}),t("video_p100_watched")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"100% Watched"}),e.jsx("span",{className:"font-semibold",children:j(s.video_p100_watched)})]}),t("video_p25_watched_rate")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"25% Watched Rate"}),e.jsx("span",{className:"font-semibold",children:w(s.video_p25_watched_rate)})]}),t("video_p50_watched_rate")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"50% Watched Rate"}),e.jsx("span",{className:"font-semibold",children:w(s.video_p50_watched_rate)})]}),t("video_p100_watched_rate")&&e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-border/50",children:[e.jsx("span",{className:"text-muted-foreground",children:"100% Watched Rate"}),e.jsx("span",{className:"font-semibold",children:w(s.video_p100_watched_rate)})]}),(a==null?void 0:a.size)===0&&e.jsx("div",{className:"flex items-center justify-center py-4 text-muted-foreground text-xs",children:"No metrics selected"})]}),e.jsx("div",{className:"mt-3 pt-2 border-t",children:e.jsxs(z,{variant:"outline",size:"sm",className:"w-full text-xs h-7",onClick:()=>window.open(s.creative_url||s.thumbnail_url,"_blank"),children:[e.jsx(Ga,{className:"w-3 h-3 mr-1.5"}),"View Full Size"]})})]})]}),i&&(v||s.creative_url||s.thumbnail_url)&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 backdrop-blur-sm",onClick:()=>c(!1),children:e.jsxs("div",{className:"relative max-w-7xl max-h-[90vh] w-full h-full flex items-center justify-center",children:[v?e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[e.jsx("img",{src:(F=h[d])==null?void 0:F.url,alt:((A=h[d])==null?void 0:A.name)||s.ad_name,className:"max-w-full max-h-full object-contain rounded-lg pointer-events-none",onClick:C=>C.stopPropagation()}),h.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-30 flex items-center justify-center w-12 h-12",children:e.jsx(z,{variant:"secondary",size:"icon",className:"!w-12 !h-12 !rounded-full bg-black/50 hover:!bg-black/70 hover:!w-12 hover:!h-12 text-white pointer-events-auto !border-0 !p-0 !m-0 !min-w-[3rem] !min-h-[3rem] !max-w-[3rem] !max-h-[3rem] flex-shrink-0",onClick:C=>{C.stopPropagation(),x(C)},style:{transform:"none",width:"3rem",height:"3rem"},children:e.jsx(us,{className:"w-6 h-6 flex-shrink-0"})})}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 z-30 flex items-center justify-center w-12 h-12",children:e.jsx(z,{variant:"secondary",size:"icon",className:"!w-12 !h-12 !rounded-full bg-black/50 hover:!bg-black/70 hover:!w-12 hover:!h-12 text-white pointer-events-auto !border-0 !p-0 !m-0 !min-w-[3rem] !min-h-[3rem] !max-w-[3rem] !max-h-[3rem] flex-shrink-0",onClick:C=>{C.stopPropagation(),S(C)},style:{transform:"none",width:"3rem",height:"3rem"},children:e.jsx(Je,{className:"w-6 h-6 flex-shrink-0"})})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-30 pointer-events-auto",children:h.map((C,_)=>e.jsx("button",{className:Q("h-2 rounded-full transition-all cursor-pointer",_===d?"w-8 bg-white":"w-2 bg-white/50"),onClick:I=>{I.stopPropagation(),u(_)},"aria-label":`Go to slide ${_+1}`},C.url||`modal-carousel-${_}`))})]})]}):e.jsx("img",{src:s.creative_url||s.thumbnail_url,alt:s.ad_name,className:"max-w-full max-h-full object-contain rounded-lg",onClick:C=>C.stopPropagation()}),e.jsx(z,{variant:"secondary",size:"icon",className:"absolute top-4 right-4 z-40",onClick:()=>c(!1),children:""})]})})]})},Xt=[{key:"spend",label:"Spend",category:"financial"},{key:"revenue",label:"Revenue",category:"financial"},{key:"roas",label:"ROAS",category:"financial"},{key:"cpc",label:"CPC",category:"financial"},{key:"cpp",label:"CPP",category:"financial"},{key:"orders",label:"Orders",category:"financial"},{key:"impressions",label:"Impressions",category:"performance"},{key:"clicks",label:"Clicks",category:"performance"},{key:"ctr",label:"CTR",category:"performance"},{key:"frequency",label:"Frequency",category:"performance"},{key:"hook_rate",label:"Hook Rate",category:"engagement"},{key:"engagementRate",label:"Engagement Rate",category:"engagement"},{key:"video_views",label:"Video Views",category:"video"},{key:"video_p25_watched",label:"25% Watched",category:"video"},{key:"video_p50_watched",label:"50% Watched",category:"video"},{key:"video_p100_watched",label:"100% Watched",category:"video"},{key:"video_p25_watched_rate",label:"25% Watched Rate",category:"video"},{key:"video_p50_watched_rate",label:"50% Watched Rate",category:"video"},{key:"video_p100_watched_rate",label:"100% Watched Rate",category:"video"}],ea={financial:"Financial Metrics",performance:"Performance Metrics",engagement:"Engagement Metrics",video:"Video Metrics"},ch=()=>{const[s,a]=r.useState([]),[t,l]=r.useState(!1),[o,i]=r.useState(!0),[c,d]=r.useState(null),[u,m]=r.useState(!0),[h,v]=r.useState(null),[y,S]=r.useState(""),[x,p]=r.useState("all"),[N,j]=r.useState("all"),[w,P]=r.useState(new Set(Xt.map(f=>f.key))),{brandId:g}=ge(),$=V(f=>{var n;return(n=f.date)==null?void 0:n.from}),F=V(f=>{var n;return(n=f.date)==null?void 0:n.to}),A=Se.useRef(null),C=Se.useRef(null),_=Ce(),I=Me(),B=async(f=null,n=!1)=>{var b,T;n?(i(!0),a([]),d(null),v(null)):l(!0);try{const U={limit:15,thumbnailWidth:600,thumbnailHeight:600};f&&(U.after=f);const D=await _.post(`/api/ads/meta-creative/${g}`,U);if(D.data.success){if(n){const W=[...D.data.creatives].sort((K,q)=>{const ee=new Date(K.created_time||0).getTime();return new Date(q.created_time||0).getTime()-ee});a(W)}else a(W=>{const K=new Map;W.forEach(ee=>{K.has(ee.ad_id)||K.set(ee.ad_id,ee)}),D.data.creatives.forEach(ee=>{K.has(ee.ad_id)||K.set(ee.ad_id,ee)});const q=Array.from(K.values()).sort((ee,J)=>{const ae=new Date(ee.created_time||0).getTime();return new Date(J.created_time||0).getTime()-ae});return console.log(` Merged ${W.length} existing + ${D.data.creatives.length} new = ${q.length} total creatives (sorted globally)`),q});m(D.data.hasMore),d(D.data.nextCursor),v(null)}else v("Failed to fetch creatives")}catch(U){console.error("Error fetching creatives:",U),v(((T=(b=U.response)==null?void 0:b.data)==null?void 0:T.message)||"Failed to fetch creatives. Please try again.")}finally{l(!1),i(!1)}};r.useEffect(()=>{g&&(console.log(" Brand changed, fetching creatives..."),B(null,!0))},[g,I]),r.useEffect(()=>{if(!s.length||!u||t)return;A.current&&A.current.disconnect();const f=new IntersectionObserver(b=>{b[0].isIntersecting&&u&&!t&&c&&(console.log(" Infinite scroll triggered! Loading more creatives..."),B(c))},{root:null,rootMargin:"300px",threshold:.1});A.current=f;const n=C.current;return n&&(console.log(" Observing last card for infinite scroll"),f.observe(n)),()=>{n&&f&&f.unobserve(n),f.disconnect()}},[s.length,u,t,c,y,x,N,$,F]);const O=()=>{B(null,!0)},E=r.useMemo(()=>s.filter(f=>{const n=y===""||f.ad_name.toLowerCase().includes(y.toLowerCase()),b=x==="all"||f.creative_type===x,T=N==="all"||f.status===N;let U=!0;if($&&F){const D=new Date(f.created_time),W=new Date($),K=new Date(F);W.setHours(0,0,0,0),K.setHours(23,59,59,999),U=D>=W&&D<=K}return n&&b&&T&&U}),[s,y,x,N,$,F]),M=f=>{P(n=>{const b=new Set(n);return b.has(f)?b.delete(f):b.add(f),b})},R=()=>{P(new Set(Xt.map(f=>f.key)))},L=()=>{P(new Set)},k=r.useMemo(()=>{const f={financial:[],performance:[],engagement:[],video:[]};for(const n of Xt)f[n.category].push(n);return f},[]);return g?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto mx-auto p-6 space-y-6",children:o?e.jsx("div",{children:e.jsx(Ae,{isLoading:!0})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search by ad name...",value:y,onChange:f=>S(f.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{}),e.jsxs(We,{value:x,onValueChange:f=>p(f),children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(He,{placeholder:"Format"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All"}),e.jsx(ie,{value:"image",children:"Image"}),e.jsx(ie,{value:"video",children:"Video"}),e.jsx(ie,{value:"carousel",children:"Carousel"})]})]}),e.jsxs(We,{value:N,onValueChange:f=>j(f),children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(He,{placeholder:"Status"})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Status"}),e.jsx(ie,{value:"ACTIVE",children:"Active"}),e.jsx(ie,{value:"PAUSED",children:"Paused"})]})]}),e.jsxs(Wo,{children:[e.jsx(Ho,{asChild:!0,children:e.jsxs(z,{variant:"outline",className:"relative",children:[e.jsx(Bi,{className:"w-4 h-4 mr-2"}),"Metrics",w.size>0&&w.size<Xt.length&&e.jsx(ps,{variant:"secondary",className:"ml-2 h-5 w-5 rounded-full p-0 flex items-center justify-center text-[10px]",children:w.size})]})}),e.jsxs(mr,{className:"w-[400px] sm:w-[540px] overflow-y-auto",children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Select Metrics"}),e.jsx(xr,{children:"Choose which metrics to display on creative cards"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(z,{variant:"ghost",size:"sm",className:"h-8 text-xs",onClick:R,children:"Select All"}),e.jsx(z,{variant:"ghost",size:"sm",className:"h-8 text-xs",onClick:L,children:"Deselect All"})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{className:"text-sm font-semibold text-foreground",children:ea.financial}),e.jsx("div",{className:"space-y-2 pl-2",children:k.financial.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{id:f.key,checked:w.has(f.key),onCheckedChange:()=>M(f.key)}),e.jsx(ye,{htmlFor:f.key,className:"text-sm font-normal cursor-pointer flex-1",children:f.label})]},f.key))})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{className:"text-sm font-semibold text-foreground",children:ea.performance}),e.jsx("div",{className:"space-y-2 pl-2",children:k.performance.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{id:f.key,checked:w.has(f.key),onCheckedChange:()=>M(f.key)}),e.jsx(ye,{htmlFor:f.key,className:"text-sm font-normal cursor-pointer flex-1",children:f.label})]},f.key))})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{className:"text-sm font-semibold text-foreground",children:ea.engagement}),e.jsx("div",{className:"space-y-2 pl-2",children:k.engagement.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{id:f.key,checked:w.has(f.key),onCheckedChange:()=>M(f.key)}),e.jsx(ye,{htmlFor:f.key,className:"text-sm font-normal cursor-pointer flex-1",children:f.label})]},f.key))})]}),e.jsx(jt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{className:"text-sm font-semibold text-foreground",children:ea.video}),e.jsx("div",{className:"space-y-2 pl-2",children:k.video.map(f=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{id:f.key,checked:w.has(f.key),onCheckedChange:()=>M(f.key)}),e.jsx(ye,{htmlFor:f.key,className:"text-sm font-normal cursor-pointer flex-1",children:f.label})]},f.key))})]})]})]})]}),e.jsx(z,{onClick:O,variant:"outline",size:"icon",disabled:t,children:e.jsx($e,{className:Q("w-4 h-4",t&&"animate-spin")})})]})]}),h&&e.jsx(ue,{className:"border-destructive",children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(js,{className:"w-5 h-5"}),e.jsx("p",{children:h})]})})}),s.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 auto-rows-fr",children:E.map((f,n)=>{const T=n===E.length-1&&u&&!t;return e.jsx("div",{ref:T?C:null,className:"h-full",children:e.jsx(ih,{creative:f,selectedKPIs:w})},f.ad_id)})}),t&&!o&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx($e,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Loading more creatives..."})]})}),(y||x!=="all"||N!=="all"||$&&F)&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",E.length," of ",s.length," loaded ads",y&&` matching "${y}"`,x!=="all"&&` (${x} format)`,N!=="all"&&` (${N.toLowerCase()} status)`,($||F)&&" (date filtered)",u&&". Keep scrolling to load more!"]})}),!y&&x==="all"&&N==="all"&&!($&&F)&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",s.length," loaded ads. Keep scrolling to load more!"]})}),!u&&s.length>0&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-muted-foreground",children:[" You've reached the end!",y||x!=="all"||N!=="all"||$&&F?` Showing ${E.length} of ${s.length} loaded ads.`:` All ${s.length} ads loaded.`]})}),E.length===0&&(y||x!=="all"||N!=="all"||$&&F)&&e.jsx(ue,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(wr,{className:"w-16 h-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Creatives Found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:y&&(x!=="all"||N!=="all"||$&&F)?`No creatives found matching "${y}"${x!=="all"?` (${x} format)`:""}${N!=="all"?` (${N.toLowerCase()} status)`:""}${$&&F?" (date filtered)":""}. Try adjusting your filters.`:y?`No creatives found matching "${y}". Try adjusting your search.`:x!=="all"&&N!=="all"?`No ${x} creatives with ${N.toLowerCase()} status found. Try selecting different filters.`:x!=="all"?`No ${x} creatives found. Try selecting a different format.`:N!=="all"?`No ${N.toLowerCase()} creatives found. Try selecting a different status.`:$&&F?"No creatives found in the selected date range. Try adjusting the date filter.":"No creatives found. Try adjusting your filters."})]})})})]}):e.jsx(ue,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(wr,{className:"w-16 h-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Creatives Found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:y?"Try adjusting your search ":"No creatives available"})]})})})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-200px)]",children:[e.jsx(js,{className:"w-16 h-16 text-muted-foreground mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No Brand Selected"}),e.jsx("p",{className:"text-muted-foreground",children:"Please select a brand to view creatives."})]})},dh=Wl,al=r.forwardRef(({className:s,...a},t)=>e.jsx(Ul,{ref:t,className:Q("border-b",s),...a}));al.displayName="AccordionItem";const rl=r.forwardRef(({className:s,children:a,...t},l)=>e.jsx(Vl,{className:"flex",children:e.jsxs(Un,{ref:l,className:Q("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",s),...t,children:[a,e.jsx(Ya,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));rl.displayName=Un.displayName;const nl=r.forwardRef(({className:s,children:a,...t},l)=>e.jsx(Vn,{ref:l,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:e.jsx("div",{className:Q("pb-4 pt-0",s),children:a})}));nl.displayName=Vn.displayName;const Gs=ne.create({baseURL:"https://parallels.messold.com",withCredentials:!0});Gs.interceptors.response.use(s=>s,s=>{var a;return((a=s.response)==null?void 0:a.status)===401&&(console.log("401 Unauthorized - Token expired or invalid"),Ds.dispatch(wa()),Ds.dispatch(Na()),ne.post(`${be}/api/auth/logout`,{},{withCredentials:!0}).catch(()=>{}),window.location.href="/login"),Promise.reject(s)});const mh=({date:s})=>{const{brandId:a}=ge(),{toast:t}=mt(),[l,o]=r.useState(!1),[i,c]=r.useState(!1),[d,u]=r.useState(0),[m,h]=r.useState("USD"),[v,y]=r.useState(null),[S,x]=r.useState(""),[p,N]=r.useState(""),[j,w]=r.useState(""),[P,g]=r.useState(""),$=r.useCallback(async()=>{var C,_;if(!a||d===0){t({title:"Error",description:"Please fetch revenue first",variant:"destructive"});return}o(!0);try{const I=await Gs.post(`${be}/api/d2c-calculator/ebidta-calculate/${a}`,{revenue:d,currency:m,cogs:S||0,sellingMarketingExpense:p||0,fulfillmentLogistics:j||0,otherOperatingExpense:P||0},{withCredentials:!0});I.data.success&&(y(I.data.data),t({title:"Success",description:"Metrics calculated successfully"}))}catch(I){console.error("Error calculating metrics:",I),t({title:"Error",description:((_=(C=I.response)==null?void 0:C.data)==null?void 0:_.error)||"Failed to calculate metrics",variant:"destructive"})}finally{o(!1)}},[a,d,m,S,p,j,P,t]),F=r.useCallback(async()=>{var C,_;if(!(!a||!s.from||!s.to)){c(!0);try{const I=await Gs.post(`${be}/api/d2c-calculator/revenue/${a}`,{startDate:Y(s.from,"yyyy-MM-dd"),endDate:Y(s.to,"yyyy-MM-dd")},{withCredentials:!0});I.data.success&&(u(I.data.data.revenue),h(I.data.data.currency||"USD"),y(null),t({title:"Success",description:"Revenue fetched successfully"}))}catch(I){console.error("Error fetching revenue:",I),t({title:"Error",description:((_=(C=I.response)==null?void 0:C.data)==null?void 0:_.error)||"Failed to fetch revenue",variant:"destructive"})}finally{c(!1)}}},[a,s.from,s.to,t]);r.useEffect(()=>{a&&s.from&&s.to&&F()},[a,s.from,s.to]);const A=C=>{const _=m||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:_,minimumFractionDigits:2,maximumFractionDigits:2}).format(C)};return e.jsx("div",{className:"w-full p-6",children:e.jsxs("div",{className:"w-full",children:[e.jsx(ue,{className:"mb-4",children:e.jsxs(he,{className:"pt-4",children:[e.jsx(ye,{className:"text-xs text-gray-500 mb-2 block",children:"Gross Profit Calculation"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"revenue",className:"text-xs text-gray-600 mb-1 block",children:"Revenue"}),e.jsx(ve,{id:"revenue",type:"text",value:A(d),readOnly:!0,className:"bg-gray-50 font-semibold text-sm h-9"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-400 mt-6",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"cogs",className:"text-xs text-gray-600 mb-1 block",children:"COGS"}),e.jsx(ve,{id:"cogs",type:"number",placeholder:"0",value:S,onChange:C=>x(C.target.value),className:"font-semibold text-sm h-9"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-400 mt-6",children:"="}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"grossProfit",className:"text-xs text-green-700 mb-1 block font-medium",children:"Gross Profit"}),e.jsx(ve,{id:"grossProfit",type:"text",value:A(v?v.grossProfit:0),readOnly:!0,className:"bg-green-50 border-green-200 font-bold text-sm text-green-900 h-9"})]})]})]})}),e.jsx(ue,{className:"mb-4",children:e.jsxs(he,{className:"pt-4",children:[e.jsx(ye,{className:"text-xs text-gray-500 mb-3 block",children:"Operating Expenses"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"sellingMarketing",className:"text-xs text-gray-600 mb-1 block",children:"Selling & Marketing"}),e.jsx(ve,{id:"sellingMarketing",type:"number",placeholder:"0",value:p,onChange:C=>N(C.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"fulfillment",className:"text-xs text-gray-600 mb-1 block",children:"Fulfillment & Logistics"}),e.jsx(ve,{id:"fulfillment",type:"number",placeholder:"0",value:j,onChange:C=>w(C.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"otherOperating",className:"text-xs text-gray-600 mb-1 block",children:"Other Operating"}),e.jsx(ve,{id:"otherOperating",type:"number",placeholder:"0",value:P,onChange:C=>g(C.target.value),className:"text-sm h-9"})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs(z,{onClick:F,disabled:i||!s.from||!s.to,variant:"outline",size:"sm",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),i?"Loading...":"Refresh Revenue"]}),e.jsxs(z,{onClick:$,disabled:l||d===0,variant:"default",size:"sm",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${l?"animate-spin":""}`}),l?"Calculating...":"Calculate"]})]}),e.jsx(ue,{className:"mb-4 border-blue-200 bg-blue-50/30",children:e.jsxs(he,{className:"pt-4",children:[e.jsx(ye,{className:"text-xs text-blue-700 mb-2 block font-medium",children:"Operating Income Calculation"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"grossProfitDisplay",className:"text-xs text-gray-600 mb-1 block",children:"Gross Profit"}),e.jsx(ve,{id:"grossProfitDisplay",type:"text",value:A(v?v.grossProfit:0),readOnly:!0,className:"bg-white font-semibold text-sm h-9"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-400 mt-6",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"totalExpenses",className:"text-xs text-gray-600 mb-1 block",children:"Total Operating Expenses"}),e.jsx(ve,{id:"totalExpenses",type:"text",value:A(v?v.totalOperatingExpenses:0),readOnly:!0,className:"bg-white font-semibold text-sm h-9"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-400 mt-6",children:"="}),e.jsxs("div",{className:"flex-1",children:[e.jsx(ye,{htmlFor:"operatingIncome",className:"text-xs text-blue-700 mb-1 block font-medium",children:"Operating Income"}),e.jsx(ve,{id:"operatingIncome",type:"text",value:A(v?v.operatingIncome:0),readOnly:!0,className:"bg-blue-100 border-blue-200 font-bold text-sm text-blue-900 h-9"})]})]})]})}),e.jsx(ue,{className:"bg-gray-50 border-gray-200",children:e.jsxs(he,{className:"pt-4",children:[e.jsx(ye,{className:"text-xs text-gray-500 mb-3 block font-medium",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Revenue"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A(v?v.revenue:0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"COGS"}),e.jsx("div",{className:"font-semibold text-gray-900",children:A(v?v.cogs:0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Gross Profit"}),e.jsx("div",{className:"font-bold text-green-700",children:A(v?v.grossProfit:0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Operating Income"}),e.jsx("div",{className:"font-bold text-blue-700",children:A(v?v.operatingIncome:0)})]})]})]})})]})})},Zr=["Product Id","Cost per item"],Ra=s=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(s),Oa=Se.memo(({btnName:s,dialogTitle:a,dialogDescription:t,changeHandler:l,addHandler:o,disabled:i})=>e.jsxs(ut,{children:[e.jsx(Co,{asChild:!0,children:e.jsxs(z,{variant:"outline",size:"sm",disabled:i,children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),s]})}),e.jsxs(Ks,{className:"sm:max-w-[450px]",children:[e.jsxs(Qs,{children:[e.jsx(Js,{children:a}),e.jsx(It,{children:t})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(ye,{htmlFor:"field-input",children:"Name"}),e.jsx("input",{id:"field-input",type:"text",onChange:l,className:"w-full p-2 border rounded shadow-sm"})]}),e.jsxs(lr,{children:[e.jsx(Tr,{asChild:!0,children:e.jsx(z,{variant:"outline",children:"Cancel"})}),e.jsx(Tr,{asChild:!0,children:e.jsx(z,{type:"submit",onClick:o,children:"Save"})})]})]})]})),uh=[{label:"Monthly",value:"monthly"},{label:"Quarterly",value:"quarterly"},{label:"Half-yearly",value:"half-yearly"},{label:"Yearly",value:"yearly"}],ft=Se.memo(({objectKey:s,updateFrequency:a,setter:t,getter:l,disabled:o=!1})=>{var c;const i=((c=l[s])==null?void 0:c.frequency)||"monthly";return e.jsx("select",{className:"w-full px-4 py-2 shadow-sm border border-gray-200 rounded-md text-sm focus:ring-2 focus:ring-gray-600 outline-none transition-all",value:i,disabled:o,onChange:d=>a(s,d.target.value,t),children:uh.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})}),st=(s,a)=>{const t=localStorage.getItem(s);try{return t?JSON.parse(t):a}catch{return a}},hh=({date:s})=>{var G,se,te,me,je,Ne,Te,Fe;const[a,t]=r.useState(!1),[l,o]=r.useState(st("revenue",{})),[i,c]=r.useState(st("additionalRevenue",{})),[d,u]=r.useState(!1),[m,h]=r.useState(st("costAndExpenses",{})),[v,y]=r.useState(st("additionalExpenses",{})),[S,x]=r.useState(st("COGSMultiplier",0)),[p,N]=r.useState(st("additionalCOGS",{})),[j,w]=r.useState(""),[P,g]=r.useState("USD"),[$,F]=r.useState(void 0),[A,C]=r.useState(void 0),[_,I]=r.useState(!1),[B,O]=r.useState(!1),{brandId:E}=ge(),{toast:M}=mt(),R=Se.useRef(null),[L,k]=r.useState(st("activeMethod","multiplier")),[f,n]=r.useState({totalRevenue:0,totalExpense:0,profit:0,COGS:0,profitMargin:0}),b=s!=null&&s.from?Y(s.from,"yyyy-MM-dd"):"",T=s!=null&&s.to?Y(s.to,"yyyy-MM-dd"):"",U=Se.useCallback(async(Z=!1)=>{var Pe,Ze;if(!E||!s.from||!s.to)return;const le=`${b}_${T}`,oe=sessionStorage.getItem("DATE_KEY"),_e=sessionStorage.getItem("BRAND_KEY");if(!(!Z&&oe===le&&_e===E)){t(!0);try{const ts={};b&&(ts.startDate=b),T&&(ts.endDate=T);const gs=Gs.post(`${be}/api/d2c-calculator/revenue/${E}`,{startDate:Y(s.from,"yyyy-MM-dd"),endDate:Y(s.to,"yyyy-MM-dd")},{withCredentials:!0}),Et=Gs.get(`${be}/api/report/${E}`,{params:ts,withCredentials:!0}),[Rs,Os]=await Promise.all([gs,Et]);h(H=>({...H,marketingCost:Os.data.data[0].totalSpend||0}));const Yt=Os.data.data[0].dailyMetrics.map(H=>({...H,googleSales:H.googleSpend*H.googleROAS,adSales:H.totalSpend*(H.grossROI||0)})),Kt=Yt.reduce((H,de)=>H+(de.metaRevenue||0),0),$a=Yt.reduce((H,de)=>H+de.googleSales,0),Qt=Kt+$a||0;o(H=>({...H,marketSales:Qt})),Rs.data.success&&(o(H=>({...H,shopifySales:Rs.data.data.revenue})),g(Rs.data.data.currency||"USD"),M({title:"Success",description:"Revenue fetched successfully"}),sessionStorage.setItem("DATE_KEY",le),sessionStorage.setItem("BRAND_KEY",E))}catch(ts){console.error("Error fetching revenue:",ts),M({title:"Error",description:((Ze=(Pe=ts.response)==null?void 0:Pe.data)==null?void 0:Ze.error)||"Failed to fetch revenue",variant:"destructive"})}finally{t(!1)}}},[E,s.from,s.to]);Se.useEffect(()=>{E&&s.from&&s.to&&U()},[E,s.from,s.to,M]);const D=Se.useCallback(async()=>{var Z,le;if(!E){M({title:"Error",description:"Brand required",variant:"destructive"});return}O(!0);try{const oe=await Gs.get(`${be}/api/d2c-calculator/last-landed-cost-for-cogs/${E}`,{withCredentials:!0}),_e=oe.data.data;oe.data.success&&(_e.COGSMultiplier!==0?(x(_e.COGSMultiplier),k("multiplier"),M({title:"Success",description:"COGS data fetched successfully"})):Object.keys(_e.additionalCOGS).length>0?(k("manual"),N({..._e.additionalCOGS}),M({title:"Success",description:"COGS data fetched successfully"})):M({title:"Success",description:"CSV file cannot be fetched",variant:"destructive"}))}catch(oe){console.error("Error calculating metrics:",oe),M({title:"Error",description:((le=(Z=oe.response)==null?void 0:Z.data)==null?void 0:le.error)||"Failed to fetch costs",variant:"destructive"})}finally{O(!1)}},[E]),W=Se.useCallback(async()=>{if(!E){M({title:"Error",description:"Brand required",variant:"destructive"});return}u(!0);try{const Z=await Gs.get(`${be}/api/d2c-calculator/last-used-expenditure/${E}`,{withCredentials:!0}),le=Z.data.data;Z.data.success&&(y({...le.additionalExpenses}),h(oe=>({...oe,operatingCost:le.operatingCost,otherMarketingCost:le.otherMarketingCost})))}catch(Z){console.error("Error fetching last used expenditure:",Z)}finally{u(!1)}},[]);Se.useEffect(()=>{localStorage.setItem("additionalRevenue",JSON.stringify(i)),localStorage.setItem("additionalExpenses",JSON.stringify(v)),localStorage.setItem("additionalCOGS",JSON.stringify(p)),localStorage.setItem("revenue",JSON.stringify(l)),localStorage.setItem("costAndExpenses",JSON.stringify(m)),localStorage.setItem("COGSMultiplier",JSON.stringify(S)),localStorage.setItem("activeMethod",JSON.stringify(L))},[i,v,p,l,m,f,L]),Se.useEffect(()=>{$&&ae($)},[$]);const K=Se.useCallback(Z=>{const le=j.trim();le&&(Z(oe=>oe[le]!==void 0?oe:{...oe,[le]:{amount:0,frequency:"monthly"}}),w(""))},[j]),q=Se.useCallback((Z,le)=>{le(oe=>{const _e={...oe};return delete _e[Z],_e})},[]),ee=async()=>{var Z,le;if(L==="multiplier"&&(S===0||S==="")){M({title:"Error",description:"COGS Multiplier is required",variant:"destructive"});return}else if(L==="manual"&&Object.keys(p).length===0){M({title:"Error",description:"Additional COGS is required",variant:"destructive"});return}else if(L==="csv"&&(A==null?void 0:A.length)===0){M({title:"Error",description:"CSV file is required",variant:"destructive"});return}I(!0),n({totalRevenue:0,totalExpense:0,profit:0,profitMargin:0,COGS:0});try{const oe=await Gs.post(`${be}/api/d2c-calculator/calculate-metrics/${E}`,{brandId:E,startDate:b,endDate:T,revenue:l,additionalRevenue:i,costAndExpenses:m,additionalExpenses:v,COGSMultiplier:L==="multiplier"&&S!==0&&S!==""?S:void 0,additionalCOGS:L==="manual"&&Object.keys(p).length>0?p:void 0,currency:P,uploadedFileList:L==="csv"&&(A!=null&&A.length)&&(A==null?void 0:A.length)>0?A:void 0},{withCredentials:!0});oe.data.success&&n({totalRevenue:oe.data.data.totalRevenue,totalExpense:oe.data.data.totalExpense,profit:oe.data.data.profit,profitMargin:oe.data.data.profitMargin,COGS:oe.data.data.COGS})}catch(oe){console.error("Error calculating metrics:",oe),M({title:"Error",description:((le=(Z=oe.response)==null?void 0:Z.data)==null?void 0:le.error)||"Failed to calculate metrics",variant:"destructive"})}finally{I(!1)}},J=Se.useCallback((Z,le,oe)=>{oe(_e=>({..._e,[Z]:{..._e[Z],frequency:le}}))},[]);function ae(Z){if(!Z){M({title:"Error",description:"Please select a file",variant:"destructive"});return}if(!Z.name.toLowerCase().endsWith(".csv")){M({title:"Error",description:"Please select a CSV file",variant:"destructive"});return}Cc.parse(Z,{header:!0,skipEmptyLines:!0,complete:le=>{const{data:oe,meta:_e}=le,Pe=[],Ze=_e.fields??[],ts=Zr.filter(gs=>!Ze.includes(gs));if(ts.length>0){alert(`Missing columns: ${ts.join(", ")}`);return}if(oe.forEach((gs,Et)=>{Zr.forEach(Rs=>{const Os=gs[Rs];(Os==null||String(Os).trim()==="")&&Pe.push(`Row ${Et+1}: Column "${Rs}" is empty.`)})}),Pe.length>0)console.error("Validation Failed:",Pe),alert("File has missing values. Check console for details.");else{const gs=pe(oe);C(gs)}}})}function pe(Z=[]){const le=[],oe=new Set;for(const _e of Z){const Pe=_e["Product Id"],Ze=_e["Cost per item"];if(!Pe)continue;const ts=String(Pe).trim();if(oe.has(ts))continue;const gs=Number(String(Ze||0).replace(/,/g,""));!ts||!Number.isFinite(gs)||gs<=0||(oe.add(ts),le.push({productId:ts,unitCost:gs}))}return le}return e.jsx("div",{className:"w-full p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("section",{children:e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 h-fit sticky top-6",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-sm font-semibold text-green-700 uppercase mb-3",children:[e.jsx(Qe,{size:16})," Revenue Sources"]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Shopify Sales"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded shadow-sm",value:Ra((l==null?void 0:l.shopifySales)||0),readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Maket Sales"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded shadow-sm",value:Ra((l==null?void 0:l.marketSales)||0),readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Other Revenue"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",className:"w-full p-2 border rounded shadow-sm ",value:((G=l.otherRevenue)==null?void 0:G.amount)||"",disabled:_,onChange:Z=>o(le=>{var oe;return{...le,otherRevenue:{amount:Z.target.value===""?"":Number(Z.target.value),frequency:((oe=le.otherRevenue)==null?void 0:oe.frequency)||"monthly"}}})})}),e.jsx("div",{className:"w-full md:w-[30%]",children:e.jsx(ft,{objectKey:"otherRevenue",updateFrequency:J,setter:o,getter:l,disabled:_})})]})]}),Object.keys(i).length>0&&Object.keys(i).map(Z=>{var le;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:Z,className:"block text-xs text-gray-500 mb-1",children:Z}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",id:Z,name:Z,className:"w-full p-2 border rounded shadow-sm",value:((le=i[Z])==null?void 0:le.amount)||"",disabled:_,onChange:oe=>c(_e=>{var Pe;return{..._e,[Z]:{amount:oe.target.value===""?"":Number(oe.target.value),frequency:((Pe=i[Z])==null?void 0:Pe.frequency)||"monthly"}}})})}),e.jsxs("div",{className:"w-full md:w-[30%] flex items-center gap-2",children:[e.jsx(ft,{objectKey:Z,updateFrequency:J,setter:c,getter:i,disabled:_}),e.jsx(Fa,{className:"h-4 w-4 text-red-500 hover:text-red-700 cursor-pointer",onClick:()=>q(Z,c)})]})]})]},Z)})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-center justify-start md:justify-between gap-2 md:gap-4 mt-4",children:[e.jsx("div",{className:"w-full md:w-auto flex md:justify-start justify-center",children:e.jsxs(z,{onClick:()=>U(!0),disabled:a||!s.from||!s.to||_,variant:"outline",size:"sm",className:"",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),a?"Loading...":"Refresh Revenue"]})}),e.jsx("div",{children:e.jsx(Oa,{btnName:"Add Revenue",dialogTitle:"Add Revenue",dialogDescription:"Add new revenue source here.",changeHandler:Z=>w(Z.target.value),addHandler:()=>K(c),disabled:_||a||!s.from||!s.to})})]})]})}),e.jsx("section",{children:e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 h-fit sticky top-6",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-sm font-semibold text-red-700 uppercase mb-3",children:[e.jsx(Gi,{size:16})," Costs & Expenses"]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"marketingCost",className:"block text-xs text-gray-500 mb-1",children:"Marketing Cost"}),e.jsx("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"w-full p-2 border rounded shadow-sm",id:"marketingCost",value:Ra(Number((m==null?void 0:m.marketingCost)||0)),readOnly:!0,name:"marketingCost",disabled:d||_})})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otherMarketingCost",className:"block text-xs text-gray-500 mb-1",children:"Other Marketing Cost (if any)"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",className:"w-full p-2 border rounded shadow-sm",id:"otherMarketingCost",name:"otherMarketingCost",value:((se=m.otherMarketingCost)==null?void 0:se.amount)||"",disabled:d||_,onChange:Z=>h(le=>{var oe;return{...le,otherMarketingCost:{amount:Z.target.value===""?"":Number(Z.target.value),frequency:((oe=le.otherMarketingCost)==null?void 0:oe.frequency)||"monthly"}}})})}),e.jsx("div",{className:"w-full md:w-[30%] flex items-center gap-2",children:e.jsx(ft,{objectKey:"otherMarketingCost",updateFrequency:J,setter:h,getter:m,disabled:_||d})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"operatingCost",className:"block text-xs text-gray-500 mb-1",children:"Operating Costs (Rent, Salary, etc.)"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2 space-y-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"number",className:"w-full p-2 border rounded shadow-sm",id:"operatingCost",value:((te=m.operatingCost)==null?void 0:te.amount)||"",name:"operatingCost",disabled:_||d,onChange:Z=>h(le=>{var oe;return{...le,operatingCost:{amount:Z.target.value===""?"":Number(Z.target.value),frequency:((oe=le.operatingCost)==null?void 0:oe.frequency)||"monthly"}}})})}),e.jsx("div",{className:"w-full md:w-[30%] flex items-center gap-2",children:e.jsx(ft,{objectKey:"operatingCost",updateFrequency:J,setter:h,getter:m,disabled:_||d})})]})]}),Object.keys(v).length>0&&Object.keys(v).map(Z=>{var le;return e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx("label",{htmlFor:Z,className:"block text-xs text-gray-500 mb-1",children:Z}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{id:Z,type:"number",className:"w-full p-2 border rounded shadow-sm",value:((le=v[Z])==null?void 0:le.amount)||"",name:Z,disabled:_,onChange:oe=>y(_e=>{var Pe;return{..._e,[Z]:{amount:oe.target.value===""?"":Number(oe.target.value),frequency:(Pe=v[Z])==null?void 0:Pe.frequency}}})})}),e.jsxs("div",{className:"w-full md:w-[30%] flex items-center gap-2",children:[e.jsx(ft,{objectKey:Z,updateFrequency:J,setter:y,getter:v,disabled:_}),e.jsx(Fa,{className:"h-4 w-4 text-red-500 hover:text-red-700 cursor-pointer",onClick:()=>q(Z,y)})]})]})]},Z)})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-center justify-start md:justify-between gap-2 md:gap-4 mt-4",children:[e.jsx("div",{className:"w-full md:w-auto flex md:justify-start justify-center",children:e.jsxs(z,{onClick:W,disabled:d||!E||_,variant:"outline",size:"sm",className:"mt-4",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),d?"Loading...":"Last Useded"]})}),e.jsx("div",{children:e.jsx(Oa,{btnName:"Add Expense",dialogTitle:"Add Cost/Expense",dialogDescription:"Add new Cost/Expense here.",changeHandler:Z=>w(Z.target.value),addHandler:()=>K(y)})})]})]})})]}),e.jsxs("div",{children:[e.jsxs("section",{className:"bg-white p-6 rounded-xl border border-gray-200 h-fit sticky top-6 mb-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 uppercase mb-3",children:[e.jsx(Ui,{size:16}),"Landed Costs (for COGS)"]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg mb-4",children:["multiplier","manual","csv"].map(Z=>e.jsx("button",{disabled:_||B,onClick:()=>k(Z),className:`flex-1 py-1 text-xs rounded-md transition-all ${L===Z?"bg-white shadow-sm font-bold":"text-gray-500"}`,children:Z.toUpperCase()},Z))}),L==="multiplier"&&e.jsxs("div",{className:"",children:[e.jsx("label",{htmlFor:"COGSMultiplier",className:"block text-xs text-gray-500 mb-2",children:"Enter COGS Multiplier (e.g. 1.5 for 50% profit)"}),e.jsx("input",{className:"w-full p-2 border rounded shadow-sm",type:"number",id:"COGSMultiplier",name:"COGSMultiplier",value:S||"",onChange:Z=>x(Z.target.value===""?"":Number(Z.target.value)),disabled:_||B})]}),L==="manual"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"COGS",className:"block text-xs text-gray-500 mb-4",children:"Add COGS Breakdown (Variable / Order-level Costs)"}),Object.keys(p).length>0&&Object.keys(p).map(Z=>{var le;return e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx("label",{htmlFor:Z,className:"block text-xs text-gray-500 mb-2",children:Z}),e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{id:Z,type:"number",className:"w-full p-2 border rounded shadow-sm",value:((le=p[Z])==null?void 0:le.amount)||"",name:Z,disabled:_||B,onChange:oe=>N(_e=>{var Pe;return{..._e,[Z]:{amount:oe.target.value===""?"":Number(oe.target.value),frequency:((Pe=v[Z])==null?void 0:Pe.frequency)||"monthly"}}})})}),e.jsxs("div",{className:"w-full md:w-[30%] flex items-center gap-2",children:[e.jsx(ft,{objectKey:Z,updateFrequency:J,setter:N,getter:p,disabled:_||B}),e.jsx(Fa,{className:"h-4 w-4 text-red-500 hover:text-red-700 cursor-pointer",onClick:()=>q(Z,N)})]})]})]},Z)})]})]}),L!=="csv"&&e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-center justify-start md:justify-between gap-2 md:gap-4 mt-4",children:[e.jsx("div",{className:"w-full md:w-auto flex md:justify-start justify-center items-center",children:e.jsxs(z,{onClick:D,disabled:d||!E,variant:"outline",size:"sm",className:"mt-4",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),d?"Loading...":"Last Useded"]})}),L==="manual"&&e.jsx("div",{children:e.jsx(Oa,{btnName:"Add",dialogTitle:"Add",dialogDescription:"Add new source here.",changeHandler:Z=>w(Z.target.value),addHandler:()=>K(N),disabled:_||!E})})]}),L==="csv"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"file_input",className:"block text-xs text-gray-500 mb-2",children:"Upload COGS Breakdown - Product-wise (Sheet.csv)"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-2 ",children:[e.jsx("input",{type:"file",ref:R,className:"cursor-pointer border border-gray-300 rounded-md p-1.5 w-full shadow-base",id:"file_input",disabled:_,onChange:Z=>{var le;return F((le=Z.target.files)==null?void 0:le[0])}}),e.jsxs(z,{onClick:()=>{F(void 0),C([]),R.current&&(R.current.value="")},variant:"outline",size:"sm",disabled:_,className:"h-10 border border-gray-300 rounded-md p-1.5 shadow-base text-red-500 hover:text-red-700",children:[e.jsx(ja,{className:"h-4 w-4 mr-2 text-red-500 hover:text-red-700"}),"Clear"]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 h-fit sticky top-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4 text-gray-700",children:"Financial Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between pb-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Total Revenue"}),e.jsx("span",{className:"font-bold text-green-600",children:(me=f.totalRevenue)==null?void 0:me.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Total Expenses"}),e.jsx("span",{className:"font-bold text-red-600",children:(je=f.totalExpense)==null?void 0:je.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between pb-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"COGS (Cost of Goods Sold)"}),e.jsx("span",{className:"font-bold text-red-600",children:(Ne=f==null?void 0:f.COGS)==null?void 0:Ne.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsx("span",{className:"text-lg font-bold",children:"Net Profit"}),e.jsx("span",{className:"text-lg font-bold {Number(totalRevenueAndExpenditure.profit?.toFixed(2)) >= 0 ? 'text-blue-600' : 'text-red-600'}",children:(Te=f.profit)==null?void 0:Te.toLocaleString()})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-800 font-medium",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[(f==null?void 0:f.profitMargin)>0?(Fe=f==null?void 0:f.profitMargin)==null?void 0:Fe.toFixed(2):0,"%"]})]})]})]}),e.jsx("div",{children:e.jsxs(z,{onClick:ee,disabled:_,variant:"outline",className:"mt-4 w-full ",children:[e.jsx($e,{className:`h-4 w-4 mr-2 ${_?"animate-spin":""}`}),_?"Calculating...":"Calculate Metrics"]})})]})]})})},xh=()=>{const s=V(o=>o.date.from),a=V(o=>o.date.to),t=r.useMemo(()=>({from:s?new Date(s):void 0,to:a?new Date(a):void 0}),[s,a]),l=[{id:"ebidtaNew",title:"Monthly Business Calculator",description:"Calculate your EBIDTA for your business",icon:bt},{id:"ebidta",title:"EBIDTA Calculator",description:"Calculate your EBIDTA for your business",icon:bt},{id:"cpa",title:"Breakeven CPA Calculator",description:"Calculate the breakeven CPA for your business",icon:bt},{id:"selling-price",title:"Selling Price Calculator",description:"Calculate the selling price for your business",icon:bt}];return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Business Calculators"}),e.jsx("p",{className:"text-gray-600",children:"Manage all your financial calculations in one place"})]}),e.jsx(Le,{})]}),e.jsx(dh,{type:"single",collapsible:!0,defaultValue:"ebidtaNew",className:"w-full space-y-4",children:l.map(o=>e.jsxs(al,{value:o.id,className:"border border-gray-200 rounded-lg overflow-hidden w-full",children:[e.jsx(rl,{className:"px-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-3 text-left",children:[e.jsx(o.icon,{className:"h-5 w-5 text-gray-700"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:o.title}),e.jsx("p",{className:"text-sm text-gray-500",children:o.description})]})]})}),e.jsx(nl,{className:"px-0 py-0 border-t border-gray-200 w-full",children:e.jsxs("div",{className:"w-full",children:[o.id==="ebidtaNew"&&e.jsx(hh,{date:t}),o.id==="ebidta"&&e.jsx(mh,{date:t}),o.id==="cpa"&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Breakeven CPA Calculator coming soon"})}),o.id==="selling-price"&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Selling Price Calculator coming soon"})})]})})]},o.id))})]})})]})};function gh({rows:s,primaryColumn:a="Page Path",initialPageSize:t="50"}){const l=r.useMemo(()=>[{key:a,header:a,width:300,minWidth:150,align:"left"},{key:"Bounce Rate",header:"Bounce Rate",width:140,minWidth:130,align:"right"},{key:"Sessions",header:"Sessions",width:120,minWidth:110,align:"right"},{key:"Sales",header:"Sales",width:140,minWidth:130,align:"right"},{key:"Purchases",header:"Purchases",width:120,minWidth:110,align:"right"},{key:"ATC",header:"ATC",width:100,minWidth:90,align:"right"},{key:"ATC Rate",header:"ATC Rate",width:130,minWidth:120,align:"right"},{key:"Checkout",header:"Checkout",width:120,minWidth:110,align:"right"},{key:"Checkout Rate",header:"Checkout Rate",width:150,minWidth:140,align:"right"},{key:"Conversion Rate",header:"Conversion Rate",width:160,minWidth:150,align:"right"}],[a]),[o,i]=r.useState([]),c=r.useRef(null),[d,u]=r.useState(0),m=r.useRef(""),h=r.useRef(!1);r.useEffect(()=>{const g=()=>{c.current&&u(c.current.clientWidth)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),r.useEffect(()=>{if(l.length===0||d===0)return;const g=l.map(_=>_.key).join(",");g!==m.current&&(m.current=g,h.current=!1);const $=l.map(_=>_.width),F=l.map(_=>_.minWidth||80),A=$.reduce((_,I)=>_+I,0),C=F.reduce((_,I)=>_+I,0);if(A>0){if(C>d){const _=d/C;i(F.map(I=>I*_))}else{const _=d/A;i($.map(I=>I*_))}h.current=!0}},[l,d]);const[v,y]=r.useState(t==="all"?s.length:Number.parseInt(t,10)),[S,x]=r.useState(1);r.useEffect(()=>{x(1)},[v]);const p=Math.ceil(s.length/v),N=(S-1)*v,j=t==="all"?s.length:N+v,w=s.slice(N,j),P=(g,$)=>{const F=g[$];return $===a?e.jsx("span",{className:"font-medium text-gray-900",children:String(F)}):typeof F=="number"?$.includes("Rate")?`${F.toFixed(2)}%`:F.toLocaleString("en-US"):String(F??"")};return e.jsxs("div",{ref:c,className:"w-full h-[calc(100vh-100px)] flex flex-col bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-30",children:e.jsx("tr",{children:l.map((g,$)=>{const F=o[$]??g.width,A=$===0,C=g.align==="right"?"text-right":g.align==="center"?"text-center":"text-left";return e.jsx("th",{style:{width:`${F}px`,minWidth:`${F}px`},className:Q("px-3 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider","border-b border-l last:border-r border-gray-200",C,A&&"sticky left-0 z-40 bg-gray-50 shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{width:"1rem",height:"1rem"}),e.jsx("span",{children:g.header})]})},String(g.key))})})}),e.jsx("tbody",{className:"text-gray-700",children:w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:l.length,className:"px-3 py-8 text-center text-gray-500",children:"No data available"})}):w.map((g,$)=>e.jsx("tr",{className:Q($%2===1&&"bg-gray-50/60","hover:bg-blue-50 transition-colors duration-150 group text-sm"),children:l.map((F,A)=>{const C=A===0,_=F.align==="right"?"text-right":F.align==="center"?"text-center":"text-left";return e.jsx("td",{className:Q("px-3 py-2 tabular-nums","border-b border-l last:border-r","align-middle","border-gray-200",_,C&&"sticky left-0 z-40 bg-white group-hover:bg-blue-50 shadow-[4px_0_5px_0_rgba(0,0,0,0.09)]"),title:typeof g[F.key]=="string"?g[F.key]:void 0,children:P(g,F.key)},String(F.key))})},$))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Rows per page:"}),e.jsxs(We,{value:t==="all"?"all":String(v),onValueChange:g=>{y(g==="all"?s.length:Number.parseInt(g,10))},children:[e.jsx(Be,{className:"w-[80px] h-8",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"25",children:"25"}),e.jsx(ie,{value:"50",children:"50"}),e.jsx(ie,{value:"100",children:"100"}),e.jsx(ie,{value:"200",children:"200"}),e.jsx(ie,{value:"all",children:"All"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[N+1,"-",Math.min(j,s.length)," of ",s.length]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(z,{variant:"outline",size:"sm",onClick:()=>x(1),disabled:S===1,className:"h-8 w-8 p-0",children:e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",size:"sm",onClick:()=>x(g=>Math.max(1,g-1)),disabled:S===1,className:"h-8 w-8 p-0",children:e.jsx(us,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",size:"sm",onClick:()=>x(g=>Math.min(p,g+1)),disabled:S>=p,className:"h-8 w-8 p-0",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(z,{variant:"outline",size:"sm",onClick:()=>x(p),disabled:S>=p,className:"h-8 w-8 p-0",children:e.jsx(Xa,{className:"h-4 w-4"})})]})]})]})]})}const fh=({isFullScreen:s,pagePathFilter:a="all",refreshTrigger:t})=>{const l=V(N=>N.date.from),o=V(N=>N.date.to),i=r.useMemo(()=>({from:l,to:o}),[l,o]),{brandId:c}=ge(),[d,u]=r.useState(null),[m,h]=r.useState(!0),v=Ce(),y=i!=null&&i.from?Y(i.from,"yyyy-MM-dd"):"",S=i!=null&&i.to?Y(i.to,"yyyy-MM-dd"):"";r.useEffect(()=>{u(null)},[c]);const x=r.useCallback(async()=>{h(!0);try{const j=(await v.post(`/api/analytics/pagePathMetricsReport/${c}`,{startDate:y,endDate:S},{withCredentials:!0})).data||null;u(j)}catch(N){console.error("Error fetching data:",N)}finally{h(!1)}},[c,y,S]);r.useEffect(()=>{i.from&&i.to&&x()},[x,t]);const p=r.useMemo(()=>{if(!(d!=null&&d.data))return[];if(a==="all")return d.data;const N=a.toLowerCase();return d.data.filter(j=>String(j["Page Path"]||"").toLowerCase().includes(N))},[d==null?void 0:d.data,a]);return m?e.jsx(Ae,{isLoading:m}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(gh,{rows:p,primaryColumn:"Page Path",initialPageSize:s?"all":"50"})})},ph=()=>{const s=V(N=>N.date.from),a=V(N=>N.date.to),t=Se.useMemo(()=>({from:s,to:a}),[s,a]),{brandId:l}=ge(),i=V(N=>N.brand.brands).find(N=>N._id===l),c=(i==null?void 0:i.ga4Account)??!1,{tokenError:d}=Ko(),[u,m]=Se.useState(!1),[h,v]=Se.useState(0),[y,S]=Se.useState("all"),x=()=>{m(!u)},p=Se.useCallback(()=>{v(N=>N+1)},[]);return d?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:e.jsx(ht,{platform:"Google Analytics",message:"We need access to your Google Analytics account to show you amazing insights about your website performance.",icon:e.jsx(Ja,{className:"w-8 h-8 text-blue-600"}),loginOptions:[{label:"Connect Google Analytics",context:"googleAnalyticsSetup",provider:"google"}]})})]}):c?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:!t.from||!t.to?e.jsx(Zs,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-none"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"p-2 space-y-6",children:e.jsx(ue,{id:"pagePath-report",className:`${u?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(he,{className:"p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:y==="all"?"default":"outline",size:"sm",onClick:()=>S("all"),children:"All"}),e.jsx(z,{variant:y==="collection"?"default":"outline",size:"sm",onClick:()=>S("collection"),children:"Collection"}),e.jsx(z,{variant:y==="product"?"default":"outline",size:"sm",onClick:()=>S("product"),children:"Product"})]}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5 ",children:[e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(z,{id:"refresh",onClick:p,size:"icon",variant:"outline",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(z,{id:"expand-button",onClick:x,size:"icon",variant:"outline",children:u?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(fh,{isFullScreen:u,pagePathFilter:y,refreshTrigger:h})})]})})})})]})})]}):e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:e.jsx(Pt,{platform:"google analytics",brandId:l??"",onSuccess:(N,j,w)=>{console.log(`Successfully connected ${N} account: ${j} (${w})`)}})})]})},bh=({isFullScreen:s,tabData:a})=>{const t=V(i=>i.locale.locale);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:a||[],primaryColumn:"All Page",monthlyDataKey:"MonthlyData",isFullScreen:s,locale:t})})})},jh=({isFullScreen:s,tabData:a})=>{const t=V(c=>c.locale.locale),l="All Page",o="MonthlyData",i=a.map(c=>{const d=ol(c["All Page"],"collections");return d?{...c,"All Page":d}:null}).filter(Boolean);return e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:i||[],primaryColumn:l,monthlyDataKey:o,isFullScreen:s,locale:t})})},yh=({isFullScreen:s,currentFilter:a,tabData:t})=>{const l=V(d=>d.locale.locale),o="All Page",i="MonthlyData",c=t.map(d=>{const u=ol(d["All Page"],"products");return u?{...d,"All Page":u}:null}).filter(Boolean);return e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(qe,{data:c||[],primaryColumn:o,monthlyDataKey:i,isFullScreen:s,locale:l,filter:a})})},ol=(s="",a="")=>{var o;if(!s||s==="(not set)"||!a)return null;let t=s.split("?")[0].split("#")[0];return((o=t==null?void 0:t.split("/"))==null?void 0:o.includes(a))?t:null};function vh(){const[s,a]=Se.useState([]),t=V(A=>A.date.from),l=V(A=>A.date.to),[o,i]=Se.useState(0),[c,d]=r.useState(!1),{brandId:u}=ge(),m=Ce(),h=Se.useCallback(()=>{i(A=>A+1)},[]),v=r.useMemo(()=>({from:t,to:l}),[t,l]),y=v!=null&&v.from?Y(v.from,"yyyy-MM-dd"):"",S=v!=null&&v.to?Y(v.to,"yyyy-MM-dd"):"",[x,p]=r.useState("allPage"),[N,j]=r.useState(!1),w=(A,C)=>{C===x&&a(A)},P=()=>{j(!N)},g=A=>{p(A)},$=[{label:"All Page",value:"allPage",icon:e.jsx(Vi,{className:"w-4 h-4"})},{label:"Collection",value:"collectionPage",icon:e.jsx(Wi,{className:"w-4 h-4"})},{label:"Product",value:"productPage",icon:e.jsx(Hi,{className:"w-4 h-4"})}],F=r.useCallback(async()=>{d(!0);try{const C=(await m.post(`/api/analytics/bounceRateReportHome/${u}`,{startDate:y,endDate:S},{withCredentials:!0})).data||[];a(C==null?void 0:C.data)}catch(A){console.error("Error fetching data:",A)}finally{d(!1)}},[u,y,S]);return r.useEffect(()=>{v.from&&v.to&&F()},[F,o]),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx(qt,{tabs:$,activeTab:x,onTabChange:g}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col lg:ml-0",children:!v.from||!v.to?e.jsx(Zs,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-none"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"p-2 space-y-6",children:e.jsx(ue,{id:`${x}-report`,className:`${N?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(he,{className:"p-3",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex-grow items-center gap-3"}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5 ",children:[e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(ss,{}),e.jsx(z,{id:"refresh",onClick:h,size:"icon",variant:"outline",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(z,{id:"expand-button",onClick:P,size:"icon",variant:"outline",children:N?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})]})]}),c?e.jsx(Ae,{isLoading:c}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsxs("div",{id:x,children:[x==="allPage"&&e.jsx(bh,{isFullScreen:N,onDataUpdate:w,tabData:s}),x==="collectionPage"&&e.jsx(jh,{isFullScreen:N,onDataUpdate:w,tabData:s}),x==="productPage"&&e.jsx(yh,{isFullScreen:N,onDataUpdate:w,tabData:s})]})})]})})})})]})})]})}const ll=s=>{const a=s.toLowerCase();return a.includes("threads")?e.jsx(Ki,{className:"w-3 h-3"}):a.includes("messenger")?e.jsx(Qi,{className:"w-3 h-3"}):a.includes("instagram")?e.jsx(Ji,{className:"w-3 h-3"}):a.includes("facebook")||a.includes("meta")?e.jsx(Zi,{className:"w-3 h-3"}):a.includes("audience_network")?e.jsx(Xi,{className:"w-3 h-3"}):null},Xr=({ad:s,onClick:a})=>{var g,$,F,A;const t=s.snapshot||{},l=t.images&&t.images.length>0,o=t.videos&&t.videos.length>0,i=t.cards&&t.cards.length>0,c=i?(g=t.cards)==null?void 0:g[0]:null,d=i&&c,u=!d&&l?($=t.images)==null?void 0:$[0]:null,m=!d&&o?(F=t.videos)==null?void 0:F[0]:null;let h=null,v=null;const y=d&&((c==null?void 0:c.video_sd_url)||(c==null?void 0:c.video_hd_url)||(c==null?void 0:c.video_preview_image_url)||(c==null?void 0:c.watermarked_video_sd_url)||(c==null?void 0:c.watermarked_video_hd_url)),S=d&&((c==null?void 0:c.resized_image_url)||(c==null?void 0:c.image_url));d?y?(h=c.video_preview_image_url||c.video_sd_url||c.video_hd_url||c.watermarked_video_sd_url||c.watermarked_video_hd_url,v="video"):S&&(h=c.resized_image_url||c.image_url,v="card"):m!=null&&m.video_preview_image_url||m!=null&&m.video_sd_url?(h=m.video_preview_image_url||m.video_sd_url,v="video"):(u!=null&&u.url||u)&&(h=typeof u=="string"?u:u.resized_image_url||u.url,v="image");const x=d&&(c!=null&&c.title)?c.title:(A=t.body)==null?void 0:A.text,p=C=>{if(!C)return null;try{let _=pt(C);if(kr(_)||(_=new Date(C)),kr(_))return Y(_,"dd/MM/yyyy")}catch(_){console.error("Error parsing date:",_)}return null},N=p(s.start_date_formatted),j=p(s.end_date_formatted),P=N&&j?`${N} - ${j}`:N?`Started at ${N}`:null;return e.jsxs(ue,{className:"cursor-pointer hover:shadow-lg transition-shadow overflow-hidden relative",children:[s.is_active!==void 0&&e.jsx("div",{className:"absolute top-2 left-2 z-20",children:e.jsx(ps,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsxs(he,{className:"p-0",children:[e.jsx("div",{className:"relative w-full aspect-[4/3] bg-gray-100 flex items-center justify-center overflow-hidden",children:h?e.jsxs(e.Fragment,{children:[(v==="video"||d&&y)&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:e.jsx(Vt,{className:"w-12 h-12 text-white"})}),e.jsx("img",{src:h,alt:x||t.title||"Ad preview",className:"w-full h-full object-cover",onError:C=>{C.currentTarget.style.display="none"}})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[v==="video"||d&&y?e.jsx(Vt,{className:"w-12 h-12"}):e.jsx(ya,{className:"w-12 h-12"}),e.jsx("span",{className:"text-xs mt-2",children:"No preview"})]})}),e.jsxs("div",{className:"p-3 space-y-2",children:[x&&e.jsx("p",{className:"text-sm font-semibold line-clamp-2",children:x}),s.publisher_platform&&s.publisher_platform.length>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"platforms :"}),s.publisher_platform.map(C=>{const _=ll(C);return _?e.jsx("span",{className:"flex items-center",children:_},`${s._id}-${C}`):null})]}),P&&e.jsx("p",{className:"text-xs text-muted-foreground",children:P}),s.collation_count&&s.collation_count>1&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("strong",{children:[s.collation_count," ads"]})," use this creative and text"]}),e.jsxs("button",{onClick:a,className:"w-full mt-4 flex items-center justify-between px-3 py-2.5 rounded-lg bg-gradient-to-r from-black/10 to-black/5 hover:from-black/20 hover:to-black/10 transition-colors border border-black/10 group/btn",children:[e.jsx("span",{className:"text-sm font-semibold text-black",children:"View Ad"}),e.jsx(Je,{className:"w-4 h-4 text-black group-hover/btn:translate-x-1 transition-transform"})]})]})]})]})},en=({brand:s,onFollow:a,isFollowing:t=!1})=>{var A,C,_,I,B;const[l,o]=r.useState(t),i=s.ads&&s.ads.length>0?s.ads[0]:null;if(!i)return null;const c=i.snapshot||{},d=c.cards&&c.cards.length>0,u=d?(A=c.cards)==null?void 0:A[0]:null,m=u&&((u==null?void 0:u.video_sd_url)||(u==null?void 0:u.video_hd_url)||(u==null?void 0:u.watermarked_video_sd_url)||(u==null?void 0:u.watermarked_video_hd_url)),h=d&&!m?((C=c.cards)==null?void 0:C.slice(0,5))||[]:[],v=d&&h.length>0&&!m,y=c.images&&c.images.length>0,S=c.videos&&c.videos.length>0,x=y?(_=c.images)==null?void 0:_[0]:null,p=S?(I=c.videos)==null?void 0:I[0]:null;let N=null,j=null,w=null;if(!v){const O=u&&((u==null?void 0:u.resized_image_url)||(u==null?void 0:u.original_image_url)||(u==null?void 0:u.image_url));u?m?(j=u.video_hd_url||u.video_sd_url||u.watermarked_video_hd_url||u.watermarked_video_sd_url,N=u.video_preview_image_url||j,w="video"):O&&(N=u.resized_image_url||u.original_image_url||u.image_url,w="image"):p!=null&&p.video_preview_image_url||p!=null&&p.video_sd_url?(j=p.video_sd_url||p.video_hd_url,N=p.video_preview_image_url||j,w="video"):(x!=null&&x.url||x)&&(N=typeof x=="string"?x:x.resized_image_url||x.url,w="image")}const P=O=>{O.stopPropagation(),o(!0),a(s._id)},g=O=>{O.stopPropagation(),c.link_url&&window.open(c.link_url,"_blank")},$=(u==null?void 0:u.title)||((B=c.body)==null?void 0:B.text)||"",F=$.length>80?$.substring(0,80)+"...":$;return e.jsxs("div",{className:"group relative cursor-pointer",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-blue-500/15 via-purple-500/15 to-pink-500/15 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-all duration-500"}),e.jsx(ue,{className:"overflow-hidden relative h-full bg-white border border-gray-200 shadow-lg hover:shadow-2xl transition-all duration-500 rounded-2xl",children:e.jsxs(he,{className:"p-0 flex flex-col h-full",children:[e.jsxs("div",{className:"px-3 pt-3 pb-2 flex items-center justify-between gap-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800 line-clamp-1",children:s.pageName||"Unknown Brand"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.adCount," ads"]})]}),e.jsx(z,{variant:l?"default":"outline",size:"sm",onClick:P,className:`h-7 w-7 p-0 flex-shrink-0 transition-all duration-300 rounded-full ${l?"bg-rose-500 hover:bg-rose-600 text-white shadow-md":"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300"}`,children:e.jsx(mo,{className:`w-3.5 h-3.5 transition-all ${l?"fill-rose-500":""}`})})]}),e.jsx("div",{className:"relative w-full bg-gradient-to-br from-gray-900 to-gray-800 overflow-hidden flex-shrink-0",children:v?e.jsx("div",{className:"aspect-[4/5] p-1 bg-gray-900",children:h.length===1?e.jsx("div",{className:"w-full h-full relative overflow-hidden rounded-lg",children:e.jsx("img",{src:h[0].resized_image_url||h[0].original_image_url||h[0].image_url||"/placeholder.svg",alt:"Card 1",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",onError:O=>{O.currentTarget.style.display="none"}})}):h.length===2?e.jsx("div",{className:"grid grid-cols-2 gap-1 h-full",children:h.map((O,E)=>e.jsx("div",{className:"relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:O.resized_image_url||O.original_image_url||O.image_url||"/placeholder.svg",alt:`Card ${E+1}`,className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:M=>{M.currentTarget.style.display="none"}})},E))}):h.length===3?e.jsxs("div",{className:"flex flex-col gap-1 h-full",children:[e.jsx("div",{className:"w-full h-1/2 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[0].resized_image_url||h[0].original_image_url||h[0].image_url||"/placeholder.svg",alt:"Card 1",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"flex gap-1 h-1/2",children:[e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[1].resized_image_url||h[1].image_url||"/placeholder.svg",alt:"Card 2",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})}),e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[2].resized_image_url||h[2].image_url||"/placeholder.svg",alt:"Card 3",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})})]})]}):h.length===4?e.jsx("div",{className:"grid grid-cols-2 gap-1 h-full",children:h.map((O,E)=>e.jsx("div",{className:"relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:O.resized_image_url||O.image_url||"/placeholder.svg",alt:`Card ${E+1}`,className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:M=>{M.currentTarget.style.display="none"}})},E))}):e.jsxs("div",{className:"flex flex-col gap-1 h-full",children:[e.jsxs("div",{className:"flex gap-1 h-1/2",children:[e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[0].resized_image_url||h[0].image_url||"/placeholder.svg",alt:"Card 1",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})}),e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[1].resized_image_url||h[1].image_url||"/placeholder.svg",alt:"Card 2",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})}),e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[2].resized_image_url||h[2].image_url||"/placeholder.svg",alt:"Card 3",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})})]}),e.jsxs("div",{className:"flex gap-1 h-1/2",children:[e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[3].resized_image_url||h[3].image_url||"/placeholder.svg",alt:"Card 4",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})}),e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg bg-gray-700 group/item",children:e.jsx("img",{src:h[4].resized_image_url||h[4].image_url||"/placeholder.svg",alt:"Card 5",className:"w-full h-full object-cover group-hover/item:scale-110 transition-transform duration-500",onError:O=>{O.currentTarget.style.display="none"}})})]})]})}):e.jsx("div",{className:"relative w-full aspect-[4/3] flex items-center justify-center bg-black",children:N?e.jsx(e.Fragment,{children:w==="video"&&j?e.jsx(e.Fragment,{children:e.jsx("video",{src:j,className:"w-full h-full object-cover",controls:!0,onClick:O=>O.stopPropagation()})}):e.jsx("img",{src:N||"/placeholder.svg",alt:s.pageName||"Ad preview",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",onError:O=>{O.currentTarget.style.display="none"}})}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ya,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"text-xs",children:"No preview"})]})})}),e.jsxs("div",{className:"px-3 pb-3 pt-2 flex-grow flex flex-col justify-between",children:[F&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2 leading-relaxed mb-2",children:F}),c.cta_text&&e.jsx(z,{onClick:g,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium shadow-none hover:shadow-sm transition-all duration-300 rounded-lg py-1.5 h-auto text-xs",children:c.cta_text})]})]})})]})},Nh=({ads:s,open:a,onOpenChange:t})=>{var w,P,g;const[l,o]=r.useState(0),[i,c]=r.useState(0);if(s.length===0)return null;const d=s[l],u=d.snapshot||{},m=u.cards&&u.cards.length>0,h=u.images&&u.images.length>0,v=u.videos&&u.videos.length>0,y=m?((w=u==null?void 0:u.cards)==null?void 0:w.map($=>$.video_sd_url||$.video_hd_url||$.watermarked_video_sd_url||$.watermarked_video_hd_url?{type:"video",videoUrl:$.video_hd_url||$.video_sd_url||$.watermarked_video_hd_url||$.watermarked_video_sd_url,poster:$.video_preview_image_url||$.resized_image_url,link:$.link,name:$.name,description:$.description,body:$.body,cta_text:$.cta_text}:{type:"card",image:$.original_image_url||$.image_url,link:$.link,name:$.name,description:$.description,body:$.body,cta_text:$.cta_text}))??[]:h?((P=u.images)==null?void 0:P.map($=>({type:"image",url:typeof $=="string"?$:$.url})))??[]:[],S=y[i],x=()=>{c($=>($+1)%y.length)},p=()=>{c($=>($-1+y.length)%y.length)},N=()=>{o($=>($+1)%s.length),c(0)},j=()=>{o($=>($-1+s.length)%s.length),c(0)};return e.jsx(ut,{open:a,onOpenChange:t,children:e.jsxs(Ks,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Qs,{children:[e.jsxs(Js,{children:["Ad Details ",s.length>1&&`(${l+1} of ${s.length})`]}),e.jsx(It,{children:u.title||"Ad Summary Details"})]}),e.jsxs("div",{className:"space-y-6",children:[s.length>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:j,disabled:l===0,children:[e.jsx(us,{className:"w-4 h-4 mr-2"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Ad ",l+1," of ",s.length]}),e.jsxs(z,{variant:"outline",size:"sm",onClick:N,disabled:l===s.length-1,children:["Next",e.jsx(Je,{className:"w-4 h-4 ml-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-stretch",children:[e.jsx("div",{className:"lg:col-span-1 flex",children:e.jsx(ue,{className:"w-full flex flex-col",children:e.jsx(he,{className:"p-0 flex-1 flex flex-col",children:m&&y.length>0?e.jsxs("div",{className:"relative flex-1 flex flex-col",children:[e.jsx("div",{className:"flex-1 bg-gray-100 flex items-center justify-center overflow-hidden min-h-[280px]",children:S.type==="video"&&"videoUrl"in S?e.jsx("video",{src:S.videoUrl,controls:!0,className:"w-full h-full object-contain",poster:S.poster,style:{maxHeight:"100%"}}):"image"in S&&S.image?e.jsx("img",{src:S.image,alt:"name"in S&&S.name||"Carousel item",className:"w-full h-full object-contain",style:{maxHeight:"100%"}}):e.jsx("div",{className:"text-muted-foreground",children:"No media"})}),S.type==="video"&&"videoUrl"in S&&e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded flex items-center gap-1 z-10",children:[e.jsx(Vt,{className:"w-3 h-3"}),"Video"]}),y.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(z,{variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 z-10",onClick:p,children:e.jsx(us,{className:"w-4 h-4"})}),e.jsx(z,{variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 z-10",onClick:x,children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:y.map(($,F)=>e.jsx("button",{className:`w-2 h-2 rounded-full ${F===i?"bg-white":"bg-white/50"}`,onClick:()=>c(F)},F))}),e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:[i+1," / ",y.length]})]})]}):v&&u.videos&&u.videos.length>0?e.jsxs("div",{className:"relative flex-1 bg-black min-h-[280px]",children:[e.jsx("video",{src:u.videos[0].video_sd_url||u.videos[0].video_hd_url,controls:!0,className:"w-full h-full",poster:u.videos[0].video_preview_image_url}),e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded flex items-center gap-1",children:[e.jsx(Vt,{className:"w-3 h-3"}),"Video"]})]}):h&&u.images&&u.images.length>0?e.jsx("div",{className:"flex-1 bg-gray-100 flex items-center justify-center overflow-hidden min-h-[280px]",children:e.jsx("img",{src:typeof u.images[0]=="string"?u.images[0]:u.images[0].url,alt:u.title||"Ad image",className:"w-full h-full object-contain"})}):e.jsx("div",{className:"flex-1 bg-gray-100 flex items-center justify-center text-muted-foreground min-h-[280px]",children:"No media available"})})})}),e.jsx("div",{className:"lg:col-span-1 flex",children:e.jsx(ue,{className:"w-full flex flex-col",children:e.jsx(he,{className:"flex-1 flex flex-col",children:e.jsxs("div",{className:"space-y-4 flex-1 flex flex-col",children:[m&&"body"in S&&S.body?e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:typeof S.body=="string"?S.body:S.body.text||JSON.stringify(S.body)})}):((g=u.body)==null?void 0:g.text)&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:u.body.text})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(ps,{variant:d.is_active?"default":"secondary",children:d.is_active?"Active":"Inactive"})}),d.publisher_platform&&d.publisher_platform.length>0&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"platforms :"}),d.publisher_platform.map($=>{const F=ll($);return F?e.jsx("span",{className:"flex items-center",children:F},`${d._id}-${$}`):null})]}),d.start_date_formatted&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{children:"Start Date"})]}),e.jsx("p",{className:"text-sm",children:d.start_date_formatted})]}),d.end_date_formatted&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{children:"End Date"})]}),e.jsx("p",{className:"text-sm",children:d.end_date_formatted})]})]}),m&&"link"in S&&S.link&&"cta_text"in S&&S.cta_text?e.jsx("div",{children:e.jsxs(z,{onClick:()=>{S.link&&window.open(S.link,"_blank","noopener,noreferrer")},className:"w-full",children:[S.cta_text,e.jsx(Ga,{className:"w-4 h-4 ml-2"})]})}):u.link_url&&u.cta_text&&e.jsx("div",{children:e.jsxs(z,{onClick:()=>{u.link_url&&window.open(u.link_url,"_blank","noopener,noreferrer")},className:"w-full",children:[u.cta_text,e.jsx(Ga,{className:"w-4 h-4 ml-2"})]})})]})})})})]})]})]})})},wh=()=>{const{brandId:s}=ge(),[a,t]=r.useState([]),[l,o]=r.useState([]),[i,c]=r.useState(!0),[d,u]=r.useState(!1),[m,h]=r.useState(!1),[v,y]=r.useState(""),[S,x]=r.useState(""),[p,N]=r.useState([]),[j,w]=r.useState(!1),[P,g]=r.useState(new Set),[$,F]=r.useState("explore"),[A,C]=r.useState(new Set),{toast:_}=mt(),I=async()=>{var n,b;c(!0);try{const T=await ne.get(`${be}/api/scraping/get-followed-brands/${s}`,{withCredentials:!0});if(T.data.success){t(T.data.data);const U=new Set(T.data.data.map(D=>D._id));C(U)}else _({variant:"destructive",description:"Failed to fetch brands"})}catch(T){console.error("Error fetching brands:",T),_({variant:"destructive",description:((b=(n=T.response)==null?void 0:n.data)==null?void 0:b.message)||"Error fetching brands"})}finally{c(!1)}},B=async()=>{var n,b;u(!0);try{const T=await ne.get(`${be}/api/scraping/get-single-ad-from-all-scraped-brands?includeAds=true`,{withCredentials:!0});T.data.success?o(T.data.data):_({variant:"destructive",description:"Failed to fetch catalog brands"})}catch(T){console.error("Error fetching catalog brands:",T),_({variant:"destructive",description:((b=(n=T.response)==null?void 0:n.data)==null?void 0:b.message)||"Error fetching catalog brands"})}finally{u(!1)}},O=async n=>{var b,T;if(!s){_({variant:"destructive",description:"Brand ID is missing"});return}try{const U=await ne.post(`${be}/api/scraping/follow-brand/${s}`,{scrapedBrandId:n},{withCredentials:!0});U.data.message==="Brand followed successfully"?(_({description:"Brand followed successfully"}),C(D=>new Set(D).add(n)),await I(),$==="explore"&&F("followed")):_({variant:"destructive",description:U.data.message||"Failed to follow brand"})}catch(U){console.error("Error following brand:",U),_({variant:"destructive",description:((T=(b=U.response)==null?void 0:b.data)==null?void 0:T.message)||"Error following brand"})}},E=async()=>{var n,b;if(!v.trim()){_({variant:"destructive",description:"Please enter a page URL"});return}h(!0);try{const T=await ne.post(`${be}/api/scraping/scrape-brand`,{pageUrl:v.trim(),count:200,countries:["IN"],activeStatus:"all",brandId:s},{withCredentials:!0});T.data.success?(_({description:`Successfully scraped ${T.data.data.saveResult.adsSaved} ads`}),y(""),await I(),($==="explore"||a.length===0)&&await B()):_({variant:"destructive",description:"Failed to scrape page"})}catch(T){console.error("Error scraping:",T),_({variant:"destructive",description:((b=(n=T.response)==null?void 0:n.data)==null?void 0:b.message)||"Error scraping page"})}finally{h(!1)}},M=n=>{g(b=>{const T=new Set(b);return T.has(n)?T.delete(n):T.add(n),T})},R=n=>{N(n),w(!0)},L=async n=>{var b,T;if(!s){_({variant:"destructive",description:"Brand ID is missing"});return}try{const U=await ne.post(`${be}/api/scraping/unfollow-brand/${s}`,{scrapedBrandId:n},{withCredentials:!0});U.data.success?(_({description:"Brand unfollowed successfully"}),C(D=>{const W=new Set(D);return W.delete(n),W}),await I(),await B()):_({variant:"destructive",description:U.data.message||"Failed to unfollow brand"})}catch(U){console.error("Error unfollowing brand:",U),_({variant:"destructive",description:((T=(b=U.response)==null?void 0:b.data)==null?void 0:T.message)||"Error unfollowing brand"})}};r.useEffect(()=>{I()},[s]),r.useEffect(()=>{(a.length===0||$==="explore")&&B()},[a.length,$]);const k=l.filter(n=>{var T,U;if(!S.trim())return!0;const b=S.toLowerCase();return((T=n.pageName)==null?void 0:T.toLowerCase().includes(b))||((U=n.pageUrl)==null?void 0:U.toLowerCase().includes(b))});if(i)return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(Ae,{isLoading:!0})})]});if(a.length===0)return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto p-6 space-y-6",children:[e.jsx(ue,{className:"border border-gray-200 shadow-md bg-white",children:e.jsxs(he,{className:"p-4",children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Discover the brands to follow their strategies"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-1 w-full sm:w-auto",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(Cs,{className:"w-4 h-4 text-gray-400"})}),e.jsx(ve,{type:"text",placeholder:"Search brands...",value:S,onChange:n=>x(n.target.value),className:"pl-9 pr-3 h-9 text-sm border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 rounded-lg bg-white transition-all"})]}),e.jsxs("div",{className:"relative flex-1 w-full sm:w-auto",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(Cr,{className:"w-4 h-4 text-gray-400"})}),e.jsx(ve,{type:"text",placeholder:"Paste Facebook page URL...",value:v,onChange:n=>y(n.target.value),onKeyDown:n=>n.key==="Enter"&&E(),className:"pl-9 pr-3 h-9 text-sm border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 rounded-lg bg-white transition-all"})]}),e.jsx(z,{onClick:E,disabled:m||!v.trim(),className:"h-9 px-4 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium shadow-sm hover:shadow transition-all duration-200 rounded-lg whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-4 h-4 mr-2 animate-spin"}),"Scraping..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Add Brand"]})})]})]})}),d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ae,{isLoading:!0})}):k.length===0?e.jsx(ue,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(js,{className:"w-16 h-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Brands Found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:S?"No brands match your search. Try a different query.":"No brands available. Start by adding a Facebook page URL to scrape ads."})]})})}):e.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-8",children:k.map((n,b)=>e.jsx("div",{className:"break-inside-avoid mb-6",style:{animation:`fadeInUp 0.6s ease-out ${Math.min(b*.05,1)}s both`},children:e.jsx(en,{brand:n,onFollow:O,isFollowing:A.has(n._id)})},n._id))})]})]});const f=[{label:"Explore Brands",value:"explore",icon:e.jsx(Cs,{className:"w-5 h-5"})},{label:"Followed Brands",value:"followed",icon:e.jsx(mo,{className:"w-5 h-5"})}];return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(Re,{}),e.jsx(qt,{tabs:f,activeTab:$,onTabChange:F,className:"h-full"}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto p-6 space-y-6",children:[$==="explore"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ue,{className:"border border-gray-200 shadow-md bg-white",children:e.jsxs(he,{className:"p-4",children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsx("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Discover the brands to follow their strategies"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center",children:[e.jsxs("div",{className:"relative flex-1 w-full sm:w-auto",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(Cs,{className:"w-4 h-4 text-gray-400"})}),e.jsx(ve,{type:"text",placeholder:"Search brands...",value:S,onChange:n=>x(n.target.value),className:"pl-9 pr-3 h-9 text-sm border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 rounded-lg bg-white transition-all"})]}),e.jsxs("div",{className:"relative flex-1 w-full sm:w-auto",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:e.jsx(Cr,{className:"w-4 h-4 text-gray-400"})}),e.jsx(ve,{type:"text",placeholder:"Paste Facebook page URL...",value:v,onChange:n=>y(n.target.value),onKeyDown:n=>n.key==="Enter"&&E(),className:"pl-9 pr-3 h-9 text-sm border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 rounded-lg bg-white transition-all"})]}),e.jsx(z,{onClick:E,disabled:m||!v.trim(),className:"h-9 px-4 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium shadow-sm hover:shadow transition-all duration-200 rounded-lg whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-4 h-4 mr-2 animate-spin"}),"Scraping..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qs,{className:"w-4 h-4 mr-2"}),"Add Brand"]})})]})]})}),d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ae,{isLoading:!0})}):k.length===0?e.jsx(ue,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(js,{className:"w-16 h-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Brands Found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:S?"No brands match your search. Try a different query.":"No brands available. Start by adding a Facebook page URL to scrape ads."})]})})}):e.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-8",children:k.map((n,b)=>e.jsx("div",{className:"break-inside-avoid mb-6",style:{animation:`fadeInUp 0.6s ease-out ${Math.min(b*.05,1)}s both`},children:e.jsx(en,{brand:n,onFollow:O,isFollowing:A.has(n._id)})},n._id))})]}),$==="followed"&&e.jsx("div",{className:"space-y-6",children:a.map(n=>{const b=(n.ads||[]).filter(W=>{const K=W.collation_id,q=W.collation_count||0;return!K||K&&q>0}),T=P.has(n._id),U=T?b:b.slice(0,4),D=b.length>4;return e.jsxs(ue,{children:[e.jsx(bs,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ts,{className:"text-xl cursor-pointer",onClick:()=>window.open(n.pageUrl,"_blank"),children:n.pageName||"Unknown Brand"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total ",e.jsx("strong",{children:n.adCount})," ads"]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[D&&e.jsx(z,{variant:"outline",onClick:()=>M(n._id),children:T?e.jsxs(e.Fragment,{children:[e.jsx(Ka,{className:"w-4 h-4 mr-2"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),"View All"]})}),e.jsx(z,{variant:"destructive",onClick:()=>L(n._id),children:"Unfollow"})]})]})}),e.jsx(he,{children:U.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No ads available"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:U.map(W=>{var ee;const K=W.collation_id,q=W.collation_count||0;if(K&&q>1){const J=((ee=n.ads)==null?void 0:ee.filter(ae=>ae.collation_id===K))||[];return e.jsx(Xr,{ad:W,onClick:()=>R(J)},W._id)}return e.jsx(Xr,{ad:W,onClick:()=>R([W])},W._id)})})})]},n._id)})})]}),j&&e.jsx(Nh,{ads:p,open:j,onOpenChange:w})]})},il=r.forwardRef(({className:s,...a},t)=>e.jsx("textarea",{className:Q("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a}));il.displayName="Textarea";const Ch=[{code:"IN",name:"India"},{code:"US",name:"United States"},{code:"UK",name:"United Kingdom"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"JP",name:"Japan"},{code:"CN",name:"China"},{code:"BR",name:"Brazil"},{code:"MX",name:"Mexico"},{code:"ES",name:"Spain"},{code:"IT",name:"Italy"}],sn=["All Months","January","February","March","April","May","June","July","August","September","October","November","December"];function Sh(){const{brandId:s}=ge(),a=Ce(),[t,l]=r.useState([]),[o,i]=r.useState(!1),[c,d]=r.useState(!1),[u,m]=r.useState(!1),[h,v]=r.useState("IN"),[y,S]=r.useState(""),[x,p]=r.useState("all"),[N,j]=r.useState("All Months"),[w,P]=r.useState("all"),[g,$]=r.useState("date-asc"),[F,A]=r.useState(""),[C,_]=r.useState(""),[I,B]=r.useState(""),[O,E]=r.useState("national"),M=r.useCallback(async()=>{if(s)try{i(!0);const T=await a.get(`/api/festival-dates/${s}`,{params:{country:h},withCredentials:!0});T.data.success&&l(T.data.data||[])}catch(T){console.error("Error fetching festival dates:",T)}finally{i(!1)}},[s,h]),R=r.useCallback(async()=>{var T,U;if(s)try{d(!0);const D=new Date().getFullYear(),W=await a.post("/api/festival-dates/generate",{country:h,year:D},{withCredentials:!0});W.data.success&&(alert(W.data.message||"Holidays generated successfully!"),await M())}catch(D){console.error("Error generating holidays:",D),alert(((U=(T=D.response)==null?void 0:T.data)==null?void 0:U.message)||"Failed to generate holidays")}finally{d(!1)}},[s,h]),L=async()=>{var T,U;if(!(!F||!C.trim()||!s))try{i(!0),(await a.post(`/api/festival-dates/${s}`,{date:F,festivalName:C.trim(),description:I.trim()||void 0,country:h,scope:O},{withCredentials:!0})).data.success&&(await M(),m(!1),f())}catch(D){console.error("Error adding festival date:",D),alert(((U=(T=D.response)==null?void 0:T.data)==null?void 0:U.message)||"Failed to add festival date")}finally{i(!1)}},k=async T=>{var U,D;if(!(!s||!confirm("Are you sure you want to delete this holiday?")))try{i(!0),(await a.delete(`/api/festival-dates/${T}`,{params:{brandId:s},withCredentials:!0})).data.success&&await M()}catch(W){console.error("Error deleting festival date:",W),alert(((D=(U=W.response)==null?void 0:U.data)==null?void 0:D.message)||"Failed to delete festival date")}finally{i(!1)}},f=()=>{A(""),_(""),B(""),E("national")},n=r.useMemo(()=>{let T=[...t];if(y&&(T=T.filter(U=>{var D;return U.festivalName.toLowerCase().includes(y.toLowerCase())||((D=U.description)==null?void 0:D.toLowerCase().includes(y.toLowerCase()))})),x!=="all"&&(T=T.filter(U=>U.type===x)),N!=="All Months"){const U=sn.indexOf(N)-1;T=T.filter(D=>{const W=pt(D.date);return nc(W)===U})}return w!=="all"&&(T=T.filter(U=>U.scope===w)),T.sort((U,D)=>{const W=pt(U.date),K=pt(D.date);return g==="date-asc"?W.getTime()-K.getTime():g==="date-desc"?K.getTime()-W.getTime():g==="name-asc"?U.festivalName.localeCompare(D.festivalName):D.festivalName.localeCompare(U.festivalName)}),T},[t,y,x,N,w,g]),b=r.useMemo(()=>{if(N==="All Months")return{"":n};const T={};return n.forEach(U=>{const D=pt(U.date),W=Y(D,"MMMM yyyy");T[W]||(T[W]=[]),T[W].push(U)}),T},[n,N]);return r.useEffect(()=>{s&&!o&&M()},[s,h]),e.jsxs("div",{className:"flex h-screen bg-slate-50",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Festival Calendar"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"View and manage holidays and festivals for your brand"})]}),e.jsxs(z,{onClick:()=>m(!0),className:"gap-2",children:[e.jsx(qs,{className:"h-4 w-4"}),"Add Holiday"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{htmlFor:"country",className:"text-sm font-medium",children:"Country:"}),e.jsxs(We,{value:h,onValueChange:v,children:[e.jsx(Be,{id:"country",className:"w-[180px]",children:e.jsx(He,{})}),e.jsx(Ge,{children:Ch.map(T=>e.jsx(ie,{value:T.code,children:T.name},T.code))})]})]}),e.jsx(z,{variant:"outline",onClick:R,disabled:c,className:"gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"h-4 w-4"}),"Generate Holidays"]})}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(ve,{placeholder:"Search holidays...",value:y,onChange:T=>S(T.target.value),className:"pl-8"})]})}),e.jsxs(We,{value:x,onValueChange:T=>p(T),children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Types"}),e.jsx(ie,{value:"global",children:"Global"}),e.jsx(ie,{value:"brand",children:"Brand"})]})]}),e.jsxs(We,{value:N,onValueChange:j,children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(He,{})}),e.jsx(Ge,{children:sn.map(T=>e.jsx(ie,{value:T,children:T},T))})]}),e.jsxs(We,{value:w,onValueChange:T=>P(T),children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"all",children:"All Scopes"}),e.jsx(ie,{value:"national",children:"National"}),e.jsx(ie,{value:"other",children:"Other"})]})]}),e.jsxs(We,{value:g,onValueChange:T=>$(T),children:[e.jsx(Be,{className:"w-[160px]",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"date-asc",children:"Date (Ascending)"}),e.jsx(ie,{value:"date-desc",children:"Date (Descending)"}),e.jsx(ie,{value:"name-asc",children:"Name (A-Z)"}),e.jsx(ie,{value:"name-desc",children:"Name (Z-A)"})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:o&&t.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(it,{className:"h-8 w-8 animate-spin text-slate-400"})}):n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(Ls,{className:"h-16 w-16 text-slate-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No holidays found"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:y||x!=="all"||N!=="All Months"||w!=="all"?"Try adjusting your filters":"Generate holidays or add your own"}),!y&&x==="all"&&N==="All Months"&&w==="all"&&e.jsxs(z,{onClick:R,variant:"outline",className:"gap-2",children:[e.jsx(Ms,{className:"h-4 w-4"}),"Generate Holidays"]})]}):e.jsx("div",{className:"space-y-8",children:Object.entries(b).map(([T,U])=>e.jsxs("div",{children:[T&&e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:T}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:U.map(D=>{const W=pt(D.date),K=D.type==="brand",q=Y(W,"d"),ee=Y(W,"MMM"),J=Y(W,"EEE");return e.jsxs(ue,{className:Q("relative overflow-hidden transition-all duration-200 hover:shadow-md border-0","group",K?"bg-gradient-to-br from-orange-50 via-amber-50/50 to-yellow-50":"bg-gradient-to-br from-blue-50 via-indigo-50/50 to-purple-50"),children:[e.jsx("div",{className:Q("absolute -top-8 -right-8 w-24 h-24 rounded-full opacity-20 blur-2xl",K?"bg-orange-400":"bg-blue-400")}),e.jsx(bs,{className:"pb-3 relative z-10",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsxs("div",{className:Q("flex flex-col items-center justify-center w-16 h-16 rounded-lg shrink-0",K?"bg-orange-500":"bg-blue-500"),children:[e.jsx("span",{className:"text-[10px] font-semibold text-white uppercase leading-tight",children:J}),e.jsx("span",{className:"text-xl font-bold text-white leading-none my-0.5",children:q}),e.jsx("span",{className:"text-[10px] font-medium text-white uppercase leading-tight",children:ee})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ts,{className:"text-base font-semibold text-slate-800 leading-tight mb-1 line-clamp-2",children:D.festivalName}),e.jsx(ir,{className:"text-xs text-slate-600",children:Y(W,"EEEE, MMMM d, yyyy")})]})]}),K&&e.jsx(z,{variant:"ghost",size:"icon",className:"h-7 w-7 text-red-500 hover:text-red-700 hover:bg-red-50 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>k(D._id),disabled:o,children:e.jsx(ja,{className:"h-3.5 w-3.5"})})]})}),e.jsx(he,{className:"pt-0 pb-4 relative z-10",children:D.description&&e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed mb-2 line-clamp-3",children:D.description})})]},D._id)})})]},T))})})]}),e.jsx(ut,{open:u,onOpenChange:T=>{m(T),T||f()},children:e.jsxs(Ks,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Qs,{children:[e.jsx(Js,{children:"Add Holiday"}),e.jsx(It,{children:"Add a brand-specific holiday or festival"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"date",children:"Date *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(ve,{id:"date",type:"date",value:F,onChange:T=>A(T.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"festivalName",children:"Holiday Name *"}),e.jsx(ve,{id:"festivalName",placeholder:"e.g., Diwali, Christmas, New Year Sale",value:C,onChange:T=>_(T.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(il,{id:"description",placeholder:"Add any additional details about this holiday",value:I,onChange:T=>B(T.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"scope",children:"Scope *"}),e.jsxs(We,{value:O,onValueChange:T=>E(T),children:[e.jsx(Be,{id:"scope",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"national",children:"National"}),e.jsx(ie,{value:"other",children:"Other"})]})]})]})]}),e.jsxs(lr,{children:[e.jsx(z,{variant:"outline",onClick:()=>{m(!1),f()},children:"Cancel"}),e.jsx(z,{onClick:L,disabled:!C.trim()||!F||o,children:o?"Adding...":"Add Holiday"})]})]})})]})}const Dt=({metric:s,isCoreVital:a=!1})=>{const t=d=>{switch(d){case"good":return"text-green-600";case"needs-improvement":return"text-orange-600";case"poor":return"text-red-600";default:return"text-gray-600"}},l=s.distributions.good.value*100,o=s.distributions.needsImprovement.value*100,i=s.distributions.poor.value*100;let c=0;return s.p75_ms!==void 0&&(s.status==="good"?c=l*.5:s.status==="needs-improvement"?c=l+o*.5:c=l+o+i*.5),e.jsxs("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800",children:s.name}),e.jsx("span",{className:Q("text-lg font-bold",t(s.status)),children:s.p75})]}),e.jsxs("div",{className:"relative h-4 mb-4 bg-gray-100 rounded overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"bg-green-500",style:{width:`${l}%`}}),e.jsx("div",{className:"bg-orange-500",style:{width:`${o}%`}}),e.jsx("div",{className:"bg-red-500",style:{width:`${i}%`}})]}),c>0&&e.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white border border-gray-600 shadow-xl",style:{left:`${c}%`,transform:"translateX(-50%)"}})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:s.distributions.good.label}),e.jsx("span",{className:"font-medium text-gray-800",children:s.distributions.good.percentage})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:s.distributions.needsImprovement.label}),e.jsx("span",{className:"font-medium text-gray-800",children:s.distributions.needsImprovement.percentage})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:s.distributions.poor.label}),e.jsx("span",{className:"font-medium text-gray-800",children:s.distributions.poor.percentage})]})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"75th Percentile:"})," ",s.p75]}),a&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:"https://web.dev/articles/vitals",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Core Web Vital"})}),s.experimental&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"text-sm text-gray-500 italic",children:"Experimental"})})]})};function kh(){const[s,a]=r.useState(null),[t,l]=r.useState(""),[o,i]=r.useState("PHONE"),[c,d]=r.useState(!1),[u,m]=r.useState({}),[h,v]=r.useState({}),[y,S]=r.useState(!1),x=Ce(),p=g=>{const $=g.trim();return!$||/^https?:\/\//i.exec($)?$:`https://${$}`},N=async(g,$)=>{var C,_;const F=p($),A=`${F}_${g}`;if(h[A]){a(h[A]),i(g),m(I=>{const B={...I};return delete B[A],B});return}d(!0),m(I=>{const B={...I};return delete B[A],B});try{const I=await x.post("/api/pageSpeedInsights",{url:F,format:g});if(I.data.success)a(I.data),i(g),S(!0),v(B=>({...B,[A]:I.data})),m(B=>{const O={...B};return delete O[A],O});else{const B=I.data.message||"Failed to fetch speed insights";m(O=>({...O,[A]:B})),i(g),S(!0)}}catch(I){const B=((_=(C=I.response)==null?void 0:C.data)==null?void 0:_.message)||"An error occurred while fetching speed insights";m(O=>({...O,[A]:B})),i(g),S(!0)}finally{d(!1)}},j=async()=>{if(!t.trim())return;const g=p(t);g!==t&&l(g),v({}),m({}),a(null),S(!1),await N("PHONE",g)},w=async g=>{t.trim()&&await N(g,t.trim())},P=()=>{var C;const $=`${p(t)}_${o}`,F=u[$],A=((C=s==null?void 0:s.data)==null?void 0:C.parsed)&&s.formFactor===o;return F?e.jsxs("div",{className:"flex items-start gap-3 pt-6",children:[e.jsx(js,{className:"h-6 w-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:["Error Loading ",o," Data"]}),e.jsx("p",{className:"text-red-800",children:F})]})]}):A&&s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pt-6 text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.data.parsed.assessment.status==="PASSED"?e.jsx(qi,{className:"h-6 w-6 text-green-600"}):e.jsx(js,{className:"h-6 w-6 text-red-600"}),e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Core Web Vitals Assessment: ",s.data.parsed.assessment.status]})]})}),e.jsxs("p",{className:"text-gray-600 mb-4",children:[s.data.parsed.assessment.passedVitals," of ",s.data.parsed.assessment.totalVitals," Core Web Vitals passed"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[e.jsx(Dt,{metric:s.data.parsed.coreWebVitals.LCP,isCoreVital:!0}),e.jsx(Dt,{metric:s.data.parsed.coreWebVitals.INP,isCoreVital:!0}),e.jsx(Dt,{metric:s.data.parsed.coreWebVitals.CLS,isCoreVital:!0})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-200 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Dt,{metric:s.data.parsed.otherMetrics.FCP}),e.jsx(Dt,{metric:s.data.parsed.otherMetrics.TTFB})]})})]}):c?e.jsx("div",{className:"pt-6",children:e.jsxs("p",{className:"text-gray-600",children:["Loading ",o.toLowerCase()," data..."]})}):null};return e.jsxs("div",{className:"flex h-screen bg-slate-50",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b bg-white",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"PageSpeed Insights"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Analyze your website's performance metrics"})]})})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white border rounded-lg p-6 shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"url-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Website URL"}),e.jsx(ve,{id:"url-input",type:"text",placeholder:"https://example.com",value:t,onChange:g=>l(g.target.value),onKeyDown:g=>{g.key==="Enter"&&j()},className:"w-full"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(z,{onClick:j,disabled:c||!t.trim(),className:"w-full md:w-auto",children:c?"Analyzing...":"Analyze"})})]})}),y&&(()=>{var F;const g=p(t),$=((F=s==null?void 0:s.data)==null?void 0:F.parsed)&&s.formFactor===o;return e.jsxs("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex justify-center gap-2 border-b border-gray-200 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>w("PHONE"),disabled:c,className:Q("px-6 py-3 text-sm font-medium transition-colors border-b-2 -mb-px",o==="PHONE"?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300",c&&"opacity-50 cursor-not-allowed"),children:"Mobile"}),e.jsx("button",{type:"button",onClick:()=>w("DESKTOP"),disabled:c,className:Q("px-6 py-3 text-sm font-medium transition-colors border-b-2 -mb-px",o==="DESKTOP"?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300",c&&"opacity-50 cursor-not-allowed"),children:"Desktop"}),e.jsx("button",{type:"button",onClick:()=>w("TABLET"),disabled:c,className:Q("px-6 py-3 text-sm font-medium transition-colors border-b-2 -mb-px",o==="TABLET"?"text-blue-600 border-blue-600":"text-gray-600 border-transparent hover:text-gray-900 hover:border-gray-300",c&&"opacity-50 cursor-not-allowed"),children:"Tablet"})]}),P(),e.jsx("div",{className:"flex items-center justify-center text-center mt-6",children:e.jsx("div",{children:$&&s?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Collection Period:"})," ",s.data.parsed.collectionPeriod.formatted]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:"URL Analyzed:"})," ",s.urlUsed]})]}):e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"URL Analyzed:"})," ",g]})})})]})})()]})})]})]})}const Ah=$t("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),cl=r.forwardRef(({className:s,variant:a,...t},l)=>e.jsx("div",{ref:l,role:"alert",className:Q(Ah({variant:a}),s),...t}));cl.displayName="Alert";const Mh=r.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:Q("mb-1 font-medium leading-none tracking-tight",s),...a}));Mh.displayName="AlertTitle";const dl=r.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:Q("text-sm [&_p]:leading-relaxed",s),...a}));dl.displayName="AlertDescription";function Th({data:s,dimensionValue:a,currencyCode:t="USD"}){const[l,o]=r.useState(1),[i,c]=r.useState(50),[d,u]=r.useState("totalSales"),[m,h]=r.useState("desc"),v=r.useMemo(()=>{const j=[...s];return j.sort((w,P)=>{let g,$;switch(d){case"location":g=`${w.city||""}${w.state?`, ${w.state}`:""}`.toLowerCase(),$=`${P.city||""}${P.state?`, ${P.state}`:""}`.toLowerCase();break;case"totalSales":g=w.totalSales,$=P.totalSales;break;case"orderCount":g=w.orderCount,$=P.orderCount;break;default:return 0}return g<$?m==="asc"?-1:1:g>$?m==="asc"?1:-1:0}),j},[s,d,m]),y=r.useMemo(()=>{const j=(l-1)*i,w=j+i;return v.slice(j,w)},[v,l,i]),S=Math.ceil(v.length/i),x=j=>{d===j?m==="desc"?h("asc"):m==="asc"&&(h(null),u("totalSales"),h("desc")):(u(j),h("desc"))},p=j=>d!==j?e.jsx(oa,{className:"h-4 w-4 ml-1 opacity-50"}):m==="asc"?e.jsx(pa,{className:"h-4 w-4 ml-1"}):m==="desc"?e.jsx(ba,{className:"h-4 w-4 ml-1"}):e.jsx(oa,{className:"h-4 w-4 ml-1 opacity-50"}),N=j=>{o(Math.max(1,Math.min(j,S)))};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold capitalize",children:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Rows per page:"}),e.jsxs(We,{value:i.toString(),onValueChange:j=>{c(Number(j)),o(1)},children:[e.jsx(Be,{className:"w-[100px]",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"25",children:"25"}),e.jsx(ie,{value:"50",children:"50"}),e.jsx(ie,{value:"100",children:"100"}),e.jsx(ie,{value:"200",children:"200"})]})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(ka,{children:[e.jsx(Aa,{children:e.jsxs(Ws,{children:[e.jsx(rs,{className:"w-[300px]",children:e.jsxs(z,{variant:"ghost",size:"sm",className:"h-8 -ml-2",onClick:()=>x("location"),children:["Location",p("location")]})}),e.jsx(rs,{className:"text-right",children:e.jsxs(z,{variant:"ghost",size:"sm",className:"h-8 -ml-2",onClick:()=>x("totalSales"),children:["Total Sales",p("totalSales")]})}),e.jsx(rs,{className:"text-right",children:e.jsxs(z,{variant:"ghost",size:"sm",className:"h-8 -ml-2",onClick:()=>x("orderCount"),children:["Order Count",p("orderCount")]})})]})}),e.jsx(Ma,{children:y.length===0?e.jsx(Ws,{children:e.jsx(Ke,{colSpan:3,className:"text-center text-muted-foreground py-8",children:"No location data available"})}):y.map((j,w)=>e.jsxs(Ws,{children:[e.jsxs(Ke,{className:"font-medium",children:[j.city&&j.state?`${j.city}, ${j.state}`:j.city||j.state||"Unknown",!j.isClassified&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Unclassified)"})]}),e.jsx(Ke,{className:"text-right",children:da(j.totalSales,t)}),e.jsx(Ke,{className:"text-right",children:j.orderCount.toLocaleString()})]},`${j.city}-${j.state}-${w}`))})]})}),S>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(l-1)*i+1," to"," ",Math.min(l*i,v.length)," of ",v.length," ","locations"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"outline",size:"sm",onClick:()=>N(1),disabled:l===1,children:e.jsx(us,{className:"h-4 w-4"})}),e.jsxs("div",{className:"text-sm",children:["Page ",l," of ",S]}),e.jsx(z,{variant:"outline",size:"sm",onClick:()=>N(l+1),disabled:l===S,children:e.jsx(Je,{className:"h-4 w-4"})})]})]})]})}function $h({summary:s,currencyCode:a="USD"}){const t=Object.values(s).reduce((o,i)=>({totalSales:o.totalSales+i.totalSales,totalOrders:o.totalOrders+i.totalOrderCount,totalLocations:o.totalLocations+i.locationCount}),{totalSales:0,totalOrders:0,totalLocations:0}),l=Object.entries(s).map(([o,i])=>e.jsxs(ue,{className:"transition-transform hover:scale-105",children:[e.jsx(bs,{className:"pb-2",children:e.jsx(Ts,{className:"text-sm font-medium text-muted-foreground capitalize",children:o})}),e.jsx(he,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Sales"})]}),e.jsx("span",{className:"text-lg font-semibold",children:da(i.totalSales,a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Orders"})]}),e.jsx("span",{className:"text-lg font-semibold",children:i.totalOrderCount.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Locations"})]}),e.jsx("span",{className:"text-lg font-semibold",children:i.locationCount.toLocaleString()})]})]})})]},o));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ue,{className:"bg-primary/5 border-primary/20",children:[e.jsx(bs,{children:e.jsx(Ts,{className:"text-lg font-semibold",children:"Overall Summary"})}),e.jsx(he,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Sales"})]}),e.jsx("span",{className:"text-xl font-bold",children:da(t.totalSales,a)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Orders"})]}),e.jsx("span",{className:"text-xl font-bold",children:t.totalOrders.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Locations"})]}),e.jsx("span",{className:"text-xl font-bold",children:t.totalLocations.toLocaleString()})]})]})})]}),l.length>0&&e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:l})})]})}function Fh(){var $;const s=V(F=>F.date.from),a=V(F=>F.date.to),{brandId:t}=ge(),o=V(F=>F.brand.brands).find(F=>F._id===t),i=r.useMemo(()=>({from:s,to:a}),[s,a]),[c,d]=r.useState("metro"),[u,m]=r.useState(!0),[h,v]=r.useState(null),[y,S]=r.useState(null),x=Ce(),p=i!=null&&i.from?Y(i.from,"yyyy-MM-dd"):"",N=i!=null&&i.to?Y(i.to,"yyyy-MM-dd"):"",j=(($=o==null?void 0:o.shopifyAccount)==null?void 0:$.currency)||"USD",w=r.useCallback(async()=>{var F,A;if(!(!t||!p||!N)){m(!0),v(null);try{const C=await x.get("/api/analytics/location-sales",{params:{brandId:t,dimension:c,startDate:p,endDate:N},withCredentials:!0});S(C.data)}catch(C){console.error("Error fetching location analytics:",C),v(((A=(F=C.response)==null?void 0:F.data)==null?void 0:A.message)||"Failed to fetch location analytics. Please try again.")}finally{m(!1)}}},[t,c,p,N]);r.useEffect(()=>{i.from&&i.to&&w()},[w]);const P=F=>{d(F)},g=r.useCallback(()=>{w()},[w]);return u&&!y?e.jsx(Ae,{isLoading:!0}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-white border-b px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Location Analytics"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"dimension-select",className:"text-sm font-medium whitespace-nowrap",children:"Dimension:"}),e.jsxs(We,{value:c,onValueChange:P,children:[e.jsx(Be,{id:"dimension-select",className:"w-[150px]",children:e.jsx(He,{})}),e.jsxs(Ge,{children:[e.jsx(ie,{value:"metro",children:"Metro"}),e.jsx(ie,{value:"region",children:"Region"}),e.jsx(ie,{value:"tier",children:"Tier"}),e.jsx(ie,{value:"coastal",children:"Coastal"})]})]})]}),e.jsx(Le,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}}),e.jsx(z,{onClick:g,disabled:u,variant:"outline",size:"icon",className:"flex-shrink-0",children:e.jsx($e,{className:`h-4 w-4 ${u?"animate-spin":""}`})})]})]})}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[h&&e.jsxs(cl,{variant:"destructive",className:"mb-4",children:[e.jsx(js,{className:"h-4 w-4"}),e.jsx(dl,{children:h})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsx($h,{summary:y.summary,currencyCode:j})}),Object.keys(y.data).length===0?e.jsx(ue,{children:e.jsx(he,{className:"pt-6",children:e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No location data available for the selected date range and dimension."})})}):e.jsx("div",{className:"space-y-8",children:Object.entries(y.data).map(([F,A])=>e.jsx(Th,{data:A,dimensionValue:F,currencyCode:j},F))})]})]})]})}const _h=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Re,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(Fh,{}),e.jsx(Ps,{})]})]}),Ih={"chart-1":"text-chart-1 bg-chart-1/20","chart-2":"text-chart-2 bg-chart-2/20","chart-3":"text-chart-3 bg-chart-3/20","chart-4":"text-chart-4 bg-chart-4/20"};function Ph(){const[s,a]=r.useState("login"),[t,l]=r.useState(!0),[o,i]=r.useState(!1),[c,d]=r.useState(""),[u,m]=r.useState(""),[h,v]=r.useState(""),[y,S]=r.useState(""),[x,p]=r.useState(!1),{toast:N}=mt(),j=Xe(),[w,P]=r.useState({username:"",email:"",password:"",shop:""}),g=V(B=>B.user.user),$=Me();r.useEffect(()=>{g!=null&&g.brands&&g.brands.length>0?j("/dashboard"):g!=null&&g.brands&&g.brands.length===0&&j("/first-time-brand-setup")},[g,j]),r.useEffect(()=>{l(s==="login")},[s]);const F=()=>{p(!x)},A=()=>{const B={username:"",email:"",password:"",shop:""};let O=!0;return x?(y.trim()||(B.shop="Shop name is required",O=!1),O):(!t&&!c.trim()&&(B.username="Username is required",O=!1),u.trim()?/\S+@\S+\.\S+/.test(u)||(B.email="Email is invalid",O=!1):(B.email="Email is required",O=!1),h?h.length<8&&(B.password="Password must be at least 8 characters",O=!1):(B.password="Password is required",O=!1),P(B),O)},C=async B=>{if(B.preventDefault(),!!A()){if(i(!0),x){I();return}try{let O;if(t){if(O=await ne.post(`${be}/api/auth/login/normal`,{email:u,password:h},{withCredentials:!0}),O.data.success){const E={...O.data.user};$(Bt(E)),N({title:"Login successful!",description:"Welcome! Redirecting to your dashboard.",variant:"default"}),console.log(g),g!=null&&g.brands&&g.brands.length>0?j("/dashboard"):g!=null&&g.brands&&g.brands.length===0&&j("/first-time-brand-setup")}}else O=await ne.post(`${be}/api/auth/signup`,{username:c,email:u,password:h},{withCredentials:!0}),O.data.success&&(N({title:"Registration successful!",description:"Please log in with your new account.",variant:"default"}),l(!0))}catch(O){ne.isAxiosError(O)&&O.response?N({title:"Error",description:O.response.data.message||"An error occurred",variant:"destructive"}):N({title:"Unexpected Error",description:"An unexpected error occurred",variant:"destructive"})}finally{i(!1),d(""),m(""),v("")}}},_=async()=>{try{const B=await ne.get(`${be}/api/auth/google?context=userLogin`),{authUrl:O}=B.data;window.location.href=O}catch(B){console.error("Error getting Google Auth URL:",B)}},I=async()=>{try{if(!y.trim()){P(E=>({...E,shop:"Shop name is required"}));return}const B=await ne.post(`${be}/api/auth/shopify`,{shop:y,flowType:"login"}),{authUrl:O}=B.data;window.location.href=O}catch(B){console.error("Error getting Shopify Auth URL:",B),N({title:"Error",description:"Failed to connect to Shopify",variant:"destructive"})}};return e.jsxs("div",{className:"auth-theme min-h-screen flex flex-col lg:flex-row",children:[e.jsxs("div",{className:"hidden lg:flex flex-1 bg-muted/50 items-center justify-center p-12 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-accent/10 via-transparent to-transparent"}),e.jsxs("div",{className:"relative w-full max-w-lg",children:[e.jsxs("div",{className:"bg-card rounded-2xl shadow-xl border p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"font-semibold text-foreground",children:"Dashboard Overview"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(sa,{icon:e.jsx(za,{className:"size-4"}),label:"Revenue",value:"$124,892",change:"+12.5%",positive:!0}),e.jsx(sa,{icon:e.jsx(Qe,{className:"size-4"}),label:"ROAS",value:"4.2x",change:"+0.8x",positive:!0}),e.jsx(sa,{icon:e.jsx(ys,{className:"size-4"}),label:"Orders",value:"2,847",change:"+8.3%",positive:!0}),e.jsx(sa,{icon:e.jsx(Ba,{className:"size-4"}),label:"Conv. Rate",value:"3.42%",change:"+0.24%",positive:!0})]}),e.jsx("div",{className:"h-32 bg-muted/50 rounded-lg flex items-end justify-around px-4 pb-4 gap-2",children:[40,65,45,80,55,90,70,85,60,95,75,100].map((B,O)=>e.jsx("div",{className:"w-full bg-primary/20 rounded-t transition-all duration-300 hover:bg-primary/40",style:{height:`${B}%`}},O))})]}),e.jsx("div",{className:"animate-bounce-slow absolute -top-4 -right-4 bg-card rounded-xl shadow-lg border p-4 animate-in slide-in-from-top-2 duration-500",children:e.jsxs("div",{className:"flex items-center gap-3 ",children:[e.jsx("div",{className:"size-10 rounded-full bg-chart-2/20 flex items-center justify-center",children:e.jsx(Qe,{className:"size-5 text-chart-2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sales Trend"}),e.jsx("p",{className:"font-semibold text-foreground",children:"+23.5%"})]})]})}),e.jsx("div",{className:"animate-bounce-slow absolute -bottom-4 -left-4 bg-card rounded-xl shadow-lg border p-4 animate-in slide-in-from-bottom-2 duration-500 delay-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-full bg-chart-1/20 flex items-center justify-center",children:e.jsx(za,{className:"size-5 text-chart-1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg. Order"}),e.jsx("p",{className:"font-semibold text-foreground",children:"$43.87"})]})]})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-screen lg:min-h-0",children:[e.jsx("header",{className:"lg:hidden px-6 py-4 border-b border-border",children:e.jsx(nt,{to:"/",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl",children:[e.jsx("img",{src:nr,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{children:"Parallels"})]})})}),e.jsx("div",{className:"flex-1 flex items-center justify-center px-6 py-10 lg:px-10 xl:px-16",children:e.jsxs("div",{className:"w-full max-w-[400px]",children:[e.jsxs("div",{className:"mb-8 text-center lg:text-left",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-foreground text-balance",children:"Welcome to Parallels"}),e.jsx("p",{className:"mt-2 text-muted-foreground text-balance",children:"Track your sales, revenue, and marketing performance in one place."})]}),x?e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"shop",className:"text-sm font-medium text-muted-foreground",children:"Shopify Store Name"}),e.jsx(ve,{id:"shop",type:"text",placeholder:"your-store-name",disabled:o,value:y,onChange:B=>S(B.target.value),required:!0,autoComplete:"shop",className:"h-11  focus:border-blue-500 focus:ring-blue-500"}),w.shop&&e.jsx("p",{className:"text-red-500 text-sm",children:w.shop})]}),e.jsx(z,{onClick:I,type:"submit",className:"w-full h-11 mt-4",children:"Connect Shopify Store"}),e.jsx("div",{className:" inline-block w-full flex items-center justify-center",children:e.jsx("p",{className:"text-center mt-4 text-sm text-muted-foreground cursor-pointer hover:underline transition-colors duration-300",onClick:()=>F(),children:"Back"})})]}):e.jsxs(Jo,{value:s,onValueChange:a,className:"w-full",children:[e.jsxs(fr,{className:"w-full grid grid-cols-2 h-11 mb-6",children:[e.jsx(Bs,{value:"login",className:"text-sm",children:"Log in"}),e.jsx(Bs,{value:"signup",className:"text-sm",children:"Sign up"})]}),e.jsx(Wt,{value:"login",className:"mt-0",children:e.jsx(Eh,{toggleShopifyLogin:F,handleGoogleLogin:_,handleSubmit:C,errors:w,isLoading:o,email:u,setEmail:m,password:h,setPassword:v})}),e.jsx(Wt,{value:"signup",className:"mt-0",children:e.jsx(Lh,{toggleShopifyLogin:I,handleGoogleLogin:_,errors:w,isLoading:o,handleSubmit:C,email:u,setEmail:m,password:h,setPassword:v,username:c,setUsername:d,setIsLogin:l})})]})]})}),e.jsx("footer",{className:"px-6 py-4 text-center text-xs text-muted-foreground border-t border-border lg:border-0",children:e.jsxs("p",{children:["By continuing, you agree to our"," ",e.jsx("a",{href:"/terms",className:"underline underline-offset-2 hover:text-foreground transition-colors",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"underline underline-offset-2 hover:text-foreground transition-colors",children:"Privacy Policy"})]})})]})]})}function Eh({toggleShopifyLogin:s,handleGoogleLogin:a,handleSubmit:t,isLoading:l,email:o,setEmail:i,password:c,setPassword:d,errors:u}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"login-email",children:"Email"}),e.jsx(ve,{id:"login-email",type:"email",placeholder:"you@company.com",disabled:l,value:o,onChange:m=>i(m.target.value),required:!0,autoComplete:"email",className:"h-11"}),u.email&&e.jsx("p",{className:"text-red-500 text-sm",children:u.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(ye,{htmlFor:"login-password",children:"Password"})}),e.jsx(ve,{id:"login-password",type:"password",placeholder:"Enter your password",value:c,onChange:m=>d(m.target.value),required:!0,disabled:l,autoComplete:"current-password",className:"h-11"}),u.password&&e.jsx("p",{className:"text-red-500 text-sm",children:u.password})]}),e.jsx(z,{onClick:t,type:"submit",className:"w-full h-11",children:l?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"size-4 animate-spin"}),"Logging in..."]}):"Log in"})]}),e.jsx(ul,{}),e.jsx(ml,{toggleShopifyLogin:s,handleGoogleLogin:a,isLoading:l})]})}function Lh({toggleShopifyLogin:s,handleGoogleLogin:a,handleSubmit:t,isLoading:l,email:o,setEmail:i,password:c,setPassword:d,username:u,setUsername:m,errors:h}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"signup-fullname",children:"Username"}),e.jsx(ve,{id:"signup-fullname",type:"text",placeholder:"John Smith",value:u,onChange:v=>m==null?void 0:m(v.target.value),required:!0,disabled:l,autoComplete:"name",className:"h-11"}),h.username&&e.jsx("p",{className:"text-red-500 text-sm",children:h.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"signup-email",children:"Work email"}),e.jsx(ve,{id:"signup-email",type:"email",placeholder:"you@company.com",value:o,onChange:v=>i(v.target.value),required:!0,disabled:l,autoComplete:"email",className:"h-11"}),h.email&&e.jsx("p",{className:"text-red-500 text-sm",children:h.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{htmlFor:"signup-password",children:"Password"}),e.jsx(ve,{id:"signup-password",type:"password",placeholder:"Create a password",value:c,onChange:v=>d(v.target.value),required:!0,disabled:l,autoComplete:"new-password",minLength:8,className:"h-11"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 8 characters"}),h.password&&e.jsx("p",{className:"text-red-500 text-sm",children:h.password})]}),e.jsx(z,{disabled:l,type:"submit",className:"w-full h-11",children:l?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"size-4 animate-spin"}),"Creating account..."]}):"Create free account"})]}),e.jsx(ul,{}),e.jsx(ml,{toggleShopifyLogin:s,handleGoogleLogin:a,isLoading:l}),e.jsxs("div",{className:"flex items-center justify-center gap-6 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(to,{className:"size-3.5"}),e.jsx("span",{children:"No credit card required"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(io,{className:"size-3.5"}),e.jsx("span",{children:"Secure data"})]})]})]})}function ml({toggleShopifyLogin:s,handleGoogleLogin:a,isLoading:t}){return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(z,{type:"button",variant:"outline",className:"w-full h-11 bg-transparent",onClick:()=>a(),disabled:t,children:[e.jsxs("svg",{className:"size-5",viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]}),e.jsxs(z,{type:"button",variant:"outline",className:"w-full h-11 bg-transparent",onClick:()=>s(),disabled:t,children:[e.jsxs("svg",{className:"size-5",viewBox:"0 0 24 24",fill:"#96BF48","aria-hidden":"true",children:[e.jsx("path",{d:"M15.337 3.415c-.022-.165-.18-.247-.3-.261-.12-.014-2.547-.19-2.547-.19s-1.685-1.684-1.876-1.876c-.19-.19-.561-.134-.705-.09-.02.006-.38.117-.97.3-.58-1.674-1.6-3.213-3.396-3.213-.05 0-.1.002-.15.005C5.051-.365 4.598.003 4.2.435c-1.186 1.283-1.68 3.202-1.865 4.831-.943.292-1.6.494-1.682.52-.522.164-.538.18-.606.673-.052.368-1.411 10.872-1.411 10.872L13.56 19.5l6.44-1.61s-4.64-14.31-4.663-14.475zM9.87 2.9l-.79.244c.004-.26.002-.53-.01-.796.492.095.847.39 1.015.815-.073.023-.144.045-.215.067zm-1.47.455l-1.685.52c.163-.63.474-1.257.9-1.676.158-.156.378-.328.634-.427.248.53.286 1.18.15 1.583zm-1.1-2.153c.207 0 .384.04.54.114-.24.117-.47.3-.688.55-.574.655-.998 1.674-1.17 2.656l-1.4.432c.313-1.416 1.514-3.72 2.718-3.752z"}),e.jsx("path",{d:"M15.037 3.154c-.12-.014-2.547-.19-2.547-.19s-1.685-1.684-1.876-1.876c-.072-.072-.167-.106-.263-.12l-.91 18.532 6.44-1.61s-4.64-14.31-4.663-14.475c-.022-.165-.18-.247-.3-.261zm-5.2 4.92l-.668 2.48s-.738-.395-1.64-.395c-1.326 0-1.392.832-1.392 1.04 0 1.143 2.978 1.58 2.978 4.255 0 2.105-1.334 3.46-3.133 3.46-2.16 0-3.265-1.344-3.265-1.344l.58-1.912s1.135.974 2.094.974c.625 0 .88-.493.88-.853 0-1.49-2.444-1.556-2.444-4.006 0-2.06 1.478-4.056 4.466-4.056 1.152 0 1.723.33 1.723.33l-.58 1.527z"})]}),"Continue with Shopify"]})]})}function ul(){return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-3 text-muted-foreground",children:"or"})})]})}function sa({icon:s,label:a,value:t,change:l,positive:o,color:i}){return e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsxs("div",{className:`flex items-center gap-2 text-muted-foreground mb-2 ${Ih[i]}`,children:[s,e.jsx("span",{className:"text-xs",children:a})]}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:t}),e.jsx("p",{className:`text-xs mt-1 ${o?"text-chart-2":"text-destructive"}`,children:l})]})}function Dh(){return e.jsx(Kl,{store:Ds,children:e.jsx(hc,{loading:null,persistor:Gd,children:e.jsx(Mm,{children:e.jsx(gl,{children:e.jsx(lh,{children:e.jsxs(xu,{children:[e.jsx(gu,{}),e.jsx(Ic,{}),e.jsxs(oc,{children:[e.jsx(Ee,{path:"/",element:e.jsx(Du,{})}),e.jsx(Ee,{path:"/login",element:e.jsx(Ph,{})}),e.jsx(Ee,{path:"/dashboard",element:e.jsx(rm,{})}),e.jsx(Ee,{path:"/admetrics/:brandId",element:e.jsx(am,{})}),e.jsx(Ee,{path:"/ecommerce-reports/:brandId",element:e.jsx(Am,{})}),e.jsx(Ee,{path:"/marketing-insights/:brandId",element:e.jsx(om,{})}),e.jsx(Ee,{path:"/performance-metrics",element:e.jsx(hm,{})}),e.jsx(Ee,{path:"/segment-dashboard/:brandId",element:e.jsx(bm,{})}),e.jsx(Ee,{path:"/meta-reports/:brandId",element:e.jsx(Xm,{})}),e.jsx(Ee,{path:"/google-reports/:brandId",element:e.jsx(Om,{})}),e.jsx(Ee,{path:"/conversion-reports/:brandId",element:e.jsx(Zu,{})}),e.jsx(Ee,{path:"/page-analytics/:brandId",element:e.jsx(ph,{})}),e.jsx(Ee,{path:"/callback",element:e.jsx(jm,{})}),e.jsx(Ee,{path:"/profile",element:e.jsx(au,{})}),e.jsx(Ee,{path:"/shopify",element:e.jsx(ah,{})}),e.jsx(Ee,{path:"/brand-setup",element:e.jsx(nh,{})}),e.jsx(Ee,{path:"/privacy-policy",element:e.jsx(Ru,{})}),e.jsx(Ee,{path:"/terms-and-conditions",element:e.jsx(Ou,{})}),e.jsx(Ee,{path:"/meta-campaigns/:brandId",element:e.jsx(eh,{})}),e.jsx(Ee,{path:"/meta-interest/:brandId",element:e.jsx(th,{})}),e.jsx(Ee,{path:"/creatives-library/:brandId",element:e.jsx(ch,{})}),e.jsx(Ee,{path:"/pricing_callback",element:e.jsx(rh,{})}),e.jsx(Ee,{path:"/first-time-brand-setup",element:e.jsx(lu,{})}),e.jsx(Ee,{path:"/d2c-calculator/:brandId",element:e.jsx(xh,{})}),e.jsx(Ee,{path:"/bounce-rate-reports/:brandId",element:e.jsx(vh,{})}),e.jsx(Ee,{path:"/followed-brands/:brandId",element:e.jsx(wh,{})}),e.jsx(Ee,{path:"/festival-calendar/:brandId",element:e.jsx(Sh,{})}),e.jsx(Ee,{path:"/speed-insights",element:e.jsx(kh,{})}),e.jsx(Ee,{path:"/location-analytics/:brandId",element:e.jsx(_h,{})})]})]})})})})})})}hl(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(Dh,{})}));
//# sourceMappingURL=index-ki4vFiUy.js.map
